(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aef5e66c","chunk-bc6e9f94","chunk-a812a06e","chunk-6e883804","chunk-c83fe0b2"],{"0426":function(e,t,i){"use strict";i.r(t);i("6762"),i("2fdb"),i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"resize",rawName:"v-resize",value:e.containerResize,expression:"containerResize"}],staticClass:"container"},[t("van-popup",{style:{height:"100%",width:"35%"},attrs:{"get-container":"body",position:"left"},model:{value:e.leftMenuShow,callback:function(t){e.leftMenuShow=t},expression:"leftMenuShow"}},[t("div",{staticClass:"left-menu"},[t("div",{staticClass:"avatar"},[t("van-image",{attrs:{round:"",width:"5rem",height:"5rem",fit:"cover",src:e.imageUrl+e.avatar}})],1),e._v(" "),t("span",[e._v(e._s(e.name))]),e._v(" "),t("div",{staticClass:"classification"},[t("van-cell",{attrs:{title:"首页",icon:"wap-home-o"},on:{click:function(t){return e.clickFileType(null,{})}}}),e._v(" "),t("van-cell",{attrs:{title:"收藏",icon:"star-o"},on:{click:function(t){return e.clickFileType(null,{isFavorite:!0})}}}),e._v(" "),t("van-cell",{attrs:{title:"图片",icon:"photo-o"},on:{click:function(t){return e.clickFileType("image",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"视频",icon:"video-o"},on:{click:function(t){return e.clickFileType("video",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"音乐",icon:"music-o"},on:{click:function(t){return e.clickFileType("audio",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"文件传输",icon:"upgrade"},on:{click:e.uploadList}})],1),e._v(" "),t("div",{staticClass:"logout"},[t("van-button",{attrs:{round:"",type:"danger"},nativeOn:{click:function(t){return e.logout.apply(null,arguments)}}},[e._v("退出登录")])],1)])]),e._v(" "),t("van-list",{attrs:{finished:e.finished,"finished-text":e.statistics()},on:{load:function(t){e.searchStatus&&e.searchValue.length>0?e.searchFile(e.searchValue,!0):e.getFileList(!0)}},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[t("van-checkbox-group",{ref:"checkboxGroup",on:{change:e.checkboxChange},model:{value:e.selectRowData,callback:function(t){e.selectRowData=t},expression:"selectRowData"}},[t("van-cell-group",[t("van-sticky",{attrs:{"offset-top":-1}},[e.pathList.length<2&&!e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:"浏览","right-arrow":"","right-text":this.selectRowData.length!==this.fileList.length?"选择":"取消","left-arrow":""},on:{"click-right":e.checkboxAll,"click-left":e.leftMenu}},[t("div",{staticClass:"header-button",attrs:{slot:"left"},slot:"left"},[t("svg",{staticClass:"header-button-icon",attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25"}},[t("path",{attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 0 0 0-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0 0 14.4 7z"}})])])]):e._e(),e._v(" "),e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:0===e.selectRowData.length?"选择项目":e.selectRowData.length+"项","right-arrow":"","left-text":this.selectRowData.length!==this.fileList.length?"全选":"取消全选","right-text":"完成"},on:{"click-left":e.checkboxAll,"click-right":e.cancelSelect}}):e._e(),e._v(" "),e.pathList.length>=2&&!e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:e.pathList[e.pathList.length-1].folder,"right-text":this.selectRowData.length!==this.fileList.length?"选择":"取消","left-arrow":""},on:{"click-right":e.checkboxAll,"click-left":e.clickBack}},[t("div",{staticClass:"header-button",attrs:{slot:"left"},slot:"left"},[t("van-icon",{attrs:{name:"arrow-left"}})],1)]):e._e(),e._v(" "),t("div",{staticClass:"searchbar",style:e.searchBarClass},[t("van-search",{ref:"search",attrs:{"show-action":e.searchStatus,shape:"round",placeholder:"搜索"},on:{focus:e.startSearch,search:e.onSearch,input:e.onSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[t("div",{attrs:{slot:"action"},on:{click:e.endSearch},slot:"action"},[e._v("取消")])])],1)],1),e._v(" "),t("van-cell",{staticStyle:{padding:"0 0 10px 0"},attrs:{center:!0}},[t("div",{staticClass:"operating-header"},[t("van-row",[t("van-col",{staticClass:"operating-header-col",attrs:{span:"4",align:"center",type:"flex"},on:{click:e.moreOperations}},[t("van-icon",{attrs:{name:"more-o"}})],1),e._v(" "),t("van-col",{staticClass:"operating-header-col",attrs:{span:"16",align:"center"},on:{click:e.showSortSheet}},[e._v("\n                已按"+e._s(e.actionsSortName)+"排序\n                "),t("van-icon",{staticClass:"sortable",attrs:{name:"arrow-"+e.sortOrder}})],1),e._v(" "),t("van-col",{staticClass:"operating-header-col",attrs:{span:"4",align:"center"},on:{click:e.changeVmode}},[t("van-icon",{style:e.grid?{}:{background:"#1989fa",color:"#ffffff",padding:"0 5px",borderRadius:"5px"},attrs:{name:"bars"}})],1)],1)],1)]),e._v(" "),e.searchStatus&&e.searchValue.length>0&&e.fileList.length>0?t("van-cell",{staticStyle:{"background-color":"#f7f8fa"}},[t("div",{staticClass:"search-result"},[e._v(e._s(e.resultCount)+"个结果")])]):e._e(),e._v(" "),e.searchStatus&&e.searchValue.length>0&&0===e.fileList.length?t("van-cell",[t("div",{staticClass:"search-result-no"},[e._v("无结果")])]):e._e(),e._v(" "),e.loading||0!==e.fileList.length?e._e():t("van-empty",{attrs:{description:"空空如也"}}),e._v(" "),e._l(e.fileList,(function(i,n){return e.grid?e._e():t("van-cell",{key:i.id,staticClass:"list-item",style:{background:e.selectIndexList.includes(n)?"#90c2fcb5":""},attrs:{center:"","is-link":i.isFolder},on:{click:function(t){return e.fileClick(i,n)}}},[t("div",{staticClass:"list-item-div",on:{touchstart:function(t){return e.touchStart(i)},touchend:e.touchEnd,touchmove:e.touchMove}},[t("van-row",{staticClass:"row-file"},[t("van-col",{staticClass:"list-cell-icon",attrs:{span:"4",align:"center"}},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})],1),e._v(" "),t("van-col",{staticClass:"list-item-content",attrs:{span:"16"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                  "+e._s(i.name)+"\n                ")]),e._v(" "),t("van-col",{staticClass:"file-description",attrs:{span:"24",justify:"space-between"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                    "+e._s(e.formatTime(i.agoTime))+"   "+e._s(e.formatSize(i.size))+"\n                  ")])],1)],1),e._v(" "),t("van-col",{attrs:{span:"4"}})],1)],1),e._v(" "),!e.grid&&e.selectStatus?t("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:i},slot:"right-icon"}):e._e()],1)})),e._v(" "),e.grid?t("van-grid",{style:{width:"100%",overflow:"auto"},attrs:{square:"",center:!0,"column-num":e.gridColumnNum,gutter:10,border:!1}},e._l(e.fileList,(function(i,n){return t("van-grid-item",{key:i.id,ref:"gridItem",refInFor:!0,staticClass:"parent-grid-item",on:{click:function(t){return e.fileClick(i,n)}}},[t("div",{staticClass:"grid-time van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:{background:e.selectIndexList.includes(n)?"#90c2fcb5":"","border-radius":"15px"},on:{touchstart:function(t){return e.touchStart(i)},touchend:e.touchEnd,touchmove:e.touchMove}},[e.grid&&e.selectStatus?t("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:i},slot:"right-icon"}):e._e(),e._v(" "),t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0}})],1),e._v(" "),t("span",{staticClass:"grid-item-text",attrs:{title:i.name}},[e._v(e._s(i.name))])],1)])})),1):e._e()],2)],1)],1),e._v(" "),t("van-action-sheet",{attrs:{actions:e.actionsMenus,"cancel-text":"取消"},on:{cancel:e.onCancel,select:e.selectActionsMenus},model:{value:e.actionSheetShow,callback:function(t){e.actionSheetShow=t},expression:"actionSheetShow"}}),e._v(" "),t("van-action-sheet",{attrs:{actions:e.actionsSortMenus,"cancel-text":"取消",description:"排序方式"},on:{cancel:e.onCancel,select:e.selectSortActionsMenus},model:{value:e.actionSortSheetShow,callback:function(t){e.actionSortSheetShow=t},expression:"actionSortSheetShow"}}),e._v(" "),t("van-dialog",{attrs:{"show-cancel-button":""},on:{confirm:e.newFolderNameClick},model:{value:e.showNewFolder,callback:function(t){e.showNewFolder=t},expression:"showNewFolder"}},[t("van-field",{ref:"newFolderInput",staticClass:"new-folder-input",attrs:{placeholder:"请输入文件夹名称",border:!0,clearable:!0,autofocus:!0},model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}})],1),e._v(" "),t("van-dialog",{attrs:{"show-cancel-button":""},on:{confirm:function(t){return e.rowRename()}},model:{value:e.showRename,callback:function(t){e.showRename=t},expression:"showRename"}},[t("van-field",{ref:"renameInput",staticClass:"rename-input",attrs:{placeholder:"请输入文件名称",border:!0,clearable:!0,autofocus:!0},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}})],1),e._v(" "),t("e-vue-contextmenu",{ref:"contextShow",staticClass:"newFileMenu",on:{"ctx-show":e.show,"ctx-hide":e.hide}},e._l(e.menus,(function(i,n){return t("ul",{key:i.label,class:{"menu-list-first":0===n,"menu-list-last":n===e.menus.length-1,"menu-list":n<e.menus.length-1&&n>0}},[0!==n?t("div",{staticStyle:{"border-bottom":"1px solid #cccccc85"}}):e._e(),e._v(" "),t("li",{class:{remove:"remove"===i.operation},on:{click:function(t){return e.menusOperations(i.operation)}}},[t("div",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)])])})),0),e._v(" "),t("van-overlay",{ref:"overlayShow",attrs:{show:e.overlayShow,duration:"0.3"},on:{click:e.overlayClick}},[null==e.rowContextData.name||e.grid?e._e():t("van-cell",{staticClass:"list-item overlay-content-class",style:e.overlayContentClass,attrs:{center:"","is-link":e.rowContextData.isFolder}},[t("div",[t("van-row",{staticClass:"row-file"},[t("van-col",{staticClass:"list-cell-icon",attrs:{span:"4",align:"center"}},[t("icon-file",{attrs:{item:e.rowContextData,"image-url":e.imageUrl}})],1),e._v(" "),t("van-col",{staticClass:"list-item-content",attrs:{span:"16"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n              "+e._s(e.rowContextData.name)+"\n            ")]),e._v(" "),t("van-col",{staticClass:"file-description",attrs:{span:"24",justify:"space-between"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                "+e._s(e.formatTime(e.rowContextData.agoTime))+"   "+e._s(e.formatSize(e.rowContextData.size))+"\n              ")])],1)],1),e._v(" "),t("van-col",{attrs:{span:"4"}})],1)],1),e._v(" "),e.selectStatus?t("van-checkbox",{staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:e.rowContextData},slot:"right-icon",model:{value:e.isShowCheckContext,callback:function(t){e.isShowCheckContext=t},expression:"isShowCheckContext"}}):e._e()],1),e._v(" "),null!=e.rowContextData.name&&e.grid?t("div",{staticClass:"grid-time overlay-content-class van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:e.overlayContentClass},[e.selectStatus?t("van-checkbox",{staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:e.rowContextData},slot:"right-icon",model:{value:e.isShowCheckContext,callback:function(t){e.isShowCheckContext=t},expression:"isShowCheckContext"}}):e._e(),e._v(" "),t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:e.rowContextData,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0}})],1),e._v(" "),t("span",{staticClass:"grid-item-text",attrs:{title:e.rowContextData.name}},[e._v(e._s(e.rowContextData.name))])],1):e._e()],1),e._v(" "),t("sim-text-preview",{attrs:{file:e.textPreviewRow,status:e.textPreviewVisible,"is-together":e.isTogether},on:{"update:file":function(t){e.textPreviewRow=t},"update:status":function(t){e.textPreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}}),e._v(" "),t("image-viewer",{attrs:{fileList:e.fileList,file:e.imagePreviewRow,status:e.imagePreviewVisible},on:{"update:status":function(t){e.imagePreviewVisible=t}}}),e._v(" "),t("video-preview",{attrs:{file:e.videoPreviewRow,status:e.videoPreviewVisible},on:{"update:status":function(t){e.videoPreviewVisible=t}}}),e._v(" "),t("office-preview",{attrs:{file:e.officePreviewRow,status:e.officePreviewVisible,"is-together":e.isTogether},on:{"update:status":function(t){e.officePreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}})],1)},a=[],o=(i("f559"),i("a8f9")),r=(i("55dd"),i("386d"),i("ae4a")),s=(i("96cf"),i("97bf")),l=(i("20d6"),i("aef6"),i("7514"),i("28a5"),i("ac6a"),i("6f8e")),c=i("2f62"),d=i("7f29"),u=i("26a1"),h=i("5580"),p=i("0dcf"),f=i("2690"),m=i("1638"),g=i("ae1f"),v=i("2d53"),b=i("1000"),w=i("fd35"),y=i("b311"),x=i.n(y),C=(i("d958"),{components:{OfficePreview:w["a"],SimTextPreview:v["a"],VideoPreview:g["a"],ImageViewer:m["a"],IconFile:p["a"]},computed:Object(l["a"])({},Object(c["b"])(["name","avatar"])),data:function(){return{test:0,lastTabbarOffsetTop:0,diffTabbarTop:0,isiPhoneX:0,imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),audioCoverUrl:"".concat("/api","/view/cover?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),tabActive:0,path:this.$route.query.path,fileList:[],pathList:[{folder:"",index:0},{folder:"+",index:1}],pagination:{pageIndex:0,pageSize:50,total:0},queryFileType:null,queryCondition:{isFolder:null},loading:!1,finished:!1,refreshing:!1,actionSheetShow:!1,actionsMenus:[{name:"新建文件夹"}],actionSortSheetShow:!1,actionsSortMenus:[{name:"名称"},{name:"日期"},{name:"大小"}],actionsSortName:"名称",showNewFolder:!1,showRename:!1,newFolderName:"新建文件夹",Loop:null,isJustHideMenus:!1,singleMenus:[{iconClass:"menu-select",label:"选择",operation:"select"},{iconClass:"menu-rename",label:"重命名",operation:"rename"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}],menus:[],rowContextData:{},selectRowData:[],checkboxGroup:[],newFolderLoading:!1,renameLoading:!1,renameFileName:"",selectIndexList:[],selectStatus:!1,isShowCheckContext:!1,overlayShow:!1,overlayContentClass:{},vanNavBarClass:{},searchBarClass:{},leftMenuShow:!1,searchValue:"",searchStatus:!0,resultCount:0,sortOrder:"up",sortableProp:null,order:null,grid:!1,vmode:"list",gridColumnNum:-1,imagePreviewRow:{},imagePreviewVisible:!1,videoPreviewRow:{},videoPreviewVisible:!1,officePreviewRow:{},officePreviewVisible:!1,textPreviewVisible:!1,textPreviewRow:{},isTogether:!0}},directives:{resize:{bind:function(e,t){var i="",n="";function a(){var a=document.defaultView.getComputedStyle(e);i===a.width&&n===a.height||t.value(),i=a.width,n=a.height}e.__vueSetInterval__=setInterval(a,300)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},mounted:function(){var e=this;if(this.$route.query.vmode&&(this.vmode=this.$route.query.vmode,"list"===this.vmode?this.grid=!1:this.grid=!0),"/"!==this.$route.query.path){var t=decodeURI(this.$route.query.path);this.pathList.splice(1,1),t.split("/").forEach((function(t,i){if(i>0){var n={};n["folder"]=t,n["index"]=i,e.pathList.push(n)}}))}this.$route.query.folder&&this.path&&localStorage.setItem(this.path,this.$route.query.folder),window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1))},destroyed:function(){window.removeEventListener("popstate",this.goBack,!1)},methods:{highlightFavorite:function(e,t){var i=this.menus.find((function(e){if("favorite"===e.operation||"unFavorite"===e.operation)return e}));i&&(e?(i.label="取消收藏",i.iconClass="menu-unfavorite-hover",i.operation="unFavorite"):(i.iconClass=t?"menu-favorite-hover":"menu-favorite",i.label="收藏",i.operation="favorite"))},show:function(){},hide:function(){var e=this;this.isJustHideMenus=!0,setTimeout((function(){e.isJustHideMenus=!1}),100)},showCheckContext:function(){return this.selectIndexList.includes(this.rowContextData.index)},rowContextmenu:function(e,t,i){if(this.menus=JSON.parse(JSON.stringify(this.singleMenus)),this.selectStatus&&this.selectIndexList.includes(e.index)){if(this.selectIndexList.includes(e.index)){var n={iconClass:"menu-unselect",label:"取消选择",operation:"unselect"};this.menus.splice(0,1,n)}}else{var a={iconClass:"menu-select",label:"选择",operation:"select"};this.menus.splice(0,1,a)}e.isShare&&!e.isPrivacy&&this.menus.splice(-2,0,{iconClass:"menu-fuzhi",label:"复制下载链接",operation:"copyDownloadLink"}),this.preliminaryRowData(e);var o=Object(u["b"])(t)-e.scrollY,r={};o+t.offsetHeight/2>document.body.offsetHeight/2?(r.pageX=i,r.pageY=Object(u["b"])(t)-47*this.menus.length+5):(r.pageX=i,r.pageY=Object(u["b"])(t)+t.offsetHeight+5),this.$refs.contextShow.showMenu(r)},preliminaryRowData:function(e){this.rowContextData=e,this.isShowCheckContext=this.selectIndexList.includes(e.index);var t=this.rowContextData.isFavorite;this.highlightFavorite(t,!1)},menusOperations:function(e){var t=this,i=this;switch(e){case"favorite":this.favoriteOperating(!0);break;case"open":this.fileClick(this.rowContextData,this.rowContextData.index);break;case"unselect":var n=this.rowContextData.index;this.$refs.checkboxes[n].toggle();break;case"unFavorite":this.favoriteOperating(!1);break;case"select":this.selectStatus=!0,this.selectIndexList.push(this.rowContextData.index),setTimeout((function(){t.$refs.checkboxes[i.rowContextData.index].toggle()}),0);break;case"rename":this.renameFileName=this.rowContextData.name,this.showRename=!0,setTimeout((function(){i.$refs.renameInput.focus()}),0);break;case"copy":vant.Toast("暂不支持移动");break;case"download":this.downloadFile();break;case"copyDownloadLink":this.copyDownloadLink(this.rowContextData);break;case"remove":this.deleteFile();break}this.overlayShow=!1,document.documentElement.style.overflow=null,this.$refs.contextShow.hideMenu()},rowRename:function(){var e=this,t=this.rowContextData,i=this.renameFileName;if(i){if(!t.isFolder){var n="."+t.suffix;i.endsWith(n)||(i+=n)}this.renameLoading=!0;var a=this.fileList.findIndex((function(e){if(i===e.name)return e}));if(a>-1){var o="该文件已存在";return t.isFolder&&(o="该文件夹已存在"),this.$message({message:o,type:"warning"}),void(this.renameLoading=!1)}h["a"].rename({newFileName:encodeURI(i),username:this.$store.state.user.name,folder:this.$route.query.folder,id:t.id}).then((function(){e.renameLoading=!1,t.name=i,e.fileList[t.index]=t,e.editingIndex=-1}))}else this.editingIndex=-1},downloadFile:function(){var e=0;if(this.selectRowData.length>0?this.selectRowData.forEach((function(t){e+=t.size})):e+=this.rowContextData.size,e>0){var t=[];if(this.selectRowData.length>0?this.selectRowData.forEach((function(e){t.push(e.id)})):t.push(this.rowContextData.id),t.length>1||this.rowContextData.isFolder)return void f["a"].packageDownloadTogether(t,this.$store.state.user.token,this.$store.state.user.name);f["a"].download(this.$store.state.user.name,this.rowContextData,this.$store.state.user.token)}else this.$message({message:"所选文件夹为空",type:"warning"})},copyDownloadLink:function(e){var t=this,i=window.location.origin+f["a"].previewUrl(this.$store.getters.name,e,void 0,void 0),n=new x.a(".newFileMenu",{text:function(){return i}});n.on("success",(function(e){t.$message({message:"复制成功",type:"success",duration:1e3}),n.destroy()})),n.on("error",(function(e){t.$message({message:"该浏览器不支持自动复制",type:"warning",duration:1e3}),n.destroy()}))},favoriteOperating:function(e){this.rowContextData.isFavorite=e,this.highlightFavorite(e,!0),h["a"].favoriteUrl({fileIds:this.rowContextData.id,isFavorite:e}).then((function(e){}))},deleteFile:function(){var e=this,t=[],i=[];this.selectRowData.length>0?(t=this.selectRowData,this.selectRowData.forEach((function(e){i.push(e.id)}))):(t=this.selectRowData,i.push(this.rowContextData.id));var n=this.getShowSumFileAndFolder(t);vant.Dialog.confirm({title:"提示",message:"此操作将永久删除"+n+", 是否继续?"}).then((function(){h["a"].delete({currentDirectory:e.rowContextData.path,username:e.$store.state.user.name,fileIds:i}).then((function(){e.getFileList(),vant.Toast.setDefaultOptions({duration:800}),vant.Toast.success("删除成功"),e.selectRowData.length>1&&(e.selectRowData=[])}))}))},touchMove:function(){clearTimeout(this.Loop)},touchStart:function(e){var t=this;clearTimeout(this.Loop);var i=window.event;this.Loop=setTimeout((function(){e.scrollY=i.targetTouches[0].pageY-i.targetTouches[0].clientY,t.findListItem(e,i.targetTouches[0].target,i.targetTouches[0].clientX)&&(t.overlayShow=!0,document.documentElement.style.overflow="hidden")}),500)},touchEnd:function(){clearTimeout(this.Loop)},overlayClick:function(){this.overlayShow=!1,document.documentElement.style.overflow=null},findListItem:function(e,t,i){if(null===t)return!1;var n=t.offsetParent,a=t.parentElement;if(!n&&a||null===n)return this.findListItem(e,t.parentElement,i);if(n.className.indexOf("list-item")>-1)this.longPressDisplayLayer(e,n,i);else{if(!(n.className.indexOf("grid-time")>-1))return this.findListItem(e,t.offsetParent,i);this.longPressDisplayLayer(e,n,i)}return!0},longPressDisplayLayer:function(e,t,i){var n=this,a=this.selectIndexList.includes(this.rowContextData.index)?"#90c2fcb5":"";this.overlayContentClass={top:Object(u["b"])(t)-e.scrollY+"px",height:t.offsetHeight+"px",width:t.offsetWidth+"px",left:Object(u["a"])(t)+"px","border-radius":"0px",background:a},setTimeout((function(){n.overlayContentClass={top:Object(u["b"])(t)-e.scrollY+"px",height:t.offsetHeight+"px",width:t.offsetWidth-(n.grid?0:10)+"px",left:Object(u["a"])(t)+(n.grid?0:5)+"px","border-radius":"20px",background:a}}),0),this.rowContextmenu(e,t,i)},goBack:function(){this.pathList.length<=1?this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path))):this.clickBack()},clickBack:function(){this.handleLink(this.pathList[this.pathList.length-2],this.pathList.length-2)},leftMenu:function(){this.leftMenuShow=!0},logout:function(){var e=Object(s["a"])(Object(r["a"])().m((function e(){return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.$store.dispatch("user/logout");case 1:this.$router.push("/login?redirect=".concat(this.$route.fullPath));case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),startSearch:function(){this.vanNavBarClass={visibility:"hidden"},this.searchBarClass={marginTop:"-30px"};var e=document.querySelector(".van-search__action");e.style.marginRight="0px",e.style.visibility="visible",e.style.color="#1989fa"},endSearch:function(){var e=this;setTimeout((function(){e.vanNavBarClass={visibility:"visible"}}),150),this.searchBarClass={marginTop:"0px"};var t=document.querySelector(".van-search__action");t.style.marginRight="-44px",t.style.visibility="hidden",this.searchValue="",this.getFileList()},onSearch:function(){this.searchValue.length<1?this.getFileList():this.searchFile(this.searchValue)},changeVmode:function(){this.grid=!this.grid,this.vmode="list",this.grid&&(this.vmode="grid"),this.path||(this.path=""),this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(this.path).concat(this.$route.query.folder?"&folder="+this.$route.query.folder:""))},showSortSheet:function(){this.actionSortSheetShow=!0},moreOperations:function(){if(this.actionSheetShow=!0,this.actionsMenus=[{name:"新建文件夹"}],window.uploader.support){var e={name:"上传文件"};this.actionsMenus.push(e)}if(window.uploader.supportDirectory){var t={name:"上传文件夹"};this.actionsMenus.push(t)}},handleLink:function(e,t,i,n){var a=this;if(e&&e.search)e.searchKey?this.searchFileByKeyWord(e.searchKey):e.row&&this.searchFileAndOpenDir(e.row),this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1));else{this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1)),this.pathList.forEach((function(e,t){0===t?a.path="":t===a.pathList.length||(a.path+="/"+a.pathList[t].folder)}));var o=localStorage.getItem(this.path);i||(this.$route.query.path,this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(o?"&folder="+o:""))),n||(this.pagination.pageIndex=1,this.getFileList())}},formatTime:function(e){return Object(d["c"])(e)},formatSize:function(e){return Object(d["b"])(e)},onRefresh:function(){this.finished=!1,this.loading=!0,this.getFileList()},getFileList:function(e){var t=this;this.beforeLoadData(e),h["a"].fileList({username:this.$store.state.user.name,userId:this.$store.state.user.userId,currentDirectory:encodeURI(this.$route.query.path),folder:this.$route.query.folder,queryFileType:this.queryFileType,sortableProp:this.sortableProp,order:this.order,isFolder:this.queryCondition.isFolder,isFavorite:this.queryCondition.isFavorite,queryCondition:this.queryCondition,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(i){t.loadData(i,e)})).catch((function(e){}))},searchFile:function(e,t){var i=this;e&&(this.beforeLoadData(t),this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e)),h["a"].searchFile({userId:this.$store.state.user.userId,username:this.$store.state.user.name,keyword:e,currentDirectory:encodeURI(this.$route.query.path),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(e){i.loadData(e,t),i.path="",i.listModeSearch=!0,i.listModeSearchOpenDir=!1})))},beforeLoadData:function(e){e?this.pagination.pageIndex++:this.pagination.pageIndex=1,this.finished=!1,this.fileList=[]},loadData:function(e,t){var i=this;t?e.data.forEach((function(e,t){e["index"]=(i.pagination.pageIndex-1)*i.pagination.pageSize+t,i.fileList.push(e)})):(this.fileList=e.data,this.fileList.map((function(e,t){e["index"]=t}))),this.refreshing=!1,this.resultCount=e.count,this.fileList.length>=e.count&&(this.finished=!0),this.fileList.sort(this.compare(this.sortableProp)),this.$nextTick((function(){i.containerResize(),i.loading=!1}))},containerResize:function(){var e=document.querySelector(".container"),t=e.clientWidth;t>1024?this.gridColumnNum=Math.round(t/100-4):(this.gridColumnNum=Math.round(t/100-2),t<=550&&(this.gridColumnNum=4),t<=375&&(this.gridColumnNum=3))},clickFileType:function(e,t){this.queryCondition=t,this.queryFileType=e,this.getFileList(),this.leftMenuShow=!1},uploadList:function(){this.$router.push("/upload/index_m")},statistics:function(){var e=0;return this.fileList.forEach((function(t){e+=t.size})),this.getShowSumFileAndFolder(this.fileList)+" "+this.getShowSumSize(e)},getShowSumFileAndFolder:function(e){var t=0,i=0;e.forEach((function(e){e.isFolder?t+=1:i+=1}));var n="";t>0&&(n=t+"个文件夹");var a="";return i>0&&(a=i+"个文件"),n+" "+a},getShowSumSize:function(e){var t="";return e>0&&(t="  共"),0===e||(t+=e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"K":e>=1048576&&e<1073741824?(e/1048576).toFixed(2)+"M":(e/1073741824).toFixed(2)+"G"),t},checkboxAll:function(){this.selectRowData.length!==this.fileList.length?this.$refs.checkboxGroup.toggleAll(!0):this.$refs.checkboxGroup.toggleAll()},cancelSelect:function(){this.$refs.checkboxGroup.toggleAll(!1);var e=this;setTimeout((function(){e.selectStatus=!1}))},checkboxChange:function(e){this.selectRowData=e,this.selectIndexList=[];var t,i=Object(o["a"])(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.selectIndexList.push(n.index)}}catch(a){i.e(a)}finally{i.f()}this.selectStatus=!0},fileClick:function(e,t){var i=this;if(this.selectStatus)this.$refs.checkboxes[t].toggle();else if(e.isFolder){this.path?this.path+="/"+e.name:this.path="/"+e.name;var n={};n["folder"]=e.name,n["index"]=this.pathList.length-1,this.pathList.push(n);var a=encodeURI(this.path);this.$store.getters.userId!==e.userId&&(e.mountFileId=e.id),e.mountFileId&&localStorage.setItem(this.path,e.mountFileId),this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(a).concat(e.mountFileId?"&folder="+e.mountFileId:"")),this.getFileList()}else{if(e.contentType.startsWith("image"))return this.imagePreviewVisible=!0,void(this.imagePreviewRow=e);if(b["c"].simText.includes(e.suffix))return this.textPreviewRow=e,void(this.textPreviewVisible=!0);if(e.contentType.indexOf("video")>-1)return this.videoPreviewVisible=!0,void(this.videoPreviewRow=e);if(e.contentType.indexOf("audio")>-1)return void this.$store.dispatch("updateMessage",{event:"onAddAudio",data:{row:e,audioCoverUrl:this.audioCoverUrl}});if(e.contentType.indexOf("office")>-1||"csv"===e.suffix)return this.officePreviewVisible=!0,void(this.officePreviewRow=e);if("pdf"===e.suffix||"PDF"===e.suffix)return void f["a"].preview(this.$store.state.user.name,e,this.$store.getters.token);vant.Dialog.confirm({title:"标题",message:"此文件不支持预览，是否下载",confirmButtonText:"下载"}).then((function(){setTimeout((function(){f["a"].download(i.$store.state.user.name,e,i.$store.state.user.token)}),0)})).catch((function(){}))}},onCancel:function(){this.actionSheetShow=!1,this.actionSortSheetShow=!1},compare:function(e){var t=this;return function(i,n){var a=i[e],o=n[e];return"ascending"===t.order?a-o:o-a}},selectSortActionsMenus:function(e){var t=this;setTimeout((function(){t.actionSortSheetShow=!1}),100),"up"===this.sortOrder?(this.sortOrder="down",this.order="descending"):(this.sortOrder="up",this.order="ascending"),this.actionsSortName=e.name,"名称"===e.name&&(this.sortableProp="name","up"===this.sortOrder&&(this.order=null),this.getFileList()),"大小"===e.name&&(this.sortableProp="size",this.fileList.sort(this.compare(this.sortableProp))),"日期"===e.name&&(this.sortableProp="updateDate",this.getFileList())},selectActionsMenus:function(e){var t=this;if(setTimeout((function(){t.actionSheetShow=!1}),100),"新建文件夹"===e.name){this.newFolderName="新建文件夹";var i=0,n=[];this.fileList.forEach((function(e){n.push(e.name)}));while(n.includes(this.newFolderName))i+=1,this.newFolderName="新建文件夹"+i;this.showNewFolder=!0;var a=this;setTimeout((function(){a.$refs.newFolderInput.focus()}),0)}"上传文件"===e.name&&this.$store.dispatch("updateMessage",{event:"openUploader",data:{folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId}}),"上传文件夹"===e.name&&this.$store.dispatch("updateMessage",{event:"uploadFolder",data:{folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId}})},newFolderNameClick:function(){var e=this;this.newFolderLoading=!0,this.newFolderName?h["a"].uploadFolder({isFolder:!0,filename:encodeURI(this.newFolderName),folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId}).then((function(t){1===t.data?(e.newFolderLoading=!1,e.$message({message:"该文件夹已存在",type:"warning"})):(e.newFolderLoading=!1,e.showNewFolder=!1,e.isShowNewFolder=!1,Notify({type:"success",message:"新建文件夹成功",duration:1e3}),e.listModeSearch?e.getFileListBySearchMode():e.getFileList())})):(this.newFolderLoading=!1,this.$message({message:"请输入文件夹名称",type:"warning"}))},swipeUp:function(){this.test=10},tabBottom:function(){return{padding:"0 0 20px 0"}}}}),k=C,_=(i("167f"),i("2877")),S=Object(_["a"])(k,n,a,!1,null,"21e77af2",null);t["default"]=S.exports},"070b":function(e,t,i){"use strict";i("588b")},"0919":function(e,t,i){"use strict";i("cda5")},"0dca":function(e,t,i){"use strict";i("7f7f");var n=function(){var e=this,t=e._self._c;return t("di",[t("message-dialog",{attrs:{title:"确认信息",content:"检测到未保存的内容，是否在离开前保存修改？",show:e.isSaveDialogVisible,operatButtonText:"放弃修改",confirmButtonText:"保存"},on:{"update:show":function(t){e.isSaveDialogVisible=t},operating:e.closeConfirmDialog,confirm:e.confirmUpdate}}),e._v(" "),t("el-dialog",{staticStyle:{"{'font-weight'":"600}"},attrs:{title:'将标签分配给 "'+e.showName+'"',visible:e.tagDialogVisible,"before-close":e.beforeClose},on:{"update:visible":function(t){e.tagDialogVisible=t},close:e.tagDialogClose}},[t("div",{staticClass:"tag-content"},[e._l(e.tags,(function(i){return t("el-tag",{key:i.name,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleClose(i.name)}}},[t("el-popover",{attrs:{placement:"bottom",trigger:"hover"}},[t("sketch-picker",{on:{input:function(t){return e.updateColor(t,i)}},model:{value:e.colors,callback:function(t){e.colors=t},expression:"colors"}}),e._v(" "),t("el-button",{staticClass:"button-tab-icon",attrs:{slot:"reference",size:"small"},slot:"reference"},[t("svg-icon",{style:{color:i.color,fontSize:"14px"},attrs:{"icon-class":"tag2"}})],1)],1),e._v("\n\n          "+e._s(i.name)+"\n        ")],1)})),e._v(" "),e.inputVisible?t("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm.apply(null,arguments)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):t("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 新标签")]),e._v(" "),t("div",{staticClass:"tag-list"},[e.existingTags.length>0?t("p",[e._v("现有标签: ")]):e._e(),e._v(" "),e._l(e.existingTags,(function(i){return e.isEditMode?e._e():t("el-button",{key:i.name,attrs:{size:"small"},on:{click:function(t){return e.addTag(i)}}},[t("svg-icon",{style:{color:i.color,fontSize:"14px"},attrs:{"icon-class":"tag2"}}),e._v("\n           "+e._s(i.name)+"\n         ")],1)})),e._v(" "),e.isEditMode?t("div",e._l(e.existingTags,(function(i){return t("el-tag",{key:i.name,attrs:{closable:e.isEditMode,"disable-transitions":!1},on:{close:function(t){return e.handleCloseCurrentTags(i.name)}}},[t("svg-icon",{style:{color:i.color,fontSize:"14px"},attrs:{"icon-class":"tag2"}}),e._v("\n              "+e._s(i.name)+"\n            ")],1)})),1):e._e()],2)],2),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.existingTags.length>0||e.isEditMode?t("el-button",{attrs:{size:"small"},on:{click:e.editMode}},[e._v(e._s(e.isEditMode?"取消编辑":"编辑现有标签"))]):e._e(),e._v(" "),t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.saveLoading,expression:"saveLoading"}],attrs:{size:"small",type:"primary"},on:{click:e.submitTag}},[e._v("保存")])],1)])],1)},a=[],o=(i("20d6"),i("ac6a"),i("5cfc")),r=i("d28d"),s=i("c345"),l=i("5a87"),c={name:"TagDialog",components:{MessageDialog:l["a"],"sketch-picker":s["Sketch"]},props:{fileList:{type:Array,default:function(){return[]}},status:{type:Boolean,default:!1},api:{type:Object,default:function(){return null}}},data:function(){return{tagDialogVisible:!1,showName:"",inputVisible:!1,inputValue:"",tags:[],existingTags:[],tagList:[],defaultTagColor:"#f56c6c",saveLoading:!1,colors:{hex:"#f56c6c"},isEditMode:!1,remoteTagIdList:[],isSaveDialogVisible:!1,hasChange:!1}},watch:{status:function(e){var t=this;if(e){if(0===this.fileList.length)return;var i=!1;this.fileList.forEach((function(e){e.tags||(i=!0)})),this.tags=i?[]:this.fileList.map((function(e){return e.tags})).reduce((function(e,t){return e.filter((function(e){return t.some((function(t){return t.name===e.name}))}))})),r["a"].tagList({userId:this.$store.state.user.userId}).then((function(e){t.tagList=e.data,t.updateExistingTags()})),1===this.fileList.length?this.showName=this.fileList[0].name:this.showName=this.fileList.length+"项目",this.tagDialogVisible=!0}}},methods:{updateExistingTags:function(){var e=this;this.existingTags=this.tagList.filter((function(t){return!e.tags.some((function(e){return e.name===t.name}))}))},handleClose:function(e){var t=this.tags.findIndex((function(t){return t.name===e}));this.tags.splice(t,1),this.updateExistingTags()},handleCloseCurrentTags:function(e){var t=this.existingTags.findIndex((function(t){return t.name===e})),i=this.existingTags.splice(t,1);this.remoteTagIdList.push(i[0].id),this.hasChange=!0},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var e=this.inputValue;if(e){var t=this.tags.some((function(t){return t.name===e}));if(t)return void this.$message.error("标签已存在");this.hasChange=!0,this.tags.push({name:e,color:this.defaultTagColor});var i=this.existingTags.findIndex((function(t){return t.name===e}));-1!==i&&this.existingTags.splice(i,1)}this.inputVisible=!1,this.inputValue=""},addTag:function(e){this.hasChange=!0,this.tags.push({name:e.name,color:e.color}),this.updateExistingTags()},closeConfirmDialog:function(){this.isSaveDialogVisible=!1,this.hasChange=!0,this.tagDialogClose()},beforeClose:function(e){this.hasChange?this.isSaveDialogVisible=!0:(e(),this.isSaveDialogVisible=!1)},tagDialogClose:function(){this.tagDialogVisible=!1,this.$emit("update:status",this.tagDialogVisible),this.isEditMode=!1,this.inputVisible=!1,this.inputValue="",this.tags=[]},editMode:function(){this.isEditMode=!this.isEditMode,this.isEditMode||(this.remoteTagIdList=[]),this.updateExistingTags()},confirmUpdate:function(){this.submitTag()},submitTag:function(){var e=this;this.saveLoading=!0;var t=this.fileList.map((function(e){return e.id})),i=this.api||o["a"];i.setTags({fileIds:t,tagList:this.tags,removeTagIds:this.remoteTagIdList}).then((function(){e.saveLoading=!1,e.$message.success("保存成功"),e.$emit("onSuccess"),e.hasChange=!1,e.tagDialogVisible=!1,e.isSaveDialogVisible=!1,e.tagDialogClose()})).catch((function(){e.saveLoading=!1}))},updateColor:function(e,t){this.hasChange=!0,this.tags.forEach((function(i){i.name===t.name&&(i.color=e.hex)}))}}},d=c,u=(i("d879"),i("2877")),h=Object(u["a"])(d,n,a,!1,null,"614f9a92",null);t["a"]=h.exports},"0e1d":function(e,t,i){},"0ee8":function(e,t,i){},"0fb2":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("article-manager",{attrs:{"page-title":e.pageTitle,"new-article-text":e.newArticleText,"alone-page":""}})],1)},a=[],o=i("b0d9"),r={name:"alonePageManager",components:{ArticleManager:o["default"]},data:function(){return{pageTitle:"管理独立页面",newArticleText:"新增页面"}},computed:{},created:function(){},mounted:function(){},watch:{},methods:{}},s=r,l=(i("896a"),i("2877")),c=Object(l["a"])(s,n,a,!1,null,"5b599770",null);t["default"]=c.exports},"0fd6":function(e,t,i){"use strict";i("6ab7")},1e3:function(e,t,i){"use strict";i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return r}));i("5df3"),i("f400"),i("ac6a");var n=i("33f9"),a={simText:["vue","asp","jsp","TXT","xml","xsl","iml","m","bas","prg","cmd","sass","sas","php","lst","key","pem","log","cmake","db","gradle","bat","conf","dart","plist"],compressedFile:["zip","tar","jar","tar.gz","tgz","tar.bz2"],cadFile:["3DM","3DS","A","ASM","BRD","CATPART","CATPRODUCT","CGR","COLLABORATION","DAE","DGN","DLV3","DWF","DWFX","DWG","DXF","EMODE","EXP","F2D","F3D","FBX","G","GBXML","GLB","GLTF","IAM","IDW","IFC","IGE","IGES","IGS","IPT","IWM","JT","MAX","MODEL","MPF","MSR","NEU","NWC","NWD","OBJ","PAR","PMLPRJ","PMLPRJZ","PRT","PSM","PSMODEL","RVM","RVT","SAB","SAT","SCH","SESSION","SKP","SLDASM","SLDDRW","SLDPRT","STE","STEP","STL","STLA","STLB","STP","STPZ","VUE","WIRE","X_B","X_T","XAS","XPR"]};n["languages"].getLanguages().forEach((function(e){e.extensions.forEach((function(e){a.simText.push(e.substring(1,e.length))}))}));var o=["txt"],r=new Map;r.set("php","file-php"),r.set("js","file-js"),r.set("vue","file-vue"),r.set("xml","file-xml"),r.set("dart","file-dart"),r.set("html","file-html"),r.set("md","file-md"),r.set("txt","file-txt"),r.set("TXT","file-txt"),r.set("css","file-css"),r.set("scss","file-css"),r.set("java","file-java"),r.set("go","file-go"),r.set("DS_Store","file-Ds-store"),r.set("jar","file-jar"),r.set("properties","file-properties"),r.set("conf","file-conf"),r.set("factories","file-factories"),r.set("class","file-class"),r.set("excel","file-excel"),r.set("xls","file-excel"),r.set("xlsx","file-excel"),r.set("gitignore","file-gitignore"),r.set("ncm","file-ncm"),r.set("dmg","file-dmg"),r.set("pkg","file-pkg"),r.set("mpkg","file-pkg"),r.set("exe","file-exe"),r.set("word","file-word"),r.set("doc","file-word"),r.set("docx","file-word"),r.set("docxf","file-docxf"),r.set("ppt","file-ppt"),r.set("pptx","file-ppt"),r.set("drawio","file-drawio"),r.set("csv","file-csv"),r.set("pdf","file-pdf"),r.set("PDF","file-pdf"),r.set("mind","file-mind"),r.set("zip","zip"),r.set("rar","zip"),r.set("iml","file-idea"),r.set("key","file-key"),r.set("pem","file-pem"),r.set("gz","file-gzip"),r.set("json","file-json"),r.set("tar","file-tar"),r.set("sh","file-shell"),r.set("log","file-log"),r.set("py","file-python"),r.set("cpp","file-cpp"),r.set("h","file-h"),r.set("xsl","file-xsl"),r.set("cmake","file-cmake"),r.set("db","file-db"),r.set("sql","file-db"),r.set("gradle","file-gradle"),r.set("bat","file-bat"),r.set("swift","file-swift"),r.set("yml","file-yml"),r.set("plist","file-plist"),r.set("iso","file-iso")},1044:function(e,t,i){"use strict";i.r(t);i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("share-dialog",{attrs:{file:e.shareDialogObject,status:e.shareDialogVisible},on:{"update:file":function(t){e.shareDialogObject=t},"update:status":function(t){e.shareDialogVisible=t},onUpdateExpireData:e.onUpdateExpireData}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.fileList.length>0,expression:"fileList.length > 0"}],style:{width:"100%",height:e.clientHeight+"px"}},[t("pl-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"fileListTable",staticStyle:{width:"100%",margin:"20px 0 0 0"},attrs:{"max-height":e.clientHeight,"default-sort":e.sortable,"highlight-current-row":!1,"empty-text":"无文件","use-virtual":!1,"row-height":50,border:!1,"excess-rows":3,"cell-style":e.rowRed,"height-change":!1,"row-class-name":e.tableRowClassName,"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{"selection-change":e.handleSelectionChange,"cell-click":e.cellClick,"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"sort-change":e.sortChange,"table-body-scroll":e.tableBodyScroll}},[e._l(e.tableHead,(function(i,n){return[0===n?t("pl-table-column",{key:n,attrs:{index:n,type:"selection","min-width":"50"}}):e._e(),e._v(" "),1===n?t("pl-table-column",{key:n,attrs:{prop:i.name,label:i.label,index:n,width:"60","header-align":"right"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("icon-file",{attrs:{item:i.row,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})]}}],null,!0)},[t("template",{slot:"header"},[""!==i.label?t("div",[t("span",{staticClass:"header-font"},[e._v(e._s(i.label))])]):e._e()])],2):e._e(),e._v(" "),2===n?t("pl-table-column",{key:n,attrs:{"show-overflow-tooltip":!0,"max-width":"200",index:n,prop:i.name,label:i.label,"sort-orders":["ascending","descending"],sortable:i.sortable,"header-align":"left"},on:{click:function(t){return t.stopPropagation(),e.fileClick(e.scope.row)}},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticClass:"table-file-name"},[e._v(e._s(i.row.fileName))])]}}],null,!0)},[t("template",{slot:"header"},[""===i.label?t("div",{staticClass:"cancel-share-header"},[t("span",{staticClass:"header-font"},[e._v(e._s(e.sumFileAndFolder))]),t("el-button",{attrs:{icon:"el-icon-my-export",size:"small"},on:{click:function(t){return e.cancelShare(!1)}}},[e._v("取消分享")])],1):e._e()])],2):e._e(),e._v(" "),4===n?t("pl-table-column",{key:n,attrs:{width:"50",index:n,align:"center","header-align":"center","tooltip-effect":"dark"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.cellMouseIndex?t("svg-icon",{staticClass:"button-class",attrs:{title:"分享","icon-class":"cancel-share"},on:{click:function(t){return e.cancelShare(i.row)}}}):e._e()]}}],null,!0)}):e._e(),e._v(" "),5===n?t("pl-table-column",{key:n,attrs:{width:"200",prop:i.name,index:n,label:i.label,"sort-orders":["ascending","descending"],sortable:i.sortable,"show-overflow-tooltip":!0,align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.createDate))])]}}],null,!0)}):e._e(),e._v(" "),6===n?t("pl-table-column",{key:n,attrs:{width:"150",prop:i.name,label:i.label,index:n,"sort-orders":["ascending","descending"],sortable:i.sortable,"show-overflow-tooltip":!0,align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.isPrivacy?"私密":"公开"))])]}}],null,!0)}):e._e(),e._v(" "),7===n?t("pl-table-column",{key:n,attrs:{width:"200",prop:i.name,label:i.label,index:n,"sort-orders":["ascending","descending"],sortable:i.sortable,"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(e.expireInfo(i.row)))])]}}],null,!0)}):e._e()]}))],2)],1),e._v(" "),e.fileList.length<1&&!e.tableLoading?t("empty-file",{attrs:{emptyStatus:"还没有分享历史哦~",emptyShare:!0}}):e._e()],1)},a=[],o=(i("20d6"),i("a8f9")),r=(i("ac6a"),i("c41c")),s=i("71e9"),l=i("0dcf"),c=i("dc5e"),d=i("5cfc"),u={components:{ShowFile:r["default"],EmptyFile:s["a"],IconFile:l["a"],ShareDialog:c["a"]},props:{emptyStatus:{type:String,default:"空空如也~"},singleFileType:{type:String,default:""},showNavigation:{type:Boolean,default:!0},queryFileType:{type:String,default:null},defaultGrid:{type:Boolean,default:!0},orderCustom:{type:Boolean,default:!0},sortable:{type:Object,default:function(){return{prop:"createDate",order:"descending"}}},queryCondition:{type:Object,default:function(){return{isFolder:null}}}},data:function(){return{imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),audioCoverUrl:"".concat("/api","/view/cover?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),fileMenuActive:"",path:this.$route.query.path,pathList:[{folder:"",index:0},{folder:"+",index:1}],fileList:[],pagination:{pageIndex:1,pageSize:20,total:0,pageSizes:[10,20,30,40,50]},indexList:[],clientHeight:500,tableHead:[{name:"",label:"",index:0},{name:"icon",label:"",index:1},{name:"fileName",label:"分享文件",sortable:"custom",index:2},{name:"",label:"",index:3},{name:"",label:"",more:!0,index:4},{name:"createDate",label:"链接创建时间",sortable:"custom",index:5},{name:"isPrivacy",label:"分享形式",sortable:"custom",index:6},{name:"expireDate",label:"过期时间",sortable:"custom",index:7}],selectRowData:[],tableLoading:!1,finished:!1,cellMouseIndex:-1,shareDialog:!1,shareLink:"",shareFileName:"",sumFileAndFolder:"",shareDialogVisible:!1,shareDialogObject:{}}},methods:{expireInfo:function(e){if(e.expireDate){var t=new Date,i=new Date(e.expireDate);return t>i?"已过期":e.expireDate}return"永久有效"},beforeLoadData:function(e){e?this.pagination.pageIndex++:this.pagination.pageIndex=1,this.tableLoading=!0,this.finished=!1},getFileList:function(e){var t=this;this.beforeLoadData(e),d["a"].sharelist({userId:this.$store.state.user.userId,sortableProp:this.sortable.prop,order:this.sortable.order,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(i){e?i.data.forEach((function(e,i){e["index"]=(t.pagination.pageIndex-1)*t.pagination.pageSize+i,t.fileList.push(e)})):(t.fileList=i.data,t.fileList.map((function(e,t){e.index=t})),t.$refs.fileListTable.reloadData(t.fileList)),t.fileList.length>=i.count&&(t.finished=!0),t.tableLoading=!1,t.clientHeight=document.documentElement.clientHeight-80,t.pagination["total"]=i.count,t.$nextTick((function(){t.tableLoading=!1}))})).catch((function(e){}))},tableBodyScroll:function(e,t){this.fileListScrollTop=t.target.scrollTop;var i=t.target.scrollHeight-t.target.clientHeight-t.target.scrollTop;i<200&&(this.finished||this.getFileList(!0))},sortChange:function(e){this.sortable.prop=e.prop,this.sortable.order=e.order,this.pagination.pageIndex=1,this.getFileList()},handleSelectionChange:function(e){var t=this;this.selectRowData=e;this.indexList=[];var i,n=Object(o["a"])(e);try{for(n.s();!(i=n.n()).done;){var a=i.value;a.size,this.indexList.push(a.index)}}catch(u){n.e(u)}finally{n.f()}e.forEach((function(e){t.$refs.fileListTable.toggleRowSelection(e,!0)}));var r=this.tableHead[1],s=this.tableHead[2],l=this.tableHead[5],c=this.tableHead[6],d=this.tableHead[7];this.selectRowData.length>0?(this.sumFileAndFolder=this.getShowSumFileAndFolder(e),r.label="已选中",s.label="",s.sortable=!1,l.label="",l.sortable=!1,d.label="",d.sortable=!1,c.label="",c.sortable=!1):(r.label="",s.label="分享文件",s.sortable="custom",l.label="时间",l.sortable="custom",d.label="过期时间",d.sortable="custom",c.label="分享形式",c.sortable="custom")},getShowSumFileAndFolder:function(e){var t=0,i=0;e.forEach((function(e){e.isFolder?t+=1:i+=1}));var n="";t>0&&(n=t+"个文件夹");var a="";return i>0&&(a=i+"个文件"),n+" "+a},rowRed:function(e){e.row,e.column;var t=e.rowIndex,i=e.columnIndex;if(this.indexList.length<1&&2===i&&this.cellMouseIndex===t)return{cursor:"pointer",color:"#19ACF9"};for(var n=0;n<this.indexList.length;n++)if(t===this.indexList[n])return{backgroundColor:"#EBEEF5",color:"#b7b5b6",cursor:"default"}},tableRowClassName:function(e){var t=e.row,i=e.rowIndex;t.index=i},cellMouseEnter:function(e){this.indexList.length<1&&(this.cellMouseIndex=e.index)},cellMouseLeave:function(){this.cellMouseIndex=-1},cellClick:function(e,t){clearTimeout(this.Loop);var i=t.index;0===i&&this.$refs.fileListTable.toggleRowSelection(e),2===i&&this.indexList.length<1&&this.fileClick(e),this.indexList.length>0&&i>0&&this.$refs.fileListTable.toggleRowSelection(e)},cancelShare:function(e){var t=this,i=!1===e?"确定要取消选中的"+this.selectRowData.length+"项分享吗？":'确定要取消分享 "'+e.fileName+'" 吗?';this.$confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=[];e?i.push(e.id):t.selectRowData.forEach((function(e){i.push(e.id)})),d["a"].cancelShareLink({userId:t.$store.state.user.userId,shareId:i}).then((function(){1===i.length?t.fileList.splice(e.index,1):t.getFileList()}))}))},fileClick:function(e){this.shareDialogObject=e,this.shareDialogObject.name=e.fileName,this.shareDialogObject.shareId=e.id,this.shareDialogVisible=!0},onUpdateExpireData:function(e,t){var i=this.fileList.findIndex((function(t){return t.id===e})),n=this.fileList[i];n.expireDate=t,this.fileList.splice(i,1,n)}}},h=u,p=(i("4994"),i("2877")),f=Object(p["a"])(h,n,a,!1,null,"65655203",null);t["default"]=f.exports},1069:function(e,t,i){"use strict";i.r(t);i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-dialog",{staticClass:"dialog-cm",attrs:{width:"500px",title:e.dialogTitle,"close-on-click-modal":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"managerForm",attrs:{size:"medium",model:e.form,"label-position":"left",rules:e.rules,"label-width":"95px"}},[t("el-form-item",{attrs:{label:"标签名称:",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入标签名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"标签缩略名:",prop:"slug"}},[t("el-input",{attrs:{placeholder:"请输入标签缩略名"},model:{value:e.form.slug,callback:function(t){e.$set(e.form,"slug",t)},expression:"form.slug"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"标签背景:",prop:"categoryBackground"}},[t("upload-image-input",{model:{value:e.form.tagBackground,callback:function(t){e.$set(e.form,"tagBackground",t)},expression:"form.tagBackground"}}),e._v(" "),t("div",{staticClass:"instruction"},[e._v("在这里填入图片的URL地址, 以在该标签页面显示一个背景大图.")])],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small","native-type":"submit",type:"primary",loading:e.tagUpdateLoading},nativeOn:{click:function(t){return t.preventDefault(),e.onSave("managerForm")}}},[e._v("保 存\n      ")])],1)],1),e._v(" "),t("el-card",{staticClass:"box-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("el-row",[t("el-col",{staticClass:"query-item",attrs:{sm:12}},[t("div",{staticClass:"clearfix"},[t("div",{staticClass:"card-header content-title"},[t("span",[e._v(e._s(e.title))])]),e._v(" "),t("el-button",{staticClass:"card-button",attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.add()}}},[e._v("新增标签")])],1)]),e._v(" "),t("el-col",{staticClass:"text-align-right",attrs:{sm:12}},[t("el-checkbox",{staticClass:"check-all",attrs:{indeterminate:e.isIndeterminate},on:{change:e.selectAll},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),t("el-button",{attrs:{disabled:1!==this.multipleSelection.length,size:"small"},on:{click:function(t){return e.handleEdit()}}},[e._v("编辑")]),e._v(" "),t("el-button",{attrs:{disabled:0===this.multipleSelection.length,size:"small",type:"danger"},on:{click:function(t){return e.handleDelete()}}},[e._v("删除")])],1)],1)],1),e._v(" "),t("div",[t("el-checkbox-group",{attrs:{size:"small"},on:{change:e.handleCheckTagChange},model:{value:e.multipleSelection,callback:function(t){e.multipleSelection=t},expression:"multipleSelection"}},e._l(e.tags,(function(i){return t("span",{key:i.id,staticClass:"tag-checkbox",on:{mouseover:function(t){t.preventDefault(),e.hoverEditId=i.id},mouseleave:function(t){t.preventDefault(),e.hoverEditId=""}}},[t("el-checkbox",{attrs:{label:i.id,border:""}},[e._v("\n            "+e._s(i.name)+"\n            "),t("i",{staticClass:"el-tag__close el-icon-edit",style:{marginLeft:"-5px",visibility:e.hoverEditId===i.id?"visible":"hidden"},on:{click:function(t){return t.preventDefault(),e.handleEdit(i.id)}}})])],1)})),0)],1)])],1)},a=[],o=i("ae4a"),r=(i("96cf"),i("97bf")),s=(i("ac6a"),i("d28d")),l=i("f406"),c={name:"tagManager",components:{UploadImageInput:l["a"]},data:function(){return{title:"标签管理",dialogVisible:!1,dialogTitle:"",tagUpdateLoading:!1,hoverEditId:"",form:{name:"",slug:"",tagBackground:""},rules:{name:[{required:!0,message:"请输入标签名称",trigger:"blur"}]},tags:[],editMove:1,tagGroup:[],multipleSelection:[],checkAll:!1,isIndeterminate:!1}},computed:{},mounted:function(){this.getTags()},methods:{getTags:function(){var e=this;s["a"].tagList().then((function(t){e.tags=t.data}))},mouseover:function(e){},handleCheckTagChange:function(e){var t=e.length;this.checkAll=t===this.tags.length,this.isIndeterminate=t>0&&t<this.tags.length},selectAll:function(e){var t=this;e?this.tags.forEach((function(e){t.multipleSelection.push(e.id)})):this.multipleSelection=[],this.isIndeterminate=!1},handleEdit:function(e){var t=this,i=this.multipleSelection[0];e&&(i=e),this.editMove=2,this.dialogVisible=!0,this.dialogTitle="修改标签",s["a"].tagInfo({tagId:i}).then((function(e){t.form=e.data}))},handleDelete:function(){var e=this,t=this.multipleSelection;this.$confirm("您确定要删除这些标签吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["a"].delete({tagIds:t}).then((function(){e.$notify({title:"删除成功",type:"success",duration:1e3}),e.multipleSelection=[],e.isIndeterminate=!1,e.getTags()})).catch((function(){e.onError()}))}))},setFormData:function(){var e=new FormData;for(var t in this.form)this.form.hasOwnProperty(t)&&this.form[t]&&e.append(t,this.form[t]);return e},onSave:function(){var e=this;this.$refs.managerForm.validate((function(t){if(e.valid=t,!t)return!1;e.tagUpdateLoading=!0,1===e.editMove&&e.addTag(e.setFormData()),2===e.editMove&&e.updateTag(e.setFormData())}))},updateTag:function(e){var t=this;s["a"].update(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},addTag:function(e){var t=this;s["a"].add(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},add:function(){var e=Object(r["a"])(Object(o["a"])().m((function e(){return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:return this.dialogVisible=!0,this.dialogTitle="添加标签",this.editMove=1,e.n=1,this.$nextTick();case 1:this.$refs.managerForm.resetFields();case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onError:function(){this.tagUpdateLoading=!1},onSuccess:function(e){this.getTags();var t="保存成功!";e&&(t=e),this.tagUpdateLoading=!1,this.dialogVisible=!1,this.$message({message:t,type:"success",duration:1e3})}}},d=c,u=(i("8f80"),i("2877")),h=Object(u["a"])(d,n,a,!1,null,"0074e6b0",null);t["default"]=h.exports},1171:function(e,t,i){},"167f":function(e,t,i){"use strict";i("1171")},"16c6":function(e,t,i){},"192f":function(e,t,i){"use strict";i("3381")},"1a40":function(e,t,i){"use strict";i.r(t);i("6762"),i("2fdb"),i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"resize",rawName:"v-resize",value:e.containerResize,expression:"containerResize"}],staticClass:"container"},[t("van-popup",{style:{height:"100%",width:"35%"},attrs:{"get-container":"body",position:"left"},model:{value:e.leftMenuShow,callback:function(t){e.leftMenuShow=t},expression:"leftMenuShow"}},[t("div",{staticClass:"left-menu"},[t("div",{staticClass:"avatar"},[t("van-image",{attrs:{round:"",width:"5rem",height:"5rem",fit:"cover",src:e.imageUrl+e.avatar}})],1),e._v(" "),t("span",[e._v(e._s(e.name))]),e._v(" "),t("div",{staticClass:"classification"},[t("van-cell",{attrs:{title:"首页",icon:"wap-home-o"},on:{click:function(t){return e.clickFileType(null,{})}}}),e._v(" "),t("van-cell",{attrs:{title:"收藏",icon:"star-o"},on:{click:function(t){return e.clickFileType(null,{isFavorite:!0})}}}),e._v(" "),t("van-cell",{attrs:{title:"图片",icon:"photo-o"},on:{click:function(t){return e.clickFileType("image",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"视频",icon:"video-o"},on:{click:function(t){return e.clickFileType("video",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"音乐",icon:"music-o"},on:{click:function(t){return e.clickFileType("audio",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"公共文件",icon:"desktop-o"},on:{click:function(t){return e.clickFileType(null,{isTogether:!0})}}})],1),e._v(" "),t("div",{staticClass:"logout"},[t("van-button",{attrs:{round:"",type:"danger"},nativeOn:{click:function(t){return e.logout.apply(null,arguments)}}},[e._v("退出登录")])],1)])]),e._v(" "),t("van-list",{attrs:{finished:e.finished,"finished-text":e.statistics()},on:{load:function(t){e.searchStatus&&e.searchValue.length>0?e.searchFile(e.searchValue,!0):e.getFileList(!0)}},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[t("van-checkbox-group",{ref:"checkboxGroup",on:{change:e.checkboxChange},model:{value:e.selectRowData,callback:function(t){e.selectRowData=t},expression:"selectRowData"}},[t("van-cell-group",[t("van-sticky",{attrs:{"offset-top":-1}},[e.pathList.length<2&&!e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:"浏览","right-arrow":"","right-text":this.selectRowData.length!==this.fileList.length?"选择":"取消","left-arrow":""},on:{"click-right":e.checkboxAll,"click-left":e.leftMenu}},[t("div",{staticClass:"header-button",attrs:{slot:"left"},slot:"left"},[t("svg",{staticClass:"header-button-icon",attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25"}},[t("path",{attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 0 0 0-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0 0 14.4 7z"}})])])]):e._e(),e._v(" "),e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:0===e.selectRowData.length?"选择项目":e.selectRowData.length+"项","right-arrow":"","left-text":this.selectRowData.length!==this.fileList.length?"全选":"取消全选","right-text":"完成"},on:{"click-left":e.checkboxAll,"click-right":e.cancelSelect}}):e._e(),e._v(" "),e.pathList.length>=2&&!e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:e.pathList[e.pathList.length-1].folder,"right-text":this.selectRowData.length!==this.fileList.length?"选择":"取消","left-arrow":""},on:{"click-right":e.checkboxAll,"click-left":e.clickBack}},[t("div",{staticClass:"header-button",attrs:{slot:"left"},slot:"left"},[t("van-icon",{attrs:{name:"arrow-left"}})],1)]):e._e(),e._v(" "),t("div",{staticClass:"searchbar",style:e.searchBarClass},[t("van-search",{ref:"search",attrs:{"show-action":e.searchStatus,shape:"round",placeholder:"搜索"},on:{focus:e.startSearch,search:e.onSearch,input:e.onSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[t("div",{attrs:{slot:"action"},on:{click:e.endSearch},slot:"action"},[e._v("取消")])])],1)],1),e._v(" "),t("van-cell",{staticStyle:{padding:"0 0 10px 0"},attrs:{center:!0}},[t("div",{staticClass:"operating-header"},[t("van-row",[t("van-col",{staticClass:"operating-header-col",attrs:{span:"4",align:"center",type:"flex"},on:{click:e.moreOperations}},[t("van-icon",{attrs:{name:"more-o"}})],1),e._v(" "),t("van-col",{staticClass:"operating-header-col",attrs:{span:"16",align:"center"},on:{click:e.showSortSheet}},[e._v("\n                  已按"+e._s(e.actionsSortName)+"排序\n                  "),t("van-icon",{staticClass:"sortable",attrs:{name:"arrow-"+e.sortOrder}})],1),e._v(" "),t("van-col",{staticClass:"operating-header-col",attrs:{span:"4",align:"center"},on:{click:e.changeVmode}},[t("van-icon",{style:e.grid?{}:{background:"#1989fa",color:"#ffffff",padding:"0 5px",borderRadius:"5px"},attrs:{name:"bars"}})],1)],1)],1)]),e._v(" "),e.searchStatus&&e.searchValue.length>0&&e.fileList.length>0?t("van-cell",{staticStyle:{"background-color":"#f7f8fa"}},[t("div",{staticClass:"search-result"},[e._v(e._s(e.resultCount)+"个结果")])]):e._e(),e._v(" "),e.searchStatus&&e.searchValue.length>0&&0===e.fileList.length?t("van-cell",[t("div",{staticClass:"search-result-no"},[e._v("无结果")])]):e._e(),e._v(" "),e.loading||0!==e.fileList.length?e._e():t("van-empty",{attrs:{description:"空空如也"}}),e._v(" "),e._l(e.fileList,(function(i,n){return e.grid?e._e():t("van-cell",{key:i.id,staticClass:"list-item",style:{background:e.selectIndexList.includes(n)?"#90c2fcb5":""},attrs:{center:"","is-link":i.isFolder},on:{click:function(t){return e.fileClick(i,n)}}},[t("div",{staticClass:"list-item-div",on:{touchstart:function(t){return e.touchStart(i)},touchend:e.touchEnd,touchmove:e.touchMove}},[t("van-row",{staticClass:"row-file"},[t("van-col",{staticClass:"list-cell-icon",attrs:{span:"4",align:"center"}},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})],1),e._v(" "),t("van-col",{staticClass:"list-item-content",attrs:{span:"16"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                    "+e._s(i.name)+"\n                  ")]),e._v(" "),t("van-col",{staticClass:"file-description",attrs:{span:"24",justify:"space-between"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                      "+e._s(e.formatTime(i.agoTime))+"   "+e._s(e.formatSize(i.size))+"\n                    ")])],1)],1),e._v(" "),t("van-col",{attrs:{span:"4"}})],1)],1),e._v(" "),!e.grid&&e.selectStatus?t("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:i},slot:"right-icon"}):e._e()],1)})),e._v(" "),e.grid?t("van-grid",{style:{width:"100%",overflow:"auto"},attrs:{square:"",center:!0,"column-num":e.gridColumnNum,gutter:10,border:!1}},e._l(e.fileList,(function(i,n){return t("van-grid-item",{key:i.id,ref:"gridItem",refInFor:!0,staticClass:"parent-grid-item",on:{click:function(t){return e.fileClick(i,n)}}},[t("div",{staticClass:"grid-time van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:{background:e.selectIndexList.includes(n)?"#90c2fcb5":"","border-radius":"15px"},on:{touchstart:function(t){return e.touchStart(i)},touchend:e.touchEnd,touchmove:e.touchMove}},[e.grid&&e.selectStatus?t("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:i},slot:"right-icon"}):e._e(),e._v(" "),t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0}})],1),e._v(" "),t("span",{staticClass:"grid-item-text",attrs:{title:i.name}},[e._v(e._s(i.name))])],1)])})),1):e._e()],2)],1)],1),e._v(" "),t("van-action-sheet",{attrs:{actions:e.actionsMenus,"cancel-text":"取消"},on:{cancel:e.onCancel,select:e.selectActionsMenus},model:{value:e.actionSheetShow,callback:function(t){e.actionSheetShow=t},expression:"actionSheetShow"}}),e._v(" "),t("van-action-sheet",{attrs:{actions:e.actionsSortMenus,"cancel-text":"取消",description:"排序方式"},on:{cancel:e.onCancel,select:e.selectSortActionsMenus},model:{value:e.actionSortSheetShow,callback:function(t){e.actionSortSheetShow=t},expression:"actionSortSheetShow"}}),e._v(" "),t("van-dialog",{attrs:{"show-cancel-button":""},on:{confirm:e.newFolderNameClick},model:{value:e.showNewFolder,callback:function(t){e.showNewFolder=t},expression:"showNewFolder"}},[t("van-field",{ref:"newFolderInput",staticClass:"new-folder-input",attrs:{placeholder:"请输入文件夹名称",border:!0,clearable:!0,autofocus:!0},model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}})],1),e._v(" "),t("van-dialog",{attrs:{"show-cancel-button":""},on:{confirm:function(t){return e.rowRename()}},model:{value:e.showRename,callback:function(t){e.showRename=t},expression:"showRename"}},[t("van-field",{ref:"renameInput",staticClass:"rename-input",attrs:{placeholder:"请输入文件名称",border:!0,clearable:!0,autofocus:!0},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}})],1),e._v(" "),t("e-vue-contextmenu",{ref:"contextShow",staticClass:"newFileMenu",on:{"ctx-show":e.show,"ctx-hide":e.hide}},e._l(e.menus,(function(i,n){return t("ul",{key:i.label,class:{"menu-list-first":0===n,"menu-list-last":n===e.menus.length-1,"menu-list":n<e.menus.length-1&&n>0}},[0!==n?t("div",{staticStyle:{"border-bottom":"1px solid #cccccc85"}}):e._e(),e._v(" "),t("li",{class:{remove:"remove"===i.operation},on:{click:function(t){return e.menusOperations(i.operation)}}},[t("div",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)])])})),0),e._v(" "),t("van-overlay",{ref:"overlayShow",attrs:{show:e.overlayShow,duration:"0.3"},on:{click:e.overlayClick}},[null==e.rowContextData.name||e.grid?e._e():t("van-cell",{staticClass:"list-item overlay-content-class",style:e.overlayContentClass,attrs:{center:"","is-link":e.rowContextData.isFolder}},[t("div",[t("van-row",{staticClass:"row-file"},[t("van-col",{staticClass:"list-cell-icon",attrs:{span:"4",align:"center"}},[t("icon-file",{attrs:{item:e.rowContextData,"image-url":e.imageUrl}})],1),e._v(" "),t("van-col",{staticClass:"list-item-content",attrs:{span:"16"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                "+e._s(e.rowContextData.name)+"\n              ")]),e._v(" "),t("van-col",{staticClass:"file-description",attrs:{span:"24",justify:"space-between"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                  "+e._s(e.formatTime(e.rowContextData.agoTime))+"   "+e._s(e.formatSize(e.rowContextData.size))+"\n                ")])],1)],1),e._v(" "),t("van-col",{attrs:{span:"4"}})],1)],1),e._v(" "),e.selectStatus?t("van-checkbox",{staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:e.rowContextData},slot:"right-icon",model:{value:e.isShowCheckContext,callback:function(t){e.isShowCheckContext=t},expression:"isShowCheckContext"}}):e._e()],1),e._v(" "),null!=e.rowContextData.name&&e.grid?t("div",{staticClass:"grid-time overlay-content-class van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:e.overlayContentClass},[e.selectStatus?t("van-checkbox",{staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:e.rowContextData},slot:"right-icon",model:{value:e.isShowCheckContext,callback:function(t){e.isShowCheckContext=t},expression:"isShowCheckContext"}}):e._e(),e._v(" "),t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:e.rowContextData,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0}})],1),e._v(" "),t("span",{staticClass:"grid-item-text",attrs:{title:e.rowContextData.name}},[e._v(e._s(e.rowContextData.name))])],1):e._e()],1),e._v(" "),t("sim-text-preview",{attrs:{file:e.textPreviewRow,status:e.textPreviewVisible,"is-together":e.isTogether},on:{"update:file":function(t){e.textPreviewRow=t},"update:status":function(t){e.textPreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}}),e._v(" "),t("image-viewer",{attrs:{fileList:e.fileList,file:e.imagePreviewRow,status:e.imagePreviewVisible},on:{"update:status":function(t){e.imagePreviewVisible=t}}}),e._v(" "),t("video-preview",{attrs:{file:e.videoPreviewRow,status:e.videoPreviewVisible},on:{"update:status":function(t){e.videoPreviewVisible=t}}}),e._v(" "),t("office-preview",{attrs:{file:e.officePreviewRow,status:e.officePreviewVisible,"is-together":e.isTogether},on:{"update:status":function(t){e.officePreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}})],1)},a=[],o=(i("f559"),i("a8f9")),r=(i("55dd"),i("386d"),i("ae4a")),s=(i("96cf"),i("97bf")),l=(i("20d6"),i("aef6"),i("7514"),i("28a5"),i("ac6a"),i("6f8e")),c=i("2f62"),d=i("7f29"),u=i("26a1"),h=i("5cfc"),p=i("5580"),f=i("0dcf"),m=i("2690"),g=i("1638"),v=i("ae1f"),b=i("2d53"),w=i("1000"),y=i("fd35"),x=i("b311"),C=i.n(x),k=(i("d958"),{components:{OfficePreview:y["a"],SimTextPreview:b["a"],VideoPreview:v["a"],ImageViewer:g["a"],IconFile:f["a"]},computed:Object(l["a"])({},Object(c["b"])(["name","avatar"])),data:function(){return{test:0,lastTabbarOffsetTop:0,diffTabbarTop:0,isiPhoneX:0,imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),audioCoverUrl:"".concat("/api","/view/cover?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),tabActive:0,path:this.$route.query.path,fileList:[],pathList:[{folder:"",index:0},{folder:"+",index:1}],pagination:{pageIndex:0,pageSize:50,total:0},queryFileType:null,queryCondition:{isFolder:null,isTogether:!1},loading:!1,finished:!1,refreshing:!1,actionSheetShow:!1,actionsMenus:[{name:"新建文件夹"}],actionSortSheetShow:!1,actionsSortMenus:[{name:"名称"},{name:"日期"},{name:"大小"}],actionsSortName:"名称",showNewFolder:!1,showRename:!1,newFolderName:"新建文件夹",Loop:null,isJustHideMenus:!1,singleMenus:[{iconClass:"menu-select",label:"选择",operation:"select"},{iconClass:"menu-favorite",label:"收藏",operation:"favorite"},{iconClass:"menu-rename",label:"重命名",operation:"rename"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}],menus:[],rowContextData:{},selectRowData:[],checkboxGroup:[],newFolderLoading:!1,renameLoading:!1,renameFileName:"",selectIndexList:[],selectStatus:!1,isShowCheckContext:!1,overlayShow:!1,overlayContentClass:{},vanNavBarClass:{},searchBarClass:{},leftMenuShow:!1,searchValue:"",searchStatus:!0,resultCount:0,sortOrder:"up",sortableProp:null,order:null,grid:!1,vmode:"list",gridColumnNum:-1,imagePreviewRow:{},imagePreviewVisible:!1,videoPreviewRow:{},videoPreviewVisible:!1,officePreviewRow:{},officePreviewVisible:!1,textPreviewVisible:!1,textPreviewRow:{},isTogether:!0}},directives:{resize:{bind:function(e,t){var i="",n="";function a(){var a=document.defaultView.getComputedStyle(e);i===a.width&&n===a.height||t.value(),i=a.width,n=a.height}e.__vueSetInterval__=setInterval(a,300)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},mounted:function(){var e=this;if(this.$route.query.vmode&&(this.vmode=this.$route.query.vmode,"list"===this.vmode?this.grid=!1:this.grid=!0),"/"!==this.$route.query.path){var t=decodeURI(this.$route.query.path);this.pathList.splice(1,1),t.split("/").forEach((function(t,i){if(i>0){var n={};n["folder"]=t,n["index"]=i,e.pathList.push(n)}}))}this.$route.query.folder&&this.path&&localStorage.setItem(this.path,this.$route.query.folder),window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1))},destroyed:function(){window.removeEventListener("popstate",this.goBack,!1)},methods:{highlightFavorite:function(e,t){var i=this.menus.find((function(e){if("favorite"===e.operation||"unFavorite"===e.operation)return e}));i&&(e?(i.label="取消收藏",i.iconClass="menu-unfavorite-hover",i.operation="unFavorite"):(i.iconClass=t?"menu-favorite-hover":"menu-favorite",i.label="收藏",i.operation="favorite"))},show:function(){},hide:function(){var e=this;this.isJustHideMenus=!0,setTimeout((function(){e.isJustHideMenus=!1}),100)},showCheckContext:function(){return this.selectIndexList.includes(this.rowContextData.index)},rowContextmenu:function(e,t,i){if(this.menus=JSON.parse(JSON.stringify(this.singleMenus)),this.selectStatus&&this.selectIndexList.includes(e.index)){if(this.selectIndexList.includes(e.index)){var n={iconClass:"menu-unselect",label:"取消选择",operation:"unselect"};this.menus.splice(0,1,n)}}else{var a={iconClass:"menu-select",label:"选择",operation:"select"};this.menus.splice(0,1,a)}e.isShare&&!e.isPrivacy&&this.menus.splice(-2,0,{iconClass:"menu-fuzhi",label:"复制下载链接",operation:"copyDownloadLink"}),this.preliminaryRowData(e);var o=Object(u["b"])(t)-e.scrollY,r={};o+t.offsetHeight/2>document.body.offsetHeight/2?(r.pageX=i,r.pageY=Object(u["b"])(t)-47*this.menus.length+5):(r.pageX=i,r.pageY=Object(u["b"])(t)+t.offsetHeight+5),this.$refs.contextShow.showMenu(r)},preliminaryRowData:function(e){this.rowContextData=e,this.isShowCheckContext=this.selectIndexList.includes(e.index);var t=this.rowContextData.isFavorite;this.highlightFavorite(t,!1)},menusOperations:function(e){var t=this,i=this;switch(e){case"favorite":this.favoriteOperating(!0);break;case"open":this.fileClick(this.rowContextData,this.rowContextData.index);break;case"unselect":var n=this.rowContextData.index;this.$refs.checkboxes[n].toggle();break;case"unFavorite":this.favoriteOperating(!1);break;case"select":this.selectStatus=!0,this.selectIndexList.push(this.rowContextData.index),setTimeout((function(){t.$refs.checkboxes[i.rowContextData.index].toggle()}),0);break;case"rename":this.renameFileName=this.rowContextData.name,this.showRename=!0,setTimeout((function(){i.$refs.renameInput.focus()}),0);break;case"copy":vant.Toast("暂不支持移动");break;case"download":this.downloadFile();break;case"copyDownloadLink":this.copyDownloadLink(this.rowContextData);break;case"remove":this.deleteFile();break}this.overlayShow=!1,document.documentElement.style.overflow=null,this.$refs.contextShow.hideMenu()},rowRename:function(){var e=this,t=this.rowContextData,i=this.renameFileName;if(i){if(!t.isFolder){var n="."+t.suffix;i.endsWith(n)||(i+=n)}this.renameLoading=!0;var a=this.fileList.findIndex((function(e){if(i===e.name)return e}));if(a>-1){var o="该文件已存在";return t.isFolder&&(o="该文件夹已存在"),this.$message({message:o,type:"warning"}),void(this.renameLoading=!1)}this.isTogether?p["a"].rename({newFileName:encodeURI(i),username:this.$store.state.user.name,folder:this.$route.query.folder,id:t.id}).then((function(){e.renameLoading=!1,t.name=i,e.fileList[t.index]=t,e.editingIndex=-1})):h["a"].rename({newFileName:encodeURI(i),username:this.$store.state.user.name,folder:this.$route.query.folder,id:t.id}).then((function(){e.renameLoading=!1,t.name=i,e.fileList[t.index]=t,e.editingIndex=-1}))}else this.editingIndex=-1},downloadFile:function(){var e=0;if(this.selectRowData.length>0?this.selectRowData.forEach((function(t){e+=t.size})):e+=this.rowContextData.size,e>0){var t=[];if(this.selectRowData.length>0?this.selectRowData.forEach((function(e){t.push(e.id)})):t.push(this.rowContextData.id),t.length>1||this.rowContextData.isFolder)return void m["a"].packageDownload(t,this.$store.state.user.token,this.$store.state.user.name);m["a"].download(this.$store.state.user.name,this.rowContextData,this.$store.state.user.token)}else this.$message({message:"所选文件夹为空",type:"warning"})},copyDownloadLink:function(e){var t=this,i=window.location.origin+m["a"].previewUrl(this.$store.getters.name,e,void 0,void 0),n=new C.a(".newFileMenu",{text:function(){return i}});n.on("success",(function(e){t.$message({message:"复制成功",type:"success",duration:1e3}),n.destroy()})),n.on("error",(function(e){t.$message({message:"该浏览器不支持自动复制",type:"warning",duration:1e3}),n.destroy()}))},favoriteOperating:function(e){this.isTogether?(vant.Toast.setDefaultOptions({duration:1200}),vant.Toast("公共文件无法收藏")):(this.rowContextData.isFavorite=e,this.highlightFavorite(e,!0),h["a"].favoriteUrl({fileIds:this.rowContextData.id,isFavorite:e}).then((function(e){})))},deleteFile:function(){var e=this,t=[],i=[];this.selectRowData.length>0?(t=this.selectRowData,this.selectRowData.forEach((function(e){i.push(e.id)}))):(t=this.selectRowData,i.push(this.rowContextData.id));var n=this.getShowSumFileAndFolder(t);vant.Dialog.confirm({title:"提示",message:"此操作将永久删除"+n+", 是否继续?"}).then((function(){e.isTogether?p["a"].delete({currentDirectory:e.rowContextData.path,username:e.$store.state.user.name,fileIds:i}).then((function(){e.getFileList(),vant.Toast.setDefaultOptions({duration:800}),vant.Toast.success("删除成功"),e.selectRowData.length>1&&(e.selectRowData=[])})):h["a"].delete({currentDirectory:e.rowContextData.path,username:e.$store.state.user.name,fileIds:i}).then((function(){e.getFileList(),vant.Toast.setDefaultOptions({duration:800}),vant.Toast.success("删除成功"),e.selectRowData.length>1&&(e.selectRowData=[])}))}))},touchMove:function(){clearTimeout(this.Loop)},touchStart:function(e){var t=this;clearTimeout(this.Loop);var i=window.event;this.Loop=setTimeout((function(){e.scrollY=i.targetTouches[0].pageY-i.targetTouches[0].clientY,t.findListItem(e,i.targetTouches[0].target,i.targetTouches[0].clientX)&&(t.overlayShow=!0,document.documentElement.style.overflow="hidden")}),500)},touchEnd:function(){clearTimeout(this.Loop)},overlayClick:function(){this.overlayShow=!1,document.documentElement.style.overflow=null},findListItem:function(e,t,i){if(null===t)return!1;var n=t.offsetParent,a=t.parentElement;if(!n&&a||null===n)return this.findListItem(e,t.parentElement,i);if(n.className.indexOf("list-item")>-1)this.longPressDisplayLayer(e,n,i);else{if(!(n.className.indexOf("grid-time")>-1))return this.findListItem(e,t.offsetParent,i);this.longPressDisplayLayer(e,n,i)}return!0},longPressDisplayLayer:function(e,t,i){var n=this,a=this.selectIndexList.includes(this.rowContextData.index)?"#90c2fcb5":"";this.overlayContentClass={top:Object(u["b"])(t)-e.scrollY+"px",height:t.offsetHeight+"px",width:t.offsetWidth+"px",left:Object(u["a"])(t)+"px","border-radius":"0px",background:a},setTimeout((function(){n.overlayContentClass={top:Object(u["b"])(t)-e.scrollY+"px",height:t.offsetHeight+"px",width:t.offsetWidth-(n.grid?0:10)+"px",left:Object(u["a"])(t)+(n.grid?0:5)+"px","border-radius":"20px",background:a}}),0),this.rowContextmenu(e,t,i)},goBack:function(){this.pathList.length<=1?this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path))):this.clickBack()},clickBack:function(){this.handleLink(this.pathList[this.pathList.length-2],this.pathList.length-2)},leftMenu:function(){this.leftMenuShow=!0},logout:function(){var e=Object(s["a"])(Object(r["a"])().m((function e(){return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.$store.dispatch("user/logout");case 1:this.$router.push("/login?redirect=".concat(this.$route.fullPath));case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),startSearch:function(){this.vanNavBarClass={visibility:"hidden"},this.searchBarClass={marginTop:"-30px"};var e=document.querySelector(".van-search__action");e.style.marginRight="0px",e.style.visibility="visible",e.style.color="#1989fa"},endSearch:function(){var e=this;setTimeout((function(){e.vanNavBarClass={visibility:"visible"}}),150),this.searchBarClass={marginTop:"0px"};var t=document.querySelector(".van-search__action");t.style.marginRight="-44px",t.style.visibility="hidden",this.searchValue="",this.getFileList()},onSearch:function(){this.searchValue.length<1?this.getFileList():this.searchFile(this.searchValue)},changeVmode:function(){this.grid=!this.grid,this.vmode="list",this.grid&&(this.vmode="grid"),this.path||(this.path=""),this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(this.path).concat(this.$route.query.folder?"&folder="+this.$route.query.folder:""))},showSortSheet:function(){this.actionSortSheetShow=!0},moreOperations:function(){if(this.actionSheetShow=!0,this.actionsMenus=[{name:"新建文件夹"}],window.uploader.support){var e={name:"上传文件"};this.actionsMenus.push(e)}if(window.uploader.supportDirectory){var t={name:"上传文件夹"};this.actionsMenus.push(t)}},handleLink:function(e,t,i,n){var a=this;if(e&&e.search)e.searchKey?this.searchFileByKeyWord(e.searchKey):e.row&&this.searchFileAndOpenDir(e.row),this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1));else{this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1)),this.pathList.forEach((function(e,t){0===t?a.path="":t===a.pathList.length||(a.path+="/"+a.pathList[t].folder)}));var o=localStorage.getItem(this.path);i||(this.$route.query.path,this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(o?"&folder="+o:""))),n||(this.pagination.pageIndex=1,this.getFileList())}},formatTime:function(e){return Object(d["c"])(e)},formatSize:function(e){return Object(d["b"])(e)},onRefresh:function(){this.finished=!1,this.loading=!0,this.getFileList()},getFileList:function(e){var t=this;this.beforeLoadData(e),h["a"].fileList({username:this.$store.state.user.name,userId:this.$store.state.user.userId,currentDirectory:encodeURI(this.$route.query.path),folder:this.$route.query.folder,queryFileType:this.queryFileType,sortableProp:this.sortableProp,order:this.order,isFolder:this.queryCondition.isFolder,isFavorite:this.queryCondition.isFavorite,isTogether:this.isTogether,queryCondition:this.queryCondition,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(i){t.loadData(i,e)})).catch((function(e){}))},searchFile:function(e,t){var i=this;e&&(this.beforeLoadData(t),this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e)),this.isTogether?p["a"].searchFile({userId:this.$store.state.user.userId,username:this.$store.state.user.name,keyword:e,currentDirectory:encodeURI(this.$route.query.path),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(e){i.loadData(e,t),i.path="",i.listModeSearch=!0,i.listModeSearchOpenDir=!1})):h["a"].searchFile({userId:this.$store.state.user.userId,username:this.$store.state.user.name,keyword:e,currentDirectory:encodeURI(this.$route.query.path),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(e){i.loadData(e,t),i.path="",i.listModeSearch=!0,i.listModeSearchOpenDir=!1})))},beforeLoadData:function(e){e?this.pagination.pageIndex++:this.pagination.pageIndex=1,this.finished=!1,this.fileList=[]},loadData:function(e,t){var i=this;t?e.data.forEach((function(e,t){e["index"]=(i.pagination.pageIndex-1)*i.pagination.pageSize+t,i.fileList.push(e)})):(this.fileList=e.data,this.fileList.map((function(e,t){e["index"]=t}))),this.refreshing=!1,this.resultCount=e.count,this.fileList.length>=e.count&&(this.finished=!0),this.fileList.sort(this.compare(this.sortableProp)),this.$nextTick((function(){i.containerResize(),i.loading=!1}))},containerResize:function(){var e=document.querySelector(".container"),t=e.clientWidth;t>1024?this.gridColumnNum=Math.round(t/100-4):(this.gridColumnNum=Math.round(t/100-2),t<=550&&(this.gridColumnNum=4),t<=375&&(this.gridColumnNum=3))},clickFileType:function(e,t){this.queryCondition=t,this.queryCondition.isTogether?this.isTogether=!0:this.isTogether=!1,this.queryFileType=e,this.getFileList(),this.leftMenuShow=!1},uploadList:function(){this.$router.push("/upload/index_m")},statistics:function(){var e=0;return this.fileList.forEach((function(t){e+=t.size})),this.getShowSumFileAndFolder(this.fileList)+" "+this.getShowSumSize(e)},getShowSumFileAndFolder:function(e){var t=0,i=0;e.forEach((function(e){e.isFolder?t+=1:i+=1}));var n="";t>0&&(n=t+"个文件夹");var a="";return i>0&&(a=i+"个文件"),n+" "+a},getShowSumSize:function(e){var t="";return e>0&&(t="  共"),0===e||(t+=e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"K":e>=1048576&&e<1073741824?(e/1048576).toFixed(2)+"M":(e/1073741824).toFixed(2)+"G"),t},checkboxAll:function(){this.selectRowData.length!==this.fileList.length?this.$refs.checkboxGroup.toggleAll(!0):this.$refs.checkboxGroup.toggleAll()},cancelSelect:function(){this.$refs.checkboxGroup.toggleAll(!1);var e=this;setTimeout((function(){e.selectStatus=!1}))},checkboxChange:function(e){this.selectRowData=e,this.selectIndexList=[];var t,i=Object(o["a"])(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.selectIndexList.push(n.index)}}catch(a){i.e(a)}finally{i.f()}this.selectStatus=!0},fileClick:function(e,t){var i=this;if(this.selectStatus)this.$refs.checkboxes[t].toggle();else if(e.isFolder){this.path?this.path+="/"+e.name:this.path="/"+e.name;var n={};n["folder"]=e.name,n["index"]=this.pathList.length-1,this.pathList.push(n);var a=encodeURI(this.path);this.$store.getters.userId!==e.userId&&(e.mountFileId=e.id),e.mountFileId&&localStorage.setItem(this.path,e.mountFileId),this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(a).concat(e.mountFileId?"&folder="+e.mountFileId:"")),this.getFileList()}else{if(e.contentType.startsWith("image"))return this.imagePreviewVisible=!0,void(this.imagePreviewRow=e);if(w["c"].simText.includes(e.suffix))return this.textPreviewRow=e,void(this.textPreviewVisible=!0);if(e.contentType.indexOf("video")>-1)return this.videoPreviewVisible=!0,void(this.videoPreviewRow=e);if(e.contentType.indexOf("audio")>-1)return void this.$store.dispatch("updateMessage",{event:"onAddAudio",data:{row:e,audioCoverUrl:this.audioCoverUrl}});if(e.contentType.indexOf("office")>-1||"csv"===e.suffix)return this.officePreviewVisible=!0,void(this.officePreviewRow=e);if("pdf"===e.suffix||"PDF"===e.suffix)return void m["a"].preview(this.$store.state.user.name,e,this.$store.getters.token);vant.Dialog.confirm({title:"标题",message:"此文件不支持预览，是否下载",confirmButtonText:"下载"}).then((function(){setTimeout((function(){m["a"].download(i.$store.state.user.name,e,i.$store.state.user.token)}),0)})).catch((function(){}))}},onCancel:function(){this.actionSheetShow=!1,this.actionSortSheetShow=!1},compare:function(e){var t=this;return function(i,n){var a=i[e],o=n[e];return"ascending"===t.order?a-o:o-a}},selectSortActionsMenus:function(e){var t=this;setTimeout((function(){t.actionSortSheetShow=!1}),100),"up"===this.sortOrder?(this.sortOrder="down",this.order="descending"):(this.sortOrder="up",this.order="ascending"),this.actionsSortName=e.name,"名称"===e.name&&(this.sortableProp="name","up"===this.sortOrder&&(this.order=null),this.getFileList()),"大小"===e.name&&(this.sortableProp="size",this.fileList.sort(this.compare(this.sortableProp))),"日期"===e.name&&(this.sortableProp="updateDate",this.getFileList())},selectActionsMenus:function(e){var t=this;if(setTimeout((function(){t.actionSheetShow=!1}),100),"新建文件夹"===e.name){this.newFolderName="新建文件夹";var i=0,n=[];this.fileList.forEach((function(e){n.push(e.name)}));while(n.includes(this.newFolderName))i+=1,this.newFolderName="新建文件夹"+i;this.showNewFolder=!0;var a=this;setTimeout((function(){a.$refs.newFolderInput.focus()}),0)}"上传文件"===e.name&&this.$store.dispatch("updateMessage",{event:"openUploader",data:{folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId,isTogether:this.isTogether}}),"上传文件夹"===e.name&&this.$store.dispatch("updateMessage",{event:"uploadFolder",data:{folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId,isTogether:this.isTogether}})},newFolderNameClick:function(){var e=this;this.newFolderLoading=!0,this.newFolderName?this.isTogether?p["a"].uploadFolder({isFolder:!0,filename:encodeURI(this.newFolderName),folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId}).then((function(t){1===t.data?(e.newFolderLoading=!1,e.$message({message:"该文件夹已存在",type:"warning"})):(e.newFolderLoading=!1,e.showNewFolder=!1,e.isShowNewFolder=!1,Notify({type:"success",message:"新建文件夹成功",duration:1e3}),e.listModeSearch?e.getFileListBySearchMode():e.getFileList())})):h["a"].uploadFolder({isFolder:!0,filename:encodeURI(this.newFolderName),folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId}).then((function(t){1===t.data?(e.newFolderLoading=!1,e.$message({message:"该文件夹已存在",type:"warning"})):(e.newFolderLoading=!1,e.showNewFolder=!1,e.isShowNewFolder=!1,Notify({type:"success",message:"新建文件夹成功",duration:1e3}),e.listModeSearch?e.getFileListBySearchMode():e.getFileList())})):(this.newFolderLoading=!1,this.$message({message:"请输入文件夹名称",type:"warning"}))},swipeUp:function(){this.test=10},tabBottom:function(){return{padding:"0 0 20px 0"}}}}),_=k,S=(i("4075"),i("2877")),L=Object(S["a"])(_,n,a,!1,null,"40eca38e",null);t["default"]=L.exports},"1b83":function(e,t,i){"use strict";i("542f")},"1f5c":function(e,t,i){"use strict";i("86ec")},"217e":function(e,t,i){},2337:function(e,t,i){},"23a0":function(e,t,i){"use strict";i.r(t);i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-dialog",{staticClass:"dialog-cm",attrs:{width:"500px",title:e.dialogTitle,"close-on-click-modal":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"managerForm",attrs:{size:"medium",model:e.form,"label-position":"left",rules:e.rules,"label-width":"95px"}},[t("el-form-item",{attrs:{label:"分类名称:",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入分类名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"分类缩略名:",prop:"slug"}},[t("el-input",{attrs:{placeholder:"分类缩略名用于创建友好的链接形式"},model:{value:e.form.slug,callback:function(t){e.$set(e.form,"slug",t)},expression:"form.slug"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"父级分类:",prop:"parentCategoryId"}},[t("tree-select",{staticStyle:{width:"100%"},attrs:{placeholder:"不选择",options:e.categories,props:{checkStrictly:!0,value:"id",label:"name"}},model:{value:e.form.parentCategoryId,callback:function(t){e.$set(e.form,"parentCategoryId",t)},expression:"form.parentCategoryId"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"分类描述:",prop:"desc"}},[t("el-input",{attrs:{type:"textarea",placeholder:"此文字用于描述分类, 在该分类首页中它会被显示",autosize:{minRows:2,maxRows:6}},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"分类背景:",prop:"categoryBackground"}},[t("upload-image-input",{model:{value:e.form.categoryBackground,callback:function(t){e.$set(e.form,"categoryBackground",t)},expression:"form.categoryBackground"}}),e._v(" "),t("div",{staticClass:"instruction"},[e._v("在这里填入图片的URL地址, 以在分类页面显示一个背景大图.")])],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{"native-type":"submit",type:"primary",size:"small",loading:e.categoryUpdateLoading},nativeOn:{click:function(t){return t.preventDefault(),e.onSave("managerForm")}}},[e._v("保 存\n      ")])],1)],1),e._v(" "),t("el-card",{staticClass:"box-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"clearfix"},[e.parentCategory.name?t("div",{staticClass:"card-header-back"},[t("span",{staticClass:"header-back-title",on:{click:e.backParent}},[t("i",{staticClass:"el-icon-back"}),e._v(" "),t("span",[e._v("返回上级目录")])]),e._v(" "),t("el-divider",{attrs:{direction:"vertical"}})],1):e._e(),e._v(" "),t("div",{staticClass:"card-header content-title"},[t("span",[e._v(e._s(e.parentCategory.name?"管理 ".concat(e.parentCategory.name," 的子分类"):"管理分类"))])]),e._v(" "),t("el-button",{staticClass:"card-button",attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.add()}}},[e._v("新增分类")])],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:this.multipleSelection.length>0,expression:"this.multipleSelection.length > 0"}],staticClass:"card-header-right"},[t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.handleDelete()}}},[e._v("删除")])],1)]),e._v(" "),t("el-table",{attrs:{data:e.categoryList,stripe:"","row-key":"id","expand-row-keys":e.expandRowKeys,size:"medium"},on:{"selection-change":e.handleSelectionChange,"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),t("el-table-column",{attrs:{prop:"name",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("a",{on:{click:function(t){return e.handleEdit(i.row.id)}}},[e._v(e._s(i.row.name))])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"子分类"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.children&&i.row.children.length>0?t("a",{on:{click:function(t){return e.subCategoryList(i.row.id)}}},[e._v(e._s(i.row.children.length)+"个分类")]):t("a",{on:{click:function(t){return e.add(i.row.id)}}},[e._v("新增")])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"slug",label:"缩略名"}}),e._v(" "),t("el-table-column",{attrs:{prop:"quota",label:"默认"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.isDefault?t("span",[e._v("默认")]):e._e(),e._v(" "),i.row.isDefault||i.row.id!==e.cellMouseIndexId?e._e():t("a",{on:{click:function(t){return e.setDefault(i.row)}}},[e._v("默认")])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"quota",label:"文章数"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.articleNum>0?t("router-link",{attrs:{to:"/setting/website/manager-articles?categoryIds="+i.row.id}},[t("el-tag",{staticClass:"article-num"},[e._v(e._s(i.row.articleNum))])],1):t("span",[t("el-tag",{staticClass:"article-num"},[e._v(e._s(i.row.articleNum))])],1)]}}])})],1)],1)],1)},a=[],o=i("ae4a"),r=(i("96cf"),i("97bf")),s=(i("ac6a"),i("c405")),l=i("f406"),c=i("d693"),d={name:"categoryManager",components:{TreeSelect:c["a"],UploadImageInput:l["a"]},data:function(){return{title:"分类管理",categoryList:[],expandRowKeys:[],dialogVisible:!1,dialogTitle:"",categoryUpdateLoading:!1,valid:!0,categories:[],parentCategory:{},parentCategoryId:void 0,form:{name:"",slug:"",parentCategoryId:"",desc:"",categoryBackground:""},rules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},editMove:1,multipleSelection:[],cellMouseIndexId:""}},computed:{},mounted:function(){this.getCategories(),this.getParentCategory()},methods:{handleSelectionChange:function(e){this.multipleSelection=e},backParent:function(){this.subCategoryList(this.parentCategory.parentCategoryId)},getParentCategory:function(){var e=this;this.$route.query.parent?s["a"].categoryInfo({categoryId:this.$route.query.parent}).then((function(t){e.parentCategory=t.data})):this.parentCategory={}},getCategories:function(){var e=this;s["a"].categories({parentCategoryId:this.$route.query.parent}).then((function(t){e.categoryList=t.data,e.categoryList.forEach((function(t){t.children&&e.expandRowKeys.push(t.id)}))}))},categoryTree:function(){var e=this;s["a"].categoryTree().then((function(t){e.categories=t.data}))},subCategoryList:function(e){e?this.$router.push("".concat(window.location.pathname,"?parent=").concat(e)):this.$router.push(window.location.pathname),this.getCategories(),this.getParentCategory()},add:function(){var e=Object(r["a"])(Object(o["a"])().m((function e(t){return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:return this.categoryTree(),this.dialogVisible=!0,this.dialogTitle="添加分类",this.editMove=1,e.n=1,this.$nextTick();case 1:this.$refs.managerForm.resetFields(),this.$route.query.parent&&(this.form.parentCategoryId=this.$route.query.parent),t&&(this.form.parentCategoryId=t);case 2:return e.a(2)}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setFormData:function(){var e=new FormData;for(var t in this.form)this.form.hasOwnProperty(t)&&this.form[t]&&e.append(t,this.form[t]);return e},setDefault:function(e){var t=this;s["a"].setDefault({categoryId:e.id}).then((function(){t.getCategories(),t.$message({message:"".concat(e.name," 已经被设为默认分类"),type:"success",duration:1500})})).catch((function(){}))},onSave:function(){var e=this;this.$refs.managerForm.validate((function(t){if(e.valid=t,!t)return!1;e.categoryUpdateLoading=!0,1===e.editMove&&e.addCategory(e.setFormData()),2===e.editMove&&e.updateCategory(e.setFormData())}))},handleEdit:function(e){var t=this;this.editMove=2,this.dialogVisible=!0,this.dialogTitle="修改分类",s["a"].categoryInfo({categoryId:e}).then((function(e){t.form=e.data})),this.categoryTree()},handleDelete:function(){var e=this,t=[];this.multipleSelection.forEach((function(e){t.push(e.id)})),this.$confirm("所选分类下的所有内容(包括文章)都将被删除,\r\n 您确认要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["a"].delete({categoryIds:t}).then((function(){e.onDeleted()})).catch((function(){e.onError()}))}))},updateCategory:function(e){var t=this;s["a"].update(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},addCategory:function(e){var t=this;s["a"].add(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},onDeleted:function(){this.$notify({title:"删除成功",type:"success",duration:1e3}),this.getCategories()},onSuccess:function(e){this.getCategories();var t="保存成功!";e&&(t=e),this.categoryUpdateLoading=!1,this.dialogVisible=!1,this.$message({message:t,type:"success",duration:1e3})},onError:function(){this.categoryUpdateLoading=!1},cellMouseEnter:function(e){this.cellMouseIndexId=e.id},cellMouseLeave:function(){this.cellMouseIndexId=""}}},u=d,h=(i("7e8e"),i("2877")),p=Object(h["a"])(u,n,a,!1,null,"ff8b3c84",null);t["default"]=p.exports},"26a1":function(e,t,i){"use strict";function n(e){return e.className&&e.className.indexOf("parent-grid-item")>-1||e.className.indexOf("van-grid-item van-grid-item--square")>-1?e.offsetTop:e.parentElement?n(e.parentElement)+e.offsetTop:e.offsetTop}function a(e){return e.className&&e.className.indexOf("parent-grid-item")>-1?e.offsetLeft:e.offsetParent?a(e.offsetParent)+e.offsetLeft:e.offsetLeft}i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a}))},"26fc":function(e,t,i){e.exports=i.p+"static/img/404_cloud.0f4bc32b.png"},"2ba9":function(e,t,i){"use strict";i("ddb3")},3158:function(e,t,i){"use strict";i.r(t);i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-dialog",{staticClass:"dialog-form",attrs:{width:"600px",title:e.dialogTitle,visible:e.dialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?t("el-form",{ref:"managerForm",attrs:{size:"medium","label-width":"90px",model:e.form,rules:e.rules}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"用户账号:",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入账号",width:"100%",disabled:2===e.editMove},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"用户名:",prop:"showName"}},[t("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.form.showName,callback:function(t){e.$set(e.form,"showName",t)},expression:"form.showName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"角色:",prop:"roles"}},[t("el-select",{ref:"selectRole",attrs:{multiple:"",placeholder:"请选择角色"},on:{change:e.changeRole},model:{value:e.form.roles,callback:function(t){e.$set(e.form,"roles",t)},expression:"form.roles"}},e._l(e.roleList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),e._v(" "),t("el-col",{attrs:{sm:12}},[1===e.editMove?t("el-form-item",{attrs:{label:"密码:",prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e(),e._v(" "),1===e.editMove?t("el-form-item",{attrs:{label:"确认密码:",prop:"checkPass"}},[t("el-input",{attrs:{type:"password"},model:{value:e.form.checkPass,callback:function(t){e.$set(e.form,"checkPass",t)},expression:"form.checkPass"}})],1):e._e(),e._v(" "),t("el-form-item",{attrs:{label:"配额(GB):"}},[t("el-input-number",{attrs:{"controls-position":"right",min:1,max:1073741824},model:{value:e.form.quota,callback:function(t){e.$set(e.form,"quota",t)},expression:"form.quota"}})],1)],1)],1)],1):e._e(),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[2===e.editMove?t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.resetPassword()}}},[e._v("重置密码")]):e._e(),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary",loading:e.userUpdateLoading},nativeOn:{click:function(t){return t.preventDefault(),e.onSave()}}},[e._v("保 存")])],1)],1),e._v(" "),t("el-card",{staticClass:"box-card table-search-header"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"box-card-header"},[t("el-form",{ref:"queryForm",staticClass:"search-form",attrs:{size:"medium","label-width":"77px",model:e.queryCondition,rules:e.rules}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{sm:12,md:8}},[t("el-form-item",{attrs:{label:"用户账号:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.username,callback:function(t){e.$set(e.queryCondition,"username",t)},expression:"queryCondition.username"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:8}},[t("el-form-item",{attrs:{label:"用户名:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.showName,callback:function(t){e.$set(e.queryCondition,"showName",t)},expression:"queryCondition.showName"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:8}},[t("div",{staticClass:"el-form-actions"},[t("el-button",{staticClass:"card-btn-icon",attrs:{size:"medium",icon:"el-icon-search",type:"primary"},on:{click:function(t){return e.getUserList()}}},[e._v("查询")]),e._v(" "),t("el-button",{staticClass:"card-btn-icon",attrs:{size:"medium",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.add()}}},[e._v("添加")]),e._v(" "),t("el-button",{staticClass:"card-btn-icon",attrs:{disabled:e.multipleSelection.length<1,size:"medium",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.handleSelectDelete()}}},[e._v("删除")])],1)])],1)],1)],1)]),e._v(" "),t("table-list",{attrs:{tableData:e.userList,loading:e.loading,tableHeader:e.tableHeader,pagination:e.pagination},on:{pageChange:e.pageChange,sizeChange:e.pageChange,selectFun:e.selectFun,sortChange:e.sortChange}})],1)],1)},a=[],o=(i("ac6a"),i("ae4a")),r=(i("96cf"),i("97bf")),s=i("6f8e"),l=(i("6762"),i("2fdb"),i("c24f")),c=i("cc5e"),d=i("74e6"),u=i("7c83"),h={username:"",password:"",showName:"",roles:[],checkPass:"",quota:10},p={name:"cusomerManager",components:{TableList:u["a"],CropperDialog:d["a"]},props:{},data:function(){var e=this,t=function(t,i,n){""===i?n(new Error("请再次输入密码")):i!==e.form.password?n(new Error("两次输入密码不一致!")):n()};return{title:"用户管理",userList:[],loading:!1,roleList:[],dialogVisible:!1,dialogTitle:"",userUpdateLoading:!1,valid:!0,form:h,pagination:{pageIndex:1,pageSize:15,pageTotal:0},queryCondition:{username:"",showName:"",sortProp:"",sortOrder:""},tableHeader:[{prop:"username",minWidth:110,label:"用户账号",sortable:"custom"},{prop:"showName",minWidth:100,label:"用户名",sortable:"custom"},{prop:"roles",minWidth:120,label:"角色",tag:!0,formatData:function(t){if(t){var i=e.roleList.map((function(e){if(t.includes(e.id))return{name:e.name}}));return i=i.filter((function(e){return void 0!==e})),i}}},{prop:"quota",label:"配额(GB)",sortable:"custom"},{prop:"createTime",label:"创建时间",sortable:"custom"},{label:"操作",minWidth:130,active:[{name:"修改",icon:"el-icon-edit",handle:function(t){return e.handleEdit(t.id,t.username)}},{name:"删除",icon:"el-icon-delete",color:"#ff4d4f",handle:function(t){return e.handleDelete([t.id])}}]}],multipleSelection:[],rules:{username:[{required:!0,message:"请输入用户账号",trigger:"blur"}],showName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码不能小于6个字符",trigger:"blur"}],checkPass:[{required:!0,validator:t,trigger:"blur"}]},editMove:1}},computed:{},mounted:function(){this.getUserList(),this.getRoleList(),this.resize()},methods:{resize:function(){var e=document.querySelector(".container").clientWidth,t=e<=768;this.tableHeader[3].disabled=t,this.tableHeader[4].disabled=t},selectFun:function(e){this.multipleSelection=e.backData},sortChange:function(e){var t=e.backData;this.queryCondition.sortProp=t.prop,this.queryCondition.sortOrder=t.order,this.getUserList()},pageChange:function(e){this.pagination=e.backData,this.getUserList()},getUserList:function(){var e=this;this.loading=!0,Object(l["o"])(Object(s["a"])({page:this.pagination.pageIndex,pageSize:this.pagination.pageSize},this.queryCondition)).then((function(t){e.userList=t.data,e.pagination.pageTotal=t.count,e.loading=!1}))},getRoleList:function(){var e=this;c["a"].roleList().then((function(t){e.roleList=t.data}))},add:function(){var e=Object(r["a"])(Object(o["a"])().m((function e(){return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:return this.dialogVisible=!0,e.n=1,this.$nextTick();case 1:return this.$refs.managerForm.resetFields(),this.dialogTitle="添加用户",this.editMove=1,this.form=h,e.n=2,this.$nextTick();case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),setFormData:function(){var e=new FormData;for(var t in this.form)this.form.hasOwnProperty(t)&&e.append(t,this.form[t]);return e.delete("createTime"),e.delete("updateTime"),e},onSave:function(){var e=this;this.$refs.managerForm.validate((function(t){if(e.valid=t,!t)return!1;e.userUpdateLoading=!0,1===e.editMove&&e.addUser(e.setFormData()),2===e.editMove&&e.userUpdate(e.setFormData())}))},handleEdit:function(e){var t=this;this.editMove=2,this.dialogVisible=!0,this.dialogTitle="修改用户",Object(l["d"])({id:e}).then((function(e){if(t.form=e.data,t.form.roles){var i=t.roleList.map((function(e){if(t.form.roles.includes(e.id))return e.id}));i=i.filter((function(e){return void 0!==e})),t.form.roles=i}}))},changeRole:function(){this.$refs.selectRole.blur()},resetPassword:function(){var e=this;this.$confirm("是否重置改用户的密码(重置后的密码为:xdzncloud)?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["k"])(e.form.id).then((function(){})).catch((function(){e.onError()}))}))},handleSelectDelete:function(){var e=this;this.$confirm("确定要删除选中的用户吗, 此操作会删除用户的所有文件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=[];e.multipleSelection.forEach((function(e){t.push(e.id)})),e.deleteUser(t)}))},handleDelete:function(e){var t=this;this.$confirm("确定要删除此用户吗？此操作会删除用户的所有文件","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteUser(e)}))},deleteUser:function(e){var t=this;Object(l["b"])({ids:e}).then((function(){t.onSuccess("删除成功!")})).catch((function(){t.onError()}))},userUpdate:function(e){var t=this;Object(l["p"])(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},addUser:function(e){var t=this;Object(l["a"])(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},onSuccess:function(e){this.getUserList();var t="保存成功!";e&&(t=e),this.userUpdateLoading=!1,this.dialogVisible=!1,this.$message({message:t,type:"success",duration:1e3})},onError:function(){this.userUpdateLoading=!1}}},f=p,m=(i("c726"),i("2877")),g=Object(m["a"])(f,n,a,!1,null,"b99e256a",null);t["default"]=g.exports},3185:function(e,t,i){"use strict";i("4e19")},3279:function(e,t,i){},3293:function(e,t,i){"use strict";i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",[t("button",{staticClass:"button"},[t("div",{staticClass:"icon"},[t("div",{staticClass:"arrow"}),e._v(" "),t("svg",{staticClass:"line",attrs:{viewBox:"0 0 24 24"}})]),e._v("\n    "+e._s(e.name)+"\n  ")])])},a=[],o=(i("ac6a"),i("cffa")),r={name:"ButtonUpload",props:{name:{type:String,default:"上传"}},data:function(){return{interval:null}},mounted:function(){this.init()},methods:{init:function(){var e=this,t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return t.querySelector(e)},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return t.querySelectorAll(e)};function n(e,t,i,n){var a=function(e,t,i,a){var o=t||e,r=i||e,s={length:Math.sqrt(Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2)),angle:Math.atan2(r[1]-o[1],r[0]-o[0])},l=s.angle+(a?Math.PI:0),c=s.length*n;return[e[0]+Math.cos(l)*c,e[1]+Math.sin(l)*c]},o=a(i[t-1],i[t-2],e,!1),r=a(e,i[t-1],i[t+1],!0);return"C ".concat(o[0],",").concat(o[1]," ").concat(r[0],",").concat(r[1]," ").concat(e[0],",").concat(e[1])}function a(e,t,i){var a=i||[[5,12],[12,e],[19,12]],o=a.reduce((function(e,i,a,o){return 0===a?"M ".concat(i[0],",").concat(i[1]):"".concat(e," ").concat(n(i,a,o,t))}),"");return'<path d="'.concat(o,'" />')}i(".button").forEach((function(i){var n=t(".icon",i),r=t(".line",n),s=new Proxy({y:null},{set:function(e,t,i){return e[t]=i,null!==e.y&&(r.innerHTML=a(e.y,.25,null)),!0},get:function(e,t){return e[t]}}),l=o["a"].timeline({paused:!0});s.y=12,l.to(n,{"--arrow-y":6,"--arrow-rotate":70,ease:"elastic.in(1.1, .8)",duration:.7}).to(n,{"--arrow-y":0,"--arrow-rotate":45,ease:"elastic.out(1.1, .8)",duration:.7}),l.to(s,{y:15,duration:.15},.65).to(s,{y:12,ease:"elastic.out(1.2, .7)",duration:.6},.8),e.interval=setInterval((function(){return l.restart()}),1500)}))}},destroyed:function(){clearInterval(this.interval)}},s=r,l=(i("92b5"),i("2877")),c=Object(l["a"])(s,n,a,!1,null,"3e3b3e02",null);t["a"]=c.exports},3339:function(e,t,i){"use strict";i("4096")},3381:function(e,t,i){},"351e":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-card",{staticClass:"box-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"box-card-header"},[t("div",{staticClass:"clearfix card-header-back"},[t("span",[e._v("OSS管理")]),e._v(" "),t("el-button",{staticClass:"card-button",attrs:{size:"mini",type:"primary"},on:{click:e.addOSS}},[e._v("新增")])],1)])]),e._v(" "),t("table-list",{ref:"tableOssConfig",attrs:{"has-selection":!1,tableData:e.ossConfigList,"less-client-height":210,loading:e.tableLoading,tableHeader:e.tableHeader}})],1),e._v(" "),t("div",[t("el-dialog",{staticClass:"set-oss-dialog",attrs:{title:e.putOssTitle,visible:e.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialog=t}}},[t("el-form",{ref:"form",attrs:{rules:e.rules,model:e.formData,"label-width":"120px",size:"small"}},[t("el-form-item",{attrs:{label:"Platform",prop:"platform"}},[t("el-select",{attrs:{placeholder:"选择平台"},model:{value:e.formData.platform,callback:function(t){e.$set(e.formData,"platform",t)},expression:"formData.platform"}},e._l(e.platforms,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"Endpoint",prop:"endpoint"}},[t("el-input",{model:{value:e.formData.endpoint,callback:function(t){e.$set(e.formData,"endpoint",t)},expression:"formData.endpoint"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Access Key",prop:"accessKey"}},[t("el-input",{model:{value:e.formData.accessKey,callback:function(t){e.$set(e.formData,"accessKey",t)},expression:"formData.accessKey"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Secret Key",prop:"secretKey"}},[t("el-input",{attrs:{type:"password"},model:{value:e.formData.secretKey,callback:function(t){e.$set(e.formData,"secretKey",t)},expression:"formData.secretKey"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Region",prop:"region"}},[t("el-input",{model:{value:e.formData.region,callback:function(t){e.$set(e.formData,"region",t)},expression:"formData.region"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Bucket",prop:"bucket"}},[t("el-input",{model:{value:e.formData.bucket,callback:function(t){e.$set(e.formData,"bucket",t)},expression:"formData.bucket"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"目录名称",prop:"folderName"}},[t("el-input",{model:{value:e.formData.folderName,callback:function(t){e.$set(e.formData,"folderName",t)},expression:"formData.folderName"}}),e._v(" "),t("div",{staticClass:"form-item-desc"},[e._v("将在根目录下创建此目录，相当于把oss挂载到了此目录")])],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.showDialog=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.submitLoading,expression:"submitLoading"}],attrs:{size:"small",type:"primary"},on:{click:e.submitForm}},[e._v("确定")])],1)],1)],1)],1)},a=[],o=(i("20d6"),i("ae4a")),r=(i("96cf"),i("97bf")),s=i("b775"),l=i("4328"),c={getPlatformList:function(e){return Object(s["a"])({url:"/oss/getPlatformList",method:"get",params:e})},ossConfigList:function(e){return Object(s["a"])({url:"/oss/ossConfigList",method:"get",params:e})},putOssConfig:function(e){return Object(s["a"])({url:"/oss/putOssConfig",method:"put",data:e})},deleteOssConfig:function(e){return Object(s["a"])({url:"/oss/deleteOssConfig",method:"delete",params:e,paramsSerializer:function(e){return l.stringify(e,{arrayFormat:"repeat"})}})}},d=i("7c83"),u={components:{TableList:d["a"]},data:function(){var e=this,t=function(){var e=Object(r["a"])(Object(o["a"])().m((function e(t,i,n){return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:""===i?n(new Error("请输入目录名")):/[\[\]\/\\"<>\?\*]/gi.test(i)?n(new Error("目录名不能包含这些字符:<,>,|,*,?,,/,[,]")):n();case 1:return e.a(2)}}),e)})));return function(t,i,n){return e.apply(this,arguments)}}();return{putOssTitle:"",showDialog:!1,ossConfigList:[],tableLoading:!1,formData:{endpoint:"",accessKey:"",secretKey:"",region:"",bucket:"",folderName:"",platform:""},submitLoading:!1,tableHeader:[{prop:"platform",label:"平台",noScope:!0,align:"left",formatData:function(t){var i=e.platforms.findIndex((function(e){return e.value===t}));return i>-1?e.platforms[i].label:""}},{prop:"bucket",label:"bucket",noScope:!0,align:"left"},{prop:"folderName",label:"目录名",noScope:!0,align:"left"},{label:"操作",minWidth:this.$pc?0:130,active:[{name:"修改",icon:"el-icon-edit",handle:function(t){return e.updateOssConfig(t)}},{name:"删除",icon:"el-icon-delete",color:"#ff4d4f",handle:function(t){return e.handleDelete(t)}}]}],platforms:[],rules:{platform:[{required:!0,message:"请选择平台",trigger:"submit"}],endpoint:[{required:!0,message:"请填写Endpoint",trigger:"submit"}],accessKey:[{required:!0,message:"请填写accessKey",trigger:"submit"}],secretKey:[{required:!0,message:"请填写secretKey",trigger:"submit"}],bucket:[{required:!0,message:"请填写bucket",trigger:"submit"}],folderName:[{required:!0,validator:t,trigger:"submit"}]}}},mounted:function(){this.getPlatformList()},destroyed:function(){},methods:{getOssConfigList:function(){var e=this;c.ossConfigList().then((function(t){e.ossConfigList=t.data}))},submitForm:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.putOssConfig()}))},handleDelete:function(e){var t=this,i="",n=this.platforms.findIndex((function(t){return t.value===e.platform}));n>-1&&(i=this.platforms[n].label),this.$confirm("确定要删除 ".concat(i,"(").concat(e.bucket,") 吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteOssConfig(e.id)}))},deleteOssConfig:function(e){var t=this;this.deleteLoading=!0,c.deleteOssConfig({id:e}).then((function(){t.getOssConfigList(),t.deleteLoading=!1,t.$message.success("删除成功！")}))},updateOssConfig:function(e){this.formData=e,this.showDialog=!0,this.putOssTitle="修改OSS"},putOssConfig:function(){var e=this;this.submitLoading=!0,this.formData.userId=this.$store.getters.userId,c.putOssConfig(this.formData).then((function(){e.getOssConfigList(),e.$message.success(e.putOssTitle+"成功！"),e.showDialog=!1,e.submitLoading=!1})).catch((function(){e.submitLoading=!1}))},addOSS:function(){this.formData={},this.showDialog=!0,this.putOssTitle="添加OSS"},getPlatformList:function(){var e=this;c.getPlatformList().then((function(t){e.platforms=t.data,e.getOssConfigList()}))}}},h=u,p=(i("5f47"),i("2877")),f=Object(p["a"])(h,n,a,!1,null,"58eb4973",null);t["default"]=f.exports},"35c2":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-card",{staticClass:"box-card"},[t("a-affix",[t("div",{staticClass:"box-card-header"},[t("div",{staticClass:"clearfix card-header-back"},[e.subpage?e._e():t("div",[t("span",[e._v("外观设置")]),e._v(" "),t("el-button",{staticClass:"card-button",attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.save()}}},[e._v("保存设置")])],1),e._v(" "),e.subpage?t("div",[t("div",{staticClass:"card-header-back"},[t("span",{staticClass:"header-back-title",on:{click:e.backParent}},[t("i",{staticClass:"el-icon-back"}),e._v(" "),t("span",[e._v("返回")])])])]):e._e()])])]),e._v(" "),e.subpage?e._e():t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"网站首页",name:"1"}},[t("div",{staticClass:"config-itme-label"},[e._v("网站图标：")]),e._v(" "),t("upload-image-input",{attrs:{desc:"只支持ico格式","enable-select":!1,"enable-url":!1,accept:"image/vnd.microsoft.icon"},model:{value:e.form.siteIco,callback:function(t){e.$set(e.form,"siteIco",t)},expression:"form.siteIco"}}),e._v(" "),t("span",{staticClass:"instruction"},[t("a",{attrs:{href:"https://tool.lu/favicon/",target:"_blank"}},[e._v("在线制作ico")])]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("站点名称：")]),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea",width:"100%"},model:{value:e.form.siteName,callback:function(t){e.$set(e.form,"siteName",t)},expression:"form.siteName"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("给您的网站取一个响亮的名字。")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("站点地址：")]),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea",width:"100%"},model:{value:e.form.siteUrl,callback:function(t){e.$set(e.form,"siteUrl",t)},expression:"form.siteUrl"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("在这里填入站点的地址或域名。例如："),t("a",{attrs:{href:"https://blog.jmal.top",target:"_blank"}},[e._v("https://blog.jmal.top")])]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("站点背景大图：")]),t("upload-image-input",{model:{value:e.form.backgroundSite,callback:function(t){e.$set(e.form,"backgroundSite",t)},expression:"form.backgroundSite"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("在这里填入图片的URL地址, 以在网站首页显示一个背景大图。")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("首页大图内文字：\n          "),t("el-button",{attrs:{type:"text"},on:{click:e.heartwings}},[e._v("历史记录")])],1),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea"},model:{value:e.form.backgroundTextSite,callback:function(t){e.$set(e.form,"backgroundTextSite",t)},expression:"form.backgroundTextSite"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("显示在博客首页大图内的描述。")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("首页大图内描述：")]),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea"},model:{value:e.form.backgroundDescSite,callback:function(t){e.$set(e.form,"backgroundDescSite",t)},expression:"form.backgroundDescSite"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("显示在博客首页大图内的描述。")])],1),e._v(" "),t("el-tab-pane",{attrs:{label:"导航栏",name:"2"}},[t("div",{staticClass:"config-itme-label"},[e._v("导航栏顶部 - 网站 Logo：")]),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea",width:"100%"},model:{value:e.form.siteLogo,callback:function(t){e.$set(e.form,"siteLogo",t)},expression:"form.siteLogo"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("配置网站的 Logo，该选项仅作用于顶部导航条")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("导航栏操作按钮：")]),e._v(" "),t("el-input",{attrs:{type:"textarea",width:"100%",autosize:{minRows:1,maxRows:6}},on:{input:e.preview},model:{value:e.form.operatingButtons,callback:function(t){e.$set(e.form,"operatingButtons",t)},expression:"form.operatingButtons"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("\n          一个操作按钮包含两个部分：\n          "),t("a",{attrs:{href:"https://fontawesome.com/icons?d=gallery",target:"_blank"}},[e._v("Font-awesome")]),e._v("\n          图标标签和链接，使用'：'隔开(标签里的内容为该图标的简述)。\n          "),t("br"),e._v("\n          列如："+e._s(e.example)+":https://github.com/jamebal (建议不超过5项)\n        ")]),e._v(" "),t("div",[t("el-divider",{attrs:{"content-position":"center"}},[e._v("预览")]),e._v(" "),t("ul",{staticClass:"navbar-nav side-toolbar-list"},e._l(e.operatingButtons,(function(i){return t("li",[t("a",{attrs:{href:i.url,title:i.title,target:"_blank"}},[t("dl",{domProps:{innerHTML:e._s(i.fontHtml)}},[e._v("\n                  "+e._s(i.fontHtml)+"\n                ")])])])})),0)],1)],1),e._v(" "),t("el-tab-pane",{attrs:{label:"归档、分类、标签",name:"3"}},[t("div",{staticClass:"config-itme-label"},[e._v("页面显示与否：")]),e._v(" "),t("el-checkbox-group",{model:{value:e.form.alonePages,callback:function(t){e.$set(e.form,"alonePages",t)},expression:"form.alonePages"}},[t("el-checkbox",{attrs:{label:"archives"}},[e._v("归档")]),e._v(" "),t("el-checkbox",{attrs:{label:"categories"}},[e._v("分类")]),e._v(" "),t("el-checkbox",{attrs:{label:"tags"}},[e._v("标签")])],1),e._v(" "),t("span",{staticClass:"instruction"},[e._v("选中项会显示在导航栏中")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("归档界面背景大图：")]),e._v(" "),t("upload-image-input",{model:{value:e.form.archiveBackground,callback:function(t){e.$set(e.form,"archiveBackground",t)},expression:"form.archiveBackground"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("在这里填入图片的URL地址, 以在归档页面显示一个背景大图。")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("分类界面背景大图：")]),e._v(" "),t("upload-image-input",{model:{value:e.form.categoryBackground,callback:function(t){e.$set(e.form,"categoryBackground",t)},expression:"form.categoryBackground"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("在这里填入图片的URL地址, 以在分类页面显示一个背景大图。")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("标签界面背景大图：")]),e._v(" "),t("upload-image-input",{model:{value:e.form.tagBackground,callback:function(t){e.$set(e.form,"tagBackground",t)},expression:"form.tagBackground"}}),e._v(" "),t("span",{staticClass:"instruction"},[e._v("在这里填入图片的URL地址, 以在分类页面显示一个背景大图。")])],1),e._v(" "),t("el-tab-pane",{attrs:{label:"网站页脚",name:"4"}},[t("div",{staticClass:"config-itme-label"},[e._v("版权信息：")]),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea",width:"100%"},model:{value:e.form.copyright,callback:function(t){e.$set(e.form,"copyright",t)},expression:"form.copyright"}}),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("备案许可号：")]),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea",width:"100%"},model:{value:e.form.recordPermissionNum,callback:function(t){e.$set(e.form,"recordPermissionNum",t)},expression:"form.recordPermissionNum"}}),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("网站联网备案号：")]),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea",width:"100%"},model:{value:e.form.networkRecordNumber,callback:function(t){e.$set(e.form,"networkRecordNumber",t)},expression:"form.networkRecordNumber"}}),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("网站联网备案号文本：")]),e._v(" "),t("el-input",{attrs:{autosize:"",type:"textarea",width:"100%"},model:{value:e.form.networkRecordNumberStr,callback:function(t){e.$set(e.form,"networkRecordNumberStr",t)},expression:"form.networkRecordNumberStr"}})],1)],1),e._v(" "),e.subpage?t("div",{staticClass:"list-body"},[t("table-list",{ref:"tableList",attrs:{"less-client-height":280,tableData:e.dataList,loading:e.heartwingsLoading,hasSelection:!1,tableHeader:e.tableHeader,pagination:e.pagination},on:{pageChange:e.pageChange,sizeChange:e.pageChange,sortChange:e.sortChange}})],1):e._e()],1)],1)},a=[],o=(i("a481"),i("4917"),i("28a5"),i("ac6a"),i("7f7f"),i("9bf0")),r=i("f406"),s=i("7c83"),l={name:"blogManager",components:{UploadImageInput:r["a"],TableList:s["a"]},data:function(){return{subpage:!1,activeName:"1",example:'<i class="fab fa-github">github</i>',form:{siteUrl:"",backgroundSite:"",backgroundTextSite:"",backgroundDescSite:"",siteIco:"",siteName:"",siteLogo:"",operatingButtons:"",categoryBackground:"",archiveBackground:"",tagBackground:"",alonePages:[],copyright:"",recordPermissionNum:"",networkRecordNumber:"",networkRecordNumberStr:""},operatingButtons:[],dataList:[],heartwingsLoading:!1,tableHeader:[{prop:"heartwings",label:"心语",minWidth:450},{prop:"username",label:"账号",minWidth:110},{prop:"createTime",label:"创建时间",minWidth:110,sortable:"custom"}],queryCondition:{sortProp:"",sortOrder:"descending"},pagination:{pageIndex:1,pageSize:15,pageTotal:0}}},computed:{},mounted:function(){this.getSetting(),this.$route.query.tab&&(this.activeName=this.$route.query.tab)},methods:{backParent:function(){this.subpage=!1},heartwings:function(){this.subpage=!0,this.heartwingsLoading=!0,this.getHeartwingsList()},getHeartwingsList:function(){var e=this;Object(o["b"])({page:this.pagination.pageIndex,pageSize:this.pagination.pageSize,order:this.queryCondition.sortOrder}).then((function(t){e.dataList=t.data,e.heartwingsLoading=!1,e.pagination.pageTotal=t.count})).catch((function(){e.heartwingsLoading=!1}))},pageChange:function(e){this.pagination=e.backData,this.getHeartwingsList()},sortChange:function(e){var t=e.backData;this.queryCondition.sortProp=t.prop,this.queryCondition.sortOrder=t.order,this.getHeartwingsList()},handleClick:function(e){this.$router.push({query:{tab:e.name}})},preview:function(){var e=this;this.operatingButtons=[],this.form.operatingButtons&&this.form.operatingButtons.split(/[\n]/).forEach((function(t){var i={},n=t.indexOf(":"),a=t.substring(0,n),o=/[^><]+(?=<\/i>)/gim,r=a.match(o);i.title=r?r[0]:"",i.fontHtml=a.replace(o,""),i.url=t.substring(n+1,t.length),e.operatingButtons.push(i)}))},getSetting:function(){var e=this;Object(o["c"])({userId:this.$store.state.user.userId}).then((function(t){t.data&&(e.form=t.data,e.preview())})).catch((function(){}))},save:function(){var e=this;this.form.userId=this.$store.state.user.userId,Object(o["e"])(this.form).then((function(){e.$message.success("保存成功！")})).catch((function(){}))}}},c=l,d=(i("46c4"),i("2877")),u=Object(d["a"])(c,n,a,!1,null,"0129da38",null);t["default"]=u.exports},"386b":function(e,t,i){var n=i("5ca1"),a=i("79e5"),o=i("be13"),r=/"/g,s=function(e,t,i,n){var a=String(o(e)),s="<"+t;return""!==i&&(s+=" "+i+'="'+String(n).replace(r,"&quot;")+'"'),s+">"+a+"</"+t+">"};e.exports=function(e,t){var i={};i[e]=t(s),n(n.P+n.F*a((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",i)}},3882:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{defaultGrid:!0,orderCustom:!0,contextMenus:e.contextMenus,sortable:e.sortable}})],1)},a=[],o=(i("6762"),i("2fdb"),i("7f7f"),function(){var e=this,t=e._self._c;return t("div",[t("div",{directives:[{name:"resize",rawName:"v-resize",value:e.containerResize,expression:"containerResize"}],staticClass:"dashboard-container",attrs:{onselectstart:"return false"}},[t("v-contextmenu",{ref:"homeContextmenu",attrs:{disabled:e.contextmenuDisabled}},e._l(e.contextMenus,(function(i){return t("div",{key:i.operation},[i.child?e._e():t("v-contextmenu-item",{attrs:{divider:!!i.divider},on:{click:function(t){return e.contextmenuClick(i.operation)}}},[i.iconClass?t("svg-icon",{attrs:{"icon-class":i.iconClass}}):e._e(),e._v("\n            "+e._s(i.label)+"\n          ")],1),e._v(" "),i.child?t("v-contextmenu-submenu",{attrs:{title:i.label}},e._l(i.child,(function(i){return t("div",{key:i.operation},[i.child?e._e():t("v-contextmenu-item",{attrs:{divider:!!i.divider},on:{click:function(t){return e.contextmenuClick(i.operation)}}},[i.iconClass?t("svg-icon",{attrs:{"icon-class":i.iconClass}}):e._e(),e._v("\n                "+e._s(i.label)+"\n              ")],1),e._v(" "),i.child?t("v-contextmenu-submenu",{attrs:{title:i.label}}):e._e()],1)})),0):e._e()],1)})),0),e._v(" "),t("el-breadcrumb",{staticClass:"app-breadcrumb",attrs:{separator:""}},[e.showNavigation?t("transition-group",{attrs:{name:"breadcrumb"}},e._l(e.pathList,(function(i,n){return t("el-breadcrumb-item",{key:i.folder+n},[0===n&&e.pathList.length>1?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"返回上一级",placement:"top"}},[t("a",{on:{click:function(t){return t.preventDefault(),e.lastLink()}}},[t("svg-icon",{staticStyle:{"font-size":"24px","margin-left":"20px"},attrs:{"icon-class":"back"}}),e._v(" ")],1)]):e._e(),e._v(" "),0===n&&e.pathList.length>2?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"根目录",placement:"top"}},[t("a",{staticClass:"home-link",on:{click:function(t){return t.preventDefault(),e.handleLink(i,n)}}},[t("svg-icon",{staticStyle:{"font-size":"24px"},attrs:{"icon-class":"home"}})],1)]):e._e(),e._v(" "),t("breadcrumb-file-path",{attrs:{pathList:e.pathList,item:i,index:n},on:{clickLink:e.handleLink}})],1)})),1):e._e(),e._v(" "),t("div",{staticClass:"search-content"},[t("div",{staticClass:"search-class"},[t("el-popover",{directives:[{name:"show",rawName:"v-show",value:e.showUploadButton,expression:"showUploadButton"}],attrs:{placement:"bottom",trigger:"hover"},on:{click:e.showNewFolderClick,"after-leave":e.hideNewFolderName},model:{value:e.isShowNewFolder,callback:function(t){e.isShowNewFolder=t},expression:"isShowNewFolder"}},[t("div",{staticClass:"newFileMenu",staticStyle:{display:"block"}},[t("ul",[t("li",{on:{click:e.upload}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":"file-upload"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(""!==e.singleFileType?e.singleFileType:"上传文件"))])],1)]),e._v(" "),""===e.singleFileType?t("li",{on:{click:e.uploadFolder}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":"folder-upload"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v("上传文件夹")])],1)]):e._e(),e._v(" "),""===e.singleFileType?t("li",{on:{click:function(t){return t.preventDefault(),e.newFolder.apply(null,arguments)}}},[t("a",{staticClass:"menuitem",attrs:{href:"#"}},[t("svg-icon",{attrs:{"icon-class":"folder-add"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v("新建文件夹")])],1)]):e._e(),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showNewFolder,expression:"showNewFolder"}],staticClass:"folder-name-form"},[t("el-input",{ref:"newFolderName",attrs:{placeholder:"请输入文件夹名称",clearable:!0},on:{focus:e.setInputFocus,blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.newFolderNameClickEnter.apply(null,arguments)}},model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}},[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.newFolderLoading,expression:"newFolderLoading"}],staticClass:"el-icon-right",attrs:{slot:"append","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:e.newFolderNameClick},slot:"append"})],1)],1)])]),e._v(" "),t("button-upload",{staticStyle:{"margin-right":"5px"},attrs:{slot:"reference",name:""},nativeOn:{click:function(t){return e.upload.apply(null,arguments)}},slot:"reference"})],1),e._v(" "),t("el-input",{directives:[{name:"show",rawName:"v-show",value:e.showSearchButton,expression:"showSearchButton"}],attrs:{placeholder:"搜索",clearable:!0},on:{focus:e.setInputFocus,blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchFile(e.searchFileName)}},model:{value:e.searchFileName,callback:function(t){e.searchFileName=t},expression:"searchFileName"}},[t("el-button",{attrs:{slot:"prepend"},on:{click:function(t){return e.searchFile(e.searchFileName)}},slot:"prepend"},[t("svg-icon",{staticStyle:{"font-size":"22px"},attrs:{"icon-class":"search"}})],1)],1),e._v(" "),t("el-dropdown",{staticStyle:{height:"40px"},attrs:{size:"medium"},on:{command:e.contextmenuClick}},[t("el-button",{staticClass:"sort",attrs:{type:"text"}},[t("svg-icon",{attrs:{"icon-class":"sort"}})],1),e._v(" "),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"orderName"}},[t("span",{class:{"al-file-sort-item":!0,active:"name"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("名称")])])]),e._v(" "),t("el-dropdown-item",{attrs:{command:"orderSize"}},[t("span",{class:{"al-file-sort-item":!0,active:"size"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("大小")])])]),e._v(" "),t("el-dropdown-item",{attrs:{command:"orderUpdateDate"}},[t("span",{class:{"al-file-sort-item":!0,active:"updateDate"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("日期")])])])],1)],1),e._v(" "),t("el-button",{staticClass:"vmode",attrs:{type:"text"},on:{click:e.changeVmode}},[t("svg-icon",{attrs:{"icon-class":e.grid?"list":"grid"}})],1)],1)])],1),e._v(" "),t("div",[t("div",{staticClass:"info-statistics"},[e.tableLoading?t("span",[e._v("获取更多数据...")]):e._e(),e._v(" "),e.tableLoading?e._e():t("span",[e._v(e._s(e.finished?"已全部加载 "+e.getSummaries3:"已加载 "+e.getSummaries3))])])]),e._v(" "),t("e-vue-contextmenu",{ref:"contextShow",staticClass:"newFileMenu",class:e.menuTriangle,on:{"ctx-show":e.show,"ctx-hide":e.hide}},[t("div",{staticClass:"popper-arrow"}),e._v(" "),e._l(e.menus,(function(i,n){return t("ul",{key:i.label},["unFavorite"===i.operation||"favorite"===i.operation?t("li",{staticClass:"menu-option",on:{click:function(t){return e.menusOperations(i.operation)},mouseover:function(t){return t.preventDefault(),t.stopPropagation(),e.menuFavoriteOver(n,e.rowContextData.isFavorite)},mouseleave:function(t){return t.preventDefault(),t.stopPropagation(),e.menuFavoriteLeave(n,e.rowContextData.isFavorite)}}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)]):t("li",{on:{click:function(t){return e.menusOperations(i.operation)}}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)])])}))],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.fileList.length>0,expression:"fileList.length > 0"}],style:{width:"100%",height:e.clientHeight+"px"},attrs:{id:"v-draw-rectangle"}},[t("pl-table",{directives:[{name:"show",rawName:"v-show",value:!e.grid,expression:"!grid"},{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"fileListTable",staticStyle:{width:"100%",margin:"20px 0 0 0"},attrs:{"max-height":e.clientHeight,"default-sort":e.sortable,"highlight-current-row":!1,"empty-text":"无文件","use-virtual":!1,"row-height":51.5,border:!1,"excess-rows":10,"pagination-show":!1,stripe:"","cell-style":e.rowStyle,"height-change":!1,"row-class-name":e.tableRowClassName,"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{"selection-change":e.handleSelectionChange,"row-contextmenu":e.rowContextmenu,"cell-click":e.cellClick,"row-dblclick":e.dblclick,"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"sort-change":e.sortChange,"table-body-scroll":e.tableBodyScroll,select:e.pinSelect}},[e._l(e.tableHead,(function(i,n){return[1===n?t("pl-table-column",{key:n,attrs:{index:n,align:"center","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("icon-file",{attrs:{item:i.row,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})]}}],null,!0)}):e._e(),e._v(" "),2===n?t("pl-table-column",{key:n,attrs:{"show-overflow-tooltip":!0,"max-width":"200",index:n,prop:i.name,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom")},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.editingIndex?t("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{span:10,placeholder:"",size:"small"},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,i.row.suffix)},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.rowRename(e.renameFileName,i.row)}},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}}):t("div",{staticClass:"table-file-name"},[e._v("\n                  "+e._s(i.row.name)+"\n                  "),i.row.ossPlatform?t("el-tag",{staticClass:"pc list oss-folder",attrs:{size:"small"}},[e._v(e._s(i.row.ossPlatform)+"\n                  ")]):e._e()],1)]}}],null,!0)}):e._e(),e._v(" "),4===n&&e.showMoreItem?t("pl-table-column",{key:n,staticClass:"el-icon-more",attrs:{width:"50",prop:i.name,label:i.label,index:n,align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.cellMouseIndex?t("svg-icon",{staticClass:"button-class",attrs:{"icon-class":"more"},on:{click:function(t){return t.stopPropagation(),e.moreClick(i.row,t)}}}):e._e()]}}],null,!0)},[t("template",{slot:"header"},[""!==i.name?t("svg-icon",{staticClass:"button-class",attrs:{"icon-class":"more"},on:{click:function(t){return t.stopPropagation(),e.moreOperation(t)}}}):e._e()],1)],2):e._e(),e._v(" "),5===n&&e.showSizeItem?t("pl-table-column",{key:n,attrs:{width:"200",prop:i.name,index:n,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom"),"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(e.formatSize(i.row.size)))])]}}],null,!0)}):e._e(),e._v(" "),6===n&&e.showUpdateDateItem?t("pl-table-column",{key:n,attrs:{width:"250",prop:i.name,index:n,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom"),"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:i.row.updateDate,placement:"top"}},[t("span",[e._v("   "+e._s(e.formatTime(i.row.agoTime)))])])]}}],null,!0)}):e._e()]}))],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.grid,expression:"grid"},{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"}},[t("van-checkbox-group",{ref:"checkboxGroup",on:{change:e.handleSelectionChange},model:{value:e.selectRowData,callback:function(t){e.selectRowData=t},expression:"selectRowData"}},[t("van-grid",{style:{width:"100%","max-height":e.clientHeight-25+"px",overflow:"auto","box-shadow":e.fileListScrollTop>0?"#a5a7a8 0px 0px 3px":"#ffffff 0px 0px 0px"},attrs:{square:"",center:!0,"column-num":e.gridColumnNum,gutter:10,border:!1}},e._l(e.fileList,(function(i,n){return t("van-grid-item",{key:i.id,ref:"gridItem",refInFor:!0,attrs:{title:"大小："+e.formatSize(i.size)+"\r\n"+(i.w&&i.h?"分辨率："+i.w+"x"+i.h+"\r\n":"")+"名称："+i.name+"\r\n创建时间："+i.uploadDate+"\r\n修改时间："+i.updateDate+"\r\n路径："+i.path}},[t("div",{staticClass:"grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:{background:e.selectRowData.includes(i)?"#caeaf991":"","background-size":"cover","background-position":"center",border:e.selectRowData.includes(i)?"solid 1px #409eff":""},on:{click:function(t){return e.gridItemClick(i)},dblclick:function(t){return e.fileClick(i)},contextmenu:function(t){return t.preventDefault(),e.rowContextmenu(i)}}},[t("div",{staticClass:"grid-hover-back grid-hover van-grid-item__content van-grid-item__content--center van-grid-item__content--square"},[t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0,"grid-width":e.gridColumnWidth}})],1),e._v(" "),i.index===e.editingIndex?t("el-input",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"grid-item-text",attrs:{placeholder:"",type:"textarea",autosize:"",size:"small"},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,i.suffix)},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.rowRename(e.renameFileName,i))}},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}}):t("div",[t("div",{staticClass:"grid-item-text"},[t("span",[e._v(e._s(e.gridFilename(i)))])])])],1)])])})),1)],1)],1),e._v(" "),t("table",{staticClass:"drag-table",attrs:{id:"drag-table"}})],1),e._v(" "),e.fileList.length<1&&!e.tableLoading?t("empty-file",{attrs:{emptyStatus:e.emptyStatus}}):e._e(),e._v(" "),t("img",{staticStyle:{position:"fixed",opacity:"0"},attrs:{id:"dragImage",draggable:"false",src:i("5116")}}),e._v(" "),e.selectFile?e._e():t("div",{staticClass:"number-files",attrs:{id:"numberFiles"}},[t("img",{staticClass:"icon",staticStyle:{display:"none"},attrs:{src:i("943c")}}),e._v(" "),t("div",{staticClass:"number",staticStyle:{display:"inline"}},[e._v("1个文件")]),e._v(" "),t("div",{staticClass:"operate",staticStyle:{display:"none","white-space":"nowrap"}},[e._v("\n          移动到：\n        ")]),e._v(" "),e._m(0)])],1),e._v(" "),t("sim-text-preview",{attrs:{file:e.textPreviewRow,status:e.textPreviewVisible,"is-together":e.isTogether,"space-flag":e.spaceFlag},on:{"update:file":function(t){e.textPreviewRow=t},"update:status":function(t){e.textPreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}}),e._v(" "),t("image-viewer",{attrs:{fileList:e.fileList,file:e.imagePreviewRow,status:e.imagePreviewVisible},on:{"update:status":function(t){e.imagePreviewVisible=t}}}),e._v(" "),t("video-preview",{attrs:{file:e.videoPreviewRow,status:e.videoPreviewVisible},on:{"update:status":function(t){e.videoPreviewVisible=t}}}),e._v(" "),t("office-preview",{attrs:{file:e.officePreviewRow,status:e.officePreviewVisible,"is-together":e.isTogether,"space-flag":e.spaceFlag},on:{"update:status":function(t){e.officePreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}}),e._v(" "),e.cadPreviewVisible?t("cad-preview",{attrs:{status:e.cadPreviewVisible,file:e.cadPreviewRow,"is-together":e.isTogether,"space-flag":e.spaceFlag},on:{"update:status":function(t){e.cadPreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t},closeDialog:e.closeHandle}}):e._e(),e._v(" "),t("el-drawer",{attrs:{title:e.rowContextData.name,visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[t("div",{staticClass:"drawer-icon"},[t("icon-file",{staticClass:"drawer-icon-font",attrs:{grid:!0,details:!0,item:e.rowContextData,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})],1),e._v(" "),t("el-form",{staticClass:"details-form"},[t("el-form-item",{attrs:{label:"名称:"}},[t("span",[e._v(e._s(e.rowContextData.name))])]),e._v(" "),t("el-form-item",{staticClass:"details-name",attrs:{label:"类型:"}},[t("span",[e._v(e._s(e.rowContextData.isFolder?"文件夹":e.rowContextData.contentType))])]),e._v(" "),e.rowContextData.music?t("div",[t("el-form-item",{attrs:{label:"🎵 歌手:"}},[t("span",[e._v(e._s(e.rowContextData.music.singer))])]),e._v(" "),t("el-form-item",{attrs:{label:"🎵 专辑:"}},[t("span",[e._v(e._s("《"+e.rowContextData.music.album+"》"))])]),e._v(" "),t("el-form-item",{attrs:{label:"🎵 歌名:"}},[t("span",[e._v(e._s("《"+e.rowContextData.music.songName+"》"))])])],1):e._e(),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.rowContextData.w&&e.rowContextData.h,expression:"rowContextData.w && rowContextData.h"}],staticClass:"details-resolution",attrs:{label:"分辨率:"}},[t("span",[e._v(e._s(e.rowContextData.w+" x "+e.rowContextData.h))])]),e._v(" "),t("el-form-item",{attrs:{label:"大小:"}},[t("span",[e._v("\n            "+e._s(e.rowContextData.size)+"字节\n            "+e._s(e.rowContextData.size>0?"("+e.formatSize(e.rowContextData.size)+")":""))])]),e._v(" "),t("el-form-item",{staticClass:"details-position",attrs:{label:"位置:"}},[t("a",{attrs:{href:"/?path="+e.rowContextData.path+"&highlight="+e.rowContextData.name}},[e._v(e._s(e.rowContextData.path))])]),e._v(" "),t("el-form-item",{attrs:{label:"创建时间:"}},[t("span",[e._v(e._s(e.rowContextData.uploadDate))])]),e._v(" "),t("el-form-item",{attrs:{label:"修改时间:"}},[t("span",[e._v(e._s(e.rowContextData.updateDate))])])],1)],1),e._v(" "),t("el-dialog",{staticClass:"open-file-dialog",attrs:{title:"提示",top:"35vh",visible:e.openCompressionVisible},on:{"update:visible":function(t){e.openCompressionVisible=t}}},[t("svg-icon",{attrs:{"icon-class":"open-folder"}}),e._v(" "),t("span",{staticClass:"dialog-msg"},[e._v("查看压缩文件")]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.unzipTo(e.openingFile)}}},[e._v("解压到...")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.unzip(e.openingFile,e.openingFile.id,!1)}}},[e._v("解压到当前目录")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.compressionFilePreview(e.openingFile)}}},[e._v("预览")])],1)],1),e._v(" "),t("message-dialog",{attrs:{title:"提示",content:"此文件不支持预览, 是否下载该文件?",show:e.notPreviewDialogVisible,"button-size":"mini",operatButtonText:"取消",confirmButtonText:"下载"},on:{"update:show":function(t){e.notPreviewDialogVisible=t},operating:function(t){e.notPreviewDialogVisible=!1},confirm:function(t){return e.determineDownload(e.openingFile)}}}),e._v(" "),t("el-dialog",{attrs:{title:"预览:"+e.compressedFileName,visible:e.compressedFileVisible},on:{"update:visible":function(t){e.compressedFileVisible=t}}},[t("file-tree",{attrs:{directoryTreeData:e.compressedFileData,tempDir:e.compressedFileTempDir,"is-together":e.isTogether,"space-flag":e.spaceFlag},on:{"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}})],1),e._v(" "),t("el-dialog",{attrs:{title:e.titlePrefix+e.selectTreeNode.showName,visible:e.dialogMoveOrCopyVisible},on:{"update:visible":function(t){e.dialogMoveOrCopyVisible=t},close:e.clearTreeNode}},[e.dialogMoveOrCopyVisible?t("el-tree",{ref:"directoryTree",attrs:{data:e.directoryTreeData,"node-key":"id",props:e.directoryTreeProps,load:e.directoryTreeLoadNode,"highlight-current":!0,"default-expanded-keys":["0"],"render-content":e.renderContent,hight:"100",lazy:""},on:{"node-click":e.treeNodeClick,"node-expand":e.treeNodeExpand}}):e._e(),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",disabled:e.fileTreeAndNewFolderDisabled},on:{click:e.fileTreeAndNewFolder}},[t("i",{staticClass:"el-icon-folder-add"}),e._v("  新建文件夹\n        ")]),e._v(" "),e.unzipOperating?e._e():t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.moveFileTree}},[e._v("移 动")]),e._v(" "),e.unzipOperating?e._e():t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.copyFileTree}},[e._v("复制")]),e._v(" "),e.unzipOperating?t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmUnzip}},[e._v("解压")]):e._e(),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogMoveOrCopyVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),t("tag-dialog",{attrs:{fileList:e.tagDialogObjectList,status:e.tagDialogVisible,api:e.api},on:{"update:status":function(t){e.tagDialogVisible=t},onSuccess:e.allocateTagSuccess}}),e._v(" "),t("share-dialog",{attrs:{file:e.shareDialogObject,status:e.shareDialogVisible},on:{"update:file":function(t){e.shareDialogObject=t},"update:status":function(t){e.shareDialogVisible=t},onSuccess:e.shareSuccess}}),e._v(" "),t("el-dialog",{staticClass:"new-text-file-dialog",attrs:{title:e.newCreateFileDialogTitle,"close-on-click-modal":!1,visible:e.newCreateFileDialog},on:{"update:visible":function(t){e.newCreateFileDialog=t}}},[t("el-input",{ref:"newCreateFileName",staticClass:"dialog-msg",attrs:{size:"small",clearable:!0},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,"")},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createFile(e.newCreateFileName)}},model:{value:e.newCreateFileName,callback:function(t){e.newCreateFileName=t},expression:"newCreateFileName"}}),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.newCreateFileDialog=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.createFileLoading,expression:"createFileLoading"}],attrs:{size:"small",type:"primary"},on:{click:function(t){return e.createFile(e.newCreateFileName)}}},[e._v("确定")])],1)],1)],1)}),r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"target"},[t("span",{staticClass:"folder",staticStyle:{display:"none","white-space":"nowrap"}},[e._v("document")])])}],s=(i("55dd"),i("386d"),i("7514"),i("f559"),i("20d6"),i("ac6a"),i("5df3"),i("1c4c"),i("28a5"),i("6f8e")),l=(i("a481"),i("c5f6"),i("2f62")),c=i("7f29"),d=i("26a1"),u=i("1000"),h=(i("9dce"),i("7d60")),p=i("573f"),f=i("0dcf"),m=i("71e9"),g=i("2d53"),v=i("1638"),b=i("ae1f"),w=i("140f"),y=i("3293"),x=i("5a87"),C=i("9476"),k=(i("3b6a"),i("2690")),_=i("4308"),S=i("fd35"),L=i("fdd2"),T=i("dc5e"),D=i("c24f"),E=i("b311"),F=i.n(E),I=i("0dca"),M={name:"ShowFile",components:{TagDialog:I["a"],ShareDialog:T["a"],OfficePreview:S["a"],CadPreview:L["a"],EditElement:_["default"],MessageDialog:x["a"],AudioPreview:w["a"],VideoPreview:b["a"],ImageViewer:v["a"],SimTextPreview:g["a"],IconFile:f["a"],BreadcrumbFilePath:p["a"],EmptyFile:m["a"],ButtonUpload:y["a"],FileTree:C["a"]},props:{selectFile:{type:Boolean,defalut:!1},lessClientHeight:{type:Number,default:106},showUploadButton:{type:Boolean,default:!0},showSearchButton:{type:Boolean,default:!0},showShareItem:{type:Boolean,default:!0},showMoreItem:{type:Boolean,default:!0},isCollectView:{type:Boolean,default:!1},emptyStatus:{type:String,default:"空空如也~"},singleFileType:{type:String,default:""},showNavigation:{type:Boolean,default:!0},queryFileType:{type:String,default:null},defaultGrid:{type:Boolean,default:!0},orderCustom:{type:Boolean,default:!1},sortable:{type:Object,default:function(){return{prop:"",order:null}}},queryCondition:{type:Object,default:function(){return{isFolder:null}}},singleMenus:{type:Array,default:function(){return[{iconClass:"menu-open",label:"打开",operation:"open"},{iconClass:"menu-details",label:"详细信息",operation:"details"},{iconClass:"menu-rename",label:"重命名",operation:"rename"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},multipleMenus:{type:Array,default:function(){return[{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},multipleRightMenus:{type:Array,default:function(){return[{iconClass:"menu-deselect",label:"取消选定",operation:"deselect"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},contextMenus:{type:Array,default:function(){return[]}}},data:function(){return{imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),audioCoverUrl:"".concat("/api","/view/cover?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),fileMenuActive:"",path:this.$route.query.path,basePath:"/",showNewFolder:!1,isShowNewFolder:!1,listModeSearch:!1,listModeSearchOpenDir:!1,newFolderName:"新建文件夹",renameFileName:"",searchFileName:"",pathList:[{folder:""}],fileList:[],pageLoadCompleteList:[],pagination:{pageIndex:1,pageSize:50,total:0,pageSizes:[10,20,30,40,50]},isIndeterminate:!1,isSelectAll:!1,clientHeight:500,tableHead:[{name:"",label:"",index:0},{name:"",label:"",index:1},{name:"name",label:"名称",sortable:!0,index:2},{name:"",label:"",index:3},{name:"",label:"",more:!0,index:4},{name:"size",label:"大小",sortable:!0,index:5},{name:"updateDate",label:"修改日期",sortable:!0,index:6}],isJustHideMenus:!1,menusIsMultiple:!1,menus:[],contextmenuDisabled:!1,rowContextData:{},tableLoading:!0,finished:!1,newFolderLoading:!1,renameLoading:!1,menuTriangle:"",cellMouseIndex:-1,editingIndex:-1,titlePrefix:"",unzipOperating:!1,dialogMoveOrCopyVisible:!1,fileTreeAndNewFolderDisabled:!1,directoryTreeData:[],compressedFileVisible:!1,compressedFileData:[],compressedFileName:"",compressedFileTempDir:!1,selectTreeNode:{},directoryTreeProps:{label:"name",children:"children",isLeaf:"isLeaf"},dragLoop:null,positionX:0,positionY:0,grid:this.defaultGrid,vmode:this.defaultGrid?"grid":"list",gridColumnNum:-1,gridColumnWidth:120,allChecked:!1,summaries:"",shareDialogVisible:!1,shareDialogObject:{},tagDialogVisible:!1,tagDialogObjectList:[],newCreateFileDialog:!1,newCreateFileName:"",newCreateFileDialogTitle:"",createFileLoading:!1,shareLink:"",shareFileName:"",textPreviewVisible:!1,textPreviewRow:{},imagePreviewRow:{},imagePreviewVisible:!1,videoPreviewRow:{},videoPreviewVisible:!1,officePreviewRow:{},officePreviewVisible:!1,cadPreviewRow:{},cadPreviewVisible:!1,audioPreviewRow:{},audioPreviewVisible:!1,drawer:!1,rowStyleExecuting:!1,selectRowData:[],selectOrgin:-1,selectEnd:-1,selectPin:!1,inputting:!1,isCmd:!1,dragElementList:[],drawFlag:!1,fileListScrollTop:0,initFileListScrollTop:0,notPreviewDialogVisible:!1,openingFile:"",openCompressionVisible:!1,stompClient:void 0,showUpdateDateItem:!0,showSizeItem:!0,stopSortChange:!1,draging:0,getFileListed:!1,onCreateFilename:"",isTogether:!1,spaceFlag:this.$route.path.replace(/\//g,""),api:h["a"]}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["c"])(["message"])),Object(l["b"])(["name"])),{},{gridFilename:function(){return function(e){var t=e.name;if(e.isFolder)return t;var i=t.split("."),n=i.length>1?i.pop():"",a=i.join("."),o=this.getEffectiveLength(a,n);if(o<=14)return t;for(var r=14-(n?n.length+1+1:0),s="",l=0,c=0,d=Array.from(a);c<d.length;c++){var u=d[c],h=this.getCharLength(u);if(l+h>r)break;l+=h,s+=u}return n?s+"…"+n:s+"…"}},getSummaries2:function(){var e=0;this.fileList.forEach((function(t){e+=t.size}));var t=this.getShowSumFileAndFolder(this.fileList),i=this.getShowSumSize(e);return this.summaries=t+i,e>0?t+i:""},getSummaries3:function(){var e=0;return this.fileList.forEach((function(t){e+=t.size})),e>0?this.fileList.length+"项 "+this.getShowSumSize(e):""}}),created:function(){},watch:{$route:function(e){e.query.tagId&&this.queryCondition.tagId!==this.$route.query.tagId&&(this.queryCondition.tagId=this.$route.query.tagId,this.getFileList())},message:function(e){switch(e.event){case"msg/file/operation/fault":this.getFileList();break;case"fileSuccess":this.setOnCreateFilename(e.data);break;case"loadFileFailed":this.notPreviewDialogVisible=!0;break;case"clickMore":this.$refs.fileListTable.tableSelectData=e.data,this.preliminaryRowData();break;case"renameRow":var t=this.fileList.findIndex((function(t){return t.name===e.data.oldName}));if(t>-1){var i=this.fileList[t];i.suffix=e.data.suffix,i.name=e.data.name,this.$refs.fileListTable.clearSelection()}break;case"msg/file/change":this.onmessage(e.data);break}}},mounted:function(){var e=this;if(window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1)),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.$route.query.vmode?this.vmode=this.$route.query.vmode:this.defaultGrid?this.vmode="grid":this.vmode="list","list"===this.vmode?(this.grid=!1,this.selectFile||(this.lessClientHeight=140)):(this.grid=!0,this.selectFile||(this.lessClientHeight=106),this.containerResize()),"/"!==this.$route.query.path){var t=decodeURI(this.$route.query.path);this.pathList.splice(1,1),t.split("/").forEach((function(t,i){if(i>0){var n={};n["folder"]=t,e.pathList.push(n)}}))}this.spaceFlag=this.$route.path.replace(/\//g,""),this.$route.query.folder&&this.path&&localStorage.setItem(this.path,this.$route.query.folder),this.$route.query.highlight&&(this.onCreateFilename=this.$route.query.highlight,this.clearOnCreateFilename());var i=this;window.onresize=function(){i.clientHeight=document.documentElement.clientHeight-i.lessClientHeight},setTimeout((function(){e.getFileListed||e.getFileList()}),50)},beforeDestroy:function(){window.removeEventListener("keydown",this.keydown,!1),window.removeEventListener("keyup",this.keyup,!1),window.removeEventListener("popstate",this.goBack,!1),this.stompClient&&this.stompClient.unsubscribe()},directives:{focus:{inserted:function(e){var t=e.querySelector("input");t||(t=e.querySelector("textarea")),t.focus()}},resize:{bind:function(e,t){var i="",n="";function a(){var a=document.defaultView.getComputedStyle(e);i===a.width&&n===a.height||t.value(),i=a.width,n=a.height}e.__vueSetInterval__=setInterval(a,300)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},methods:{isChineseChar:function(e){return e.charCodeAt(0)>255},getCharLength:function(e){return this.isChineseChar(e)?2:1},getEffectiveLength:function(e,t){var i=this,n=Array.from(e).reduce((function(e,t){return e+i.getCharLength(t)}),0);return t?n+t.length+1:n},keydown:function(e){var t=this,i=navigator.platform.startsWith("Mac"),n=(e.key,e.c,e.keyCode),a=e.ctrlKey,o=e.metaKey;this.isCmd=i&&o||!i&&a,16===e.keyCode&&e.shiftKey&&(this.selectPin=!0),this.isCmd&&65===n&&(this.inputting||-1!==this.editingIndex?e.target.select():(this.$nextTick((function(){t.$refs.fileListTable&&t.$refs.fileListTable.toggleAllSelection()})),e.preventDefault(),e.stopPropagation()))},keyup:function(e){var t=navigator.platform.startsWith("Mac"),i=(e.key,e.c,e.keyCode,e.ctrlKey),n=e.metaKey;this.isCmd=t&&n||!t&&i,16===e.keyCode&&(this.selectPin=!1)},onmessage:function(e){var t=e.body,i=e.url,n=this.fileList.findIndex((function(e){return e.id===t.id}));if("updateFile"===i&&n>-1&&(t.m3u8&&(this.fileList[n].m3u8=t.m3u8),this.fileList[n].size=t.size,this.fileList[n].agoTime=1,this.fileList[n].updateDate=t.updateDate),"deleteFile"===i&&n>-1&&this.getFileList(),"createFile"===i){if(t.$set&&(this.onCreateFilename=t.$set.name),t&&t.name&&(this.onCreateFilename=t.name),this.path||(this.path=""),t)if(t.$set){var a=t.$set.path;a=a.replace(/\\/g,"/"),this.path+"/"===a&&this.getFileList()}else this.path+"/"===t.path&&this.getFileList();this.clearOnCreateFilename()}},clearOnCreateFilename:function(){var e=this;setTimeout((function(){e.onCreateFilename=""}),2e3)},load:function(){this.getFileList(!0)},gridItemClick:function(e){if(this.selectFile&&this.fileClick(e),this.isCmd)return this.pinSelect(null,e),void this.$refs.fileListTable.toggleRowSelection([{row:e}]);this.pinSelect(null,e)},containerResize:function(){var e=document.querySelector(".dashboard-container"),t=e.clientWidth;this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,"image"===this.queryFileType?this.gridColumnNum=Math.round((t-10)/165):this.gridColumnNum=Math.round((t-10)/135),this.gridColumnWidth=(t-11*this.gridColumnNum)/this.gridColumnNum-4.5,this.showUpdateDateItem=!(t<900),this.showSizeItem=!(t<500);var i=Math.round(this.clientHeight/(t/this.gridColumnNum));this.pagination.pageSize=i*this.gridColumnNum+this.gridColumnNum,this.rowDrop(),this.darwRectangle()},darwRectangle:function(){var e=this,t=document.querySelector(".el-table__body-wrapper");if(this.grid&&(t=document.querySelector(".van-grid")),t.onscroll=function(t){e.tableBodyScroll(null,t)},!this.selectFile){var i=this,n=function(e){return document.getElementById(e)},a=n("v-draw-rectangle"),o="rectangle1",r=0,s=0,l=0,c=0,d=0,u=0;i.drawFlag=!1;var h="el-table__row";i.grid&&(h="grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square"),a.onmousedown=null,a.onmousedown=function(e){var t=window.event||e,n=e.path||e.composedPath&&e.composedPath();if(!i.grid&&i.selectRowData.length>0){var m=n.findIndex((function(e){if("el-table__header-wrapper"===e.className)return e}));m>-1&&(i.stopSortChange=!0)}var g=n.find((function(e){if(e.className===h||"el-table__row el-table__row--striped"===e.className)return e}));if(g)i.selectRowData.includes(i.fileList[g.rowIndex])||(i.editingIndex=-1,i.isCmd||i.selectPin||(i.$refs.fileListTable.clearSelection(),i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[g.rowIndex],selected:!0}])));else if(i.editingIndex=-1,0===t.button){if(!i.isCmd&&!i.selectPin){var v=n.findIndex((function(e){return e.className===h||"el-table__row el-table__row--striped"===e.className}));v<0&&i.$refs.fileListTable.clearSelection()}var b=a.scrollTop||a.scrollTop,w=a.scrollLeft||a.scrollLeft;r=t.clientX+w,s=t.clientY+b;var y=document.createElement("div");y.id=o,y.className="draw-rectangle",y.style.left=r+"px",y.style.top=s+"px",y.style.position="fixed",y.style.border="1px dashed #2898ff",y.style.width="0px",y.style.height="0px",y.style.left="0px",y.style.top="0px",y.style.overflow="hidden",a.appendChild(y),document.onmousemove=function(e){var t=window.event||e,n=document.body.scrollTop||document.documentElement.scrollTop,a=document.body.scrollLeft||document.documentElement.scrollLeft;if(l=r-t.clientX-a>0?t.clientX+a:r,c=s-t.clientY-n>0?t.clientY+n:s,d=Math.abs(s-t.clientY-n),u=Math.abs(r-t.clientX-a),i.drawFlag=!0,!(d+u<4)){var h=document.getElementById(o);h&&(h.style.left=l+"px",h.style.top=c+"px",h.style.width=u+"px",h.style.height=d+"px",h.style.backgroundColor="#f2f5fa55"),i.drawFlag&&d+u>4&&(p||f({x:l,y:c+i.fileListScrollTop,w:u,h:d}))}},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,i.stopSortChange&&(i.stopSortChange=!1,setTimeout((function(){i.changeSelectedStyle(i.selectRowData)}),200)),setTimeout((function(){i.drawFlag=!1}),50);var t=document.getElementById(o);t&&a.removeChild(t),i.grid||(a=document.getElementById("drag-table"));var n=Array.prototype.slice.call(a.getElementsByClassName("dragingDiv"));n.forEach((function(e){return a.removeChild(e)}))}}};var p=!1,f=function(e){p=!0,i.dragElementList.forEach((function(t){m(t,e)?i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[t.rowIndex],selected:!0}]):i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[t.rowIndex],selected:!1}])})),setTimeout((function(){return p=!1}),10)},m=function(e,t){var i=e.x,n=e.y,a=t.x,o=t.y,r=e.w,s=e.h,l=t.w,c=t.h;return(i-a<=0&&a-i<r||i-a>=0&&i-a<l)&&(n-o<=0&&o-n<s||n-o>=0&&n-o<c)}}},rowDrop:function(){if(!this.selectFile){var e=null,t=this,i=null,n=-1,a="van-grid",o="van-grid-item van-grid-item--square",r="grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square";t.grid||(o="el-table__row",a="el-table__body");var s=null,l=document.querySelector(".dashboard-container"),c=document.querySelector(".el-table__body-wrapper tbody");this.grid&&(c=document.querySelector(".van-checkbox-group .van-grid"));var u=document.getElementById("v-draw-rectangle");this.grid||(u=document.getElementById("drag-table"));var h=0,p=Object(d["a"])(u),f=0,m="";setTimeout((function(){h=c.childElementCount,t.dragElementList=[];for(var e=0;e<c.childElementCount;e++){var i=c.children[e];t.grid&&(i.rowIndex!==e&&(i.rowIndex=e),i.children[0].children[0].rowIndex=e,i=i.children[0].children[0]);var n=C(i);i.w=i.offsetWidth,i.h=i.offsetHeight,i.x=n.x,i.y=n.y,n.rowIndex=i.rowIndex,t.dragElementList.push(i),i.draggable=!0,i.slot="jmal";var a=i.querySelector(".el-avatar > img");t.grid&&(a=i.querySelector(".el-image > img")),a&&(a.draggable=!1)}}),300);var g=-1,v=function(e,i){var n=e.path||e.composedPath&&e.composedPath();if("enter"===i){var s=null;e.toElement.className;if(t.grid?(e.toElement.className===o&&(s=e.toElement),e.toElement.className===a&&(s=e.fromElement)):s="v-draw-rectangle"===n[0].id||"el-table__virtual-wrapper"===n[0].className?e.toElement:n.find((function(e){if("el-table__header-wrapper"===e.className)return e})),s){if(g>-1){var l=c.children[g];x(l)}g=-1}}var d=null;return t.grid?(n[0].className===r||(d=n.find((function(e){if(e.className===r)return e}))),d):("TD"===n[0].tagName&&(d=n.find((function(e){if("el-table__row el-table__row--striped"===e.className||"el-table__row"===e.className)return e}))),d)},b=function(e){e?(t.selectRowData.forEach((function(e){var i=document.getElementById("dragingDiv"+e.index);i.style.transition="all 0.3s",i.style.top=i.original.top-(t.fileListScrollTop-t.initFileListScrollTop)+"px",i.style.left=i.original.left})),setTimeout((function(){t.selectRowData.forEach((function(e){u.removeChild(document.getElementById("dragingDiv"+e.index))}))}),300)):t.selectRowData.forEach((function(e){u.removeChild(document.getElementById("dragingDiv"+e.index))})),setTimeout((function(){t.grid?c.querySelectorAll(".grid-hover-back").forEach((function(e){e.classList.add("grid-hover")})):document.getElementsByClassName("el-table")[0].classList.add("el-table--enable-row-hover")}),350),t.draging=0};l.ondragend=function(e){t.$store.dispatch("updateMessage",{event:"onDragStart",data:!1}),e.dataTransfer.effectAllowed="none";var n=c.children[g];x(n),i.style.cursor="default",e.target.parentNode.parentNode.title=m},l.ondragstart=function(a){if(t.drawFlag||t.isCmd||t.selectPin)return a.preventDefault(),void a.stopPropagation();if(!a.target.slot||"jmal"!==a.target.slot)return!0;if(a.target.rowIndex===t.editingIndex)return a.preventDefault(),void a.stopPropagation();a.target.style.cursor="no-drop",m=a.target.parentNode.parentNode.title,a.target.parentNode.parentNode.title="",t.selectRowData.forEach((function(e,i){var n=t.dragElementList[e.index],a=n.rowIndex;s=n.cloneNode(!0),s.id="dragingDiv"+a,s.classList.add("dragingDiv"),s.classList.remove("el-table_row"),s.style.transition="all 0.3s",s.style.zIndex=-1,s.style.position="absolute";var o=t.dragElementList[a];s.style.width=o.w+"px",s.style.height=o.h+"px",s.style.left=o.x-p+"px";var r=0;if(t.grid)r=o.y-t.fileListScrollTop-o.h/2+10;else{s.firstChild.style.textAlign="center";var l=Array.prototype.slice.call(s.childNodes);l.forEach((function(e,t){if(4===t)return e.style.borderRadius="0 3px 3px 0",e.style.borderRight="1px solid #409eff",e.firstChild.style.height="44px",e.firstChild.style.lineHeight="44px",e.firstChild.style.width="80px",!0;0!==t&&1!==t&&s.removeChild(e)})),r=o.y-t.fileListScrollTop-51.5}if(s.style.top=r+"px",0===i){var c=document.getElementById("numberFiles").cloneNode(!0);c.id="numberFilesCopy",c.querySelector(".number").innerHTML=t.selectRowData.length+"个文件",s.appendChild(c)}s.original={top:r,left:s.style.left},t.initFileListScrollTop=t.fileListScrollTop,u.appendChild(s)})),f=0;var o=document.getElementById("dragImage");a.dataTransfer.setDragImage(o,10,10),t.$store.dispatch("updateMessage",{event:"onDragStart",data:!0}),t.drawFlag=!1;var r=document.getElementById("rectangle1");r&&document.getElementById("v-draw-rectangle").removeChild(r),i=a.target,n=i.rowIndex,t.cellMouseIndex=-1,e=i.style.backgroundColor,t.grid?c.querySelectorAll(".grid-hover-back").forEach((function(e){e.classList.remove("grid-hover")})):document.getElementsByClassName("el-table--enable-row-hover")[0].classList.remove("el-table--enable-row-hover"),t.draging=1},l.ondragenter=function(e){clearTimeout(w);var a=v(e,"enter");if(a){if(g!==a.rowIndex){if(g>-1){var o=c.children[g];x(o)}if(n!==a.rowIndex&&t.fileList[a.rowIndex].isFolder&&-1===t.selectRowData.findIndex((function(e){return e.index===a.rowIndex}))){i.style.cursor="copy";var r=document.getElementById("numberFilesCopy");r.style.backgroundColor="#40a9ffc9",r.querySelector(".number").style.display="none",r.querySelector(".icon").style.display="inline",r.querySelector(".operate").style.display="inline";var s=r.querySelector(".target .folder");s.style.display="inline",s.innerHTML=t.fileList[a.rowIndex].name,a.style.backgroundColor;var l="#9fcdfc99";t.grid?a.style.backgroundColor=l:a.childNodes.forEach((function(e){return e.style.backgroundColor=l}))}g=a.rowIndex}y=-1}},l.ondragover=function(e){t.selectRowData.forEach((function(t,i){var n=document.getElementById("dragingDiv"+t.index);n&&(n.style.left=e.clientX-p+3*i+10+"px",n.style.top=e.clientY-50+3*i+10+"px",0===f&&(n.style.zIndex=999,setTimeout((function(){n.style.transition=""}),300)))})),e.preventDefault(),y=-1,f++};var w=null,y=-1;l.ondragleave=function(e){clearTimeout(w);var i=v(e,"leave");i&&(t.grid||0!==i.rowIndex&&i.rowIndex!==h-1||(y=i.rowIndex,w=setTimeout((function(){if(y>-1){var e=c.children[y];x(e),g=-1}}),100)))},l.ondrop=function(){var e=t.fileList[n],i=t.fileList[g];if(e&&i&&e.id!==i.id&&i.isFolder&&!t.selectRowData.includes(i)){var a=[];t.selectRowData.forEach((function(e){a.push(e.id)})),t.$confirm("是否将选中的".concat(t.selectRowData.length,"项移动到 ").concat(i.name,"?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){t.copyOrMoveApi("move",a,i.id),b(!1)})).catch((function(){b(!0)}))}else b(!0)};var x=function(n){if(i){if(n){t.grid?(n=n.children[0].children[0],"rgba(159, 205, 252, 0.6)"===n.style.backgroundColor&&(n.style.backgroundColor=null)):"rgba(159, 205, 252, 0.6)"===n.firstChild.style.backgroundColor&&n.childNodes.forEach((function(e){e.style.backgroundColor=null})),i.style.cursor="default";var a=document.getElementById("numberFilesCopy");a&&(a.style.backgroundColor="#d2eefa66",a.querySelector(".number").style.display="inline",a.querySelector(".icon").style.display="none",a.querySelector(".operate").style.display="none",a.querySelector(".target .folder").style.display="none")}i.style.backgroundColor=e}}}function C(e){var t={x:0,y:0};while(e)t.x+=e.offsetLeft,t.y+=e.offsetTop,e=e.offsetParent;return t}},formatTime:function(e){return Object(c["c"])(e)},formatSize:function(e){return Object(c["b"])(e)},upload:function(){this.$store.dispatch("updateMessage",{event:"openUploader",data:{folder:this.$route.query.folder,currentDirectory:this.getQueryPath(),username:this.$store.state.user.name,userId:this.$store.state.user.userId,spaceFlag:this.spaceFlag}})},uploadFolder:function(){window.uploader.supportDirectory?this.$store.dispatch("updateMessage",{event:"uploadFolder",data:{folder:this.$route.query.folder,currentDirectory:this.getQueryPath(),username:this.$store.state.user.name,userId:this.$store.state.user.userId,spaceFlag:this.spaceFlag}}):this.$message({message:"该浏览器不支持上传文件夹",type:"warning"})},goBack:function(){if(this.pathList.length<=1){var e=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("/?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(e))}else this.lastLink()},lastLink:function(){this.handleLink(this.pathList[this.pathList.length-2],this.pathList.length-2)},handleLink:function(e,t,i,n){var a=this;if(e&&e.search)e.searchKey?this.searchFileByKeyWord(e.searchKey):e.row&&this.searchFileAndOpenDir(e.row),this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1));else{this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1)),this.pathList.forEach((function(e,t){0===t?a.path="":t===a.pathList.length||(a.path+="/"+a.pathList[t].folder),a.path=a.path.replace(/\\/g,"/")}));var o=localStorage.getItem(this.path);if(!i){var r=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$route.query.path,this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(o?"&folder="+o:"").concat(r))}n||(this.pagination.pageIndex=1,this.getFileList())}},newDocument:function(){window.open("/setting/website/manager-articles?operation=new","_blank")},newFolder:function(){var e=this;this.newFolderName=this.getNewFileName(this.fileList,"新建文件夹"),this.showNewFolder=!0,this.$nextTick((function(){e.$refs.newFolderName.focus(),e.$refs.newFolderName.select()}))},getNewFileName:function(e,t){var i=0,n=[];e.forEach((function(e){var t=e.name||e.label;n.push(t)}));var a=t;while(n.includes(t))if(i+=1,a.indexOf(".")>0){var o=a.substring(0,a.lastIndexOf(".")),r=a.substring(a.lastIndexOf("."));t="".concat(o).concat(i).concat(r)}else t="".concat(a).concat(i);return t},getDuplicateFileName:function(e,t){var i=0,n=[];e.forEach((function(e){var t=e.name||e.label;n.push(t)}));var a=t;while(n.includes(t))if(i+=1,a.indexOf(".")>0){var o=a.substring(0,a.lastIndexOf("."));o.indexOf(" 副本")>0&&(o=o.substring(0,o.lastIndexOf(" 副本")));var r=a.substring(a.lastIndexOf("."));t=1===i?"".concat(o," 副本").concat(r):"".concat(o," 副本").concat(i).concat(r)}else a.indexOf(" 副本")>0&&(a=a.substring(0,a.lastIndexOf(" 副本"))),t=1===i?"".concat(a," 副本"):"".concat(a," 副本").concat(i);return t},hideNewFolderName:function(){this.showNewFolder=!1,this.isShowNewFolder=!1},showNewFolderClick:function(){this.isShowNewFolder=!0},setInputFocus:function(){this.inputting=!0},setInputBlur:function(){this.inputting=!1},newFolderNameClickEnter:function(){this.newFolderNameClick()},newFolderNameClick:function(){var e=this;if(this.newFolderName){if(/[\[\]\/\\"<>\?\*]/gi.test(this.newFolderName))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});this.newFolderLoading=!0,this.createFileLoading=!0,h["a"].uploadFolder({isFolder:!0,filename:encodeURI(this.newFolderName),currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,username:this.$store.state.user.name,userId:this.$store.state.user.userId,spaceFlag:this.spaceFlag}).then((function(t){1===t.data?(e.newFolderLoading=!1,e.$message({message:"该文件夹已存在",type:"warning"})):(e.createFileLoading=!1,e.newCreateFileDialog=!1,e.newFolderLoading=!1,e.showNewFolder=!1,e.isShowNewFolder=!1,e.$notify({title:"新建文件夹成功",type:"success",duration:1e3}),e.listModeSearch?e.getFileListBySearchMode():e.getFileList())})).catch((function(){e.newFolderLoading=!1,e.createFileLoading=!1}))}else this.newFolderLoading=!1,this.$message({message:"请输入文件夹名称",type:"warning"})},createFile:function(e){var t=this;if("新建文件夹"===this.newCreateFileDialogTitle)return this.newFolderName=e,void this.newFolderNameClick();if(e){if(/[\[\]\/\\"<>\?\*]/gi.test(e))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});this.createFileLoading=!0;var i="/";this.path&&this.path.length>0&&(i=this.path);var n=e.substring(e.lastIndexOf(".")+1);h["a"].addFile({fileName:encodeURI(e),isFolder:!1,folder:this.$route.query.folder,username:this.$store.state.user.name,parentPath:encodeURI(i),spaceFlag:this.spaceFlag}).then((function(i){switch(t.createFileLoading=!1,n&&!t.$route.query.folder){case"txt":t.textPreviewRow=i.data,t.textPreviewVisible=!0;break;case"drawio":case"mind":case"docx":case"xlsx":case"pptx":t.officePreviewRow=i.data,t.officePreviewVisible=!0;break}var a=t;t.setOnCreateFilename(e),setTimeout((function(){a.newCreateFileDialog=!1}),200)})).catch((function(){t.createFileLoading=!1}))}},searchFileByKeyWord:function(e){this.searchFile(e)},changeVmode:function(){this.grid=!this.grid,this.vmode="list",this.grid?(this.vmode="grid",this.lessClientHeight=106):(this.lessClientHeight=140,this.$refs.fileListTable.setHeight()),this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,this.path||(this.path=""),this.editingIndex=-1;var e=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(this.path).concat(this.$route.query.folder?"&folder="+this.$route.query.folder:"").concat(e)),this.rowDrop(),this.darwRectangle(),this.loadContextMenus(),this.grid||this.fileListScrollTop>0&&this.$refs.fileListTable.pagingScrollTopLeft(),this.fileListScrollTop=0},loadContextMenus:function(){var e=this;if(this.contextMenus.length<1)this.contextmenuDisabled=!0;else{var t=document.querySelector(".dashboard-container");0===this.$refs.homeContextmenu.references.length&&this.$refs.homeContextmenu.addRef({el:t,vnode:t});var i=this.contextMenus.findIndex((function(e){return"viewMode"===e.operation})),n=this.contextMenus.findIndex((function(e){return"arrangement"===e.operation}));if(i>-1){var a=this.contextMenus[i].child;this.grid?(a[0].iconClass="menu-empty",a[1].iconClass="menu-point"):(a[0].iconClass="menu-point",a[1].iconClass="menu-empty")}if(n>-1){var o=this.contextMenus[n].child,r=this.sortable.prop;o.forEach((function(t){var i=t.orderProp;i===r&&o.map((function(t){return i===t.orderProp?t.iconClass="menu-"+e.sortable.order:t.iconClass="menu-null",t}))}))}}},beforeLoadData:function(e){e?this.pagination.pageIndex++:this.pagination.pageIndex=1,this.pageLoadCompleteList[this.pagination.pageIndex]=!1,this.tableLoading=!0,this.finished=!1},loadData:function(e,t){var i=this;if(this.$refs.fileListTable){t?e.data.forEach((function(e,t){e["index"]=(i.pagination.pageIndex-1)*i.pagination.pageSize+t,i.fileList.push(e)})):(this.fileList=e.data,this.fileList.map((function(e,t){e.index=t})),this.$refs.fileListTable.reloadData(this.fileList),setTimeout((function(){i.$refs.fileListTable.reloadData(i.fileList)}),0)),this.fileList.length>=e.count&&(this.finished=!0),this.tableLoading=!1,this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,this.listModeSearch=!1,this.pagination["total"]=e.count,this.$nextTick((function(){i.containerResize(),i.tableLoading=!1,i.pageLoadCompleteList[i.pagination.pageIndex]=!0})),this.loadContextMenus(),this.highlightNewFile(),this.setMountFileOwner();var n="Object";if(this.fileList.length>0){var a=/([a-zA-Z]:\\[^*|"<>?\n]*)|(\/[^*|"<>?\n]*)/;a.test(this.fileList[0].id)||(n="File")}this.$store.dispatch("updateMessage",{event:"storageTypeChange",data:n})}},setMountFileOwner:function(){if(this.$route.query.folder&&this.fileList.length>0){var e=this.fileList[0];e.userId!==this.$store.getters.userId&&Object(D["e"])({userId:e.userId}).then((function(e){localStorage.setItem("mountFileOwner",e.data)}))}},highlightNewFile:function(){var e=this;if(this.onCreateFilename){var t=this.fileList.findIndex((function(t){return t.name===e.onCreateFilename}));if(t>-1){var i=this.fileList[t];setTimeout((function(){e.$refs.fileListTable.clearSelection(),e.$refs.fileListTable.toggleRowSelection([{row:i,selected:!0}])}),0)}}},searchFile:function(e,t){var i=this;if(e){this.beforeLoadData(t),this.pathList=[{folder:""}];var n={};n["folder"]='搜索: "'+e+'"',n["search"]=!0,n["searchKey"]=e,this.pathList.push(n);var a=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e).concat(a)),h["a"].searchFile({userId:this.$store.state.user.userId,username:this.$store.state.user.name,keyword:e,sortableProp:this.sortable.prop,order:this.sortable.order,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,spaceFlag:this.spaceFlag}).then((function(e){i.loadData(e,t),i.path="",i.listModeSearch=!0,i.listModeSearchOpenDir=!1}))}},searchFileAndOpenDir:function(e,t){var i=this;this.beforeLoadData(t),h["a"].searchFileAndOpenDir({userId:this.$store.state.user.userId,username:this.$store.getters.name,id:e.id,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,folder:this.$route.query.folder,spaceFlag:this.spaceFlag}).then((function(n){i.loadData(n,t),i.listModeSearch=!0,i.listModeSearchOpenDir=e})),this.path=e.path+e.name,this.path=this.path.replace(/\\/g,"/")},openDir:function(e,t){var i=this;this.beforeLoadData(t),h["a"].searchFileAndOpenDir({userId:this.$store.state.user.userId,username:this.$store.getters.name,id:e.mountFileId||e.id,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,folder:this.$route.query.folder,spaceFlag:this.spaceFlag}).then((function(e){i.loadData(e,t)})),this.path=e.path+e.name,this.path=this.path.replace(/\\/g,"/")},getFileList:function(e){var t=this;this.getFileListed=!0,this.beforeLoadData(e),h["a"].fileList({userId:this.$store.state.user.userId,username:this.$store.state.user.name,currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,queryFileType:this.queryFileType,sortableProp:this.sortable.prop,order:this.sortable.order,isFolder:this.queryCondition.isFolder,isFavorite:this.queryCondition.isFavorite,tagId:this.queryCondition.tagId,queryCondition:this.queryCondition,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,spaceFlag:this.spaceFlag}).then((function(i){t.loadData(i,e)}))},getFileListBySearchMode:function(e){var t=this;this.beforeLoadData(e),h["a"].fileList({userId:this.$store.state.user.userId,username:this.$store.state.user.name,currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,spaceFlag:this.spaceFlag}).then((function(i){t.loadData(i,e)}))},getQueryPath:function(){var e=this.$route.query.basePath?this.$route.query.basePath:"/";return e&&e.lastIndexOf("/")===e.length-1&&(e=e.substring(0,e.length-1)),encodeURI(e+this.$route.query.path)},tableBodyScroll:function(e,t){this.fileListScrollTop=t.target.scrollTop;var i=t.target.scrollHeight-t.target.clientHeight-t.target.scrollTop;if(i<200&&!this.finished){if(!this.pageLoadCompleteList[this.pagination.pageIndex])return;this.listModeSearch?this.listModeSearchOpenDir?this.searchFileAndOpenDir(this.listModeSearchOpenDir,!0):this.searchFile(this.searchFileName,!0):this.getFileList(!0)}},pinSelect:function(e,t){if(this.selectPin&&this.selectOrgin>-1){var i=this.selectOrgin;this.selectEnd=t.index;var n=this.selectEnd-i;if(this.$refs.fileListTable.clearSelection(),0===n&&(this.selectOrgin=-1),n>0)for(var a=i;a<=this.selectEnd;a++)this.$refs.fileListTable.toggleRowSelection([{row:this.fileList[a],selected:!0}]),this.$refs.fileListTable.tableSelectData.push(this.fileList[a]);if(n<0)for(var o=this.selectEnd;o<=i;o++)this.$refs.fileListTable.toggleRowSelection([{row:this.fileList[o],selected:!0}]),this.$refs.fileListTable.tableSelectData.push(this.fileList[o])}this.changeSelectedStyle(this.$refs.fileListTable.tableSelectData)},sortChangeOfMenu:function(e,t){var i=this,n=document.querySelector(".el-table__header thead tr");n.childNodes.forEach((function(e){e.className.indexOf("is-sortable")>-1&&(i.removeClass(e,"descending"),i.removeClass(e,"ascending"))}));var a="ascending"===this.sortable.order?"descending":"ascending";this.addClass(n.children[t],a),this.orderCustom=!0,this.sortChange({prop:e,order:a})},sortChange:function(e){var t=e.prop,i=e.order;(this.orderCustom||this.listModeSearch)&&(this.sortable.prop=t,this.sortable.order=i,this.pagination.pageIndex=1,this.listModeSearch?this.searchFile(this.searchFileName):this.getFileList())},removeClass:function(e,t){var i=e.className;i.indexOf(t)>-1&&(e.className=i.replace(t,""))},addClass:function(e,t){if(e){e.className;e.className=e.className+" "+t}},getShowSumFileAndFolder:function(e){var t=0,i=0;e.forEach((function(e){e.isFolder?t+=1:i+=1}));var n="";t>0&&(n=t+"个文件夹");var a="";return i>0&&(a=i+"个文件"),n+" "+a},getShowSumSize:function(e){var t="";return t+=e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"K":e>=1048576&&e<1073741824?(e/1048576).toFixed(2)+"M":(e/1073741824).toFixed(2)+"G",t},selectAll:function(e){var t=this;this.isSelectAll=e,e?this.fileList.forEach((function(e){t.selectRowData.push(e)})):this.isIndeterminate=!1},handleSelectionChange:function(e){if(e.length>0){if(this.selectPin||(this.selectOrgin=e[0].index),this.selectPin)return;this.rowContextData=e[0]}this.$refs.fileListTable.tableSelectData=e,this.selectRowData=e,this.changeSelectedStyle(e)},changeSelectedStyle:function(e){if(!this.stopSortChange){var t=0;e.forEach((function(e){t+=e.size}));var i=this.tableHead[2],n=this.tableHead[4],a=this.tableHead[5],o=this.tableHead[6];if(e.length>0){var r=this.getShowSumFileAndFolder(e),s=this.getShowSumSize(t);i.label=r,i.sortable=!1,n.name="more",a.label=s,a.sortable=!1,o.label="",o.sortable=!1}else i.label="名称",i.sortable=!0,n.name="",a.label="大小",a.sortable=!0,o.label="修改日期",o.sortable=!0;this.selectRowData.length===this.fileList.length?this.allChecked=!0:this.allChecked=!1}},rowStyle:function(e){e.row,e.column;var t=e.rowIndex,i=e.columnIndex;if(this.$refs.fileListTable.tableSelectData.findIndex((function(e){return e.index===t}))>-1)return 0===i?{backgroundColor:"#e0f3fc !important",borderRadius:"3px 0 0 3px",borderLeft:"1px solid #409eff",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}:5===i?{backgroundColor:"#e0f3fc !important",borderRadius:"0 3px 3px 0",borderRight:"1px solid #409eff",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}:{backgroundColor:"#e0f3fc !important",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}},tableRowClassName:function(e){e.row,e.rowIndex},preliminaryRowData:function(e){e&&(this.rowContextData=e);var t=this.rowContextData.isFavorite;this.highlightFavorite(!!this.isCollectView||t,!1)},cellMouseEnter:function(e){1!==this.draging&&("moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex!==e.index&&this.$refs.contextShow.hideMenu(),-1!==this.editingIndex||this.$refs.contextShow.ctxVisible||this.selectRowData.length<=1&&(this.cellMouseIndex=e.index))},cellMouseLeave:function(e){if(1!==this.draging)return"moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex!==e.index?(this.$refs.contextShow.hideMenu(),void(this.$refs.contextShow.locals={})):void(this.$refs.contextShow.ctxVisible&&"moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex===e.index||(this.cellMouseIndex=-1))},dblclick:function(e){this.fileClick(e)},cellClick:function(e,t){if(this.selectFile)this.fileClick(e);else if(clearTimeout(this.Loop),-1===this.editingIndex){var i=t.index;if(2===i&&this.selectRowData.length<1&&e.index!==this.editingIndex&&(this.editingIndex=-1),this.isCmd)return this.pinSelect(null,e),void this.$refs.fileListTable.toggleRowSelection([{row:e}]);this.pinSelect(null,e)}},renameInputFocus:function(e,t){this.setInputFocus(),e.focus(),e.selectionStart=0,e.selectionEnd=e.value.length,t&&(e.selectionEnd-=t.length+1)},rowRename:function(e,t){var i=this;if(e=e.replace(/[\r\n]/g,""),e){if(/[\[\]\/\\"<>\?\*]/gi.test(e))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});var n=e.replace(/(.*\/)*([^.]+).*/gi,"$2"),a=e.replace(/.+\./,"");t.isFolder?this.rename(t,e):t.suffix!==a?this.$confirm("您确定要将扩展名“.".concat(t.suffix,"”更改为“.").concat(a,"”吗？"),"提示",{type:"warning",showClose:!1,closeOnClickModal:!1,confirmButtonText:"保持.".concat(t.suffix),cancelButtonText:"使用.".concat(a)}).then((function(){e=n+"."+t.suffix})).catch((function(){})).then((function(){i.rename(t,e)})):this.rename(t,e)}else this.editingIndex=-1},rename:function(e,t){var i=this;if(e.name!==t){this.renameLoading=!0;var n=this.fileList.findIndex((function(e){if(t===e.name)return e}));if(n>-1){var a="该文件已存在";return e.isFolder&&(a="该文件夹已存在"),this.$message({message:a,type:"warning"}),void(this.renameLoading=!1)}h["a"].rename({newFileName:encodeURI(t),username:this.$store.state.user.name,folder:this.$route.query.folder,id:e.id,spaceFlag:this.spaceFlag}).then((function(n){i.renameLoading=!1,e.name=t,e.suffix=t.replace(/.+\./,""),i.fileList[e.index]=e,i.editingIndex=-1})).then((function(){i.$refs.fileListTable.clearSelection(),i.setOnCreateFilename(t)})).catch((function(){i.renameLoading=!1,i.editingIndex=-1}))}else this.editingIndex=-1},setOnCreateFilename:function(e){this.$route.query.folder&&(this.onCreateFilename=e,this.getFileList(),this.clearOnCreateFilename())},moreOperation:function(e){this.menusIsMultiple=!0,this.menus=this.multipleMenus,this.showOperationMenus(e)},setMenus:function(e){if(this.menus=JSON.parse(JSON.stringify(this.singleMenus)),this.$route.query.folder)this.setMenusByPermission(e);else{if(e.isFolder&&e.mountFileId)for(var t=[6,5,4,3,1],i=0,n=t;i<n.length;i++){var a=n[i];this.menus.splice(a,1)}if(e.isFolder||this.menus.splice(-2,0,{iconClass:"duplicate",label:"创建副本",operation:"duplicate"}),e.isShare&&!e.shareBase||e.ossFolder){var o=this.menus.findIndex((function(e){return"share"===e.operation}));o>-1&&this.menus.splice(o,1)}e.isShare&&!e.isPrivacy&&this.menus.splice(-2,0,{iconClass:"menu-fuzhi",label:"复制下载链接",operation:"copyDownloadLink"})}this.preliminaryRowData(e)},setMenusByPermission:function(e){var t=["open","download"];this.menus=this.menus.filter((function(e){return t.includes(e.operation)})),e.operationPermissionList&&e.operationPermissionList.length>0&&(e.operationPermissionList.indexOf("PUT")>-1&&this.menus.splice(this.menus.length-1,0,{iconClass:"menu-rename",label:"重命名",operation:"rename"}),e.operationPermissionList.indexOf("UPLOAD")>-1&&!e.isFolder&&this.menus.splice(this.menus.length-1,0,{iconClass:"duplicate",label:"创建副本",operation:"duplicate"}),e.operationPermissionList.indexOf("DELETE")>-1&&this.menus.splice(this.menus.length,0,{iconClass:"menu-remove",label:"删除",operation:"remove"}))},moreClick:function(e,t){this.menusIsMultiple=!1,this.setMenus(e),this.showOperationMenus(t,{menuType:"moreClick",rowIndex:e.index})},rowContextmenu:function(e){if(!this.selectFile){this.$refs.fileListTable.tableSelectData.length>1&&this.$refs.fileListTable.tableSelectData.findIndex((function(t){return t.index===e.index}))>-1?(this.menusIsMultiple=!0,this.menus=this.multipleRightMenus,this.highlightFavorite(this.isCollectView,!1)):(this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.toggleRowSelection([{row:e}]),this.menusIsMultiple=!1,this.setMenus(e)),event.preventDefault(),this.menuTriangle="";var t={};t.pageX=event.pageX+5,t.pageY=event.pageY+2,t.clientX=event.clientX+5,t.clientY=event.clientY+2,this.$refs.contextShow.showMenu(t),this.cellMouseIndex=-1}},showOperationMenus:function(e,t){var i=e.pageY;e.target.clientHeight>0&&(i+=e.target.clientHeight/2-e.offsetY);var n={};document.body.scrollHeight-i>400?(this.menuTriangle="menu-triangle-top",n.pageX=e.pageX-78,n.pageY=i+25):(this.menuTriangle="menu-triangle-bottom",n.pageX=e.pageX-78,n.pageY=i-38*this.menus.length-36),this.isJustHideMenus||this.$refs.contextShow.showMenu(n,t)},menuFavoriteOver:function(e,t){this.highlightFavorite(!!this.isCollectView||t,!1)},menuFavoriteLeave:function(e,t){this.highlightFavorite(!!this.isCollectView||t,!1)},highlightFavorite:function(e,t){var i=this.menus.find((function(e){if("favorite"===e.operation||"unFavorite"===e.operation)return e}));i&&(e?(i.label="取消收藏",i.iconClass="menu-unfavorite-hover",i.operation="unFavorite"):(i.iconClass=t?"menu-favorite-hover":"menu-favorite",i.label="收藏",i.operation="favorite"))},show:function(){var e=this;this.contextmenuDisabled=!0,setTimeout((function(){e.contextmenuDisabled=!1}),1e3)},hide:function(){var e=this;this.isJustHideMenus=!0,setTimeout((function(){e.isJustHideMenus=!1}),100),this.cellMouseIndex=-1},contextmenuClick:function(e){switch(e){case"vmode-list":this.grid=!0,this.changeVmode();break;case"vmode-grid":this.grid=!1,this.changeVmode();break;case"orderName":this.sortChangeOfMenu("name",2);break;case"orderSize":this.sortChangeOfMenu("size",5);break;case"orderUpdateDate":this.sortChangeOfMenu("updateDate",6);break;case"refresh":this.getFileList();break;case"createTextFile":this.newCreateFileDialogTitle="新建文本文件",this.createNewFile("txt");break;case"createFolder":this.newCreateFileDialogTitle="新建文件夹",this.createNewFile("");break;case"createDrawioFile":this.newCreateFileDialogTitle="新建流程图",this.createNewFile("drawio");break;case"createMinderFile":this.newCreateFileDialogTitle="新建思维导图",this.createNewFile("mind");break;case"createWordFile":this.newCreateFileDialogTitle="新建Word文档",this.createNewFile("docx");break;case"createExcelFile":this.newCreateFileDialogTitle="新建Excel工作表",this.createNewFile("xlsx");break;case"createPPTFile":this.newCreateFileDialogTitle="新建PPT演示文档",this.createNewFile("pptx");break;case"createMarkdownFile":this.newDocument();break}},createNewFile:function(e){var t=this;"新建文件夹"===this.newCreateFileDialogTitle?this.newCreateFileName="新建文件夹":this.newCreateFileName="未命名文件.".concat(e),this.newCreateFileName=this.getNewFileName(this.fileList,this.newCreateFileName),this.newCreateFileDialog=!0,this.$nextTick((function(){var i=t.$refs.newCreateFileName.$el.querySelector(".el-input__inner");t.renameInputFocus(i,e)}))},menusOperations:function(e){switch(e){case"share":this.share();break;case"tag":this.allocateTag();break;case"favorite":this.favoriteOperating(!0);break;case"edit":window.open("/setting/website/manager-articles?operation=editor&id=".concat(this.rowContextData.id),"_blank");break;case"open":this.fileClick(this.rowContextData);break;case"deselect":this.$refs.fileListTable.clearSelection();break;case"unFavorite":this.favoriteOperating(!1);break;case"details":this.drawer=!0;break;case"rename":this.renameFileName=this.rowContextData.name,this.editingIndex=this.rowContextData.index;break;case"duplicate":this.duplicate();break;case"copy":this.moveOrCopy();break;case"download":this.downloadFile();break;case"copyDownloadLink":this.copyDownloadLink(this.rowContextData);break;case"remove":this.deleteFile();break}this.$refs.contextShow.hideMenu()},clearTreeNode:function(){},directoryTreeLoadNode:function(e,t){var i=null;if(0===e.level){var n=this;return setTimeout((function(){n.$refs.directoryTree.setCurrentKey("0")}),0),t([{id:"0",name:"全部文件"}])}e.level>1&&(i=e.data.id),h["a"].queryFileTree({userId:this.$store.state.user.userId,username:this.$store.state.user.name,fileId:i,spaceFlag:this.spaceFlag}).then((function(e){var i=e.data;return t(i)}))},treeNodeClick:function(e,t,i){this.fileTreeAndNewFolderDisabled=e.hasOwnProperty("newFolder"),this.selectTreeNode=e,this.selectTreeNode.showName=' "'+e.name+'"'},treeNodeExpand:function(e,t,i){},fileTreeAndNewFolder:function(){var e="newFolderNodeKey",t=this.$refs.directoryTree.getNode(e);null!==t&&this.$refs.directoryTree.remove(t);var i=this.$refs.directoryTree.store.currentNode.childNodes,n=this.getNewFileName(i,"新建文件夹"),a={id:e,newFolder:!0,name:n,showName:n,isLeaf:!0};this.$refs.directoryTree.append(a,this.selectTreeNode),setTimeout((function(){var e=document.getElementById("treeInput");e&&(e.value=n,e.focus(),e.select())}),100)},moveFileTree:function(){this.copyOrMove("move")},copyFileTree:function(){this.copyOrMove("copy")},confirmUnzip:function(){this.unzip(this.openingFile,this.selectTreeNode.id,!1)},showDialogMoveOrCopyVisible:function(){this.dialogMoveOrCopyVisible=!0},duplicate:function(){var e=this,t=this.getDuplicateFileName(this.fileList,this.rowContextData.name);h["a"].duplicateFile({fileId:this.rowContextData.id,newFilename:t,spaceFlag:this.spaceFlag}).then((function(){e.$message.success("创建副本成功"),e.setOnCreateFilename(t)}))},moveOrCopy:function(){this.showDialogMoveOrCopyVisible(),this.titlePrefix="移动或复制到: ",this.unzipOperating=!1;var e=this;setTimeout((function(){e.selectTreeNode=e.$refs.directoryTree.getCurrentNode(),e.selectTreeNode.showName=' "'+e.selectTreeNode.name+'"'}),100)},copyOrMove:function(e){var t=this,i="复制";"move"===e&&(i="移动");var n="/";this.selectTreeNode.path&&(n=this.selectTreeNode.path+this.selectTreeNode.name+"/");var a=[];if(this.menusIsMultiple||this.selectRowData.length>1){var o=this.$refs.fileListTable.tableSelectData.some((function(e){a.push(e.id);var o=e.path;if(o===n)return t.$message({message:"不能将文件"+i+"到自身或其子目录下",type:"warning"}),!0}));if(o)return}else this.rowContextData.id?a.push(this.rowContextData.id):a.push(this.rowContextData[0].id);this.copyOrMoveApi(e,a,this.selectTreeNode.id)},copyOrMoveApi:function(e,t,i){var n=this,a="复制";"move"===e&&(a="移动");var o=this.$message({iconClass:"el-icon-loading",type:"info",duration:0,dangerouslyUseHTMLString:!0,message:a+"中..."});this.dialogMoveOrCopyVisible=!1,h["a"][e]({userId:this.$store.state.user.userId,username:this.$store.state.user.name,froms:t,to:i,spaceFlag:this.spaceFlag}).then((function(){o.iconClass=null,o.type="success",o.message=a+"中...",n.rowContextData.isFolder&&n.$refs.directoryTree.append(n.rowContextData,i),"move"===e&&n.getFileList(),setTimeout((function(){o.close()}),1e3)})).catch((function(){o.close()}))},renderContent:function(e,t){var i=this,n=t.node,a=t.data;t.store;return a.newFolder?e("span",{class:"custom-tree-node"},[e("span",[e("svg-icon",{attrs:{"icon-class":"folder"}})]),e("span",[e("div",{class:"el-input el-input--mini el-input-tree"},[e("input",{attrs:{type:"text",autocomplete:"on",value:"新建文件夹",id:"treeInput"},class:"el-input__inner"})]),e("button",{attrs:{type:"button","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(){var e="/",t=n.parent.data;t.path&&(e=t.path+t.name+e);var o=document.getElementById("treeInput").value;h["a"].newFolder({isFolder:!0,filename:encodeURI(o),currentDirectory:i.getQueryPath(),folder:i.$route.query.folder,username:i.$store.state.user.name,userId:i.$store.state.user.userId,spaceFlag:i.spaceFlag}).then((function(e){a.newFolder=!1,a.name=o,a.id=e.data})).catch((function(){window.event.preventDefault(),window.event.stopPropagation()}))}},class:"el-button el-icon-check el-button--mini el-input-tree-button"}),e("button",{attrs:{type:"button","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(){i.$refs.directoryTree.remove(n),window.event.preventDefault(),window.event.stopPropagation()}},class:"el-button el-icon-close el-button--mini el-input-tree-button"})])]):n.expanded?e("span",{class:"custom-tree-node"},[e("svg-icon",{attrs:{"icon-class":"open-folder"}}),e("span",{style:"margin-left: 5px;"},[n.label]),e("span")]):e("span",{class:"custom-tree-node"},[e("svg-icon",{attrs:{"icon-class":"folder"}}),e("span",{style:"margin-left: 5px;"},[n.label]),e("span")])},allocateTag:function(){this.tagDialogObjectList=JSON.parse(JSON.stringify(this.$refs.fileListTable.tableSelectData)),this.tagDialogVisible=!0},allocateTagSuccess:function(){this.getFileList()},share:function(e){e&&e.id||(e=this.rowContextData.id?this.rowContextData:this.$refs.fileListTable.tableSelectData[0]),this.shareDialogObject=e,this.shareDialogObject.fileId=e.id,this.shareDialogObject.shareBase=e.shareBase,this.shareDialogVisible=!0},shareSuccess:function(e){var t=this.rowContextData.isFavorite;this.rowContextData.isFavorite=!t,this.rowContextData.isFavorite=t,this.rowContextData.shareBase=e,this.rowContextData.isShare=!0},downloadFile:function(){var e=0;if(this.$refs.fileListTable.tableSelectData.length>0?this.$refs.fileListTable.tableSelectData.forEach((function(t){e+=t.size})):e+=this.rowContextData.size,e>0){var t=[];if(this.$refs.fileListTable.tableSelectData.length>0?this.$refs.fileListTable.tableSelectData.forEach((function(e){t.push(e.id)})):t.push(this.rowContextData.id),t.length>1||this.rowContextData.isFolder)return void k["a"].packageDownloadSpace(t,this.$store.state.user.token,this.$store.state.user.name,this.spaceFlag);k["a"].download(this.$store.state.user.name,this.rowContextData,this.$store.getters.token)}else this.$message({message:"所选文件为空",type:"warning"})},copyDownloadLink:function(e){var t=this,i=window.location.origin+k["a"].previewUrl(this.$store.getters.name,e,void 0,void 0),n=new F.a(".newFileMenu",{text:function(){return i}});n.on("success",(function(e){t.$message({message:"复制成功",type:"success",duration:1e3}),n.destroy()})),n.on("error",(function(e){t.$message({message:"该浏览器不支持自动复制",type:"warning",duration:1e3}),n.destroy()}))},favoriteOperating:function(e){var t=this,i=this.getSelectIdList();this.rowContextData.isFavorite=e,this.highlightFavorite(e,!0),h["a"].favoriteUrl({fileIds:i,isFavorite:e,spaceFlag:this.spaceFlag}).then((function(i){!e&&t.isCollectView&&t.removeSelectItme()})).catch((function(){t.rowContextData.isFavorite=!e}))},deleteFile:function(){var e=this,t=[],i=[];this.menusIsMultiple||this.selectRowData.length>1?(t=this.$refs.fileListTable.tableSelectData,this.$refs.fileListTable.tableSelectData.forEach((function(e){i.push(e.id)}))):i.push(this.rowContextData.id);var n=this.getShowSumFileAndFolder(t);this.$confirm("此操作将永久删除"+n+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){h["a"].delete({currentDirectory:e.getQueryPath(),username:e.$store.state.user.name,fileIds:i,spaceFlag:e.spaceFlag}).then((function(){e.$route.query.folder&&e.getFileList()})).then((function(){e.$notify({title:"删除成功",type:"success",duration:1e3})}))}))},getSelectIdList:function(){var e=[];return this.selectRowData.length>1||this.menusIsMultiple?this.$refs.fileListTable.tableSelectData.forEach((function(t){e.push(t.id)})):e.push(this.rowContextData.id),e},removeSelectItme:function(){var e=this,t=[];this.$refs.fileListTable.tableSelectData.length>0&&this.$refs.fileListTable.tableSelectData.forEach((function(i){var n=e.fileList.findIndex((function(e){return e.id===i.id}));n>-1&&t.push(n)})),this.$refs.fileListTable.doLayout(),this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.tableSelectData=[],t=t.sort((function(e,t){return t-e})),setTimeout((function(){for(var i=0;i<t.length;i++)e.fileList.splice(t[i],1);e.fileList.map((function(e,t){e.index=t})),e.rowDrop(),e.darwRectangle()}),300)},compressionFilePreview:function(e){this.unzip(e,void 0,!0)},unzipTo:function(e){this.showDialogMoveOrCopyVisible(),this.titlePrefix="解压到: ",this.unzipOperating=!0;var t=this;setTimeout((function(){t.openCompressionVisible=!1,t.selectTreeNode=t.$refs.directoryTree.getCurrentNode(),t.selectTreeNode.showName=' "'+t.selectTreeNode.name+'"'}),100)},unzip:function(e,t,i){var n=this,a="解压",o=this.$message({iconClass:"el-icon-loading",type:"info",duration:0,dangerouslyUseHTMLString:!0,message:"<span>&nbsp;&nbsp;正在"+a+"</span>"});h["a"].unzip({fileId:e.id,destFileId:t,spaceFlag:this.spaceFlag}).then((function(r){o.iconClass=null,o.type="success",o.message=a+"成功",i&&(n.compressedFileData=r.data,n.compressedFileVisible=!0,n.compressedFileName=e.name,n.compressedFileTempDir=i);var s=n;setTimeout((function(){o.close(),s.openCompressionVisible=!1,e.id===t&&s.getFileList(),t&&e.id!==t&&!i&&(s.dialogMoveOrCopyVisible=!1)}),1e3)})).catch((function(){o.close()}))},fileClick:function(e){if(this.editingIndex!==e.index)if(this.openingFile=e,e.isFolder){this.editingIndex=-1;var t=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";if(this.listModeSearch){var i={};i["folder"]=e.name,i["search"]=!0,i["row"]=e,this.pathList.push(i),this.pagination.pageIndex=1,this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e.id).concat(t)),this.searchFileAndOpenDir(e)}else{var n=this.$route.path.length>1;n&&1===this.basePath.length&&(this.basePath=e.path),this.path?this.path+="/"+e.name:this.path=this.basePath+e.name,this.path=this.path.replace(this.basePath,"/");var a={folder:e.name,shareBase:e.shareBase};this.pathList.push(a),this.pagination.pageIndex=1;var o=encodeURI(this.path);this.$store.getters.userId!==e.userId&&(e.mountFileId=e.id),e.mountFileId&&localStorage.setItem(this.path,e.mountFileId),this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(o).concat(e.mountFileId?"&folder="+e.mountFileId:"").concat(t).concat(this.basePath.length>1?"&basePath="+this.basePath:"")),this.openDir(e)}}else{if(this.selectFile){var r=e,s=this.$refs.fileListTable.tableSelectData;return s.length<1||s[0].id!==e.id?(this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.toggleRowSelection([{row:e}]),this.pinSelect(null,e)):(this.$refs.fileListTable.clearSelection(),r={}),void this.$emit("selectedFile",r)}if(u["c"].cadFile.includes(e.suffix.toUpperCase()))return this.cadPreviewRow=e,void(this.cadPreviewVisible=!0);if(e.contentType.startsWith("image"))return this.imagePreviewVisible=!0,void(this.imagePreviewRow=e);if(u["c"].simText.includes(e.suffix))return this.textPreviewRow=e,void(this.textPreviewVisible=!0);if(e.contentType.indexOf("video")>-1)return this.videoPreviewVisible=!0,void(this.videoPreviewRow=e);if(e.contentType.indexOf("audio")>-1)return void this.$store.dispatch("updateMessage",{event:"onAddAudio",data:{row:e,audioCoverUrl:this.audioCoverUrl}});if(u["c"].compressedFile.includes(e.suffix))return void(this.openCompressionVisible=!0);if(e.contentType.indexOf("office")>-1||["pdf","PDF","csv","drawio","mind"].includes(e.suffix))return this.officePreviewVisible=!0,void(this.officePreviewRow=e);if(e.contentType.indexOf("utf-8")>-1)return this.textPreviewRow=e,void(this.textPreviewVisible=!0);this.notPreviewDialogVisible=!0}},forciblyOpen:function(e){this.textPreviewRow=e,this.textPreviewVisible=!0;var t=this;setTimeout((function(){t.notPreviewDialogVisible=!1}),100)},determineDownload:function(e){this.download(e),this.notPreviewDialogVisible=!1},download:function(e){k["a"].download(this.$store.state.user.name,e,this.$store.getters.token)},closeHandle:function(){this.cadPreviewVisible=!1}}},N=M,O=(i("3339"),i("2877")),A=Object(O["a"])(N,o,r,!1,null,"082bf57d",null),P=A.exports,$={components:{ShowFile:P},data:function(){return{sortable:{prop:"name",order:"ascending"},contextMenus:[{label:"查看",operation:"viewMode",child:[{iconClass:this.grid?"":"menu-point",label:"列表",operation:"vmode-list"},{iconClass:this.grid?"menu-point":"",label:"缩略图",operation:"vmode-grid"}]},{label:"排列方式",operation:"arrangement",child:[{label:"名称",operation:"orderName",orderProp:"name"},{label:"大小",operation:"orderSize",orderProp:"size"},{label:"日期",operation:"orderUpdateDate",orderProp:"updateDate"}]},{label:"刷新",operation:"refresh"},{divider:!0,operation:"divider"},{label:"新建",operation:"create",child:[{label:"文件夹",operation:"createFolder",iconClass:"folder"},{divider:!0,operation:"divider"},{label:"文本",operation:"createTextFile",iconClass:"file-txt"},{label:"思维导图",operation:"createMinderFile",iconClass:"file-mind"},{label:"流程图",operation:"createDrawioFile",iconClass:"file-drawio"},{label:"Word",operation:"createWordFile",iconClass:"file-word"},{label:"Excel",operation:"createExcelFile",iconClass:"file-excel"},{label:"PPT",operation:"createPPTFile",iconClass:"file-ppt"}]}]}}},R=$,H=Object(O["a"])(R,n,a,!1,null,"a854bcf4",null);t["default"]=H.exports},"3b28":function(e,t,i){},"3b6b":function(e,t,i){"use strict";i.r(t);i("6762"),i("2fdb"),i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"resize",rawName:"v-resize",value:e.containerResize,expression:"containerResize"}],staticClass:"container"},[t("van-popup",{style:{height:"100%",width:"35%"},attrs:{"get-container":"body",position:"left"},model:{value:e.leftMenuShow,callback:function(t){e.leftMenuShow=t},expression:"leftMenuShow"}},[t("div",{staticClass:"left-menu"},[t("div",{staticClass:"avatar"},[t("van-image",{attrs:{round:"",width:"5rem",height:"5rem",fit:"cover",src:e.imageUrl+e.avatar}})],1),e._v(" "),t("span",[e._v(e._s(e.name))]),e._v(" "),t("div",{staticClass:"classification"},[t("van-cell",{attrs:{title:"首页",icon:"wap-home-o"},on:{click:function(t){return e.clickFileType(null,{})}}}),e._v(" "),t("van-cell",{attrs:{title:"收藏",icon:"star-o"},on:{click:function(t){return e.clickFileType(null,{isFavorite:!0})}}}),e._v(" "),t("van-cell",{attrs:{title:"图片",icon:"photo-o"},on:{click:function(t){return e.clickFileType("image",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"视频",icon:"video-o"},on:{click:function(t){return e.clickFileType("video",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"音乐",icon:"music-o"},on:{click:function(t){return e.clickFileType("audio",{isFolder:!1})}}}),e._v(" "),t("van-cell",{attrs:{title:"文件传输",icon:"upgrade"},on:{click:e.uploadList}})],1),e._v(" "),t("div",{staticClass:"logout"},[t("van-button",{attrs:{round:"",type:"danger"},nativeOn:{click:function(t){return e.logout.apply(null,arguments)}}},[e._v("退出登录")])],1)])]),e._v(" "),t("van-list",{attrs:{finished:e.finished,"finished-text":e.statistics()},on:{load:function(t){e.searchStatus&&e.searchValue.length>0?e.searchFile(e.searchValue,!0):e.getFileList(!0)}},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[t("van-checkbox-group",{ref:"checkboxGroup",on:{change:e.checkboxChange},model:{value:e.selectRowData,callback:function(t){e.selectRowData=t},expression:"selectRowData"}},[t("van-cell-group",[t("van-sticky",{attrs:{"offset-top":-1}},[e.pathList.length<2&&!e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:"浏览","right-arrow":"","right-text":this.selectRowData.length!==this.fileList.length?"选择":"取消","left-arrow":""},on:{"click-right":e.checkboxAll,"click-left":e.leftMenu}},[t("div",{staticClass:"header-button",attrs:{slot:"left"},slot:"left"},[t("svg",{staticClass:"header-button-icon",attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25"}},[t("path",{attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 0 0 0-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0 0 14.4 7z"}})])])]):e._e(),e._v(" "),e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:0===e.selectRowData.length?"选择项目":e.selectRowData.length+"项","right-arrow":"","left-text":this.selectRowData.length!==this.fileList.length?"全选":"取消全选","right-text":"完成"},on:{"click-left":e.checkboxAll,"click-right":e.cancelSelect}}):e._e(),e._v(" "),e.pathList.length>=2&&!e.selectStatus?t("van-nav-bar",{style:e.vanNavBarClass,attrs:{title:e.pathList[e.pathList.length-1].folder,"right-text":this.selectRowData.length!==this.fileList.length?"选择":"取消","left-arrow":""},on:{"click-right":e.checkboxAll,"click-left":e.clickBack}},[t("div",{staticClass:"header-button",attrs:{slot:"left"},slot:"left"},[t("van-icon",{attrs:{name:"arrow-left"}})],1)]):e._e(),e._v(" "),t("div",{staticClass:"searchbar",style:e.searchBarClass},[t("van-search",{ref:"search",attrs:{"show-action":e.searchStatus,shape:"round",placeholder:"搜索"},on:{focus:e.startSearch,search:e.onSearch,input:e.onSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[t("div",{attrs:{slot:"action"},on:{click:e.endSearch},slot:"action"},[e._v("取消")])])],1)],1),e._v(" "),t("van-cell",{staticStyle:{padding:"0 0 10px 0"},attrs:{center:!0}},[t("div",{staticClass:"operating-header"},[t("van-row",[t("van-col",{staticClass:"operating-header-col",attrs:{span:"4",align:"center",type:"flex"},on:{click:e.moreOperations}},[t("van-icon",{attrs:{name:"more-o"}})],1),e._v(" "),t("van-col",{staticClass:"operating-header-col",attrs:{span:"16",align:"center"},on:{click:e.showSortSheet}},[e._v("\n                已按"+e._s(e.actionsSortName)+"排序\n                "),t("van-icon",{staticClass:"sortable",attrs:{name:"arrow-"+e.sortOrder}})],1),e._v(" "),t("van-col",{staticClass:"operating-header-col",attrs:{span:"4",align:"center"},on:{click:e.changeVmode}},[t("van-icon",{style:e.grid?{}:{background:"#1989fa",color:"#ffffff",padding:"0 5px",borderRadius:"5px"},attrs:{name:"bars"}})],1)],1)],1)]),e._v(" "),e.searchStatus&&e.searchValue.length>0&&e.fileList.length>0?t("van-cell",{staticStyle:{"background-color":"#f7f8fa"}},[t("div",{staticClass:"search-result"},[e._v(e._s(e.resultCount)+"个结果")])]):e._e(),e._v(" "),e.searchStatus&&e.searchValue.length>0&&0===e.fileList.length?t("van-cell",[t("div",{staticClass:"search-result-no"},[e._v("无结果")])]):e._e(),e._v(" "),e.loading||0!==e.fileList.length?e._e():t("van-empty",{attrs:{description:"空空如也"}}),e._v(" "),e._l(e.fileList,(function(i,n){return e.grid?e._e():t("van-cell",{key:i.id,staticClass:"list-item",style:{background:e.selectIndexList.includes(n)?"#90c2fcb5":""},attrs:{center:"","is-link":i.isFolder},on:{click:function(t){return e.fileClick(i,n)}}},[t("div",{staticClass:"list-item-div",on:{touchstart:function(t){return e.touchStart(i)},touchend:e.touchEnd,touchmove:e.touchMove}},[t("van-row",{staticClass:"row-file"},[t("van-col",{staticClass:"list-cell-icon",attrs:{span:"4",align:"center"}},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})],1),e._v(" "),t("van-col",{staticClass:"list-item-content",attrs:{span:"16"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                  "+e._s(i.name)+"\n                ")]),e._v(" "),t("van-col",{staticClass:"file-description",attrs:{span:"24",justify:"space-between"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                    "+e._s(e.formatTime(i.agoTime))+"   "+e._s(e.formatSize(i.size))+"\n                  ")])],1)],1),e._v(" "),t("van-col",{attrs:{span:"4"}})],1)],1),e._v(" "),!e.grid&&e.selectStatus?t("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:i},slot:"right-icon"}):e._e()],1)})),e._v(" "),e.grid?t("van-grid",{style:{width:"100%",overflow:"auto"},attrs:{square:"",center:!0,"column-num":e.gridColumnNum,gutter:10,border:!1}},e._l(e.fileList,(function(i,n){return t("van-grid-item",{key:i.id,ref:"gridItem",refInFor:!0,staticClass:"parent-grid-item",on:{click:function(t){return e.fileClick(i,n)}}},[t("div",{staticClass:"grid-time van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:{background:e.selectIndexList.includes(n)?"#90c2fcb5":"","border-radius":"15px"},on:{touchstart:function(t){return e.touchStart(i)},touchend:e.touchEnd,touchmove:e.touchMove}},[e.grid&&e.selectStatus?t("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:i},slot:"right-icon"}):e._e(),e._v(" "),t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0}})],1),e._v(" "),t("span",{staticClass:"grid-item-text",attrs:{title:i.name}},[e._v(e._s(i.name))])],1)])})),1):e._e()],2)],1)],1),e._v(" "),t("van-action-sheet",{attrs:{actions:e.actionsMenus,"cancel-text":"取消"},on:{cancel:e.onCancel,select:e.selectActionsMenus},model:{value:e.actionSheetShow,callback:function(t){e.actionSheetShow=t},expression:"actionSheetShow"}}),e._v(" "),t("van-action-sheet",{attrs:{actions:e.actionsSortMenus,"cancel-text":"取消",description:"排序方式"},on:{cancel:e.onCancel,select:e.selectSortActionsMenus},model:{value:e.actionSortSheetShow,callback:function(t){e.actionSortSheetShow=t},expression:"actionSortSheetShow"}}),e._v(" "),t("van-dialog",{attrs:{"show-cancel-button":""},on:{confirm:e.newFolderNameClick},model:{value:e.showNewFolder,callback:function(t){e.showNewFolder=t},expression:"showNewFolder"}},[t("van-field",{ref:"newFolderInput",staticClass:"new-folder-input",attrs:{placeholder:"请输入文件夹名称",border:!0,clearable:!0,autofocus:!0},model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}})],1),e._v(" "),t("van-dialog",{attrs:{"show-cancel-button":""},on:{confirm:function(t){return e.rowRename()}},model:{value:e.showRename,callback:function(t){e.showRename=t},expression:"showRename"}},[t("van-field",{ref:"renameInput",staticClass:"rename-input",attrs:{placeholder:"请输入文件名称",border:!0,clearable:!0,autofocus:!0},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}})],1),e._v(" "),t("e-vue-contextmenu",{ref:"contextShow",staticClass:"newFileMenu",on:{"ctx-show":e.show,"ctx-hide":e.hide}},e._l(e.menus,(function(i,n){return t("ul",{key:i.label,class:{"menu-list-first":0===n,"menu-list-last":n===e.menus.length-1,"menu-list":n<e.menus.length-1&&n>0}},[0!==n?t("div",{staticStyle:{"border-bottom":"1px solid #cccccc85"}}):e._e(),e._v(" "),t("li",{class:{remove:"remove"===i.operation},on:{click:function(t){return e.menusOperations(i.operation)}}},[t("div",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)])])})),0),e._v(" "),t("van-overlay",{ref:"overlayShow",attrs:{show:e.overlayShow,duration:"0.3"},on:{click:e.overlayClick}},[null==e.rowContextData.name||e.grid?e._e():t("van-cell",{staticClass:"list-item overlay-content-class",style:e.overlayContentClass,attrs:{center:"","is-link":e.rowContextData.isFolder}},[t("div",[t("van-row",{staticClass:"row-file"},[t("van-col",{staticClass:"list-cell-icon",attrs:{span:"4",align:"center"}},[t("icon-file",{attrs:{item:e.rowContextData,"image-url":e.imageUrl}})],1),e._v(" "),t("van-col",{staticClass:"list-item-content",attrs:{span:"16"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n              "+e._s(e.rowContextData.name)+"\n            ")]),e._v(" "),t("van-col",{staticClass:"file-description",attrs:{span:"24",justify:"space-between"}},[t("van-col",{attrs:{span:"24"}},[e._v("\n                "+e._s(e.formatTime(e.rowContextData.agoTime))+"   "+e._s(e.formatSize(e.rowContextData.size))+"\n              ")])],1)],1),e._v(" "),t("van-col",{attrs:{span:"4"}})],1)],1),e._v(" "),e.selectStatus?t("van-checkbox",{staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:e.rowContextData},slot:"right-icon",model:{value:e.isShowCheckContext,callback:function(t){e.isShowCheckContext=t},expression:"isShowCheckContext"}}):e._e()],1),e._v(" "),null!=e.rowContextData.name&&e.grid?t("div",{staticClass:"grid-time overlay-content-class van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:e.overlayContentClass},[e.selectStatus?t("van-checkbox",{staticClass:"file-item-checkbox",attrs:{slot:"right-icon",name:e.rowContextData},slot:"right-icon",model:{value:e.isShowCheckContext,callback:function(t){e.isShowCheckContext=t},expression:"isShowCheckContext"}}):e._e(),e._v(" "),t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:e.rowContextData,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0}})],1),e._v(" "),t("span",{staticClass:"grid-item-text",attrs:{title:e.rowContextData.name}},[e._v(e._s(e.rowContextData.name))])],1):e._e()],1),e._v(" "),t("sim-text-preview",{attrs:{file:e.textPreviewRow,status:e.textPreviewVisible,"is-together":e.isTogether},on:{"update:file":function(t){e.textPreviewRow=t},"update:status":function(t){e.textPreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}}),e._v(" "),t("image-viewer",{attrs:{fileList:e.fileList,file:e.imagePreviewRow,status:e.imagePreviewVisible},on:{"update:status":function(t){e.imagePreviewVisible=t}}}),e._v(" "),t("video-preview",{attrs:{file:e.videoPreviewRow,status:e.videoPreviewVisible},on:{"update:status":function(t){e.videoPreviewVisible=t}}}),e._v(" "),t("office-preview",{attrs:{file:e.officePreviewRow,status:e.officePreviewVisible,"is-together":e.isTogether},on:{"update:status":function(t){e.officePreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}})],1)},a=[],o=(i("f559"),i("a8f9")),r=(i("55dd"),i("386d"),i("ae4a")),s=(i("96cf"),i("97bf")),l=(i("20d6"),i("aef6"),i("7514"),i("28a5"),i("ac6a"),i("a481"),i("6f8e")),c=i("2f62"),d=i("7f29"),u=i("26a1"),h=i("7d60"),p=i("0dcf"),f=i("2690"),m=i("1638"),g=i("ae1f"),v=i("2d53"),b=i("1000"),w=i("fd35"),y=i("b311"),x=i.n(y),C=(i("d958"),{components:{OfficePreview:w["a"],SimTextPreview:v["a"],VideoPreview:g["a"],ImageViewer:m["a"],IconFile:p["a"]},computed:Object(l["a"])({},Object(c["b"])(["name","avatar"])),data:function(){return{test:0,lastTabbarOffsetTop:0,diffTabbarTop:0,isiPhoneX:0,imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),audioCoverUrl:"".concat("/api","/view/cover?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),tabActive:0,path:this.$route.query.path,fileList:[],pathList:[{folder:"",index:0},{folder:"+",index:1}],pagination:{pageIndex:0,pageSize:50,total:0},queryFileType:null,queryCondition:{isFolder:null},loading:!1,finished:!1,refreshing:!1,actionSheetShow:!1,actionsMenus:[{name:"新建文件夹"}],actionSortSheetShow:!1,actionsSortMenus:[{name:"名称"},{name:"日期"},{name:"大小"}],actionsSortName:"名称",showNewFolder:!1,showRename:!1,newFolderName:"新建文件夹",Loop:null,isJustHideMenus:!1,singleMenus:[{iconClass:"menu-select",label:"选择",operation:"select"},{iconClass:"menu-rename",label:"重命名",operation:"rename"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}],menus:[],rowContextData:{},selectRowData:[],checkboxGroup:[],newFolderLoading:!1,renameLoading:!1,renameFileName:"",selectIndexList:[],selectStatus:!1,isShowCheckContext:!1,overlayShow:!1,overlayContentClass:{},vanNavBarClass:{},searchBarClass:{},leftMenuShow:!1,searchValue:"",searchStatus:!0,resultCount:0,sortOrder:"up",sortableProp:null,order:null,grid:!1,vmode:"list",gridColumnNum:-1,imagePreviewRow:{},imagePreviewVisible:!1,videoPreviewRow:{},videoPreviewVisible:!1,officePreviewRow:{},officePreviewVisible:!1,textPreviewVisible:!1,textPreviewRow:{},isTogether:!1,spaceFlag:this.$route.path.replace(/\//g,"")}},directives:{resize:{bind:function(e,t){var i="",n="";function a(){var a=document.defaultView.getComputedStyle(e);i===a.width&&n===a.height||t.value(),i=a.width,n=a.height}e.__vueSetInterval__=setInterval(a,300)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},mounted:function(){var e=this;if(this.$route.query.vmode&&(this.vmode=this.$route.query.vmode,"list"===this.vmode?this.grid=!1:this.grid=!0),"/"!==this.$route.query.path){var t=decodeURI(this.$route.query.path);this.pathList.splice(1,1),t.split("/").forEach((function(t,i){if(i>0){var n={};n["folder"]=t,n["index"]=i,e.pathList.push(n)}}))}this.$route.query.folder&&this.path&&localStorage.setItem(this.path,this.$route.query.folder),window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1))},destroyed:function(){window.removeEventListener("popstate",this.goBack,!1)},methods:{highlightFavorite:function(e,t){var i=this.menus.find((function(e){if("favorite"===e.operation||"unFavorite"===e.operation)return e}));i&&(e?(i.label="取消收藏",i.iconClass="menu-unfavorite-hover",i.operation="unFavorite"):(i.iconClass=t?"menu-favorite-hover":"menu-favorite",i.label="收藏",i.operation="favorite"))},show:function(){},hide:function(){var e=this;this.isJustHideMenus=!0,setTimeout((function(){e.isJustHideMenus=!1}),100)},showCheckContext:function(){return this.selectIndexList.includes(this.rowContextData.index)},rowContextmenu:function(e,t,i){if(this.menus=JSON.parse(JSON.stringify(this.singleMenus)),this.selectStatus&&this.selectIndexList.includes(e.index)){if(this.selectIndexList.includes(e.index)){var n={iconClass:"menu-unselect",label:"取消选择",operation:"unselect"};this.menus.splice(0,1,n)}}else{var a={iconClass:"menu-select",label:"选择",operation:"select"};this.menus.splice(0,1,a)}e.isShare&&!e.isPrivacy&&this.menus.splice(-2,0,{iconClass:"menu-fuzhi",label:"复制下载链接",operation:"copyDownloadLink"}),this.preliminaryRowData(e);var o=Object(u["b"])(t)-e.scrollY,r={};o+t.offsetHeight/2>document.body.offsetHeight/2?(r.pageX=i,r.pageY=Object(u["b"])(t)-47*this.menus.length+5):(r.pageX=i,r.pageY=Object(u["b"])(t)+t.offsetHeight+5),this.$refs.contextShow.showMenu(r)},preliminaryRowData:function(e){this.rowContextData=e,this.isShowCheckContext=this.selectIndexList.includes(e.index);var t=this.rowContextData.isFavorite;this.highlightFavorite(t,!1)},menusOperations:function(e){var t=this,i=this;switch(e){case"favorite":this.favoriteOperating(!0);break;case"open":this.fileClick(this.rowContextData,this.rowContextData.index);break;case"unselect":var n=this.rowContextData.index;this.$refs.checkboxes[n].toggle();break;case"unFavorite":this.favoriteOperating(!1);break;case"select":this.selectStatus=!0,this.selectIndexList.push(this.rowContextData.index),setTimeout((function(){t.$refs.checkboxes[i.rowContextData.index].toggle()}),0);break;case"rename":this.renameFileName=this.rowContextData.name,this.showRename=!0,setTimeout((function(){i.$refs.renameInput.focus()}),0);break;case"copy":vant.Toast("暂不支持移动");break;case"download":this.downloadFile();break;case"copyDownloadLink":this.copyDownloadLink(this.rowContextData);break;case"remove":this.deleteFile();break}this.overlayShow=!1,document.documentElement.style.overflow=null,this.$refs.contextShow.hideMenu()},rowRename:function(){var e=this,t=this.rowContextData,i=this.renameFileName;if(i){if(!t.isFolder){var n="."+t.suffix;i.endsWith(n)||(i+=n)}this.renameLoading=!0;var a=this.fileList.findIndex((function(e){if(i===e.name)return e}));if(a>-1){var o="该文件已存在";return t.isFolder&&(o="该文件夹已存在"),this.$message({message:o,type:"warning"}),void(this.renameLoading=!1)}h["a"].rename({newFileName:encodeURI(i),username:this.$store.state.user.name,folder:this.$route.query.folder,id:t.id,spaceFlag:this.spaceFlag}).then((function(){e.renameLoading=!1,t.name=i,e.fileList[t.index]=t,e.editingIndex=-1}))}else this.editingIndex=-1},downloadFile:function(){var e=0;if(this.selectRowData.length>0?this.selectRowData.forEach((function(t){e+=t.size})):e+=this.rowContextData.size,e>0){var t=[];if(this.selectRowData.length>0?this.selectRowData.forEach((function(e){t.push(e.id)})):t.push(this.rowContextData.id),t.length>1||this.rowContextData.isFolder)return void f["a"].packageDownloadSpace(t,this.$store.state.user.token,this.$store.state.user.name,this.spaceFlag);f["a"].download(this.$store.state.user.name,this.rowContextData,this.$store.state.user.token)}else this.$message({message:"所选文件夹为空",type:"warning"})},copyDownloadLink:function(e){var t=this,i=window.location.origin+f["a"].previewUrl(this.$store.getters.name,e,void 0,void 0),n=new x.a(".newFileMenu",{text:function(){return i}});n.on("success",(function(e){t.$message({message:"复制成功",type:"success",duration:1e3}),n.destroy()})),n.on("error",(function(e){t.$message({message:"该浏览器不支持自动复制",type:"warning",duration:1e3}),n.destroy()}))},favoriteOperating:function(e){this.rowContextData.isFavorite=e,this.highlightFavorite(e,!0),h["a"].favoriteUrl({fileIds:this.rowContextData.id,isFavorite:e,spaceFlag:this.spaceFlag}).then((function(e){}))},deleteFile:function(){var e=this,t=[],i=[];this.selectRowData.length>0?(t=this.selectRowData,this.selectRowData.forEach((function(e){i.push(e.id)}))):(t=this.selectRowData,i.push(this.rowContextData.id));var n=this.getShowSumFileAndFolder(t);vant.Dialog.confirm({title:"提示",message:"此操作将永久删除"+n+", 是否继续?"}).then((function(){h["a"].delete({currentDirectory:e.rowContextData.path,username:e.$store.state.user.name,fileIds:i,spaceFlag:e.spaceFlag}).then((function(){e.getFileList(),vant.Toast.setDefaultOptions({duration:800}),vant.Toast.success("删除成功"),e.selectRowData.length>1&&(e.selectRowData=[])}))}))},touchMove:function(){clearTimeout(this.Loop)},touchStart:function(e){var t=this;clearTimeout(this.Loop);var i=window.event;this.Loop=setTimeout((function(){e.scrollY=i.targetTouches[0].pageY-i.targetTouches[0].clientY,t.findListItem(e,i.targetTouches[0].target,i.targetTouches[0].clientX)&&(t.overlayShow=!0,document.documentElement.style.overflow="hidden")}),500)},touchEnd:function(){clearTimeout(this.Loop)},overlayClick:function(){this.overlayShow=!1,document.documentElement.style.overflow=null},findListItem:function(e,t,i){if(null===t)return!1;var n=t.offsetParent,a=t.parentElement;if(!n&&a||null===n)return this.findListItem(e,t.parentElement,i);if(n.className.indexOf("list-item")>-1)this.longPressDisplayLayer(e,n,i);else{if(!(n.className.indexOf("grid-time")>-1))return this.findListItem(e,t.offsetParent,i);this.longPressDisplayLayer(e,n,i)}return!0},longPressDisplayLayer:function(e,t,i){var n=this,a=this.selectIndexList.includes(this.rowContextData.index)?"#90c2fcb5":"";this.overlayContentClass={top:Object(u["b"])(t)-e.scrollY+"px",height:t.offsetHeight+"px",width:t.offsetWidth+"px",left:Object(u["a"])(t)+"px","border-radius":"0px",background:a},setTimeout((function(){n.overlayContentClass={top:Object(u["b"])(t)-e.scrollY+"px",height:t.offsetHeight+"px",width:t.offsetWidth-(n.grid?0:10)+"px",left:Object(u["a"])(t)+(n.grid?0:5)+"px","border-radius":"20px",background:a}}),0),this.rowContextmenu(e,t,i)},goBack:function(){this.pathList.length<=1?this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path))):this.clickBack()},clickBack:function(){this.handleLink(this.pathList[this.pathList.length-2],this.pathList.length-2)},leftMenu:function(){this.leftMenuShow=!0},logout:function(){var e=Object(s["a"])(Object(r["a"])().m((function e(){return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.$store.dispatch("user/logout");case 1:this.$router.push("/login?redirect=".concat(this.$route.fullPath));case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),startSearch:function(){this.vanNavBarClass={visibility:"hidden"},this.searchBarClass={marginTop:"-30px"};var e=document.querySelector(".van-search__action");e.style.marginRight="0px",e.style.visibility="visible",e.style.color="#1989fa"},endSearch:function(){var e=this;setTimeout((function(){e.vanNavBarClass={visibility:"visible"}}),150),this.searchBarClass={marginTop:"0px"};var t=document.querySelector(".van-search__action");t.style.marginRight="-44px",t.style.visibility="hidden",this.searchValue="",this.getFileList()},onSearch:function(){this.searchValue.length<1?this.getFileList():this.searchFile(this.searchValue)},changeVmode:function(){this.grid=!this.grid,this.vmode="list",this.grid&&(this.vmode="grid"),this.path||(this.path=""),this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(this.path).concat(this.$route.query.folder?"&folder="+this.$route.query.folder:""))},showSortSheet:function(){this.actionSortSheetShow=!0},moreOperations:function(){if(this.actionSheetShow=!0,this.actionsMenus=[{name:"新建文件夹"}],window.uploader.support){var e={name:"上传文件"};this.actionsMenus.push(e)}if(window.uploader.supportDirectory){var t={name:"上传文件夹"};this.actionsMenus.push(t)}},handleLink:function(e,t,i,n){var a=this;if(e&&e.search)e.searchKey?this.searchFileByKeyWord(e.searchKey):e.row&&this.searchFileAndOpenDir(e.row),this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1));else{this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1)),this.pathList.forEach((function(e,t){0===t?a.path="":t===a.pathList.length||(a.path+="/"+a.pathList[t].folder)}));var o=localStorage.getItem(this.path);i||(this.$route.query.path,this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(o?"&folder="+o:""))),n||(this.pagination.pageIndex=1,this.getFileList())}},formatTime:function(e){return Object(d["c"])(e)},formatSize:function(e){return Object(d["b"])(e)},onRefresh:function(){this.finished=!1,this.loading=!0,this.getFileList()},getFileList:function(e){var t=this;this.beforeLoadData(e),h["a"].fileList({username:this.$store.state.user.name,userId:this.$store.state.user.userId,currentDirectory:encodeURI(this.$route.query.path),folder:this.$route.query.folder,queryFileType:this.queryFileType,sortableProp:this.sortableProp,order:this.order,isFolder:this.queryCondition.isFolder,isFavorite:this.queryCondition.isFavorite,queryCondition:this.queryCondition,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,spaceFlag:this.spaceFlag}).then((function(i){t.loadData(i,e)})).catch((function(e){}))},searchFile:function(e,t){var i=this;e&&(this.beforeLoadData(t),this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e)),h["a"].searchFile({userId:this.$store.state.user.userId,username:this.$store.state.user.name,keyword:e,currentDirectory:encodeURI(this.$route.query.path),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,spaceFlag:this.spaceFlag}).then((function(e){i.loadData(e,t),i.path="",i.listModeSearch=!0,i.listModeSearchOpenDir=!1})))},beforeLoadData:function(e){e?this.pagination.pageIndex++:this.pagination.pageIndex=1,this.finished=!1,this.fileList=[]},loadData:function(e,t){var i=this;t?e.data.forEach((function(e,t){e["index"]=(i.pagination.pageIndex-1)*i.pagination.pageSize+t,i.fileList.push(e)})):(this.fileList=e.data,this.fileList.map((function(e,t){e["index"]=t}))),this.refreshing=!1,this.resultCount=e.count,this.fileList.length>=e.count&&(this.finished=!0),this.fileList.sort(this.compare(this.sortableProp)),this.$nextTick((function(){i.containerResize(),i.loading=!1}))},containerResize:function(){var e=document.querySelector(".container"),t=e.clientWidth;t>1024?this.gridColumnNum=Math.round(t/100-4):(this.gridColumnNum=Math.round(t/100-2),t<=550&&(this.gridColumnNum=4),t<=375&&(this.gridColumnNum=3))},clickFileType:function(e,t){this.queryCondition=t,this.queryFileType=e,this.getFileList(),this.leftMenuShow=!1},uploadList:function(){this.$router.push("/upload/index_m")},statistics:function(){var e=0;return this.fileList.forEach((function(t){e+=t.size})),this.getShowSumFileAndFolder(this.fileList)+" "+this.getShowSumSize(e)},getShowSumFileAndFolder:function(e){var t=0,i=0;e.forEach((function(e){e.isFolder?t+=1:i+=1}));var n="";t>0&&(n=t+"个文件夹");var a="";return i>0&&(a=i+"个文件"),n+" "+a},getShowSumSize:function(e){var t="";return e>0&&(t="  共"),0===e||(t+=e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"K":e>=1048576&&e<1073741824?(e/1048576).toFixed(2)+"M":(e/1073741824).toFixed(2)+"G"),t},checkboxAll:function(){this.selectRowData.length!==this.fileList.length?this.$refs.checkboxGroup.toggleAll(!0):this.$refs.checkboxGroup.toggleAll()},cancelSelect:function(){this.$refs.checkboxGroup.toggleAll(!1);var e=this;setTimeout((function(){e.selectStatus=!1}))},checkboxChange:function(e){this.selectRowData=e,this.selectIndexList=[];var t,i=Object(o["a"])(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.selectIndexList.push(n.index)}}catch(a){i.e(a)}finally{i.f()}this.selectStatus=!0},fileClick:function(e,t){var i=this;if(this.selectStatus)this.$refs.checkboxes[t].toggle();else if(e.isFolder){this.path?this.path+="/"+e.name:this.path="/"+e.name;var n={};n["folder"]=e.name,n["index"]=this.pathList.length-1,this.pathList.push(n);var a=encodeURI(this.path);this.$store.getters.userId!==e.userId&&(e.mountFileId=e.id),e.mountFileId&&localStorage.setItem(this.path,e.mountFileId),this.$router.push("/_m?vmode=".concat(this.vmode,"&path=").concat(a).concat(e.mountFileId?"&folder="+e.mountFileId:"")),this.getFileList()}else{if(e.contentType.startsWith("image"))return this.imagePreviewVisible=!0,void(this.imagePreviewRow=e);if(b["c"].simText.includes(e.suffix))return this.textPreviewRow=e,void(this.textPreviewVisible=!0);if(e.contentType.indexOf("video")>-1)return this.videoPreviewVisible=!0,void(this.videoPreviewRow=e);if(e.contentType.indexOf("audio")>-1)return void this.$store.dispatch("updateMessage",{event:"onAddAudio",data:{row:e,audioCoverUrl:this.audioCoverUrl}});if(e.contentType.indexOf("office")>-1||"csv"===e.suffix)return this.officePreviewVisible=!0,void(this.officePreviewRow=e);if("pdf"===e.suffix||"PDF"===e.suffix)return void f["a"].preview(this.$store.state.user.name,e,this.$store.getters.token);vant.Dialog.confirm({title:"标题",message:"此文件不支持预览，是否下载",confirmButtonText:"下载"}).then((function(){setTimeout((function(){f["a"].download(i.$store.state.user.name,e,i.$store.state.user.token)}),0)})).catch((function(){}))}},onCancel:function(){this.actionSheetShow=!1,this.actionSortSheetShow=!1},compare:function(e){var t=this;return function(i,n){var a=i[e],o=n[e];return"ascending"===t.order?a-o:o-a}},selectSortActionsMenus:function(e){var t=this;setTimeout((function(){t.actionSortSheetShow=!1}),100),"up"===this.sortOrder?(this.sortOrder="down",this.order="descending"):(this.sortOrder="up",this.order="ascending"),this.actionsSortName=e.name,"名称"===e.name&&(this.sortableProp="name","up"===this.sortOrder&&(this.order=null),this.getFileList()),"大小"===e.name&&(this.sortableProp="size",this.fileList.sort(this.compare(this.sortableProp))),"日期"===e.name&&(this.sortableProp="updateDate",this.getFileList())},selectActionsMenus:function(e){var t=this;if(setTimeout((function(){t.actionSheetShow=!1}),100),"新建文件夹"===e.name){this.newFolderName="新建文件夹";var i=0,n=[];this.fileList.forEach((function(e){n.push(e.name)}));while(n.includes(this.newFolderName))i+=1,this.newFolderName="新建文件夹"+i;this.showNewFolder=!0;var a=this;setTimeout((function(){a.$refs.newFolderInput.focus()}),0)}"上传文件"===e.name&&this.$store.dispatch("updateMessage",{event:"openUploader",data:{folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId,spaceFlag:this.spaceFlag}}),"上传文件夹"===e.name&&this.$store.dispatch("updateMessage",{event:"uploadFolder",data:{folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId,spaceFlag:this.spaceFlag}})},newFolderNameClick:function(){var e=this;this.newFolderLoading=!0,this.newFolderName?h["a"].uploadFolder({isFolder:!0,filename:encodeURI(this.newFolderName),folder:this.$route.query.folder,currentDirectory:encodeURI(this.path),username:this.$store.state.user.name,userId:this.$store.state.user.userId,spaceFlag:this.spaceFlag}).then((function(t){1===t.data?(e.newFolderLoading=!1,e.$message({message:"该文件夹已存在",type:"warning"})):(e.newFolderLoading=!1,e.showNewFolder=!1,e.isShowNewFolder=!1,Notify({type:"success",message:"新建文件夹成功",duration:1e3}),e.listModeSearch?e.getFileListBySearchMode():e.getFileList())})):(this.newFolderLoading=!1,this.$message({message:"请输入文件夹名称",type:"warning"}))},swipeUp:function(){this.test=10},tabBottom:function(){return{padding:"0 0 20px 0"}}}}),k=C,_=(i("192f"),i("2877")),S=Object(_["a"])(k,n,a,!1,null,"346546f4",null);t["default"]=S.exports},"3b6f":function(e,t,i){e.exports=i.p+"static/img/history.e973a23c.svg"},"3e79":function(e,t,i){"use strict";i("ce82")},"403e":function(e,t,i){"use strict";i("ff90")},4075:function(e,t,i){"use strict";i("5792")},4096:function(e,t,i){},4108:function(e,t,i){},4308:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"edit-div",contenteditable:e.canEdit},domProps:{innerHTML:e._s(e.innerText)},on:{focus:function(t){e.isLocked=!0},blur:function(t){e.isLocked=!1},input:e.changeText}})},a=[],o={name:"EditElement",props:{value:{type:String,default:""},canEdit:{type:Boolean,default:!0}},data:function(){return{innerText:"",isLocked:!1}},watch:{value:function(e){this.isLocked||(this.innerText=e,document.getElementById("edit-div").innerHTML=e)}},methods:{changeText:function(){this.$emit("input",this.$el.innerHTML)}}},r=o,s=(i("94fe"),i("2877")),l=Object(s["a"])(r,n,a,!1,null,null,null);t["default"]=l.exports},4678:function(e,t,i){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-ps":"4c98","./ar-ps.js":"4c98","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"38862","./en-ca.js":"38862","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"73332","./en-il.js":"73332","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku-kmr":"7558","./ku-kmr.js":"7558","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e9","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e9","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33e","./yo.js":"7f33e","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(e){var t=o(e);return i(t)}function o(e){var t=n[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id="4678"},"46c4":function(e,t,i){"use strict";i("4dd3")},"481c":function(e,t,i){"use strict";i("5769")},"488d":function(e,t,i){"use strict";i.r(t);i("6762"),i("2fdb"),i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"resize",rawName:"v-resize",value:e.containerResize,expression:"containerResize"}],staticClass:"dashboard-container"},[t("transition",{attrs:{name:"fade"}},[e.isLoading?t("al-loading"):e._e()],1),e._v(" "),t("div",{staticClass:"share-h"},[t("div",{staticClass:"share-header"},[t("div",{staticClass:"share-header-content logo"},[t("Logo",{attrs:{width:"35"},model:{value:e.netdiskLogo,callback:function(t){e.netdiskLogo=t},expression:"netdiskLogo"}}),e._v(" "),t("span",[e._v(e._s(e.netdiskName))])],1),e._v(" "),e.sharer&&!e.showShareCode?t("div",{staticClass:"share-header-content sharer"},[e.loginTitle.length>0?t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.loginOrMount}},[e._v(" "+e._s(e.loginTitle)+" ")]):e._e(),e._v(" "),t("span",{staticClass:"user"},[e._v(e._s(e.sharer.showName)+"的分享")]),e._v(" "),t("el-avatar",{attrs:{src:e.sharerAvatarUrl}})],1):e._e()]),e._v(" "),t("el-divider",{staticClass:"header-location"}),e._v(" "),e.linkFailed?e._e():t("el-breadcrumb",{staticClass:"app-breadcrumb",attrs:{separator:""}},[t("transition-group",{attrs:{name:"breadcrumb"}},e._l(e.pathList,(function(i,n){return t("el-breadcrumb-item",{key:i.index},[0===n?t("span",[e._v("当前位置:")]):e._e(),e._v(" "),t("breadcrumb-file-path",{attrs:{pathList:e.pathList,item:i,index:n},on:{clickLink:e.handleLink}})],1)})),1),e._v(" "),t("div",{staticClass:"search-content"},[t("div",{staticClass:"search-class"},[e.indexList.length>0?t("el-button",{staticClass:"sort",attrs:{type:"text",title:"下载"},on:{click:function(t){return e.downloadFile(!1)}}},[t("svg-icon",{attrs:{"icon-class":"menu-download"}})],1):e._e(),e._v(" "),t("el-button",{staticClass:"vmode",attrs:{type:"text"},on:{click:e.changeVmode}},[t("svg-icon",{attrs:{"icon-class":e.grid?"list":"grid"}})],1)],1)])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"挂载到："+e.selectTreeNode.showName,visible:e.mountToVisible},on:{"update:visible":function(t){e.mountToVisible=t}}},[e.mountToVisible?t("file-tree",{ref:"fileTreeMount",attrs:{localFileMode:!1},on:{treeNodeClick:e.onTreeNodeClick}}):e._e(),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",disabled:e.fileTreeAndNewFolderDisabled},on:{click:e.fileTreeAndNewFolder}},[t("i",{staticClass:"el-icon-folder-add"}),e._v("  新建文件夹")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.mountFolder}},[e._v("挂载")])],1)],1),e._v(" "),t("e-vue-contextmenu",{ref:"contextShow",staticClass:"newFileMenu",class:e.menuTriangle,on:{"ctx-show":e.show,"ctx-hide":e.hide}},[t("div",{staticClass:"popper-arrow"}),e._v(" "),e._l(e.menus,(function(i){return t("ul",{key:i.label},[t("li",{staticClass:"menu-option",on:{click:function(t){return e.menusOperations(i.operation)}}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)])])}))],2),e._v(" "),t("el-table",{directives:[{name:"show",rawName:"v-show",value:!e.grid&&!e.linkFailed&&!e.showShareCode,expression:"!grid && !linkFailed && !showShareCode"},{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"fileListTable",staticStyle:{width:"100%",margin:"20px 0 0 0"},attrs:{"empty-text":"无文件",data:e.fileList,"row-key":"id","summary-method":e.getSummaries,"show-summary":"","cell-style":e.rowRed,"row-class-name":e.tableRowClassName,"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{"selection-change":e.handleSelectionChange,"row-contextmenu":e.rowContextmenu,"cell-click":e.cellClick,"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[e._l(e.tableHead,(function(i,n){return[0===n?t("el-table-column",{key:n,attrs:{index:n,type:"selection","min-width":"50"}}):e._e(),e._v(" "),1===n?t("el-table-column",{key:n,attrs:{index:n,width:"50"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.sharer?t("icon-file",{attrs:{item:i.row,"image-url":e.imageUrl,"audio-cover-url":e.audioUrl,public:!0}}):e._e()]}}],null,!0)}):e._e(),e._v(" "),2===n?t("el-table-column",{key:n,attrs:{"show-overflow-tooltip":!0,"max-width":"200",index:n,prop:i.name,label:i.label,sortable:i.sortable},on:{click:function(t){return t.stopPropagation(),e.fileClick(e.scope.row)}},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.editingIndex?t("el-col",{attrs:{span:10}},[t("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:"",size:"small",clearable:!0},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.rowRename(e.renameFileName,i.row)}},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}}),e._v(" "),t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.renameLoading,expression:"renameLoading"}],staticClass:"el-icon-check",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(t){return e.rowRename(e.renameFileName,i.row)}}}),e._v(" "),t("el-button",{staticClass:"el-icon-close",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(t){e.editingIndex=-1}}})],1):t("span",{staticClass:"table-file-name"},[e._v(e._s(i.row.name))])]}}],null,!0)}):e._e(),e._v(" "),3===n&&e.showUpdateDateItem?t("el-table-column",{key:n,attrs:{width:"50",index:n,align:"center","header-align":"center"}}):e._e(),e._v(" "),4===n&&e.showUpdateDateItem?t("el-table-column",{key:n,staticClass:"el-icon-more",attrs:{width:"50",prop:i.name,label:i.label,index:n,align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.cellMouseIndex?t("svg-icon",{staticClass:"button-class",attrs:{"icon-class":"more"},on:{click:function(t){return e.moreClick(i.row,t)}}}):e._e()]}}],null,!0)},[t("template",{slot:"header"},[""!==i.name?t("svg-icon",{staticClass:"button-class",attrs:{"icon-class":"more"},on:{click:function(t){return e.moreOperation(t)}}}):e._e()],1)],2):e._e(),e._v(" "),5===n&&e.showSizeItem?t("el-table-column",{key:n,attrs:{width:"200",prop:i.name,index:n,label:i.label,sortable:i.sortable,"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(e.formatSize(i.row.size)))])]}}],null,!0)}):e._e(),e._v(" "),6===n&&e.showUpdateDateItem?t("el-table-column",{key:n,attrs:{width:"300",prop:i.name,index:n,label:i.label,sortable:i.sortable,"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.updateDate))])]}}],null,!0)}):e._e()]}))],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.grid&&!e.linkFailed&&!e.showShareCode,expression:"grid && !linkFailed && !showShareCode"},{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"}},[t("div",{staticClass:"checkbox-group-header"},[t("van-checkbox",{staticClass:"grid-all-checkbox",on:{click:function(t){return e.clickGridAllCheckBox()}},model:{value:e.allChecked,callback:function(t){e.allChecked=t},expression:"allChecked"}},[e._v("\n        "+e._s(e.indexList.length>0?"已选择 "+this.tableHead[2].label:"选择")+"\n      ")]),e._v(" "),t("el-divider")],1),e._v(" "),t("van-checkbox-group",{ref:"checkboxGroup",on:{change:e.handleSelectionChange},model:{value:e.selectRowData,callback:function(t){e.selectRowData=t},expression:"selectRowData"}},[t("van-grid",{attrs:{square:"","column-num":e.gridColumnNum,gutter:10,border:!1}},e._l(e.fileList,(function(i,n){return t("van-grid-item",{key:i.id,ref:"gridItem",refInFor:!0},[t("div",{staticClass:"grid-time van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:{background:e.indexList.includes(n)?"#baebff91":"",cursor:e.indexList.length>0?"default":"pointer"},on:{mouseover:function(t){return e.gridItemHover(i,n)},mouseout:function(t){return e.gridItemOut(i,n)},click:function(t){return e.gridItemClick(i,t)},contextmenu:function(t){return t.preventDefault(),e.rowContextmenu(i)}}},[t("van-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.gridHoverItemIndex===n||e.indexList.includes(n),expression:"gridHoverItemIndex === index || indexList.includes(index)"}],staticClass:"grid-item-checkbox",attrs:{name:i},on:{click:function(t){return t.stopPropagation(),e.clickGridItemCheckBox(i,n)}}}),e._v(" "),t("div",{staticClass:"grid-item-icon"},[e.sharer?t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioUrl,grid:!0,"grid-width":e.gridColumnWidth,public:!0}}):e._e()],1),e._v(" "),t("span",{staticClass:"grid-item-text"},[e._v(e._s(i.name))])],1)])})),1)],1)],1),e._v(" "),e.linkFailed&&!e.showShareCode?t("div",{staticClass:"share-header"},[""!==e.prompt?t("p",[e._v("温馨提示：")]):e._e(),e._v(" "),t("p",[e._v(e._s(e.prompt))])]):e._e(),e._v(" "),e.showShareCode?t("div",{staticClass:"share-content"},[t("div",{staticClass:"share-icon"},[e.sharer?t("icon-file",{staticClass:"share-icon-font",attrs:{item:e.shareData,grid:!0,details:!0,"image-url":e.imageUrl,"audio-cover-url":e.audioUrl}}):e._e()],1),e._v(" "),t("div",{staticClass:"share-filename"},[t("span",[e._v(e._s(e.shareData.fileName))])]),e._v(" "),t("div",{staticClass:"share-code"},[t("el-input",{attrs:{placeholder:"请输入提取码",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validShareCode(e.extractionCode)}},model:{value:e.extractionCode,callback:function(t){e.extractionCode=t},expression:"extractionCode"}})],1),e._v(" "),t("div",{staticClass:"share-code-valid"},[t("el-button",{attrs:{type:"primary",disabled:0===e.extractionCode.length},on:{click:function(t){return e.validShareCode(e.extractionCode)}}},[e._v("\n        查看文件\n      ")])],1),e._v(" "),t("div",{staticClass:"share-expire-date"},[t("span",[e._v(e._s(e.shareData.expireDate?"到期时间："+e.shareData.expireDate:"永久有效"))])])]):e._e(),e._v(" "),t("sim-text-preview",{attrs:{file:e.textPreviewRow,shareId:e.shareId,status:e.textPreviewVisible},on:{"update:file":function(t){e.textPreviewRow=t},"update:status":function(t){e.textPreviewVisible=t}}}),e._v(" "),t("image-viewer",{attrs:{fileList:e.fileList,shareId:e.shareId,file:e.imagePreviewRow,status:e.imagePreviewVisible},on:{"update:status":function(t){e.imagePreviewVisible=t}}}),e._v(" "),t("video-preview",{attrs:{file:e.videoPreviewRow,shareId:e.shareId,status:e.videoPreviewVisible},on:{"update:status":function(t){e.videoPreviewVisible=t}}}),e._v(" "),t("office-preview",{attrs:{file:e.officePreviewRow,shareId:e.shareId,status:e.officePreviewVisible},on:{"update:status":function(t){e.officePreviewVisible=t}}}),e._v(" "),e.linkFailed||e.showShareCode?e._e():t("el-divider",{staticClass:"grid-divider",attrs:{"content-position":"center"}},[t("i",{staticClass:"el-icon-folder-opened"}),e._v(" "+e._s(e.summaries)+"\n  ")]),e._v(" "),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next","hide-on-single-page":!0,"current-page":e.pagination.pageIndex,"page-sizes":e.pagination.pageSizes,"page-size":e.pagination.pageSize,total:e.pagination.total},on:{"update:currentPage":function(t){return e.$set(e.pagination,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageIndex",t)},"current-change":e.currentChange}})],1)},a=[],o=(i("f559"),i("a8f9")),r=(i("ac6a"),i("28a5"),i("20d6"),i("6f8e")),s=i("2f62"),l=i("7f29"),c=i("5cfc"),d=i("573f"),u=i("0dcf"),h=function(){var e=this,t=e._self._c;return t("div",{staticClass:"loading"})},p=[],f={name:"AlLoading"},m=f,g=(i("4bb6"),i("2877")),v=Object(g["a"])(m,h,p,!1,null,"913373be",null),b=v.exports,w=i("1000"),y=i("2d53"),x=i("1638"),C=i("ae1f"),k=i("140f"),_=i("2690"),S=i("b311"),L=i.n(S),T=i("fd35"),D=i("1383"),E=i("4360"),F=i("9476"),I={components:{FileTree:F["a"],Logo:D["a"],OfficePreview:T["a"],IconFile:u["a"],BreadcrumbFilePath:d["a"],AlLoading:b,AudioPreview:k["a"],VideoPreview:C["a"],ImageViewer:x["a"],SimTextPreview:y["a"]},data:function(){return{prompt:"文件分享已被撤销",isLoading:!0,fileMenuActive:"",path:this.$route.query.path,showNewFolder:!1,isShowNewFolder:!1,listModeSearch:!1,newFolderName:"新建文件夹",renameFileName:"",searchFileName:"",pathList:[],fileList:[],pagination:{fileId:!1,pageIndex:1,pageSize:256,total:0,pageSizes:[10,20,30,40,50]},indexList:[],clientHeight:500,tableHead:[{name:"",label:"",index:0},{name:"",label:"",index:1},{name:"name",label:"名称",sortable:!0,index:2},{name:"",label:"",index:3},{name:"",label:"",more:!0,index:4},{name:"size",label:"大小",sortable:!0,index:5},{name:"updateDate",label:"修改日期",sortable:!0,index:6}],isJustHideMenus:!1,menusIsMultiple:!1,menus:[],singleMenus:[{iconClass:"menu-open",label:"打开",operation:"open"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-fuzhi",label:"复制下载链接",operation:"copyDownloadUrl"}],singleMenusEdit:[{iconClass:"menu-open",label:"打开",operation:"open"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-fuzhi",label:"复制下载链接",operation:"copyDownloadUrl"}],multipleMenus:[{iconClass:"menu-download",label:"下载",operation:"download"}],multipleRightMenus:[{iconClass:"menu-download",label:"下载",operation:"download"}],rowContextData:{},selectRowData:[],tableLoading:!1,newFolderLoading:!1,renameLoading:!1,menuTriangle:"",cellMouseIndex:-1,editingIndex:-1,dialogMoveOrCopyVisible:!1,directoryTreeData:[],selectTreeNode:{},fileTreeAndNewFolderDisabled:!1,directoryTreeProps:{label:"name",children:"children",isLeaf:"isLeaf"},dragLoop:null,positionX:0,positionY:0,grid:!1,vmode:"list",gridColumnNum:-1,gridColumnWidth:120,gridHoverItemIndex:-1,gridHoverIntermediate:-1,allChecked:!1,summaries:"",shareDialog:!1,shareLink:"",shareFileName:"",generateShareLinkLoading:!0,shareId:this.$route.query.s,currentDirName:"",linkFailed:!0,textPreviewVisible:!1,textPreviewRow:{},imagePreviewRow:{},imagePreviewVisible:!1,videoPreviewRow:{},videoPreviewVisible:!1,officePreviewRow:{},officePreviewVisible:!1,audioPreviewRow:{},audioPreviewVisible:!1,showUpdateDateItem:this.$pc,showSizeItem:this.$pc,sharer:void 0,loginTitle:"",sharerAvatarUrl:"",netdiskName:"鑫达云存储",netdiskLogo:"",showShareCode:!1,shareData:{},extractionCode:"",mountToVisible:!1,mountFileData:[]}},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(s["c"])(["message"])),Object(s["b"])(["name"])),{},{netdiskLogo:function(){return this.$store.state.user.netdiskLogo?this.$store.state.user.netdiskLogo:""},imageUrl:function(){return void 0===this.$store.getters.shareToken?"".concat("/api","/public/s/view/thumbnail?id="):"".concat("/api","/public/s/view/thumbnail?share-token=").concat(this.$store.getters.shareToken,"&id=")},audioUrl:function(){return void 0===this.$store.getters.shareToken?"".concat("/api","/public/s/view/cover?name=").concat(this.sharer.username,"&id="):"".concat("/api","/public/s/view/cover?name=").concat(this.sharer.username,"&share-token=").concat(this.$store.getters.shareToken,"&id=")}}),watch:{message:function(e){"fileSuccess"===e.event&&this.getFileList(),"clickMore"===e.event&&(this.selectRowData=e.data,this.preliminaryRowData())}},created:function(){this.getFileList(),this.getSharer()},mounted:function(){window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1));var e=this;window.onresize=function(){e.loadClientHeight()},this.$route.query.vmode&&(this.vmode=this.$route.query.vmode,this.grid="list"!==this.vmode)},destroyed:function(){window.removeEventListener("popstate",this.goBack,!1)},directives:{focus:{inserted:function(e){e.querySelector("input").focus()}},resize:{bind:function(e,t){var i="",n="";function a(){var a=document.defaultView.getComputedStyle(e);i===a.width&&n===a.height||t.value(),i=a.width,n=a.height}e.__vueSetInterval__=setInterval(a,300)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},methods:{loadClientHeight:function(){this.clientHeight=document.documentElement.clientHeight-200},gridItemHover:function(e,t){this.gridHoverItemIndex=t,this.gridHoverIntermediate=t},gridItemOut:function(e,t){this.gridHoverIntermediate=-1;var i=this;setTimeout((function(){i.gridHoverIntermediate!==i.gridHoverItemIndex&&(i.gridHoverItemIndex=-1)}),10)},clickGridItemCheckBox:function(e,t){this.indexList.includes(t)&&this.$refs.fileListTable.toggleRowSelection(e,!0)},clickGridAllCheckBox:function(){this.indexList.length!==this.fileList.length?this.$refs.checkboxGroup.toggleAll(!0):(this.$refs.checkboxGroup.toggleAll(),this.$refs.fileListTable.clearSelection())},gridItemClick:function(e,t){var i=t.path||t.composedPath&&t.composedPath(),n=i.findIndex((function(e){return"grid-item-checkbox van-checkbox"===e.className}));n>-1||(this.indexList.length<1?e.index!==this.editingIndex&&(this.fileClick(e),this.editingIndex=-1):this.indexList.includes(e.index)?this.$refs.fileListTable.toggleRowSelection(e,!1):this.$refs.fileListTable.toggleRowSelection(e,!0))},containerResize:function(){var e=document.querySelector(".dashboard-container").clientWidth;this.gridColumnNum=Math.round((e-10)/135),this.gridColumnWidth=(e-11*this.gridColumnNum)/this.gridColumnNum-4.5},formatTime:function(e){return Object(l["c"])(e)},formatSize:function(e){return Object(l["b"])(e)},goBack:function(){var e=this.pathList.length-3;this.handleLink(this.pathList[e],e)},handleLink:function(e,t){0===t&&(this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1)),this.getFileList(null,!0),this.$router.push("/s?s=".concat(this.shareId,"&vmode=").concat(this.vmode))),e&&e.fileId&&(this.accessShareOpenDir(e.fileId),this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1)))},changeVmode:function(){this.grid=!this.grid,this.vmode="list",this.grid&&(this.vmode="grid");this.$router.push("/s?s=".concat(this.shareId,"&vmode=").concat(this.vmode))},accessShareOpenDir:function(e){var t=this;this.tableLoading=!0,c["a"].accessShareOpenDir({share:this.shareId,fileId:e,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(i){t.isLoading=!1,t.fileList=i.data,t.loadClientHeight(),t.listModeSearch=!0,t.pagination.fileId=e,t.pagination["total"]=i.count,t.$nextTick((function(){t.containerResize(),t.tableLoading=!1,t.linkFailed=!1}))})).catch((function(e){}))},getFileList:function(e,t){var i=this;this.tableLoading=!0,c["a"].accessShare({share:this.shareId,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(n){i.isLoading=!1,Object.getPrototypeOf(n.data)===String.prototype?i.prompt="该链接已失效":(n.data.isPrivacy?(i.showShareCode=!0,i.shareData=n.data):(i.fileList=n.data,i.fileList.map((function(e,t){e.index=t}))),i.fileList.length>0&&!i.fileList[0].isPrivacy?E["a"].dispatch("user/resetShareToken").then((function(){i.loadShareFileList(e,t,n.count)})):i.loadShareFileList(e,t,n.count))})).catch((function(){i.tableLoading=!1,i.linkFailed=!0,i.isLoading=!1}))},loadShareFileList:function(e,t,i){var n=this;if(this.loadClientHeight(),this.listModeSearch=!1,this.listModeSearchOpenDir=!1,this.pagination["total"]=i,this.$nextTick((function(){n.containerResize(),n.tableLoading=!1,n.linkFailed=!1})),!e){var a=this.fileList[0].path.split("/");this.currentDirName=a[a.length-2]}this.$nextTick((function(){if(n.containerResize(),n.tableLoading=!1,n.linkFailed=!1,!e){var i={};i["folder"]=n.currentDirName,i["index"]=n.pathList.length,t||n.pathList.push(i)}}))},getSharer:function(){var e=this;c["a"].getSharer({shareId:this.shareId}).then((function(t){e.sharer=t.data,e.setLoginTitle(),t.data&&(e.sharerAvatarUrl=window.location.origin+e.imageUrl+t.data.avatar,e.sharer.netdiskName&&(e.netdiskName=e.sharer.netdiskName),e.sharer.netdiskLogo&&(e.netdiskLogo=e.sharer.netdiskLogo),e.audioUrl="".concat("/api","/public/s/view/cover?name=").concat(e.sharer.username,"&id="),e.$store.dispatch("user/setLogo",{netdiskName:e.netdiskName,netdiskLogo:e.netdiskLogo}))}))},setLoginTitle:function(){this.$store.getters.token?this.sharer.userId===this.$store.getters.userId?this.loginTitle="":this.loginTitle="挂载到我的云盘":this.loginTitle="登录"},currentChange:function(e){this.pagination.pageIndex=e,this.pagination.fileId?this.accessShareOpenDir(this.pagination.fileId):this.getFileList(!0)},getSummaries:function(e){var t=[];return t[2]=this.getShowSumFileAndFolder(this.fileList),this.summaries=t[2],t},getShowSumFileAndFolder:function(e){var t=0,i=0,n=0;e.forEach((function(e){e.isFolder?t+=1:i+=1,n+=e.size}));var a="";t>0&&(a=t+"个文件夹");var o="";return i>0&&(o=i+"个文件"),a+" "+o+this.getShowSumSize(n)},getShowSumSize:function(e){var t="";return e>0&&(t="  共"),t+=e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"K":e>=1048576&&e<1073741824?(e/1048576).toFixed(2)+"M":(e/1073741824).toFixed(2)+"G",t},handleSelectionChange:function(e){var t=this;this.selectRowData=e;var i=0;this.indexList=[];var n,a=Object(o["a"])(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;i+=r.size,this.indexList.push(r.index)}}catch(p){a.e(p)}finally{a.f()}e.forEach((function(e){t.$refs.fileListTable.toggleRowSelection(e,!0)}));var s=this.tableHead[2],l=this.tableHead[4],c=this.tableHead[5],d=this.tableHead[6];if(this.selectRowData.length>0){var u=this.getShowSumFileAndFolder(e),h=this.getShowSumSize(i);s.label=u,s.sortable=!1,l.name="more",c.label=h,c.sortable=!1,d.label="",d.sortable=!1,this.menusIsMultiple=!0,this.rowContextData=e[0]}else s.label="名称",s.sortable=!0,l.name="",c.label="大小",c.sortable=!0,d.label="修改日期",d.sortable=!0;this.indexList.length===this.fileList.length?this.allChecked=!0:this.allChecked=!1},rowRed:function(e){e.row,e.column;var t=e.rowIndex,i=e.columnIndex;if(this.indexList.length<1&&2===i&&this.cellMouseIndex===t)return{cursor:"pointer",color:"#19ACF9"};for(var n=0;n<this.indexList.length;n++)if(t===this.indexList[n])return{backgroundColor:"#baebff91",cursor:"default"}},tableRowClassName:function(e){var t=e.row,i=e.rowIndex;t.index=i},preliminaryRowData:function(e){e&&(this.rowContextData=e);this.rowContextData.isFavorite},cellMouseEnter:function(e){-1===this.editingIndex&&this.indexList.length<1&&(this.cellMouseIndex=e.index)},cellMouseLeave:function(){this.cellMouseIndex=-1},cellClick:function(e,t){if(clearTimeout(this.Loop),-1===this.editingIndex){var i=t.index;0===i&&this.$refs.fileListTable.toggleRowSelection(e),2===i&&this.indexList.length<1&&e.index!==this.editingIndex&&(this.fileClick(e),this.editingIndex=-1),this.indexList.length>0&&i>0&&this.$refs.fileListTable.toggleRowSelection(e)}},moreOperation:function(e){this.menusIsMultiple=!0,this.menus=this.multipleMenus,this.showOperationMenus(e)},moreClick:function(e,t){this.menusIsMultiple=!1,e.contentType&&e.contentType.includes("text")?this.menus=this.singleMenusEdit:this.menus=this.singleMenus,this.preliminaryRowData(e),this.showOperationMenus(t)},rowContextmenu:function(e){this.indexList.includes(e.index)?(this.menusIsMultiple=!0,this.menus=this.multipleRightMenus):(this.menusIsMultiple=!1,e.contentType&&e.contentType.includes("text")?this.menus=this.singleMenusEdit:this.menus=this.singleMenus,this.preliminaryRowData(e)),event.preventDefault(),this.menuTriangle="";var t={};t.pageX=event.pageX+5,t.pageY=event.pageY+2,t.clientX=event.clientX+5,t.clientY=event.clientY+2,this.$refs.contextShow.showMenu(event)},showOperationMenus:function(e){var t={};document.body.scrollHeight-e.pageY>400?(this.menuTriangle="menu-triangle-top",t.pageX=e.pageX-78,t.pageY=e.pageY+30,t.clientX=e.clientX+78,t.clientY=e.clientY+30):(this.menuTriangle="menu-triangle-bottom",t.pageX=e.pageX-78,t.pageY=e.pageY-350,t.clientX=e.clientX+78,t.clientY=e.clientY-350),this.isJustHideMenus||this.$refs.contextShow.showMenu(t)},show:function(){},hide:function(){var e=this;this.isJustHideMenus=!0,setTimeout((function(){e.isJustHideMenus=!1}),100)},menusOperations:function(e){switch(e){case"open":this.fileClick(this.rowContextData);break;case"download":this.downloadFile();break;case"copyDownloadUrl":this.downloadFile(!0);break}this.$refs.contextShow.hideMenu()},loginOrMount:function(){if(this.$store.getters.token){this.mountToVisible=!0}else this.$router.push({path:"/login",query:{redirect:this.$route.fullPath}})},mountFolder:function(){var e=this;c["a"].mountFolder({userId:this.$store.getters.userId,shareId:this.shareId,fileId:this.selectTreeNode.id}).then((function(){e.$message.success("挂载成功"),e.mountToVisible=!1}))},fileTreeAndNewFolder:function(){this.$refs.fileTreeMount.fileTreeAndNewFolder(this.selectTreeNode)},onTreeNodeClick:function(e){this.fileTreeAndNewFolderDisabled=e.hasOwnProperty("newFolder"),this.selectTreeNode=e,this.selectTreeNode.showName=' "'+e.name+'"'},downloadFile:function(e){var t=0;if(this.indexList.length>0?this.selectRowData.forEach((function(e){t+=e.size})):t=this.rowContextData.size,t>0){var i=[];if(this.menusIsMultiple?this.selectRowData.forEach((function(e){i.push(e.id)})):i.push(this.rowContextData.id),i.length>1||this.rowContextData.isFolder)return void(e?this.copyDownloadLink(_["a"].publicPackageDownloadUrl(this.shareId,i,this.$store.getters.shareToken)):_["a"].publicPackageDownload(this.shareId,i,this.$store.getters.shareToken));e?this.rowContextData.isShare?this.copyDownloadLink(window.location.origin+_["a"].previewUrl(this.sharer.username,this.rowContextData,void 0,this.$store.getters.shareToken)):this.copyDownloadLink(_["a"].publicPackageDownloadUrl(this.shareId,i,this.$store.getters.shareToken)):_["a"].publicDownload(this.shareId,this.rowContextData,this.$store.getters.shareToken)}else this.$message({message:"所选文件为空",type:"warning"})},copyDownloadLink:function(e){var t=this,i=new L.a(".menu-option",{text:function(){return e}});i.on("success",(function(e){t.$message({message:"复制成功",type:"success",duration:1e3}),i.destroy()})),i.on("error",(function(e){t.$message({message:"该浏览器不支持自动复制",type:"warning",duration:1e3}),i.destroy()}))},fileClick:function(e){if(window.shareId=this.shareId,e.isFolder){var t={};t["folder"]=e.name,t["fileId"]=e.id,t["index"]=this.pathList.length,this.pathList.push(t),this.pagination.pageIndex=1,this.$router.push("?s=".concat(this.shareId,"&vmode=").concat(this.vmode)),this.accessShareOpenDir(e.id)}else{if(e.contentType.startsWith("image"))return this.imagePreviewVisible=!0,void(this.imagePreviewRow=e);if(w["c"].simText.includes(e.suffix))return this.textPreviewRow=e,void(this.textPreviewVisible=!0);if(e.contentType.indexOf("video")>-1)return this.videoPreviewVisible=!0,void(this.videoPreviewRow=e);if(e.contentType.indexOf("audio")>-1)return void this.$store.dispatch("updateMessage",{event:"onAddAudio",data:{row:e,audioCoverUrl:this.audioCoverUrl}});if(e.contentType.indexOf("office")>-1||["pdf","PDF","csv","drawio","mind"].includes(e.suffix))return this.officePreviewVisible=!0,void(this.officePreviewRow=e);_["a"].publicPreview(e,this.shareId,this.$store.getters.shareToken)}},validShareCode:function(e){var t=this;this.$store.dispatch("user/validShareCode",{shareId:this.shareId,shareCode:e}).then((function(){t.showShareCode=!1,t.getFileList()}))}}},M=I,N=(i("d935"),Object(g["a"])(M,n,a,!1,null,"462ab95b",null));t["default"]=N.exports},4994:function(e,t,i){"use strict";i("2337")},"4bb6":function(e,t,i){"use strict";i("3279")},"4d8d":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-card",{staticClass:"box-card table-search-header"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"box-card-header"},[t("el-form",{ref:"queryForm",staticClass:"search-form",attrs:{size:"medium","label-width":"77px",model:e.queryCondition},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-row",{attrs:{gutter:10}},[e.isLoginType?e._e():t("el-col",{attrs:{sm:12,md:e.isLoginType?8:4}},[t("el-form-item",{attrs:{label:"日志类型:"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.isLoginType,placeholder:"请选择日志类型"},on:{change:e.selectType},model:{value:e.typeValue,callback:function(t){e.typeValue=t},expression:"typeValue"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:e.isLoginType?8:5}},[t("el-form-item",{attrs:{label:"账号:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.username,callback:function(t){e.$set(e.queryCondition,"username",t)},expression:"queryCondition.username"}})],1)],1),e._v(" "),e.isLoginType?e._e():t("el-col",{attrs:{sm:12,md:e.isLoginType?8:5}},[t("el-form-item",{attrs:{label:"ip:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.ip,callback:function(t){e.$set(e.queryCondition,"ip",t)},expression:"queryCondition.ip"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:e.isLoginType?8:5}},[t("el-form-item",{attrs:{label:"时间:",prop:"logTime"}},[t("el-date-picker",{attrs:{size:"medium",type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.pickerValue,callback:function(t){e.pickerValue=t},expression:"pickerValue"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:e.isLoginType?8:5}},[t("div",{staticClass:"el-form-actions"},[t("el-radio-group",{attrs:{size:"medium"},on:{change:e.queryLogList},model:{value:e.queryCondition.excludeUsername,callback:function(t){e.$set(e.queryCondition,"excludeUsername",t)},expression:"queryCondition.excludeUsername"}},[t("el-radio-button",{attrs:{label:void 0}},[e._v("所有人")]),e._v(" "),t("el-radio-button",{attrs:{label:"other"}},[e._v("其他人")])],1),e._v(" "),t("el-button",{staticClass:"card-btn-icon",attrs:{size:"medium",icon:"el-icon-search",type:"primary"},on:{click:e.queryLogList}},[e._v("查询\n                ")])],1)])],1)],1)],1)]),e._v(" "),t("table-list",{ref:"tableList",attrs:{"less-client-height":245,tableData:e.dataList,loading:e.loading,hasSelection:!1,tableHeader:e.tableHeader,"page-index":e.pageIndex,pagination:e.pagination},on:{pageChange:e.pageChange,sizeChange:e.pageChange,sortChange:e.sortChange}})],1)],1)},a=[],o=i("6f8e"),r=i("b775"),s=(i("4328"),{logList:function(e){return Object(r["a"])({url:"/log/list",method:"get",params:e})}}),l=i("7c83"),c={name:"LogList",components:{TableList:l["a"]},props:{type:{type:String,default:""},tableHeader:{type:Array,default:[]}},data:function(){return{dataList:[],loading:!1,pageIndex:1,pagination:{pageIndex:1,pageSize:10,pageTotal:0},options:[{value:"LOGIN",label:"登录"},{value:"BROWSE",label:"足迹👣"},{value:"OPERATION",label:"操作"},{value:"ARTICLE",label:"文章"},{value:"WEBDAV",label:"WebDAV"}],typeValue:this.type,isLoginType:"LOGIN"===this.type,queryCondition:{excludeUsername:"other",username:void 0,ip:void 0,type:this.type,startTime:void 0,endTime:void 0},pickerValue:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]}}},mounted:function(){this.getLogList()},methods:{sortChange:function(e){var t=e.backData;this.queryCondition.sortProp=t.prop,this.queryCondition.sortOrder=t.order,this.queryLogList()},pageChange:function(e){this.pagination=e.backData,this.getLogList()},selectType:function(){this.queryCondition.type=this.typeValue,"ARTICLE"===this.typeValue?(this.tableHeader[0].disabled=!0,this.tableHeader[1].disabled=!0,this.tableHeader[3].disabled=!0,this.tableHeader[5].minWidth=200):(this.tableHeader[0].disabled=!1,this.tableHeader[1].disabled=!1,this.tableHeader[3].disabled=!1,this.tableHeader[5].minWidth=105),this.queryLogList()},queryLogList:function(){this.$refs.tableList.initPageIndex(),this.getLogList()},getLogList:function(){var e=this;null!=this.pickerValue&&this.pickerValue.length>0&&(this.queryCondition.startTime=this.pickerValue[0].getTime(),this.queryCondition.endTime=this.pickerValue[1].getTime()),this.loading=!0,s.logList(Object(o["a"])({page:this.pagination.pageIndex,pageSize:this.pagination.pageSize},this.queryCondition)).then((function(t){e.dataList=t.data,e.pagination.pageTotal=t.count,e.loading=!1}))}}},d=c,u=(i("c111"),i("2877")),h=Object(u["a"])(d,n,a,!1,null,"0158a2bf",null);t["default"]=h.exports},"4dd3":function(e,t,i){},"4e19":function(e,t,i){},"4efd":function(e,t,i){"use strict";i("d86c")},5116:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF0AAABKCAIAAABWwM+3AAAAq0lEQVR4nO3QsRHAIBDAsJD9d34GwD0U0gQ+r5n5OPy3Ax7lS/Ol+dJ8ab40X5ovzZfmS/Ol+dJ8ab40X5ovzZfmS/Ol+dJ8ab40X5ovzZfmS/Ol+dJ8ab40X5ovzZfmS/Ol+dJ8ab40X5ovzZfmS/Ol+dJ8ab40X5ovzZfmS/Ol+dJ8ab40X5ovzZfmS/Ol+dJ8ab40X5ovzZfmS/Ol+dJ8ab40X5ovzZe2AZ0NA5FzKaYlAAAAAElFTkSuQmCC"},"542f":function(e,t,i){},"56a6":function(e,t,i){e.exports=i.p+"static/img/emptyfile_intro.6df1f625.jpeg"},5769:function(e,t,i){},5792:function(e,t,i){},"588b":function(e,t,i){},"5caa":function(e,t,i){"use strict";i("c6b1")},"5d88":function(e,t,i){var n={"./Favoritestarrate.svg":"ba29","./add-file.svg":"cb53","./audio.svg":"5b8d","./back.svg":"c557","./breadcrumb-right.svg":"16b5","./cancel-share.svg":"5c1e","./close.svg":"7710","./contents.svg":"6e48","./dashboard.svg":"f782","./docment.svg":"29ad","./document.svg":"fd28","./example.svg":"30c3","./eye-open.svg":"d7ec","./eye.svg":"4df5","./file-Ds-store.svg":"c5e8","./file-add.svg":"6ab0","./file-bat.svg":"d3b9","./file-class.svg":"b7ab","./file-cmake.svg":"4fee","./file-conf.svg":"fa5a","./file-cpp.svg":"33e1","./file-css.svg":"270b","./file-csv.svg":"8d1b","./file-dart.svg":"2f38","./file-db.svg":"d0a2","./file-dmg.svg":"a240","./file-docxf.svg":"393d","./file-drawio.svg":"6a4e","./file-excel.svg":"bd70","./file-exe.svg":"49f2","./file-factories.svg":"f3c5","./file-gitignore.svg":"47ff","./file-go.svg":"b909","./file-gradle.svg":"00d8","./file-gzip.svg":"bdb5","./file-h.svg":"5623","./file-html.svg":"e9ad","./file-idea.svg":"0ab8","./file-iso.svg":"70a9","./file-jar.svg":"fd7c","./file-java.svg":"2870","./file-js.svg":"6b09","./file-json.svg":"b7f1","./file-key.svg":"09e8","./file-log.svg":"1f55","./file-md.svg":"f421","./file-mind.svg":"5399","./file-ncm.svg":"60c7","./file-pdf.svg":"63f3","./file-pem.svg":"2afe","./file-php.svg":"13a8","./file-pkg.svg":"f4b7","./file-plist.svg":"77a2","./file-ppt.svg":"1d06","./file-properties.svg":"9339","./file-python.svg":"0c41","./file-shell.svg":"3f78","./file-swift.svg":"00b4","./file-tar.svg":"cf7d","./file-txt.svg":"374b","./file-upload.svg":"c9b7","./file-vue.svg":"2bc8","./file-word.svg":"5743","./file-xls.svg":"e6ed","./file-xml.svg":"e155","./file-xsl.svg":"7f33","./file-yml.svg":"3671","./file.svg":"b8b2","./folder-128.svg":"5911","./folder-add.svg":"2129","./folder-upload.svg":"c04d","./folder.svg":"d079","./form.svg":"eb1b","./fullscreen.svg":"9921","./gongxiangzhongxin.svg":"3886","./home.svg":"6bbe","./image.svg":"8736","./jmal-cloud.svg":"0340","./link.svg":"18f0","./loading-image-error.svg":"bd9b","./md-list.svg":"2edc4","./md.svg":"304e","./menu-addtab.svg":"2c60","./menu-ascending.svg":"d129","./menu-copy.svg":"f613","./menu-descending.svg":"8e8c","./menu-deselect.svg":"3a0f","./menu-details.svg":"8ec2","./menu-download.svg":"8d45","./menu-edit1.svg":"ce0b","./menu-empty.svg":"3d2e","./menu-favorite-hover.svg":"aeb7","./menu-favorite.svg":"f17e","./menu-grid.svg":"4195","./menu-list.svg":"7f6d","./menu-null.svg":"8707","./menu-open.svg":"00bd","./menu-point.svg":"c784","./menu-remove.svg":"910d","./menu-rename.svg":"f1ae","./menu-select.svg":"cdac","./menu-unfavorite-hover.svg":"83bf","./menu-unfavorite.svg":"b554","./menu-unselect.svg":"21bd","./more.svg":"3dd0","./nested.svg":"dcf8","./normalscreen.svg":"7a3a","./open-folder.svg":"03fd","./password.svg":"2a3d","./release.svg":"7186","./search.svg":"8e8d","./share.svg":"5306","./tab-favorite.svg":"4a51","./tab-folder.svg":"93d7","./tab-recently.svg":"44b8","./tab-setting.svg":"46d6","./table.svg":"47f1","./tree.svg":"93cd","./user.svg":"b3b5","./video.svg":"8f2b","./warring.svg":"c1c0","./widget-email.svg":"5863","./widget-github.svg":"ca9d","./widget-music.svg":"2e4a","./widget-subscription.svg":"fba5","./yes.svg":"8d65","./zip.svg":"8aa6","./ziyuan.svg":"adc6","./zuijinyuedu.svg":"d565"};function a(e){var t=o(e);return i(t)}function o(e){var t=n[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id="5d88"},"5def":function(e,t,i){"use strict";i("f2c7")},"5f47":function(e,t,i){"use strict";i("f2e7")},"61cb":function(e,t,i){"use strict";i("fea9")},"61ee":function(e,t,i){"use strict";i("3b28")},6613:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{defaultGrid:!0,sortable:e.sortable,orderCustom:!0,defaultSort:e.sortable,queryCondition:e.queryCondition,contextMenus:e.contextMenus}})],1)},a=[],o=i("c41c"),r={components:{ShowFile:o["default"]},data:function(){return{sortable:{prop:"name",order:"ascending"},queryCondition:{tagId:void 0},contextMenus:[{label:"查看",operation:"viewMode",child:[{iconClass:this.grid?"":"menu-point",label:"列表",operation:"vmode-list"},{iconClass:this.grid?"menu-point":"",label:"缩略图",operation:"vmode-grid"}]},{label:"排列方式",operation:"arrangement",child:[{label:"名称",operation:"orderName",orderProp:"name"},{label:"大小",operation:"orderSize",orderProp:"size"},{label:"日期",operation:"orderUpdateDate",orderProp:"updateDate"}]},{label:"刷新",operation:"refresh"},{divider:!0,operation:"divider"},{label:"新建",operation:"create",child:[{label:"文件夹",operation:"createFolder",iconClass:"folder"},{divider:!0,operation:"divider"},{label:"文本",operation:"createTextFile",iconClass:"file-txt"},{label:"思维导图",operation:"createMinderFile",iconClass:"file-mind"},{label:"流程图",operation:"createDrawioFile",iconClass:"file-drawio"},{label:"Word",operation:"createWordFile",iconClass:"file-word"},{label:"Excel",operation:"createExcelFile",iconClass:"file-excel"},{label:"PPT",operation:"createPPTFile",iconClass:"file-ppt"}]}]}},mounted:function(){this.$route.query.tagId&&(this.queryCondition.tagId=this.$route.query.tagId)},destroyed:function(){}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"30174f0e",null);t["default"]=c.exports},6854:function(e,t,i){},"6ab7":function(e,t,i){},"71e9":function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"share-empty"},[t("div",{staticClass:"share-empty-icon"},[e.emptyShare?t("img",{ref:"image",staticStyle:{"max-width":"100%"},attrs:{src:i("87d4"),alt:""}}):e._e(),e._v(" "),e.emptyShare?e._e():t("img",{ref:"image",staticStyle:{"max-width":"100%"},attrs:{src:i("56a6"),alt:""}})]),e._v(" "),t("p",{staticClass:"share-empty-status"},[e._v("\n      "+e._s(e.emptyStatus)+"\n    ")])])])},a=[],o={name:"EmptyFile",props:{emptyImgUrl:{type:String,default:"~@/assets/img/emptyfile_intro.jpeg"},emptyStatus:{type:String,default:"空空如也~"},emptyShare:{type:Boolean,default:!1}},created:function(){},data:function(){return{}},methods:{sourceImg:function(){return"~@/assets/img/emptyfile_intro.jpeg"}}},r=o,s=(i("736c"),i("2877")),l=Object(s["a"])(r,n,a,!1,null,"46eb68b5",null);t["a"]=l.exports},"72d3":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("van-list",[t("van-sticky",{attrs:{"offset-top":0}},[t("van-nav-bar",{attrs:{title:"文件上传列表","left-text":"返回","left-arrow":""},on:{"click-left":e.onClickLeft}})],1),e._v(" "),t("ul",{staticClass:"file-list"},[e._l(e.fileList,(function(e){return t("li",{key:e.id},[t("uploader-file",{ref:"files",refInFor:!0,class:"file_"+e.id,attrs:{file:e,list:!0}})],1)})),e._v(" "),e.fileList.length?e._e():t("div",{staticClass:"no-file"},[t("van-empty",{attrs:{description:"暂无待上传文件"}})],1)],2)],1)],1)},a=[],o=i("0dcf"),r=i("4360"),s={components:{IconFile:o["a"]},data:function(){return{fileList:[]}},mounted:function(){window.uploader&&(this.fileList=window.uploader.fileList)},destroyed:function(){window.removeEventListener("popstate",this.goBack,!1)},methods:{onClickLeft:function(){this.$router.push("/_m"),r["a"].dispatch("updateMessage",{event:"uploadFileListBack",data:!0})}}},l=s,c=(i("3e79"),i("2877")),d=Object(c["a"])(l,n,a,!1,null,"b966330e",null);t["default"]=d.exports},"736c":function(e,t,i){"use strict";i("ec0f")},"74e6":function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"container"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"img-container"},[t("div",{staticClass:"img-region"},[t("img",{ref:"image",staticStyle:{"max-width":"100%"},attrs:{src:e.sourceImg,alt:""}})]),e._v(" "),t("div",{staticClass:"button-region"},[t("el-button",{attrs:{type:"primary"},on:{click:e.sureSava}},[e._v("保存头像")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.selectImg.id,expression:"selectImg.id"}],attrs:{type:"primary"},on:{click:function(t){return e.noCropSave(e.selectImg.id)}}},[e._v("不剪裁保存")])],1)]),e._v(" "),t("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),e._m(0)],1)])},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"avatar-preview"},[t("h3",[e._v("头像预览")]),e._v(" "),t("div",{staticClass:"before big"}),e._v(" "),t("span",[e._v("大头像100*100")]),e._v(" "),t("div",{staticClass:"before small margin-top"}),e._v(" "),t("span",[e._v("小头像55*55")])])}],o=(i("a481"),i("7f7f"),i("ed66"),i("bab4")),r=i.n(o),s=i("2690"),l={name:"CropperDialog",components:{},props:{fileImg:{type:Blob,default:{}},selectImg:{type:Object,default:{}},avatar:{type:String,defalut:""}},data:function(){return{loading:!0,cropper:null,filename:"",sourceImg:""}},mounted:function(){var e=this;this.$nextTick((function(){e.initCropper(),e.loading=!1,e.changImg(e.fileImg),e.setSelectImg(e.selectImg)}))},methods:{initCropper:function(){this.cropper=new r.a(this.$refs.image,{responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,autoCrop:!0,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,preview:".before",aspectRatio:1,viewMode:1})},setSelectImg:function(e){if(e.id){this.loading=!0,this.cropper.reset();var t=s["a"].previewUrl(this.$store.state.user.name,e,this.$store.getters.token)+"&o=crop&w=1024";this.sourceImg=t,this.cropper.replace(t),this.loading=!1}},changImg:function(e){if(this.filename=e.name,e.size>0){this.loading=!0,this.cropper.reset();var t=this,i=new FileReader;i.readAsDataURL(e),i.onload=function(){t.cropper.replace(i.result),t.loading=!1}}},sureSava:function(){var e=this,t=this.cropper.getCroppedCanvas({maxWidth:1204,maxHeight:1024,fillColor:"#FFF",imageSmoothingEnabled:!0,imageSmoothingQuality:"high"}),i=t.toDataURL("image/jpeg");t.toBlob((function(t){t.name=e.filename,e.$emit("croppedCanvas",i,t)}))},noCropSave:function(e){this.$emit("noCropSave",e)}}},c=l,d=(i("2ba9"),i("2877")),u=Object(d["a"])(c,n,a,!1,null,"59f3edbd",null);t["a"]=u.exports},"79f0":function(e,t,i){e.exports=i.p+"static/img/beian.d0289dc0.png"},"7abe":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{defaultGrid:!0,orderCustom:!0,contextMenus:e.contextMenus,sortable:e.sortable}})],1)},a=[],o=i("c41c"),r={components:{ShowFile:o["default"]},data:function(){return{sortable:{prop:"name",order:"ascending"},contextMenus:[{label:"查看",operation:"viewMode",child:[{iconClass:this.grid?"":"menu-point",label:"列表",operation:"vmode-list"},{iconClass:this.grid?"menu-point":"",label:"缩略图",operation:"vmode-grid"}]},{label:"排列方式",operation:"arrangement",child:[{label:"名称",operation:"orderName",orderProp:"name"},{label:"大小",operation:"orderSize",orderProp:"size"},{label:"日期",operation:"orderUpdateDate",orderProp:"updateDate"}]},{label:"刷新",operation:"refresh"},{divider:!0,operation:"divider"},{label:"新建",operation:"create",child:[{label:"文件夹",operation:"createFolder",iconClass:"folder"},{divider:!0,operation:"divider"},{label:"文本",operation:"createTextFile",iconClass:"file-txt"},{label:"思维导图",operation:"createMinderFile",iconClass:"file-mind"},{label:"流程图",operation:"createDrawioFile",iconClass:"file-drawio"},{label:"Word",operation:"createWordFile",iconClass:"file-word"},{label:"Excel",operation:"createExcelFile",iconClass:"file-excel"},{label:"PPT",operation:"createPPTFile",iconClass:"file-ppt"}]}]}}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"d36c6242",null);t["default"]=c.exports},"7c83":function(e,t,i){"use strict";i("7f7f"),i("d263");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-temp"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tableData",attrs:{data:e.tableData,"max-height":e.tableMaxHeight,"row-key":"id",border:e.border,size:"medium",fit:"","highlight-current-row":"","default-expand-all":e.isExpand,"tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"selection-change":e.handleSelectionChange,"sort-change":e.sortChange}},[e.hasSelection?t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),t("el-table-column",{attrs:{type:"index",label:"",align:"center",fixed:""}}),e._v(" "),e._l(e.tableHeader,(function(i,n){return i.disabled?e._e():t("el-table-column",{key:n,attrs:{prop:i.prop,label:i.label,fixed:i.fixed,width:i.width,"min-width":i.minWidth,align:i.align||"center","sort-orders":["ascending","descending"],sortable:i.sortable,"show-overflow-tooltip":!0,"tooltip-effect":"dark"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n          "+e._s(i.formatData||i.active?"":n.row[i.prop])+"\n          "),i.active?t("div",e._l(i.active,(function(i,a){return t("el-button",{key:a,style:{color:i.color},attrs:{type:i.type||"text",icon:i.icon,size:"medium"},on:{click:function(e){return i.handle(n.row)}}},[e._v(e._s(i.name))])})),1):e._e(),e._v(" "),i.formatData?t("div",[i.tag?t("div",e._l(i.formatData(n.row[i.prop]),(function(i){return t("el-tag",{key:i.name,attrs:{size:"mini",type:i.type}},[e._v(e._s(i.name))])})),1):i.icon?t("div",[t("svg-icon",{attrs:{"icon-class":i.formatData(n.row[i.prop])}})],1):t("div",[t("span",{attrs:{else:""}},[e._v(e._s(i.formatData(n.row[i.prop])||n.row[i.prop]))])])]):e._e()]}}],null,!0)})}))],2),e._v(" "),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"hide-on-single-page":"",background:"",layout:"total,sizes, prev, pager, next, jumper","current-page":e.pagination.pageIndex,"page-sizes":[20,30,50,100],"page-size":e.pagination.pageSize,total:e.pagination.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1)],1)},a=[],o=(i("ac6a"),i("c5f6"),{name:"TableList",props:{tableData:{type:Array,default:function(){return[]}},lessClientHeight:{type:Number,default:0},tableHeader:{type:Array,default:function(){return[]}},border:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},hasSelection:{type:Boolean,default:!0},isExpand:{type:Boolean,default:!0},pagination:{type:Object,default:{pageIndex:0,pageSize:15,pageTotal:0}}},data:function(){return{tableMaxHeight:document.documentElement.clientHeight,multipleSelection:[]}},mounted:function(){this.setMaxHeight(!0);var e=this;window.onresize=function(){e.setMaxHeight()}},methods:{setMaxHeight:function(e){this.tableMaxHeight=document.documentElement.clientHeight-this.lessClientHeight,e&&this.$set(this.pagination,"pageSize",10+Math.round((this.tableMaxHeight-500)/45))},handleSelectionChange:function(e){this.multipleSelection=e,this.$emit("selectFun",{backData:this.multipleSelection})},initPageIndex:function(){this.$set(this.pagination,"pageIndex",1)},handleSizeChange:function(e){this.$set(this.pagination,"pageSize",e),this.$emit("sizeChange",{backData:this.pagination})},handlePageChange:function(e){this.$set(this.pagination,"pageIndex",e),this.$emit("pageChange",{backData:this.pagination})},handleActive:function(e,t,i){this.$router.push({path:"/"+t,query:{id:e[i]}})},sortChange:function(e){this.$emit("sortChange",{backData:e})},handleExpand:function(){var e=this;this.$nextTick((function(){e.forArr(e.tableData,e.isExpand)}))},forArr:function(e,t){var i=this;e.forEach((function(e){i.$refs.tableData.toggleRowExpansion(e,t),e.children&&i.forArr(e.children,t)}))}}}),r=o,s=(i("a204"),i("2877")),l=Object(s["a"])(r,n,a,!1,null,"1712006c",null);t["a"]=l.exports},"7cab":function(e,t,i){"use strict";i("d540")},"7e8e":function(e,t,i){"use strict";i("16c6")},"816e":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.vditorLoading,expression:"vditorLoading"}]},[t("div",{staticClass:"article-editor"},[t("div",{staticClass:"editor-left"},[e.currentDarft?t("cite",[e._v("你正在编辑的是保存于 "+e._s(e.file.updateDate)+" 的草稿, 你也可以\n        "),t("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text"},on:{click:e.deleteDraft}},[e._v("删除它")])],1):e._e(),e._v(" "),t("el-header",[t("div",{staticClass:"header-item"},[t("el-input",{staticClass:"articles-title",attrs:{placeholder:"标题"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1),e._v(" "),t("div",{staticClass:"url-slug"},[t("div",[e._v(e._s(e.siteUrl+(e.alonePage?"/o/":"/s/")))]),e._v(" "),t("edit-element",{ref:"editElement",staticClass:"mark-setting-input",style:{minWidth:e.file.slug&&e.file.slug.length>0?"0px":"35px"},attrs:{placeholder:"缩略名","can-edit":""},model:{value:e.file.slug,callback:function(t){e.$set(e.file,"slug",t)},expression:"file.slug"}}),e._v(" "),e.isEdit?t("a",{staticClass:"view-icon",attrs:{title:"预览 "+e.filename,href:e.siteUrl+(e.alonePage?"/o/":"/s/")+(e.file.slug?e.file.slug:e.file.id),target:"_blank"}},[t("svg-icon",{staticClass:"wailian",attrs:{"icon-class":"eye-open"}}),e._v("预览\n          ")],1):e._e()],1)]),e._v(" "),t("el-main",[t("div",{style:{maxHeight:e.clientHeight+"px"},attrs:{id:"vditor"}})])],1),e._v(" "),t("div",{staticClass:"editor-right"},[t("div",{staticClass:"operation"},[t("el-button",{staticClass:"release-button",attrs:{type:"warning",size:"small",loading:e.updating},on:{click:e.saveDraft}},[e._v("保存草稿\n        ")]),e._v(" "),t("el-button",{staticClass:"release-button",attrs:{type:"primary",size:"small",loading:e.updating},on:{click:e.release}},[e._v("发布文章\n        ")])],1),e._v(" "),t("div",{staticClass:"more-setting"},[t("p",{staticClass:"mark-setting-label"},[e._v("发布日期：")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime",size:"medium","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss"},model:{value:e.file.uploadDate,callback:function(t){e.$set(e.file,"uploadDate",t)},expression:"file.uploadDate"}}),e._v(" "),t("p",{staticClass:"mark-setting-label"},[e._v("文章封面：")]),e._v(" "),t("upload-image-input",{attrs:{placeholder:"请输入文章封面大图的url","intput-autosize":{minRows:2,maxRows:6}},model:{value:e.file.cover,callback:function(t){e.$set(e.file,"cover",t)},expression:"file.cover"}}),e._v(" "),e.alonePage?e._e():t("div",[t("p",{staticClass:"mark-setting-label"},[e._v("分类：")]),e._v(" "),t("multiple-tree-select",{ref:"selectTree",staticStyle:{width:"100%"},attrs:{size:"medium",placeholder:"请选择分类",options:e.categories,"select-pack-up":""},model:{value:e.file.categoryIds,callback:function(t){e.$set(e.file,"categoryIds",t)},expression:"file.categoryIds"}})],1),e._v(" "),e.alonePage?e._e():t("div",{staticClass:"setting-tags"},[t("p",{staticClass:"mark-setting-label"},[e._v("标签：")]),e._v(" "),e._l(e.dynamicTags,(function(i){return t("el-tag",{key:i.id,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleClose(i)}}},[e._v("\n            "+e._s(i)+"\n          ")])})),e._v(" "),e.inputVisible?t("el-autocomplete",{ref:"saveTagInput",class:[e.inputNewTagClass,e.inputValueExist?e.inputErrorClass:""],attrs:{size:"small","fetch-suggestions":e.querySearch,"popper-append-to-body":!0,"trigger-on-focus":!1,placeholder:"请输入标签名"},on:{select:e.handleSelect,blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm.apply(null,arguments)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):e._e(),e._v(" "),e.inputValueExist?t("div",{staticClass:"instruction-error"},[e._v("该标签已存在")]):e._e(),e._v(" "),e.inputVisible?e._e():t("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v(" + 新增标签")])],2)],1)])]),e._v(" "),t("el-drawer",{attrs:{visible:e.moreSetting,"append-to-body":!0,"with-header":!1},on:{"update:visible":function(t){e.moreSetting=t}}},[t("div",{staticClass:"more-setting"},[t("h2",[e._v("更多设置")]),e._v(" "),t("p",{staticClass:"mark-setting-label"},[e._v("文章封面：")]),e._v(" "),t("upload-image-input",{model:{value:e.file.cover,callback:function(t){e.$set(e.file,"cover",t)},expression:"file.cover"}})],1)])],1)},a=[],o=(i("ac6a"),i("a481"),i("6762"),i("2fdb"),i("28a5"),i("7f7f"),i("021e")),r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.selectTreeNode.showName,visible:e.visible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.visible=t},close:e.clearTreeNode}},[t("el-tree",{ref:"directoryTree",attrs:{data:e.directoryTreeData,"node-key":"id",props:e.directoryTreeProps,load:e.directoryTreeLoadNode,"highlight-current":!0,"default-expanded-keys":["0"],"render-content":e.renderContent,hight:"100",lazy:""},on:{"node-click":e.treeNodeClick,"node-expand":e.treeNodeExpand}}),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:e.fileTreeAndNewFolder}},[t("i",{staticClass:"el-icon-folder-add"}),e._v("  新建文件夹")]),e._v(" "),e.$slots.footer?t("span",{staticClass:"dialog-footer"},[e._t("footer")],2):e._e(),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.visible=!1}}},[e._v("取 消")])],1)],1)],1)},s=[],l=i("5cfc"),c={name:"DirTree",props:{appendToBody:{type:Boolean,default:!1},currentDir:{type:String,default:"/"},unzip:{type:Boolean,default:!1}},data:function(){return{visible:!1,directoryTreeData:[],selectTreeNode:{},directoryTreeProps:{label:"name",children:"children",isLeaf:"isLeaf"}}},methods:{show:function(){this.visible=!0;var e=this;setTimeout((function(){e.selectTreeNode.showName||(e.selectTreeNode=e.$refs.directoryTree.getCurrentNode(),e.selectTreeNode.showName=e.selectTreeNode.name)}),100)},hide:function(){this.visible=!1},getSelectTreeNode:function(){return this.selectTreeNode},clearTreeNode:function(){var e=this.$refs.directoryTree.getNode("0");e.loaded=!1,e.expanded=!1},directoryTreeLoadNode:function(e,t){var i=null;if(0===e.level){var n=this;return setTimeout((function(){n.$refs.directoryTree.setCurrentKey("0")}),0),t([{id:"0",name:"全部文件"}])}e.level>1&&(i=e.data.id),l["a"].queryFileTree({userId:this.$store.state.user.userId,username:this.$store.state.user.name,fileId:i}).then((function(e){var i=e.data;return t(i)}))},treeNodeClick:function(e,t,i){this.selectTreeNode=e,this.selectTreeNode.showName=e.name},treeNodeExpand:function(e,t,i){},fileTreeAndNewFolder:function(){var e="newFolderNodeKey",t=this.$refs.directoryTree.getNode(e);null!==t&&this.$refs.directoryTree.remove(t);var i=this.$refs.directoryTree.store.currentNode.childNodes,n=this.getNewFileName(i,"新建文件夹"),a={id:e,newFolder:!0,name:n,showName:n,isLeaf:!0};this.$refs.directoryTree.append(a,this.selectTreeNode);setTimeout((function(){var e=document.getElementById("treeInput");e&&(e.value=n,e.focus(),e.select())}),100)},getNewFileName:function(e,t){var i=0,n=[];e.forEach((function(e){n.push(e.name||e.label)}));var a=t;while(n.includes(t))i+=1,t=a+i;return t},renderContent:function(e,t){var i=this,n=t.node,a=t.data;t.store;return a.newFolder?e("span",{class:"custom-tree-node"},[e("span",[e("svg-icon",{attrs:{"icon-class":"folder"}})]),e("span",[e("div",{class:"el-input el-input--mini el-input-tree"},[e("input",{attrs:{type:"text",autocomplete:"on",value:"新建文件夹",id:"treeInput"},class:"el-input__inner"})]),e("button",{attrs:{type:"button","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(){var e="/",t=n.parent.data;t.path&&(e=t.path+t.name+e),l["a"].newFolder({isFolder:!0,filename:encodeURI(a.name),currentDirectory:encodeURI(e),username:i.$store.state.user.name,userId:i.$store.state.user.userId}).then((function(e){a.newFolder=!1,a.id=e.data})).catch((function(){window.event.preventDefault(),window.event.stopPropagation()}))}},class:"el-button el-icon-check el-button--mini el-input-tree-button"}),e("button",{attrs:{type:"button","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(){i.$refs.directoryTree.remove(n),window.event.preventDefault(),window.event.stopPropagation()}},class:"el-button el-icon-close el-button--mini el-input-tree-button"})])]):n.expanded?e("span",{class:"custom-tree-node"},[e("svg-icon",{attrs:{"icon-class":"open-folder"}}),e("span",{style:"margin-left: 5px;"},[n.label]),e("span")]):e("span",{class:"custom-tree-node"},[e("svg-icon",{attrs:{"icon-class":"folder"}}),e("span",{style:"margin-left: 5px;"},[n.label]),e("span")])}}},d=c,u=(i("5def"),i("2877")),h=Object(u["a"])(d,r,s,!1,null,"5aa1cccb",null),p=h.exports,f=i("2690"),m=i("ff41"),g=i.n(m),v=(i("ae60"),i("c405")),b=i("d28d"),w=i("4308"),y=i("f406"),x=i("eea1"),C=["emoji","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","line","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","edit-mode","code-theme","outline","preview","fullscreen",{name:"more",toolbar:["export","both","info","help"]}],k={name:"MarkdownEditor",components:{MultipleTreeSelect:x["a"],EditElement:w["default"],DirTree:p,Vditor:g.a,UploadImageInput:y["a"]},props:{hasChange:{type:Boolean,defalut:!1},alonePage:{type:Boolean,default:!1},siteUrl:{type:String,default:""},isEdit:{type:Boolean,default:!1}},data:function(){return{activeNames:["1"],file:{},editStatus:!1,filename:"",clientHeight:document.documentElement.clientHeight-150,updating:!1,storageLocation:"",selectLocationVisible:!1,moreSetting:!1,contentEditor:"",categories:[],draft:!1,currentDarft:!1,tags:[],dynamicTags:[],inputVisible:!1,inputValue:"",inputValueExist:!1,inputNewTagClass:"input-new-tag",inputErrorClass:"input-error",vditorLoading:!1,releaseTime:void 0}},mounted:function(){this.getMarkdown(),this.categoryTree(),this.getTags()},watch:{file:function(){this.valueHasChanged()},filename:function(e){this.valueHasChanged(),this.$emit("onTitle",e)},storageLocation:function(){this.valueHasChanged()}},computed:{},methods:{reload:function(){this.getMarkdown(!0),this.categoryTree()},querySearch:function(e,t){var i=this.tags,n=e?i.filter((function(t){return 0===t.name.toLowerCase().indexOf(e.toLowerCase())})):[];n=n.map((function(e){return{value:e.name}})),t(n)},handleSelect:function(){this.handleInputConfirm()},valueHasChanged:function(){this.$emit("update:hasChange",!0)},getMarkdown:function(e){var t=this;this.vditorLoading=!0,this.draft=!1,this.$route.query.id?(this.editStatus=!0,o["a"].getMarkdown({mark:this.$route.query.id}).then((function(i){i.data.draft?(t.file=JSON.parse(i.data.draft),i.data.release&&(t.currentDarft=!0)):(t.currentDarft=!1,t.file=i.data),e?(t.contentEditor.setValue(t.file.contentText),t.vditorLoading=!1):t.vditorInit(t.file.contentText),t.content=t.file.contentText,t.filename=t.file.name.split(".md")[0],t.file.tagIds&&t.file.tagIds.length>0&&t.tags&&t.tags.length>0&&t.loadDynamicTags()})).then((function(){var e=t;setTimeout((function(){e.$emit("update:hasChange",!1)}),200)}))):e?this.contentEditor.setValue(""):this.vditorInit("")},moreSet:function(){this.moreSetting=!0},categoryTree:function(){var e=this;v["a"].categoryTree().then((function(t){e.categories=t.data}))},getTags:function(){var e=this;b["a"].tagList().then((function(t){e.tags=t.data,e.file.tagIds&&e.file.tagIds.length>0&&e.loadDynamicTags()}))},loadDynamicTags:function(){var e=this;this.dynamicTags=this.tags.filter((function(t){return e.file.tagIds.includes(t.id)})).map((function(e){return e.name}))},handleClose:function(e){this.dynamicTags.splice(this.dynamicTags.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var e=this;setTimeout((function(){var t=e.inputValue;if(t){if(e.dynamicTags.includes(t))return void(e.inputValueExist=!0);e.dynamicTags.push(t)}e.inputValueExist=!1,e.inputVisible=!1,e.inputValue=""}),250)},vditorInit:function(e){var t=this;this.contentEditor=new g.a("vditor",{height:this.clientHeight,resize:{enable:!0},toolbar:[].concat(C),toolbarConfig:{pin:!0},cdn:"".concat(window.location.origin,"/resource/vditor@3.9.3"),preview:{mode:"both",hljs:{lineNumber:!0}},cache:{enable:!1},after:function(){t.contentEditor.setValue(e),t.vditorLoading=!1},input:function(){t.valueHasChanged()},upload:this.markdownImageUplaod()})},markdownImageUplaod:function(){return{accept:"image/*,.mp3, .wav, .rar",headers:{"jmal-token":this.$store.state.user.token,name:this.$store.state.user.name,username:this.$store.state.user.name,userId:this.$store.state.user.userId},url:"/api/upload-markdown-image",extraData:{username:this.$store.state.user.name,userId:this.$store.state.user.userId},fieldName:"files",filename:function(e){return e.replace(/[^(a-zA-Z0-9\u4e00-\u9fa5\.)]/g,"").replace(/[\?\\/:|<>\*\[\]\(\)\$%\{\}@~]/g,"").replace("/\\s/g","")},format:function(e,t){var i=JSON.parse(t),n={};return i.data.forEach((function(e){n[e.filename]=f["a"].markdownPreviewUrl(e.filepath)})),i.data={},i.data["succMap"]=n,JSON.stringify(i)},error:function(e){console.log("error",e)},linkToImgUrl:"/api/upload-markdown-link-image",linkToImgFormat:function(e){var t=JSON.parse(e);return t.data["url"]=f["a"].markdownPreviewUrl(t.data.url),JSON.stringify(t)}}},save:function(){this.editStatus?this.update():this.add()},imageFilter:function(){return!0},checkParam:function(){return this.filename?!(this.contentEditor.getValue().length<2)||(this.$message.warning("请输入文章内容"),!1):(this.$message.warning("请输入文章标题"),!1)},saveDraft:function(){this.draft=!0,this.update("保存草稿成功")},release:function(){this.draft=!1,this.update()},deleteDraft:function(){var e=this;this.$confirm("您确定要删除这份草稿吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){o["a"].deleteDraft({fileId:e.$route.query.id,username:e.$store.state.user.name}).then((function(){e.$message({message:"草稿已被删除",type:"success",duration:1e3}),e.reload()}))}))},update:function(e){var t=this;if(this.checkParam()&&(this.updating=!0,this.filename)){var i=this.filename+".md";o["a"].editMarkdown({fileId:this.$route.query.id,userId:this.$store.state.user.userId,username:this.$store.state.user.name,filename:encodeURI(i),cover:this.file.cover,isDraft:this.draft,isRelease:this.file.release,isAlonePage:this.alonePage,slug:this.file.slug?this.file.slug:this.filename,categoryIds:this.file.categoryIds,tagNames:this.dynamicTags,currentDirectory:encodeURI(this.path),contentText:this.contentEditor.getValue(),html:this.contentEditor.getHTML(),uploadDate:this.file.uploadDate}).then((function(i){t.$emit("update:hasChange",!1),t.updating=!1,t.$message({message:e||"发布成功",type:"success",duration:1e3}),t.draft?(t.$router.push({path:t.$route.path,query:{operation:"editor",id:i.data}}),t.$emit("onTitle",t.filename),t.reload()):t.$emit("onRelease")})).catch((function(){t.updating=!1}))}},selectDir:function(){this.$refs.dirTree.show()},confirmSelectDir:function(){var e=this.$refs.dirTree.getSelectTreeNode();this.storageLocation=e.path+e.name,this.$refs.dirTree.hide()}}},_=k,S=(i("070b"),Object(u["a"])(_,n,a,!1,null,"42a12bb4",null));t["default"]=S.exports},8281:function(e,t,i){"use strict";i("8642")},"82ca":function(e,t,i){"use strict";i("ebc4")},"84a7":function(e,t,i){"use strict";i("f8f5")},"85d7":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("article-manager",{attrs:{"page-title":e.pageTitle,"new-article-text":e.newArticleText}})],1)},a=[],o=i("b0d9"),r={name:"articlePageManager",components:{ArticleManager:o["default"]},data:function(){return{pageTitle:"管理文章",newArticleText:"写文章"}},computed:{},created:function(){},mounted:function(){},watch:{},methods:{}},s=r,l=(i("61ee"),i("2877")),c=Object(l["a"])(s,n,a,!1,null,"23a763fe",null);t["default"]=c.exports},8642:function(e,t,i){},"86ec":function(e,t,i){},8740:function(e,t,i){"use strict";i.r(t);i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-card",{staticClass:"box-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"box-card-header"},[t("div",{staticClass:"clearfix card-header-back"},[t("span",[e._v("网盘设置")])])])]),e._v(" "),t("div",[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"基本设置",name:"1"}},["1"===e.activeName?t("div",[t("div",{staticClass:"config-itme-label"},[e._v("网盘名称：\n              "),t("el-input",{style:{width:e.inputNetdiskNameWidth+"px"},attrs:{placeholder:"请输入网盘名称",minlength:"1",maxlength:"10",size:"medium"},on:{input:e.inputNetdiskName},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateNetdiskName.apply(null,arguments)}},model:{value:e.netdiskName,callback:function(t){e.netdiskName=t},expression:"netdiskName"}},[e.showAckBtn?t("el-button",{attrs:{slot:"append",icon:"el-icon-check"},on:{click:e.updateNetdiskName},slot:"append"}):e._e()],1)],1),e._v(" "),t("div",{staticClass:"config-itme-label logo"},[e._v("网盘Logo：\n              "),t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[t("Logo",{staticClass:"avatar",attrs:{width:"80"},model:{value:e.logoFileName,callback:function(t){e.logoFileName=t},expression:"logoFileName"}})],1)],1),e._v(" "),t("span",{staticClass:"instruction"},[e._v("点击更换Logo")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("启用webp：\n              "),t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.webpChange},model:{value:e.webpEnabled,callback:function(t){e.webpEnabled=t},expression:"webpEnabled"}})],1),e._v(" "),t("span",{staticClass:"instruction"},[e._v("\n        将图片转换为webp格式存储，在不降低图片质量的情况下，极大降低图片文件的体积，建议开启.\n        "),t("a",{attrs:{href:"https://baike.baidu.com/item/webp%E6%A0%BC%E5%BC%8F",target:"_blank"}},[e._v("什么是webp?")])]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("重建索引：\n              "),t("el-button",{staticClass:"sync-button",attrs:{size:"mini",loading:e.syncLoading,type:"primary"},on:{click:function(t){return e.sync()}}},[t("i",{staticClass:"el-icon-refresh"})]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:e.syncPercent<100,expression:"syncPercent < 100"}]},[e._v(e._s(e.syncPercent)+"%")])],1),e._v(" "),t("span",{staticClass:"instruction"},[e._v("一般用于初始化操作, 将文件数据同步到数据库")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("重置角色、菜单：\n              "),t("el-button",{staticClass:"sync-button",attrs:{size:"mini",loading:e.resetLoading,type:"danger"},on:{click:function(t){return e.resetMenuAndRole()}}},[t("i",{staticClass:"el-icon-refresh-left"})])],1),e._v(" "),t("span",{staticClass:"instruction"},[e._v("一般用于初始化角色、菜单数据")]),e._v(" "),t("div",{staticClass:"config-itme-label"},[e._v("当前版本：v"+e._s(e.currentVersion)+"\n              "),e.newVersion?t("el-badge",{staticClass:"item",attrs:{value:"new"}}):e._e()],1),e._v(" "),t("span",{staticClass:"instruction"},[e._v("最新版本："+e._s(e.newVersion?e.newVersion:"v"+e.currentVersion)+"\n              "),t("a",{attrs:{href:"https://github.com/jamebal/jmal-cloud-view/releases",target:"_blank"}},[e._v("在github上更新（测试）")])])]):e._e()]),e._v(" "),t("el-tab-pane",{staticClass:"setting-tab-panel",attrs:{label:"LDAP认证",name:"2"}},["2"===e.activeName?t("div",[t("el-form",{ref:"form",staticStyle:{width:"450px"},attrs:{rules:e.rules,model:e.ldapFormData,"label-width":"120px",size:"small",autocomplete:"off"}},[t("el-form-item",{attrs:{label:"功能状态",prop:"enable"}},[t("el-select",{model:{value:e.ldapFormData.enable,callback:function(t){e.$set(e.ldapFormData,"enable",t)},expression:"ldapFormData.enable"}},e._l(e.ldapStatusOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"LDAP 服务器",prop:"ldapServer"}},[t("el-input",{attrs:{placeholder:"例如: ldap.test.com:389"},model:{value:e.ldapFormData.ldapServer,callback:function(t){e.$set(e.ldapFormData,"ldapServer",t)},expression:"ldapFormData.ldapServer"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Base DN",prop:"baseDN"}},[t("el-input",{attrs:{placeholder:"例如: dc=test,dc=com",autocomplete:"off"},model:{value:e.ldapFormData.baseDN,callback:function(t){e.$set(e.ldapFormData,"baseDN",t)},expression:"ldapFormData.baseDN"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"账号",prop:"userDN"}},[t("el-input",{attrs:{placeholder:"管理员账号,例如: cn=admin,dc=test,dc=com",autocomplete:"off"},model:{value:e.ldapFormData.userDN,callback:function(t){e.$set(e.ldapFormData,"userDN",t)},expression:"ldapFormData.userDN"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"管理员密码",autocomplete:"off"},model:{value:e.ldapFormData.password,callback:function(t){e.$set(e.ldapFormData,"password",t)},expression:"ldapFormData.password"}})],1),e._v(" "),t("el-form-item",[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.testLdapConfigLoading,expression:"testLdapConfigLoading"}],attrs:{type:"primary",disabled:e.ldapTestBtn},on:{click:e.doTestLdapConfig}},[e._v("测试链接")]),e._v(" "),0===e.testLdapConfigResult?t("span",{staticClass:"el-icon-check",staticStyle:{color:"#67C23A"}}):e._e(),e._v(" "),e.testLdapConfigResult>0?t("span",{staticClass:"el-icon-close",staticStyle:{color:"#F56C6C"}}):e._e()],1),e._v(" "),t("el-form-item",{attrs:{label:"登录名",prop:"loginName"}},[t("el-input",{attrs:{placeholder:"LDAP服务器中对应个人用户名的字段, 例如: uid"},model:{value:e.ldapFormData.loginName,callback:function(t){e.$set(e.ldapFormData,"loginName",t)},expression:"ldapFormData.loginName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"默认角色",prop:"defaultRoleList"}},[t("el-select",{ref:"selectRole",attrs:{multiple:"",placeholder:"请选择角色"},model:{value:e.ldapFormData.defaultRoleList,callback:function(t){e.$set(e.ldapFormData,"defaultRoleList",t)},expression:"ldapFormData.defaultRoleList"}},e._l(e.roleList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),t("el-form-item",[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.saveLdapConfigLoading,expression:"saveLdapConfigLoading"}],attrs:{type:"primary",disabled:e.ldapSaveBtn},on:{click:e.saveLdapConfig}},[e._v("保存配置")])],1)],1)],1):e._e()])],1)],1)])],1)},a=[],o=(i("6762"),i("2fdb"),i("6f8e")),r=i("9224"),s=i("9bf0"),l=i("1383"),c=i("036d"),d=i("f406"),u=i("cc5e"),h=i("c24f"),p=i("2f62"),f=i("4360"),m={components:{UploadImageInput:d["a"],Logo:l["a"]},data:function(){return{activeName:"1",uploadUrl:"".concat("/api","/user/setting/upload_logo?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name),title:"网盘管理",syncLoading:!1,syncPercent:100,resetLoading:!1,webpEnabled:!1,logoFileName:"",netdiskName:"鑫达云存储",showAckBtn:!1,inputNetdiskNameWidth:150,logoFileTypeList:["image/svg+xml","image/jpg","image/png","image/jpeg"],ldapFormData:{enable:!0,ldapServer:"",defaultRoleList:[],baseDN:"",userDN:"",password:"",loginName:""},currentVersion:r.version,roleList:[],ldapStatusOptions:[{value:!0,label:"启用"},{value:!1,label:"禁用"}],rules:{ldapServer:[{required:!0,message:"请填写LDAP服务器",trigger:"submit"}],defaultRoleList:[{required:!0,message:"请选择默认角色",trigger:"submit"}],baseDN:[{required:!0,message:"请填写 Base DN",trigger:"submit"}],userDN:[{required:!0,message:"请填写 管理员账号",trigger:"submit"}],loginName:[{required:!0,message:"请填写登录名",trigger:"submit"}]},testLdapConfigLoading:!1,saveLdapConfigLoading:!1,testLdapConfigResult:-1}},mounted:function(){this.getWebsiteSetting(),this.getInfo(),this.getIsSync(),this.$route.query.tab&&(this.activeName=this.$route.query.tab,"2"===this.activeName&&(this.getRoleList(),this.getLdapConfig()))},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(p["c"])(["message"])),Object(p["b"])(["newVersion"])),{},{ldapTestBtn:function(){return!(this.ldapFormData.ldapServer.length>0&&this.ldapFormData.baseDN.length>0&&this.ldapFormData.password&&this.ldapFormData.password.length>0)},ldapSaveBtn:function(){return!(!this.ldapTestBtn&&this.ldapFormData.defaultRoleList.length>0&&this.ldapFormData.loginName.length>0)}}),watch:{message:function(e){"synced"===e.url&&(this.syncPercent=e.body,this.syncPercent>=100&&(this.syncLoading=!1))}},methods:{doTestLdapConfig:function(){var e=this;this.testLdapConfigLoading=!0,Object(h["l"])(this.ldapFormData).then((function(){e.testLdapConfigLoading=!1,e.testLdapConfigResult=0,e.$message.success("连接成功")})).catch((function(){e.testLdapConfigResult=1,e.testLdapConfigLoading=!1}))},saveLdapConfig:function(){var e=this;this.saveLdapConfigLoading=!0,Object(h["m"])(this.ldapFormData).then((function(){e.saveLdapConfigLoading=!1,e.$message.success("保存成功")})).catch((function(){e.saveLdapConfigLoading=!1}))},handleClick:function(e){this.$router.push({query:{tab:e.name}}),"2"===e.name&&(this.getRoleList(),this.getLdapConfig())},handleAvatarSuccess:function(e){0===e.code?(this.logoFileName=e.data,this.$store.dispatch("user/setLogo",{netdiskName:this.netdiskName,netdiskLogo:this.logoFileName}).then((function(){f["a"].dispatch("updateMessage",{event:"updateLogo"})}))):this.$message.error(e.message)},beforeAvatarUpload:function(e){var t=this.logoFileTypeList.includes(e.type),i=e.size/1024<128;return t||this.$message.error("网盘Logo只能是 SVG|JPG|JPEG|PNG 格式!"),i||this.$message.error("网盘Logo大小不能超过 128k!"),t&&i},getWebsiteSetting:function(){var e=this;Object(s["c"])({userId:this.$store.state.user.userId}).then((function(t){t.data&&(t.data.netdiskLogo&&(e.logoFileName=t.data.netdiskLogo),t.data.netdiskName&&(e.netdiskName=t.data.netdiskName))}))},getRoleList:function(){var e=this;u["a"].roleList().then((function(t){e.roleList=t.data}))},getLdapConfig:function(){var e=this;Object(h["h"])().then((function(t){t.data&&(e.ldapFormData=t.data)}))},inputNetdiskName:function(e){e&&(this.showAckBtn=!0,this.inputNetdiskNameWidth=206)},setInputBlur:function(){this.showAckBtn=!1,this.inputNetdiskNameWidth=150},updateNetdiskName:function(){var e=this;if(this.netdiskName){var t=/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/;t.test(this.netdiskName)?s["a"].updateNetdiskName({netdiskName:this.netdiskName}).then((function(){e.$store.dispatch("user/setLogo",{netdiskName:e.netdiskName,netdiskLogo:e.logoFileName}).then((function(){f["a"].dispatch("updateMessage",{event:"updateLogo"}),document.title=Object(c["a"])(e.$route.meta.title)})),e.$message.success("网盘名称 修改成功"),e.setInputBlur()})).catch((function(){e.setInputBlur()})):this.$message.warning("网盘名称 只能包含中文，数字，字母，下划线")}else this.$message.warning("网盘名称不能为空")},getInfo:function(){var e=this;s["a"].getWebp({userId:this.$store.state.user.userId}).then((function(t){e.webpEnabled=!t.data}))},getIsSync:function(){var e=this;s["a"].isSync({username:this.$store.state.user.name}).then((function(t){e.syncLoading=!0,e.syncPercent=t.data,e.syncLoading=e.syncPercent<100}))},sync:function(){var e=this;this.$confirm("是否开始同步? ","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.syncLoading=!0,e.syncPercent=0,s["a"].sync({username:e.$store.state.user.name}).then((function(){e.$message.success("开始同步...")}))}))},resetMenuAndRole:function(){var e=this;this.$confirm("您确定要删除当前角色、菜单吗? ","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.resetLoading=!0,s["a"].resetMenuAndRole().then((function(){e.$message.success("重置完成"),e.resetLoading=!1})).catch((function(){e.resetLoading=!1}))})).catch((function(){e.resetLoading=!1}))},webpChange:function(e){var t=this;s["a"].disabledWebp({userId:this.$store.state.user.userId,disabled:!e}).then((function(){e?t.$message.success("webp 已启用"):t.$message.warning("webp 已禁用")})).catch((function(){t.webpEnabled=!t.webpEnabled}))}}},g=m,v=(i("403e"),i("2877")),b=Object(v["a"])(g,n,a,!1,null,"7dc4114e",null);t["default"]=b.exports},"87d4":function(e,t,i){e.exports=i.p+"static/img/pic_sharing_empty.7c5a0c94.png"},"896a":function(e,t,i){"use strict";i("a7ed")},"8cdb":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wscn-http404-container"},[t("div",{staticClass:"wscn-http404"},[e._m(0),e._v(" "),t("div",{staticClass:"bullshit"},[t("div",{staticClass:"bullshit__oops"},[e._v("哎呦!")]),e._v(" "),t("div",{staticClass:"bullshit__headline"},[e._v(e._s(e.message))]),e._v(" "),t("div",{staticClass:"bullshit__info"},[e._v("请检查您输入的URL是否正确，或单击下面的按钮返回首页。")]),e._v(" "),t("a",{staticClass:"bullshit__return-home",attrs:{href:"/"}},[e._v("返回首页")])])])])},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"pic-404"},[t("img",{staticClass:"pic-404__parent",attrs:{src:i("a36b"),alt:"404"}}),e._v(" "),t("img",{staticClass:"pic-404__child left",attrs:{src:i("26fc"),alt:"404"}}),e._v(" "),t("img",{staticClass:"pic-404__child mid",attrs:{src:i("26fc"),alt:"404"}}),e._v(" "),t("img",{staticClass:"pic-404__child right",attrs:{src:i("26fc"),alt:"404"}})])}],o={name:"Page404",computed:{message:function(){return"网站管理员说您无法进入此页面..."}}},r=o,s=(i("4efd"),i("2877")),l=Object(s["a"])(r,n,a,!1,null,"54041639",null);t["default"]=l.exports},"8ea6":function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{staticClass:"select-file-dialog",attrs:{title:e.title,visible:e.dialogVisible,top:"7.5vh",width:"70%","append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[e.dialogVisible?t("show-file",{attrs:{"select-file":"","query-file-type":"image",defaultGrid:!0,orderCustom:!0,"show-upload-button":!1,"show-search-button":!1,"show-more-item":!1,"show-share-item":!1,"less-client-height":e.lessClientHeight,sortable:e.sortable},on:{selectedFile:e.selectedFile}}):e._e(),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{disabled:!e.selectedFileRow.size,type:"primary"},on:{click:e.select}},[e._v("选择")])],1)],1)],1)},a=[],o={components:{ShowFile:function(){return Promise.resolve().then(i.bind(null,"c41c"))}},name:"SelectFile",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"选择文件"}},data:function(){return{dialogVisible:!1,sortable:{prop:"updateDate",order:"descending"},selectedFileRow:{},lessClientHeight:.15*document.body.clientHeight+150}},watch:{visible:function(e){e&&(this.dialogVisible=!0)}},methods:{selectedFile:function(e){this.selectedFileRow=e},select:function(){this.handleClose(),this.$emit("select",this.selectedFileRow)},handleClose:function(){this.dialogVisible=!1,this.$emit("update:visible",this.dialogVisible)}}},r=o,s=(i("e222"),i("2877")),l=Object(s["a"])(r,n,a,!1,null,"b90cdb7e",null);t["a"]=l.exports},"8f80":function(e,t,i){"use strict";i("dee2")},"92a2":function(e,t,i){"use strict";i("c4a4")},"92b5":function(e,t,i){"use strict";i("0ee8")},"93ab":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{isCollectView:!0,defaultGrid:!0,sortable:e.sortable,orderCustom:!0,defaultSort:e.sortable,queryCondition:e.queryCondition,singleMenus:e.singleMenus,singleMenusEdit:e.singleMenusEdit,multipleMenus:e.multipleMenus,multipleRightMenus:e.multipleRightMenus}})],1)},a=[],o=i("c41c"),r={components:{ShowFile:o["default"]},data:function(){return{sortable:{prop:"name",order:"ascending"},queryCondition:{isFavorite:!0},singleMenus:[{iconClass:"menu-open",label:"打开",operation:"open"},{iconClass:"share",label:"分享",operation:"share"},{iconClass:"menu-favorite",label:"收藏",operation:"favorite"},{iconClass:"menu-details",label:"详细信息",operation:"details"},{iconClass:"menu-rename",label:"重命名",operation:"rename"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"}],singleMenusEdit:[{iconClass:"menu-open",label:"打开",operation:"open"},{iconClass:"share",label:"分享",operation:"share"},{iconClass:"menu-favorite",label:"收藏",operation:"favorite"},{iconClass:"menu-edit1",label:"编辑",operation:"edit"},{iconClass:"menu-details",label:"详细信息",operation:"details"},{iconClass:"menu-rename",label:"重命名",operation:"rename"},{iconClass:"menu-download",label:"下载",operation:"download"}],multipleMenus:[{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-favorite-hover",label:"取消收藏",operation:"unFavorite"}],multipleRightMenus:[{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-favorite-hover",label:"取消收藏",operation:"unFavorite"}]}}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"5cc3a56d",null);t["default"]=c.exports},"943c":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAANO0lEQVR4Xu1de6wcVRn/fbO7s30EkxKh3d3yCqTd2eKtUkNFuJZHkIIUpHiNxLaJgA8gSqSYEpW0hGiooURNRCUiSekftLeAQDX0D2ilKFbTGgrdvb2BVKk7t4UE/jCld2d25zNnd29bsPfuPM6Z2dmdSTa5ycz3/P3uPM75zncIydHXGaC+jj4JHgkB+pwECQESAvR5Bvo8/OQOkBCgzzPQ5+End4CEAL2ZgbP5U7OscXshpbQBAg8AmAdgZvNHNBPg1t+t4yhAR8F8tPV38zfKoH3ccPbp0zKvv0NvfNCLmeqJO0CeF81A/dhFBCxm8CAYFwE4SzJgh0DYS6BdDOxGevpek/Z8KNlG6OpiS4A5x4qXayntekCAzZcC0EPOngXQXwDsdRrOtsPTR3aGbF+KuVgRYA5fcIZmZ4YYGCLgcikZkKSEgZ0EDDsZe/gwvfWeJLXK1cSCAAW7eAkzrQAwBOAM5VkJZkCAP0zEm6qZkdeCqVIv3dUEyNcX3EANXsXEN6tPhXwLxPQ0p2ijmd7/vHztcjR2JQHylnEbEVYyY4mcMKPVQoQ/M+NJU688Hq0n/2+9qwhQsOdfwUitAfM13ZYoKf4QbSc01lczB3ZI0SdBSVcQYPZ/zz9Ty2bXEPgeCTF1vQoGPeLUauuPnPb2u1E7GzkBcrXSCiK+vz1QE3U+wrQ/ykwPjmXLm8I0+nFbkRIgXzMeAmFNlAmI3DZjvZmt3BeVH5EQoDBenMdEG0AQAznJwdhGzKur00ZGw05G6ATI1Y2byMEGAOeFHWyX2zvIGlaPpSvPhulnqAQoWMYdDDwaZoBxs0XAnVW98uuw/A6NAHm7uBZM68IKLNZ2mB8wsyOh5CoUAuRrxXUgWhtrUMJ2PiQSKCdAAn4A5oRAAqUEKNSNlexgY4AU9L0oaVhVTVeeVJUIZQQo1EpDTLxFleP9pJeYvlrNlodVxKyEAAn48qFSRQLpBGh/5z8jPwWJRtawXPY4gVQCNEf4NHoxGeRRRtaD5PBSmSOGUgmQrxkvJMO7ysBvKWZsM7OVZbKsSCNAMrEjCxIXeiROIEkhQHtKV9mniouUnLiE8AoYm50GlzGtvr95Yjy9QEtRCYRbwLjMk74uvZiZVsqYSg5MAFHMkcrqu7piPp/xM1Of8WPQHnsy3Aq28XNm3N2luHpxa7RRswaDFpUEJkDOKm3ohkoer59JectgL9nuxmtFZdGYXl4dxLdABGjW8LH2chAHZMh6BV/YzNVKXxel2zLsR6mDyLkySI1hIALk7dKLURdw+gF/ArCCbfyJGddGCWBg20TbzUx5qV89vgkgSrcB/M6vYRlyQcAX9vNW6bsA/1KGLxHruN1vyblvAhRsY2eUdftBwW8SYLz4RWi0PWLwApsX6w6qmYqvpXK+CCBW7MBxngvsuU8FMsAXps/kC2en7cZhn250l5im3ehnBZIvAhRqpa1RLdeSBb5Ar73YNPLafBlMEsvQqtnyV7zq8kyA9kLNv3o1JON6meA3CdBcYk5ds0onaI6I+PNeF6R6JkDeMn4F4M6gznqVlw1+6yXQEHGIeHrleNTUK3d5CcYTAdq3TDG8GuoSbRXgtwhQfAmgK70krMuvfc/J2Au89CfwRIAo/mOUgV8z1oDwUJcD6se9u0y94rr03hMBcpaxI8zOHKrAL1ilTzP4FQCn+clwN8uITiVjeuUKtz66JkDYL0zqwJ+3kJF+CuCi2yTF7TqnwVe47VnkmgBhTvqoAj9nFReBaTMRzo8bqF789TJJ5JoAecsQU77K59JVgT/XKi12wJsBnOMlmTG99lVTrwy68d0VAWbzwMyUbYtGiRk3Sv1eowr8vD3/UkDbDEbBr28xk7MbmcysI7RPNLyc8nBFgIK94Epm56VOyoKcVwX+HLu4RGNsAejMIP7FTZZIu6qa2d9xqt4VAXJ26YfE/BNVSVAFfuFY6SpO8xYwTlfle7fqZaIfjWXKP+3knysC5O3Sc2C+oZMyP+dVgZ8bL15DGonVND33qecqz0TPm5nyjZ2udUcAy3hHQe9dqAK/MG58iTUI8Kd3SkAPnz9k6pWzO8XXkQCi63bdrr/fSZHX86rAb09VPw0g7dWnXrs+nUmf3qnLeUcCqBgAUgV+rl5cTg4J8JMDgJsBoY4EyFml7xH4F7Iyqgp8Wf6FrSd3zDgHGg1qhEEGfw3AJ2T5wKC7x/TylCVvHQmQtwxR9yfq/wIfCfhTp3AOLyhpdX5EYqHt46ZeuX0qq24IICZNXI0qTR0e3Wrq5ScCs6gPFMwdN65zNPxRQqi7TL3yhaAE2NPalCHQ8ZSpV24JpKHPhPOW8RiAbwYMe6+pVxYFJcAIgPm+HSG833Cw5Ei28qZvHX0oOOdY8VwtRf8A8MkA4R8w9cqUs56dHwF26RCY5/p3gp8w9ZFb/cv3r2TeKv4eoG/4zgDRf8xMecq9k1wQwHgfjFl+nSDQHVW9/Bu/8v0sV7BK32Gw/6aRhA/MTGXKYXA3BKiB/W/IlHJSFxya9ubb/Qyk39jPGr/w/IbWeMuvPAiWmalkg70D2EYgAnAD545Nr/zbdxB9LCjGCCiFf/lOgSQCBHoEyGpk4DsJMRYM3HhDziMg2EsggR6r6uVvxxiHyFwvWKXfMvhbvh2Q8hJoGclnoG8E/AvmrPmfJTR7LwSZzpbwGWgZyUCQfxx9S0oqwZcyEJQMBfuG0Z+gxFlNKUPByWSQPxw9S53DRq5exw+Y8X3PwqcWCD4ZlEwHS4JiEjXiW9/RnKsZzsUgug6M2bIsSpkOjlVBSK24nCgpCJkgkJSCkPiVhBWXiaogVryGQdZ/qUo9UkrChIP5mBWFzhkvXatpLErDkqLQDgzrOBfQJIBt/AGMjiXGftisqkoobxtXA9gKlldi5Se+yGQIz5mZypc72XdFgIJdWs3MD3dS5ve8KhK0G1luBfpvYQgR3VvNlMX+jFMergiQt0uXgVksDlV2qCJBzi4NEnhY5tu1siTIVEw0aGbKr3ZS6Y4AvGgG7A/F4lC9k8Ig51WRoNnYyqFhUN8sDrWQmTHLpD0fdsLDFQFaL4KllwF23Xmik+HJzqsiwRyrdLHWWh5+rl/f4iNHO0y97Kr3kRcCPAxwoM7UbhOoigQ5y7iIGJtBuMCtL/G8jjaYevleN767JoCKAaGpHFRFgrm1+QMOUptBSYsYkX/XBBAXS5qhckPM5jWqSJA0iToBgScCJG3iXHM3ygvVtYlLGkVGiasr22obRba+BnqpVWzP7BcwwQ61rWKFlV5qFt0r+wVMoB9Ks+gmCXqkXXwv7RcQWrv45mOgRzaM6KX9AhDmhhGtR0H8t4wJe2zD1Wucj4tC3zKm/TLYA5tG9cx+AeFvGtUkQcy3jcvbxq7YbyUb1bZxrcdAfDeO7JUtZCPdOLI1PJxsHevjsS1FxEtX8MkMehoKPpWSuG0e3StbxgLojs2jm3eBWmkFEXfR9vG0FY5zoJ5Nvy78S9fqC6Fp84n42thvFdv+L5S16jrwHWDirpCvGQ+BsEbKvS1RMnUGGOvNbOU+GWmSRoDmV0HNeAGE62U4luiYJAOMbWa2skxWfqQSoDBenMcavQjgPFkOJno+koGD5PDS6rSRUVl5kUqA5vtA3biJHDwjy8FEz4kMsIblY+nKszJzIp0AzfEBy7iDAdd718kMqFd1EXBnVa/47xg2SWKUEKD5PmAX14JpXa8CEmpczA+Y2REluVRGgNZLYXEdiNaGmqxeM6YQfJEqpQRI7gQB2agY/FAI0HwnqBsr2cHGgOnoK3HSsKqarigfXFN+B5hArVArDTHxlr5C0WewqsrhT+VOaARo3gkSEnSkRJjgh/YIODnq9jiBWLacDBZ9lA4HWcNq2d/5nRgX6h3g+ONAjBgSbUiGjdsZYWwj5tUyR/g6AT9xPhICTBhPJpAASJzYcQv6yddFSgDhSHsq+X4A8/wEEGOZUWZ6cCxb3hRlDJETQAQvikq0bHYNge+JMhlh2RaVPE6ttv7IaW+/G5bNyex0BQGOvxuIGkOk1kjcNi3q/H7UPtF2QmN9NXNgR7c41lUEOP5uYBm3EWElM5Z0S6KC+CHq9pnxpKlXHg+iR4VsVxLgOBHqC26gBq9i4ptVBK9ap1iuxSnaaKb3P6/all/9XU2AE4+G4iXMtALAEIAz/AYbktx7AIaJeFM1M/JaSDZ9m4kFASaia6/lG2JgiIDLfUetQJCBnQQMOxl7+DC9JUgQiyNWBDg5o2JdH6W0ZQS+GMBihN8b2Aawm0F/54bzwuHpIztjgfjHnIwtAU6OYzYPzEzXG4sd8OdIkIH5MwCm3DDRB1iHQPRPBnZroL/V06ndR2jfUR96ukqkJwhwqoyKLufWuL2QUtoAgQfaA00zAcwE0UyAW3+3jqMAHQWzAHTiN8qgfdxw9unTMq+/Q2+IRpk9d/QsAXoOKUUBJQRQlNi4qE0IEBekFPmZEEBRYuOiNiFAXJBS5GdCAEWJjYvahABxQUqRnwkBFCU2Lmr/B0fnVMxGNsTkAAAAAElFTkSuQmCC"},"94fe":function(e,t,i){"use strict";i("b011")},"961d":function(e,t,i){"use strict";i.r(t);i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[e.accessToken?t("el-alert",{attrs:{title:"新的操作令牌生成成功！您必须立即复制到一个安全的地方, 因为该令牌只会显示一次!",type:"success",center:"",closable:!1}}):e._e(),e._v(" "),e.accessToken?t("el-alert",{attrs:{title:e.accessToken,center:"",type:"info",closable:!1}}):e._e(),e._v(" "),t("el-dialog",{staticClass:"dialog-cm",attrs:{width:"500px",title:e.dialogTitle,"close-on-click-modal":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"managerForm",attrs:{size:"medium",model:e.form,"label-position":"left",rules:e.rules,"label-width":"95px"},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"令牌名称:",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入令牌名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSave.apply(null,arguments)}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary",loading:e.saveLoading},on:{click:e.onSave}},[e._v("保 存\n      ")])],1)],1),e._v(" "),t("el-card",{staticClass:"box-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"box-card-header"},[t("div",{staticClass:"clearfix card-header-back"},[t("span",[e._v("管理个人操作令牌")]),e._v(" "),t("el-button",{staticClass:"card-button",attrs:{size:"mini",type:"primary"},on:{click:e.newAccessToken}},[e._v("新增令牌")])],1)])]),e._v(" "),t("div",[t("div",{staticClass:"token-title-desc"},[e._v("您可以使用这些以生成的令牌来操作 JmalCloud API。")]),e._v(" "),t("el-divider"),e._v(" "),t("div",[e.accessTokenList.length>0?t("ul",e._l(e.accessTokenList,(function(i){return t("li",{key:i.id},[t("div",{staticClass:"token-item"},[t("div",{staticClass:"item-icon"},[t("svg-icon",{attrs:{"icon-class":"key"}})],1),e._v(" "),t("div",{staticClass:"item-content"},[t("div",{staticClass:"item-title"},[e._v(e._s(i.name))]),e._v(" "),t("div",{staticClass:"item-desc"},[t("span",[e._v("增加于")]),e._v(" "),t("span",[e._v(e._s(i.createTime))]),e._v(" "),t("i",[i.lastActiveTime?t("svg-icon",{attrs:{"icon-class":"zuijinhuoyue"}}):e._e(),i.lastActiveTime?e._e():t("i",{staticClass:"el-icon-info"}),e._v(e._s(i.lastActiveTime?"最近活动于 "+i.lastActiveTime:"没有最近活动")+"\n                  ")],1)])]),e._v(" "),t("div",{staticClass:"item-active"},[t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.deleteToken(i.id)}}},[e._v("删除令牌")])],1)]),e._v(" "),t("el-divider")],1)})),0):t("div",{staticClass:"empty-text"},[e._v("暂无令牌")])])],1)])],1)},a=[],o=i("9bf0"),r={data:function(){return{dialogVisible:!1,dialogTitle:"新增令牌",accessTokenList:[],accessToken:void 0,form:{name:"",createTime:"",lastActiveTime:""},rules:{name:[{required:!0,message:"请输入令牌名称",trigger:"blur"}]},saveLoading:!1}},mounted:function(){this.getAccessTokenList()},methods:{getAccessTokenList:function(){var e=this;o["a"].getAccessTokenList().then((function(t){e.accessTokenList=t.data}))},newAccessToken:function(){this.dialogVisible=!0},onSave:function(){var e=this;this.$refs.managerForm.validate((function(t){if(e.valid=t,!t)return!1;e.saveLoading=!0,o["a"].generateAccessToken({tokenName:e.form.name}).then((function(t){e.accessToken=t.data,e.saveLoading=!1,e.dialogVisible=!1,e.getAccessTokenList()})).catch((function(){e.saveLoading=!1}))}))},deleteToken:function(e){var t=this;this.$confirm("您确定要删除此令牌吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){o["a"].deleteAccessToken({id:e}).then((function(){t.getAccessTokenList(),t.$notify({title:"删除成功",type:"success",duration:1e3})}))}))}}},s=r,l=(i("fce2"),i("2877")),c=Object(l["a"])(s,n,a,!1,null,"544ec4b4",null);t["default"]=c.exports},"9bf0":function(e,t,i){"use strict";i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"e",(function(){return r})),i.d(t,"b",(function(){return s}));var n=i("b775");function a(e){return Object(n["a"])({url:"/public/website/record",method:"get",params:e})}function o(e){return Object(n["a"])({url:"/website/setting",method:"get",params:e})}function r(e){return Object(n["a"])({url:"/website/setting/update",method:"put",data:e})}function s(e){return Object(n["a"])({url:"/website/heartwings",method:"get",params:e})}t["a"]={sync:function(e){return Object(n["a"])({url:"/user/setting/sync",method:"get",params:e})},isSync:function(e){return Object(n["a"])({url:"/user/setting/isSync",method:"get",params:e})},updateNetdiskName:function(e){return Object(n["a"])({url:"/user/setting/update_netdisk_name",method:"put",params:e})},getWebp:function(e){return Object(n["a"])({url:"/user/setting/get/webp",method:"get",params:e})},disabledWebp:function(e){return Object(n["a"])({url:"/user/setting/disabled/webp",method:"put",params:e})},getAccessTokenList:function(e){return Object(n["a"])({url:"/user/setting/accessTokenList",method:"get",params:e})},generateAccessToken:function(e){return Object(n["a"])({url:"/user/setting/generateAccessToken",method:"put",params:e})},deleteAccessToken:function(e){return Object(n["a"])({url:"/user/setting/deleteAccessToken",method:"delete",params:e})},resetMenuAndRole:function(){return Object(n["a"])({url:"/user/setting/resetMenuAndRole",method:"put"})}}},"9ed6":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("div",{attrs:{id:"stars"}}),e._v(" "),t("div",{attrs:{id:"stars2"}}),e._v(" "),t("div",{attrs:{id:"stars3"}}),e._v(" "),t("div",{staticClass:"login-content"},[t("el-card",{staticClass:"box-card"},[t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"auto-complete":"on","label-position":"left"}},[t("div",{staticClass:"title-container"},[e.initialize?e._e():t("h3",[t("div",{staticClass:"title"},[t("Logo",{attrs:{width:"65"},model:{value:e.webstieRecord.netdiskLogo,callback:function(t){e.$set(e.webstieRecord,"netdiskLogo",t)},expression:"webstieRecord.netdiskLogo"}}),e._v(" "),t("div",{staticClass:"jmal-cloud-name"},[t("div",[e._v(e._s(e.webstieRecord.netdiskName?e.webstieRecord.netdiskName:"鑫达云存储"))])])],1)]),e._v(" "),e.initialize?t("h3",{staticClass:"title"},[e._v("创建管理员")]):e._e()]),e._v(" "),t("el-form-item",{attrs:{prop:"username"}},[t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"user"}})],1),e._v(" "),t("el-input",{ref:"username",attrs:{placeholder:"用户名",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"password"}},[t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),t("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"密码",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),e._v(" "),t("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[t("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1),e._v(" "),e.initialize?e._e():t("el-form-item",{staticClass:"remember"},[t("el-checkbox",{attrs:{label:"记住我"},model:{value:e.loginForm.rememberMe,callback:function(t){e.$set(e.loginForm,"rememberMe",t)},expression:"loginForm.rememberMe"}})],1),e._v(" "),e.initialize?t("el-form-item",{attrs:{prop:"confirmPassword"}},[t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),t("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"确认密码",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.confirmPassword,callback:function(t){e.$set(e.loginForm,"confirmPassword",t)},expression:"loginForm.confirmPassword"}}),e._v(" "),t("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[t("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1):e._e(),e._v(" "),t("el-button",{staticStyle:{width:"100%",margin:"30px 0"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e._v(e._s(e.initialize?"创建":"登录"))])],1)],1)],1),e._v(" "),t("footer",{staticClass:"clearfix",staticStyle:{"font-size":"0.725rem"},attrs:{id:"footer"}},[t("div",{staticClass:"copyright"},[t("div",[e._v(e._s(e.webstieRecord.copyright))]),e._v(" "),t("span",[t("a",{attrs:{target:"_blank",href:"https://beian.miit.gov.cn"}},[e._v(e._s(e.webstieRecord.recordPermissionNum))]),e._v(" "),t("a",{attrs:{target:"_blank",href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode="+e.webstieRecord.networkRecordNumber}},[e.webstieRecord.networkRecordNumberStr?t("img",{attrs:{src:i("79f0")}}):e._e(),e._v(e._s(e.webstieRecord.networkRecordNumberStr))])])])])])},a=[],o=i("9bf0"),r=i("c24f"),s=i("5f87"),l=i("1383"),c=(i("9dce"),{name:"Login",components:{Logo:l["a"]},data:function(){var e=this,t=function(t,i,n){e.validUsername(i)?n():n(new Error("请输入正确的用户名"))},n=function(e,t,i){t.length<6||i()},a=function(t,i,n){i.length<6||(e.loginForm.password!==i?n(new Error("密码不一致")):n())};return{beianUrl:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=",webstieRecord:{copyright:"",recordPermissionNum:"",netdiskName:"鑫达云存储",netdiskLogo:""},loginForm:{username:"",password:"",rememberMe:!1,confirmPassword:""},loginRules:{username:[{required:!0,trigger:"blur",validator:t}],password:[{required:!0,trigger:"blur",validator:n}],confirmPassword:[{required:!0,trigger:"blur",validator:a}]},loading:!1,passwordType:"password",redirect:void 0,initialize:!1,backgroundImg:{background:"url("+i("a598")+")",width:"100%",height:"100%",position:"absolute"}}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect,e.query.path&&(this.redirect+="&path=".concat(e.query.path))},immediate:!0}},mounted:function(){var e=this;Object(r["f"])().then((function(t){t.count<1&&(e.initialize=!0)}));var t=Object(s["b"])();t&&(this.loginForm.username=t,this.loginForm.rememberMe=!0),Object(o["d"])().then((function(t){e.webstieRecord=t.data,(e.webstieRecord.netdiskName||e.webstieRecord.netdiskLogo)&&e.$store.dispatch("user/setLogo",{netdiskName:e.webstieRecord.netdiskName,netdiskLogo:e.webstieRecord.netdiskLogo})}))},methods:{showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return!1;if(e.initialize){var i=new FormData;i.append("username",e.loginForm.username),i.append("password",e.loginForm.password),Object(r["g"])(i).then((function(){e.initialize=!1,e.$message.success("创建成功")}))}else e.loading=!0,e.$store.dispatch("user/login",e.loginForm).then((function(){e.$store.dispatch("user/setMenuList").then((function(t){e.$router.push({path:e.redirect||"/"}),e.loading=!1})).catch((function(){e.loading=!1}))})).catch((function(){e.loading=!1}))}))},validUsername:function(){return!0}}}),d=c,u=(i("92a2"),i("1b83"),i("2877")),h=Object(u["a"])(d,n,a,!1,null,"b482824c",null);t["default"]=h.exports},a204:function(e,t,i){"use strict";i("f969")},a221:function(e,t,i){"use strict";i("0e1d")},a36b:function(e,t,i){e.exports=i.p+"static/img/404.a57b6f31.png"},a598:function(e,t,i){e.exports=i.p+"static/img/login-bg.72db061a.png"},a6b0:function(e,t,i){},a7ed:function(e,t,i){},a8c4:function(e,t,i){var n={"./views/404":"8cdb","./views/404.vue":"8cdb","./views/favorite":"93ab","./views/favorite/":"93ab","./views/favorite/index":"93ab","./views/favorite/index.vue":"93ab","./views/fileType/audio":"e054","./views/fileType/audio.vue":"e054","./views/fileType/document":"c1fe","./views/fileType/document.vue":"c1fe","./views/fileType/image":"de32","./views/fileType/image.vue":"de32","./views/fileType/video":"c1b6","./views/fileType/video.vue":"c1b6","./views/home":"7abe","./views/home/":"7abe","./views/home/index":"7abe","./views/home/index.vue":"7abe","./views/home/mobile":"1a40","./views/home/mobile/":"1a40","./views/home/mobile/index":"1a40","./views/home/mobile/index.vue":"1a40","./views/login":"9ed6","./views/login/":"9ed6","./views/login/index":"9ed6","./views/login/index.vue":"9ed6","./views/markdown":"816e","./views/markdown/":"816e","./views/markdown/EditElement":"4308","./views/markdown/EditElement.vue":"4308","./views/markdown/index":"816e","./views/markdown/index.vue":"816e","./views/public/share/shareList":"488d","./views/public/share/shareList.vue":"488d","./views/recently":"e053","./views/recently/":"e053","./views/recently/index":"e053","./views/recently/index.vue":"e053","./views/setting/articles/alonePageManager":"0fb2","./views/setting/articles/alonePageManager.vue":"0fb2","./views/setting/articles/articleManager":"b0d9","./views/setting/articles/articleManager.vue":"b0d9","./views/setting/articles/articlePageManager":"85d7","./views/setting/articles/articlePageManager.vue":"85d7","./views/setting/articles/blogManager":"35c2","./views/setting/articles/blogManager.vue":"35c2","./views/setting/articles/categoryManager":"23a0","./views/setting/articles/categoryManager.vue":"23a0","./views/setting/articles/tagManager":"1069","./views/setting/articles/tagManager.vue":"1069","./views/setting/authAPP":"961d","./views/setting/authAPP.vue":"961d","./views/setting/cloudManager":"8740","./views/setting/cloudManager.vue":"8740","./views/setting/ossManager":"351e","./views/setting/ossManager.vue":"351e","./views/setting/sys/cusomerInfo":"f9ca","./views/setting/sys/cusomerInfo.vue":"f9ca","./views/setting/sys/cusomerManager":"3158","./views/setting/sys/cusomerManager.vue":"3158","./views/setting/sys/logList":"4d8d","./views/setting/sys/logList.vue":"4d8d","./views/setting/sys/logLogin":"ddfe","./views/setting/sys/logLogin.vue":"ddfe","./views/setting/sys/logOperation":"f9f9","./views/setting/sys/logOperation.vue":"f9f9","./views/setting/sys/menuManager":"aeaa","./views/setting/sys/menuManager.vue":"aeaa","./views/setting/sys/roleManager":"f620","./views/setting/sys/roleManager.vue":"f620","./views/share":"1044","./views/share/":"1044","./views/share/index":"1044","./views/share/index.vue":"1044","./views/space":"3882","./views/space/":"3882","./views/space/index":"3882","./views/space/index.vue":"3882","./views/space/mobile":"3b6b","./views/space/mobile/":"3b6b","./views/space/mobile/index":"3b6b","./views/space/mobile/index.vue":"3b6b","./views/tag":"6613","./views/tag/":"6613","./views/tag/index":"6613","./views/tag/index.vue":"6613","./views/together":"d9c9","./views/together/":"d9c9","./views/together/index":"d9c9","./views/together/index.vue":"d9c9","./views/together/mobile":"0426","./views/together/mobile/":"0426","./views/together/mobile/index":"0426","./views/together/mobile/index.vue":"0426","./views/upload/mobile":"72d3","./views/upload/mobile/":"72d3","./views/upload/mobile/index":"72d3","./views/upload/mobile/index.vue":"72d3"};function a(e){var t=o(e);return i(t)}function o(e){var t=n[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id="a8c4"},aeaa:function(e,t,i){"use strict";i.r(t);i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-dialog",{staticClass:"dialog-form",attrs:{width:"600px",title:e.dialogTitle,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"managerForm",attrs:{size:"medium","label-width":"90px",model:e.form,rules:e.rules}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"上级菜单:",prop:"parentId"}},[t("tree-select",{ref:"selectTree",attrs:{placeholder:"请选择上级菜单",props:{value:"id",label:"name"},options:e.dataList,clearable:""},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单名称:",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入菜单名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单图标:",prop:"icon"}},[t("icon-select",{model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"路由地址:",prop:"path"}},[t("el-input",{attrs:{placeholder:"请输入路由地址"},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"组件路径:",prop:"component"}},[t("el-input",{attrs:{placeholder:"请输入组件路径"},model:{value:e.form.component,callback:function(t){e.$set(e.form,"component",t)},expression:"form.component"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"权限标识:",prop:"authority"}},[t("el-input",{attrs:{placeholder:"请输入权限标识"},model:{value:e.form.authority,callback:function(t){e.$set(e.form,"authority",t)},expression:"form.authority"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"排序号:",prop:"sortNumber"}},[t("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.form.sortNumber,callback:function(t){e.$set(e.form,"sortNumber",t)},expression:"form.sortNumber"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"是否隐藏:",prop:"hide"}},[t("el-radio",{attrs:{label:!1},model:{value:e.form.hide,callback:function(t){e.$set(e.form,"hide",t)},expression:"form.hide"}},[e._v("显示")]),e._v(" "),t("el-radio",{attrs:{label:!0},model:{value:e.form.hide,callback:function(t){e.$set(e.form,"hide",t)},expression:"form.hide"}},[e._v("隐藏")])],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单类型:",prop:"menuType"}},[t("el-radio",{attrs:{label:0},model:{value:e.form.menuType,callback:function(t){e.$set(e.form,"menuType",t)},expression:"form.menuType"}},[e._v("菜单")]),e._v(" "),t("el-radio",{attrs:{label:1},model:{value:e.form.menuType,callback:function(t){e.$set(e.form,"menuType",t)},expression:"form.menuType"}},[e._v("按钮")])],1),e._v(" "),1!==e.form.menuType?t("el-form-item",{attrs:{label:"菜单位置:",prop:"menuType"}},[t("el-radio-group",{attrs:{size:"mini"},model:{value:e.form.menuType,callback:function(t){e.$set(e.form,"menuType",t)},expression:"form.menuType"}},[t("el-radio-button",{attrs:{label:2}},[e._v("设置")]),e._v(" "),t("el-radio-button",{attrs:{label:3}},[e._v("顶部")]),e._v(" "),t("el-radio-button",{attrs:{label:4}},[e._v("右上")])],1)],1):e._e()],1)],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary",loading:e.updateLoading},nativeOn:{click:function(t){return t.preventDefault(),e.onSave()}}},[e._v("保 存")])],1)],1),e._v(" "),t("el-card",{staticClass:"box-card table-search-header"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"box-card-header"},[t("el-form",{ref:"queryForm",staticClass:"search-form",attrs:{size:"medium","label-width":"77px",model:e.queryCondition,rules:e.rules}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{sm:12,md:8}},[t("el-form-item",{attrs:{label:"菜单名称:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.name,callback:function(t){e.$set(e.queryCondition,"name",t)},expression:"queryCondition.name"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:8}},[t("el-form-item",{attrs:{label:"菜单地址:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.path,callback:function(t){e.$set(e.queryCondition,"path",t)},expression:"queryCondition.path"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:8}},[t("div",{staticClass:"el-form-actions"},[t("el-button",{staticClass:"card-btn-icon",attrs:{size:"medium",icon:"el-icon-search",type:"primary"},on:{click:function(t){return e.getMenuTree()}}},[e._v("查询")]),e._v(" "),t("el-button",{staticClass:"card-btn-icon",attrs:{size:"medium",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.add()}}},[e._v("添加")]),e._v(" "),t("el-button",{staticClass:"card-btn-icon",attrs:{size:"medium",icon:e.isExpand?"el-icon-remove-outline":"el-icon-circle-plus-outline",type:"primary"},on:{click:function(t){return e.handleExpand()}}},[e._v(e._s(e.isExpand?"折叠":"展开"))])],1)])],1)],1)],1)]),e._v(" "),t("table-list",{ref:"tableMenu",attrs:{"has-selection":!1,tableData:e.dataList,"less-client-height":210,loading:e.loading,tableHeader:e.tableHeader,pagination:e.pagination,"is-expand":e.isExpand},on:{"update:isExpand":function(t){e.isExpand=t},"update:is-expand":function(t){e.isExpand=t},pageChange:e.pageChange,sizeChange:e.pageChange,selectFun:e.selectFun,sortChange:e.sortChange}})],1)],1)},a=[],o=(i("ac6a"),i("ae4a")),r=(i("96cf"),i("97bf")),s=i("6f8e"),l=i("1f27"),c=i("7c83"),d=i("d693"),u=function(){var e=this,t=e._self._c;return t("el-popover",{ref:"popover",attrs:{placement:"bottom-start","popper-class":"al-icon-picker-popper",width:"400",trigger:"click"},on:{show:e.showPopover,hide:e.hidePopover}},[t("el-tabs",{on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"本地",name:"first"}},[t("icon-list",{ref:"local",attrs:{"icon-list":e.iconList},on:{select:e.select}})],1),e._v(" "),t("el-tab-pane",{attrs:{label:"iconfont",name:"second"}},[t("icon-list",{ref:"iconfont",attrs:{"icon-list":e.iconfontList},on:{select:e.select}})],1)],1),e._v(" "),t("div",{class:{"al-icon-picker":!0,"al-icon-picker-open":e.pickerOpen},attrs:{slot:"reference"},on:{mouseenter:function(t){e.hovering=!0},mouseleave:function(t){e.hovering=!1}},slot:"reference"},[t("el-input",{attrs:{type:"text",clearable:"",readonly:"",placeholder:"请选择图标"},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}},[t("span",{staticClass:"el-input__prefix-inner",attrs:{slot:"prefix"},slot:"prefix"},[t("svg-icon",{attrs:{"icon-class":e.currentValue}})],1),e._v(" "),t("span",{staticClass:"el-input__suffix-inner",attrs:{slot:"suffix"},slot:"suffix"},[e.hovering&&e.currentValue.length>0?t("i",{staticClass:"el-input__icon el-icon-circle-close el-input__clear",on:{mousedown:function(e){e.preventDefault()},click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleClear.apply(null,arguments)}}}):t("i",{staticClass:"el-select__caret el-input__icon el-icon-arrow-down"})])])],1)],1)},h=[],p=(i("4917"),i("51ff")),f=function(e){return e.keys()},m=/\.\/(.*)\.svg/,g=f(p).map((function(e){return e.match(m)[1]})),v=g,b=i("00a1"),w=function(){var e=this,t=e._self._c;return t("el-scrollbar",{staticStyle:{height:"280px"}},[t("el-row",e._l(e.iconList,(function(i,n){return t("el-col",{key:n,attrs:{span:4}},[t("el-card",{staticClass:"al-card-border",attrs:{shadow:"hover",title:i}},[t("div",{staticClass:"al-icon-picker-item",on:{click:function(t){return e.select(i)}}},[t("svg-icon",{attrs:{"icon-class":i}})],1)])],1)})),1)],1)},y=[],x={name:"IconList",props:{iconList:{type:Array,default:[]}},methods:{select:function(e){this.$emit("select",e)}}},C=x,k=i("2877"),_=Object(k["a"])(C,w,y,!1,null,null,null),S=_.exports,L={name:"IconSelect",components:{IconList:S},props:{value:{type:String,default:"sdfsd"}},data:function(){return{iconList:v,iconfontList:b["b"].list,currentValue:this.value,hasValue:!0,pickerOpen:!1,hovering:!1,activeName:"first"}},watch:{value:function(e){this.currentValue=e}},mounted:function(){},methods:{showPopover:function(){this.pickerOpen=!0},hidePopover:function(){this.pickerOpen=!1},select:function(e){this.currentValue=e,this.$emit("input",e),this.$refs.popover.doClose()},handleClear:function(){this.currentValue="",this.$emit("input","")},handleTabClick:function(){}}},T=L,D=(i("0919"),Object(k["a"])(T,u,h,!1,null,"700688ce",null)),E=D.exports,F={components:{IconSelect:E,TreeSelect:d["a"],TableList:c["a"]},props:{},data:function(){var e=this;return{title:"角色管理",dataList:[],authorityList:[],loading:!1,dialogVisible:!1,dialogTitle:"",updateLoading:!1,valid:!0,isExpand:!1,form:{name:"",parentId:"",authority:"",path:"",component:"",icon:"",sortNumber:"",menuType:0,hide:!1},pagination:{pageIndex:1,pageSize:15,pageTotal:0},queryCondition:{name:"",code:"",remarks:"",sortProp:"",sortOrder:""},tableHeader:[{prop:"name",label:"菜单名称",noScope:!0,align:"left"},{prop:"icon",label:"图标",icon:!0,formatData:function(e){return e},width:50},{prop:"path",label:"路由地址"},{prop:"component",label:"组件路径"},{prop:"authority",label:"权限标识"},{prop:"sortNumber",label:"排序",width:50},{prop:"hide",label:"隐藏",width:50,formatData:function(e){return e?"是":"否"}},{prop:"menuType",label:"类型",width:100,tag:!0,formatData:function(e){switch(e){case 0:return[{name:"首页菜单"}];case 1:return[{name:"按钮"}];case 2:return[{name:"设置菜单"}];case 3:return[{name:"顶部菜单"}];case 4:return[{name:"右上角菜单"}]}}},{label:"操作",minWidth:this.$pc?0:130,active:[{name:"修改",icon:"el-icon-edit",handle:function(t){return e.handleEdit(t.id)}},{name:"删除",icon:"el-icon-delete",color:"#ff4d4f",handle:function(t){return e.handleDelete([t.id])}}]}],multipleSelection:[],rules:{name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],sortNumber:[{required:!0,message:"请输入排序号",trigger:"blur"}]},editMove:1}},computed:{},mounted:function(){this.getMenuTree(),this.getAuthorityList(),this.resize()},methods:{resize:function(){document.querySelector(".container").clientWidth},selectFun:function(e){this.multipleSelection=e.backData},sortChange:function(e){var t=e.backData;this.queryCondition.sortProp=t.prop,this.queryCondition.sortOrder=t.order,this.getRoleList()},pageChange:function(e){this.pagination=e.backData,this.getMenuTree()},getAuthorityList:function(){var e=this;l["a"].authorityList().then((function(t){e.authorityList=t.data}))},getMenuTree:function(){var e=this;this.loading=!0,l["a"].menuTree(Object(s["a"])({page:this.pagination.pageIndex,pageSize:this.pagination.pageSize},this.queryCondition)).then((function(t){e.dataList=t.data,e.pagination.pageTotal=t.count,e.loading=!1}))},add:function(){var e=Object(r["a"])(Object(o["a"])().m((function e(){return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:return this.dialogVisible=!0,this.dialogTitle="添加角色",this.editMove=1,e.n=1,this.$nextTick();case 1:this.$refs.managerForm.resetFields(),this.$refs.selectTree.clearHandle();case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleExpand:function(){this.isExpand=!this.isExpand,this.$refs.tableMenu.handleExpand()},setFormData:function(){var e=new FormData;for(var t in this.form)this.form.hasOwnProperty(t)&&e.append(t,this.form[t]);return e.delete("createTime"),e.delete("updateTime"),e},onSave:function(){var e=this;this.$refs.managerForm.validate((function(t){if(e.valid=t,!t)return!1;e.updateLoading=!0,1===e.editMove&&e.addMenu(e.setFormData()),2===e.editMove&&e.updateMenu(e.setFormData())}))},handleEdit:function(e){var t=this;this.editMove=2,this.dialogVisible=!0,this.dialogTitle="修改菜单",l["a"].menuInfo({menuId:e}).then((function(e){t.form=e.data}))},handleSelectDelete:function(){var e=this;this.$confirm("确定要删除选中的角色吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=[];e.multipleSelection.forEach((function(e){t.push(e.id)})),e.deleteMenu(t)}))},handleDelete:function(e){var t=this;this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteMenu(e)}))},deleteMenu:function(e){var t=this;l["a"].delete({menuIds:e}).then((function(){t.onSuccess("删除成功!")})).catch((function(){t.onError()}))},updateMenu:function(e){var t=this;l["a"].update(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},addMenu:function(e){var t=this;l["a"].add(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},onSuccess:function(e){this.getMenuTree();var t="保存成功!";e&&(t=e),this.updateLoading=!1,this.dialogVisible=!1,this.$message({message:t,type:"success",duration:1e3})},onError:function(){this.updateLoading=!1}}},I=F,M=(i("e874"),Object(k["a"])(I,n,a,!1,null,"632078b1",null));t["default"]=M.exports},b011:function(e,t,i){},b0d9:function(e,t,i){"use strict";i.r(t);i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.title,fullscreen:!0,visible:e.newArticleDialogVisible,"before-close":e.handleClose,"destroy-on-close":!0},on:{"update:visible":function(t){e.newArticleDialogVisible=t},open:e.openDialog,close:e.closeDialog}},[t("markdown-editor",{ref:"editor",attrs:{"has-change":e.hasChange,"alone-page":e.alonePage,"site-url":e.siteUrl,"is-edit":e.isEdit},on:{"update:hasChange":function(t){e.hasChange=t},"update:has-change":function(t){e.hasChange=t},onTitle:e.onTitle,onRelease:e.onRelease}})],1),e._v(" "),t("el-card",{staticClass:"box-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"box-card-header"},[t("div",{staticClass:"clearfix card-header-back"},[t("span",[e._v(e._s(e.alonePage?"管理独立页面":"管理文章"))]),e._v(" "),t("el-button",{staticClass:"card-button",attrs:{size:"mini",type:"primary"},on:{click:e.newArticle}},[e._v(e._s(e.newArticleText))])],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:this.multipleSelection.length>0,expression:"this.multipleSelection.length > 0"}],staticClass:"card-header-right"},[t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.handleDelete()}}},[e._v("删除")])],1)])]),e._v(" "),t("div",[t("div",{staticClass:"table-top"},[t("el-row",[t("el-col",{attrs:{xs:24,sm:5}},[t("div",{staticClass:"query-item"},[t("el-badge",{attrs:{hidden:0===e.draftNums,value:e.draftNums,type:"primary"}},[t("el-radio-group",{attrs:{size:"mini"},on:{change:e.getArticleList},model:{value:e.query.radioStatus,callback:function(t){e.$set(e.query,"radioStatus",t)},expression:"query.radioStatus"}},[t("el-radio-button",{attrs:{label:""}},[e._v("可用")]),e._v(" "),e.alonePage?e._e():t("el-radio-button",{attrs:{label:"release"}},[e._v("已发布")]),e._v(" "),t("el-radio-button",{attrs:{label:"draft"}},[e._v("草稿")])],1)],1)],1)]),e._v(" "),t("el-col",{attrs:{xs:24,sm:5}},[t("div",{staticClass:"query-item"},[t("span",{staticClass:"table-top-author"},[e._v("作者:")]),e._v(" "),t("el-radio-group",{attrs:{size:"mini"},on:{change:e.getArticleList},model:{value:e.query.radioUser,callback:function(t){e.$set(e.query,"radioUser",t)},expression:"query.radioUser"}},[t("el-radio-button",{attrs:{label:"all"}},[e._v("所有")]),e._v(" "),t("el-radio-button",{attrs:{label:"my"}},[e._v("我的")])],1)],1)]),e._v(" "),t("el-col",{staticClass:"text-align-right",attrs:{xs:24,sm:14}},[e.isFilter?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.cancelFilter}},[e._v("取消筛选")]):e._e(),e._v(" "),t("el-input",{staticClass:"query-item",staticStyle:{width:"unset"},attrs:{clearable:"",size:"mini",placeholder:"请输入关键字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getArticleList.apply(null,arguments)}},model:{value:e.query.keyword,callback:function(t){e.$set(e.query,"keyword",t)},expression:"query.keyword"}}),e._v(" "),t("multiple-tree-select",{ref:"selectTree",staticClass:"query-item",attrs:{placeholder:"请选择分类",size:"mini","collapse-tags":"",options:e.categories},model:{value:e.categoryIdsList,callback:function(t){e.categoryIdsList=t},expression:"categoryIdsList"}}),e._v(" "),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.theFilter}},[e._v("筛选")])],1)],1)],1),e._v(" "),t("el-table",{class:{"el-table-alone-page":e.alonePage},attrs:{data:e.articleList,"max-height":e.tableMaxHeight,"row-key":"id",size:"medium"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),t("el-table-column",{attrs:{prop:"name","show-overflow-tooltip":!0,"min-width":"200",label:"标题"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("a",{attrs:{title:"编辑 "+i.row.name},on:{click:function(t){return e.editArticle(i.row.id)}}},[e._v(e._s(i.row.name)),t("svg-icon",{attrs:{"icon-class":"bianji-"}})],1),e._v(" "),t("a",{attrs:{title:"浏览 "+i.row.name,href:(e.alonePage?e.siteUrl+"/o/":e.siteUrl+"/s/")+i.row.slug,target:"_blank"}},[t("svg-icon",{staticClass:"wailian",attrs:{"icon-class":"wailian"}})],1)]}}])}),e._v(" "),e.alonePage?e._e():t("el-table-column",{attrs:{"min-width":"100",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.draft?t("el-tag",{attrs:{size:"medium",type:"warning"}},[e._v("草稿")]):e._e(),e._v(" "),i.row.release?t("el-tag",{attrs:{size:"medium",type:"success"}},[e._v("已发布")]):e._e(),e._v(" "),i.row.release?e._e():t("el-tag",{attrs:{size:"medium",type:"info"}},[e._v("未发布")])]}}],null,!1,4167391289)}),e._v(" "),e.alonePage?t("el-table-column",{attrs:{prop:"slug",label:"缩略名"}}):e._e(),e._v(" "),t("el-table-column",{attrs:{prop:"username",label:"作者"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.alonePage?e._e():t("a",{on:{click:function(t){return e.theFilterUserId(i.row.userId)}}},[e._v(e._s(i.row.username))]),e._v(" "),e.alonePage?t("span",[e._v(e._s(i.row.username))]):e._e()]}}])}),e._v(" "),e.alonePage?e._e():t("el-table-column",{attrs:{prop:"categories",label:"分类"},scopedSlots:e._u([{key:"default",fn:function(i){return e._l(i.row.categories,(function(i,n){return t("span",[e._v("\n            "+e._s(n>0?",":"")+"\n            "),t("a",{on:{click:function(t){return e.theFilterCategoty(i.id)}}},[e._v(e._s(i.name))])])}))}}],null,!1,3795730018)}),e._v(" "),t("el-table-column",{attrs:{prop:"updateDate",label:"发布日期",width:"160"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.uploadDate.substring(0,16)))])]}}])})],1)],1),e._v(" "),t("el-pagination",{staticStyle:{"text-align":"center"},attrs:{background:"","hide-on-single-page":!0,"current-page":e.pagination.pageIndex,"page-sizes":e.pagination.pageSizes,"page-size":e.pagination.pageSize,total:e.pagination.total,layout:"total, prev, pager, next"},on:{"update:currentPage":function(t){return e.$set(e.pagination,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageIndex",t)},"current-change":e.currentChange}})],1)],1)},a=[];i("a481"),i("28a5"),i("ac6a");function o(e,t,i){return(t=h(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)({}).hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r.apply(null,arguments)}function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function c(e,t){if(null==e)return{};var i,n,a=d(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)i=o[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function d(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}function u(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function h(e){var t=u(e,"string");return"symbol"==typeof t?t:t+""}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var f="1.15.7";function m(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var g=m(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),v=m(/Edge/i),b=m(/firefox/i),w=m(/safari/i)&&!m(/chrome/i)&&!m(/android/i),y=m(/iP(ad|od|hone)/i),x=m(/chrome/i)&&m(/android/i),C={capture:!1,passive:!1};function k(e,t,i){e.addEventListener(t,i,!g&&C)}function _(e,t,i){e.removeEventListener(t,i,!g&&C)}function S(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(i){return!1}return!1}}function L(e){return e.host&&e!==document&&e.host.nodeType&&e.host!==e?e.host:e.parentNode}function T(e,t,i,n){if(e){i=i||document;do{if(null!=t&&(">"===t[0]?e.parentNode===i&&S(e,t):S(e,t))||n&&e===i)return e;if(e===i)break}while(e=L(e))}return null}var D,E=/\s+/g;function F(e,t,i){if(e&&t)if(e.classList)e.classList[i?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(E," ").replace(" "+t+" "," ");e.className=(n+(i?" "+t:"")).replace(E," ")}}function I(e,t,i){var n=e&&e.style;if(n){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=i+("string"===typeof i?"":"px")}}function M(e,t){var i="";if("string"===typeof e)i=e;else do{var n=I(e,"transform");n&&"none"!==n&&(i=n+" "+i)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(i)}function N(e,t,i){if(e){var n=e.getElementsByTagName(t),a=0,o=n.length;if(i)for(;a<o;a++)i(n[a],a);return n}return[]}function O(){var e=document.scrollingElement;return e||document.documentElement}function A(e,t,i,n,a){if(e.getBoundingClientRect||e===window){var o,r,s,l,c,d,u;if(e!==window&&e.parentNode&&e!==O()?(o=e.getBoundingClientRect(),r=o.top,s=o.left,l=o.bottom,c=o.right,d=o.height,u=o.width):(r=0,s=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||i)&&e!==window&&(a=a||e.parentNode,!g))do{if(a&&a.getBoundingClientRect&&("none"!==I(a,"transform")||i&&"static"!==I(a,"position"))){var h=a.getBoundingClientRect();r-=h.top+parseInt(I(a,"border-top-width")),s-=h.left+parseInt(I(a,"border-left-width")),l=r+o.height,c=s+o.width;break}}while(a=a.parentNode);if(n&&e!==window){var p=M(a||e),f=p&&p.a,m=p&&p.d;p&&(r/=m,s/=f,u/=f,d/=m,l=r+d,c=s+u)}return{top:r,left:s,bottom:l,right:c,width:u,height:d}}}function P(e,t,i){var n=z(e,!0),a=A(e)[t];while(n){var o=A(n)[i],r=void 0;if(r="top"===i||"left"===i?a>=o:a<=o,!r)return n;if(n===O())break;n=z(n,!1)}return!1}function $(e,t,i,n){var a=0,o=0,r=e.children;while(o<r.length){if("none"!==r[o].style.display&&r[o]!==Ze.ghost&&(n||r[o]!==Ze.dragged)&&T(r[o],i.draggable,e,!1)){if(a===t)return r[o];a++}o++}return null}function R(e,t){var i=e.lastElementChild;while(i&&(i===Ze.ghost||"none"===I(i,"display")||t&&!S(i,t)))i=i.previousElementSibling;return i||null}function H(e,t){var i=0;if(!e||!e.parentNode)return-1;while(e=e.previousElementSibling)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ze.clone||t&&!S(e,t)||i++;return i}function j(e){var t=0,i=0,n=O();if(e)do{var a=M(e),o=a.a,r=a.d;t+=e.scrollLeft*o,i+=e.scrollTop*r}while(e!==n&&(e=e.parentNode));return[t,i]}function q(e,t){for(var i in e)if(e.hasOwnProperty(i))for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[i][n])return Number(i);return-1}function z(e,t){if(!e||!e.getBoundingClientRect)return O();var i=e,n=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var a=I(i);if(i.clientWidth<i.scrollWidth&&("auto"==a.overflowX||"scroll"==a.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==a.overflowY||"scroll"==a.overflowY)){if(!i.getBoundingClientRect||i===document.body)return O();if(n||t)return i;n=!0}}}while(i=i.parentNode);return O()}function B(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function V(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function U(e,t){return function(){if(!D){var i=arguments,n=this;1===i.length?e.call(n,i[0]):e.apply(n,i),D=setTimeout((function(){D=void 0}),t)}}}function W(){clearTimeout(D),D=void 0}function G(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function X(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}function K(e,t,i){var n={};return Array.from(e.children).forEach((function(a){var o,r,s,l;if(T(a,t.draggable,e,!1)&&!a.animated&&a!==i){var c=A(a);n.left=Math.min(null!==(o=n.left)&&void 0!==o?o:1/0,c.left),n.top=Math.min(null!==(r=n.top)&&void 0!==r?r:1/0,c.top),n.right=Math.max(null!==(s=n.right)&&void 0!==s?s:-1/0,c.right),n.bottom=Math.max(null!==(l=n.bottom)&&void 0!==l?l:-1/0,c.bottom)}})),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var Y="Sortable"+(new Date).getTime();function J(){var e,t=[];return{captureAnimationState:function(){if(t=[],this.options.animation){var e=[].slice.call(this.el.children);e.forEach((function(e){if("none"!==I(e,"display")&&e!==Ze.ghost){t.push({target:e,rect:A(e)});var i=l({},t[t.length-1].rect);if(e.thisAnimationDuration){var n=M(e,!0);n&&(i.top-=n.f,i.left-=n.e)}e.fromRect=i}}))}},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(q(t,{target:e}),1)},animateAll:function(i){var n=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof i&&i());var a=!1,o=0;t.forEach((function(e){var t=0,i=e.target,r=i.fromRect,s=A(i),l=i.prevFromRect,c=i.prevToRect,d=e.rect,u=M(i,!0);u&&(s.top-=u.f,s.left-=u.e),i.toRect=s,i.thisAnimationDuration&&V(l,s)&&!V(r,s)&&(d.top-s.top)/(d.left-s.left)===(r.top-s.top)/(r.left-s.left)&&(t=Z(d,l,c,n.options)),V(s,r)||(i.prevFromRect=r,i.prevToRect=s,t||(t=n.options.animation),n.animate(i,d,s,t)),t&&(a=!0,o=Math.max(o,t),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout((function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null}),t),i.thisAnimationDuration=t)})),clearTimeout(e),a?e=setTimeout((function(){"function"===typeof i&&i()}),o):"function"===typeof i&&i(),t=[]},animate:function(e,t,i,n){if(n){I(e,"transition",""),I(e,"transform","");var a=M(this.el),o=a&&a.a,r=a&&a.d,s=(t.left-i.left)/(o||1),l=(t.top-i.top)/(r||1);e.animatingX=!!s,e.animatingY=!!l,I(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=Q(e),I(e,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),I(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){I(e,"transition",""),I(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),n)}}}}function Q(e){return e.offsetWidth}function Z(e,t,i,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))*n.animation}var ee=[],te={initializeByDefault:!0},ie={mount:function(e){for(var t in te)te.hasOwnProperty(t)&&!(t in e)&&(e[t]=te[t]);ee.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),ee.push(e)},pluginEvent:function(e,t,i){var n=this;this.eventCanceled=!1,i.cancel=function(){n.eventCanceled=!0};var a=e+"Global";ee.forEach((function(n){t[n.pluginName]&&(t[n.pluginName][a]&&t[n.pluginName][a](l({sortable:t},i)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](l({sortable:t},i)))}))},initializePlugins:function(e,t,i,n){for(var a in ee.forEach((function(n){var a=n.pluginName;if(e.options[a]||n.initializeByDefault){var o=new n(e,t,e.options);o.sortable=e,o.options=e.options,e[a]=o,r(i,o.defaults)}})),e.options)if(e.options.hasOwnProperty(a)){var o=this.modifyOption(e,a,e.options[a]);"undefined"!==typeof o&&(e.options[a]=o)}},getEventProperties:function(e,t){var i={};return ee.forEach((function(n){"function"===typeof n.eventProperties&&r(i,n.eventProperties.call(t[n.pluginName],e))})),i},modifyOption:function(e,t,i){var n;return ee.forEach((function(a){e[a.pluginName]&&a.optionListeners&&"function"===typeof a.optionListeners[t]&&(n=a.optionListeners[t].call(e[a.pluginName],i))})),n}};function ne(e){var t=e.sortable,i=e.rootEl,n=e.name,a=e.targetEl,o=e.cloneEl,r=e.toEl,s=e.fromEl,c=e.oldIndex,d=e.newIndex,u=e.oldDraggableIndex,h=e.newDraggableIndex,p=e.originalEvent,f=e.putSortable,m=e.extraEventProperties;if(t=t||i&&i[Y],t){var b,w=t.options,y="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||g||v?(b=document.createEvent("Event"),b.initEvent(n,!0,!0)):b=new CustomEvent(n,{bubbles:!0,cancelable:!0}),b.to=r||i,b.from=s||i,b.item=a||i,b.clone=o,b.oldIndex=c,b.newIndex=d,b.oldDraggableIndex=u,b.newDraggableIndex=h,b.originalEvent=p,b.pullMode=f?f.lastPutMode:void 0;var x=l(l({},m),ie.getEventProperties(n,t));for(var C in x)b[C]=x[C];i&&i.dispatchEvent(b),w[y]&&w[y].call(t,b)}}var ae=["evt"],oe=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.evt,a=c(i,ae);ie.pluginEvent.bind(Ze)(e,t,l({dragEl:se,parentEl:le,ghostEl:ce,rootEl:de,nextEl:ue,lastDownEl:he,cloneEl:pe,cloneHidden:fe,dragStarted:Te,putSortable:ye,activeSortable:Ze.active,originalEvent:n,oldIndex:me,oldDraggableIndex:ve,newIndex:ge,newDraggableIndex:be,hideGhostForTarget:Ke,unhideGhostForTarget:Ye,cloneNowHidden:function(){fe=!0},cloneNowShown:function(){fe=!1},dispatchSortableEvent:function(e){re({sortable:t,name:e,originalEvent:n})}},a))};function re(e){ne(l({putSortable:ye,cloneEl:pe,targetEl:se,rootEl:de,oldIndex:me,oldDraggableIndex:ve,newIndex:ge,newDraggableIndex:be},e))}var se,le,ce,de,ue,he,pe,fe,me,ge,ve,be,we,ye,xe,Ce,ke,_e,Se,Le,Te,De,Ee,Fe,Ie,Me=!1,Ne=!1,Oe=[],Ae=!1,Pe=!1,$e=[],Re=!1,He=[],je="undefined"!==typeof document,qe=y,ze=v||g?"cssFloat":"float",Be=je&&!x&&!y&&"draggable"in document.createElement("div"),Ve=function(){if(je){if(g)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Ue=function(e,t){var i=I(e),n=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),a=$(e,0,t),o=$(e,1,t),r=a&&I(a),s=o&&I(o),l=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+A(a).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+A(o).width;if("flex"===i.display)return"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal";if("grid"===i.display)return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&r["float"]&&"none"!==r["float"]){var d="left"===r["float"]?"left":"right";return!o||"both"!==s.clear&&s.clear!==d?"horizontal":"vertical"}return a&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||l>=n&&"none"===i[ze]||o&&"none"===i[ze]&&l+c>n)?"vertical":"horizontal"},We=function(e,t,i){var n=i?e.left:e.top,a=i?e.right:e.bottom,o=i?e.width:e.height,r=i?t.left:t.top,s=i?t.right:t.bottom,l=i?t.width:t.height;return n===r||a===s||n+o/2===r+l/2},Ge=function(e,t){var i;return Oe.some((function(n){var a=n[Y].options.emptyInsertThreshold;if(a&&!R(n)){var o=A(n),r=e>=o.left-a&&e<=o.right+a,s=t>=o.top-a&&t<=o.bottom+a;return r&&s?i=n:void 0}})),i},Xe=function(e){function t(e,i){return function(n,a,o,r){var s=n.options.group.name&&a.options.group.name&&n.options.group.name===a.options.group.name;if(null==e&&(i||s))return!0;if(null==e||!1===e)return!1;if(i&&"clone"===e)return e;if("function"===typeof e)return t(e(n,a,o,r),i)(n,a,o,r);var l=(i?n:a).options.group.name;return!0===e||"string"===typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var i={},n=e.group;n&&"object"==p(n)||(n={name:n}),i.name=n.name,i.checkPull=t(n.pull,!0),i.checkPut=t(n.put),i.revertClone=n.revertClone,e.group=i},Ke=function(){!Ve&&ce&&I(ce,"display","none")},Ye=function(){!Ve&&ce&&I(ce,"display","")};je&&!x&&document.addEventListener("click",(function(e){if(Ne)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Ne=!1,!1}),!0);var Je=function(e){if(se){e=e.touches?e.touches[0]:e;var t=Ge(e.clientX,e.clientY);if(t){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[Y]._onDragOver(i)}}},Qe=function(e){se&&se.parentNode[Y]._isOutsideThisEl(e.target)};function Ze(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=r({},t),e[Y]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ue(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ze.supportPointer&&"PointerEvent"in window&&(!w||y),emptyInsertThreshold:5};for(var n in ie.initializePlugins(this,e,i),i)!(n in t)&&(t[n]=i[n]);for(var a in Xe(t),this)"_"===a.charAt(0)&&"function"===typeof this[a]&&(this[a]=this[a].bind(this));this.nativeDraggable=!t.forceFallback&&Be,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?k(e,"pointerdown",this._onTapStart):(k(e,"mousedown",this._onTapStart),k(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(k(e,"dragover",this),k(e,"dragenter",this)),Oe.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),r(this,J())}function et(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function tt(e,t,i,n,a,o,r,s){var l,c,d=e[Y],u=d.options.onMove;return!window.CustomEvent||g||v?(l=document.createEvent("Event"),l.initEvent("move",!0,!0)):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=i,l.draggedRect=n,l.related=a||t,l.relatedRect=o||A(t),l.willInsertAfter=s,l.originalEvent=r,e.dispatchEvent(l),u&&(c=u.call(d,l,r)),c}function it(e){e.draggable=!1}function nt(){Re=!1}function at(e,t,i){var n=A($(i.el,0,i.options,!0)),a=K(i.el,i.options,ce),o=10;return t?e.clientX<a.left-o||e.clientY<n.top&&e.clientX<n.right:e.clientY<a.top-o||e.clientY<n.bottom&&e.clientX<n.left}function ot(e,t,i){var n=A(R(i.el,i.options.draggable)),a=K(i.el,i.options,ce),o=10;return t?e.clientX>a.right+o||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>a.bottom+o||e.clientX>n.right&&e.clientY>n.top}function rt(e,t,i,n,a,o,r,s){var l=n?e.clientY:e.clientX,c=n?i.height:i.width,d=n?i.top:i.left,u=n?i.bottom:i.right,h=!1;if(!r)if(s&&Fe<c*a){if(!Ae&&(1===Ee?l>d+c*o/2:l<u-c*o/2)&&(Ae=!0),Ae)h=!0;else if(1===Ee?l<d+Fe:l>u-Fe)return-Ee}else if(l>d+c*(1-a)/2&&l<u-c*(1-a)/2)return st(t);return h=h||r,h&&(l<d+c*o/2||l>u-c*o/2)?l>d+c/2?1:-1:0}function st(e){return H(se)<H(e)?1:-1}function lt(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,n=0;while(i--)n+=t.charCodeAt(i);return n.toString(36)}function ct(e){He.length=0;var t=e.getElementsByTagName("input"),i=t.length;while(i--){var n=t[i];n.checked&&He.push(n)}}function dt(e){return setTimeout(e,0)}function ut(e){return clearTimeout(e)}Ze.prototype={constructor:Ze,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(De=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,se):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,n=this.options,a=n.preventOnFilter,o=e.type,r=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(r||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=n.filter;if(ct(i),!se&&!(/mousedown|pointerdown/.test(o)&&0!==e.button||n.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!w||!s||"SELECT"!==s.tagName.toUpperCase())&&(s=T(s,n.draggable,i,!1),(!s||!s.animated)&&he!==s)){if(me=H(s),ve=H(s,n.draggable),"function"===typeof c){if(c.call(this,e,s,this))return re({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:i,fromEl:i}),oe("filter",t,{evt:e}),void(a&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(n){if(n=T(l,n.trim(),i,!1),n)return re({sortable:t,rootEl:n,name:"filter",targetEl:s,fromEl:i,toEl:i}),oe("filter",t,{evt:e}),!0})),c))return void(a&&e.preventDefault());n.handle&&!T(l,n.handle,i,!1)||this._prepareDragStart(e,r,s)}}},_prepareDragStart:function(e,t,i){var n,a=this,o=a.el,r=a.options,s=o.ownerDocument;if(i&&!se&&i.parentNode===o){var l=A(i);if(de=o,se=i,le=se.parentNode,ue=se.nextSibling,he=i,we=r.group,Ze.dragged=se,xe={target:se,clientX:(t||e).clientX,clientY:(t||e).clientY},Se=xe.clientX-l.left,Le=xe.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,se.style["will-change"]="all",n=function(){oe("delayEnded",a,{evt:e}),Ze.eventCanceled?a._onDrop():(a._disableDelayedDragEvents(),!b&&a.nativeDraggable&&(se.draggable=!0),a._triggerDragStart(e,t),re({sortable:a,name:"choose",originalEvent:e}),F(se,r.chosenClass,!0))},r.ignore.split(",").forEach((function(e){N(se,e.trim(),it)})),k(s,"dragover",Je),k(s,"mousemove",Je),k(s,"touchmove",Je),r.supportPointer?(k(s,"pointerup",a._onDrop),!this.nativeDraggable&&k(s,"pointercancel",a._onDrop)):(k(s,"mouseup",a._onDrop),k(s,"touchend",a._onDrop),k(s,"touchcancel",a._onDrop)),b&&this.nativeDraggable&&(this.options.touchStartThreshold=4,se.draggable=!0),oe("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(v||g))n();else{if(Ze.eventCanceled)return void this._onDrop();r.supportPointer?(k(s,"pointerup",a._disableDelayedDrag),k(s,"pointercancel",a._disableDelayedDrag)):(k(s,"mouseup",a._disableDelayedDrag),k(s,"touchend",a._disableDelayedDrag),k(s,"touchcancel",a._disableDelayedDrag)),k(s,"mousemove",a._delayedDragTouchMoveHandler),k(s,"touchmove",a._delayedDragTouchMoveHandler),r.supportPointer&&k(s,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(n,r.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){se&&it(se),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._disableDelayedDrag),_(e,"touchend",this._disableDelayedDrag),_(e,"touchcancel",this._disableDelayedDrag),_(e,"pointerup",this._disableDelayedDrag),_(e,"pointercancel",this._disableDelayedDrag),_(e,"mousemove",this._delayedDragTouchMoveHandler),_(e,"touchmove",this._delayedDragTouchMoveHandler),_(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?k(document,"pointermove",this._onTouchMove):k(document,t?"touchmove":"mousemove",this._onTouchMove):(k(se,"dragend",this),k(de,"dragstart",this._onDragStart));try{document.selection?dt((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(i){}},_dragStarted:function(e,t){if(Me=!1,de&&se){oe("dragStarted",this,{evt:t}),this.nativeDraggable&&k(document,"dragover",Qe);var i=this.options;!e&&F(se,i.dragClass,!1),F(se,i.ghostClass,!0),Ze.active=this,e&&this._appendGhost(),re({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Ce){this._lastX=Ce.clientX,this._lastY=Ce.clientY,Ke();var e=document.elementFromPoint(Ce.clientX,Ce.clientY),t=e;while(e&&e.shadowRoot){if(e=e.shadowRoot.elementFromPoint(Ce.clientX,Ce.clientY),e===t)break;t=e}if(se.parentNode[Y]._isOutsideThisEl(e),t)do{if(t[Y]){var i=void 0;if(i=t[Y]._onDragOver({clientX:Ce.clientX,clientY:Ce.clientY,target:e,rootEl:t}),i&&!this.options.dragoverBubble)break}e=t}while(t=L(t));Ye()}},_onTouchMove:function(e){if(xe){var t=this.options,i=t.fallbackTolerance,n=t.fallbackOffset,a=e.touches?e.touches[0]:e,o=ce&&M(ce,!0),r=ce&&o&&o.a,s=ce&&o&&o.d,l=qe&&Ie&&j(Ie),c=(a.clientX-xe.clientX+n.x)/(r||1)+(l?l[0]-$e[0]:0)/(r||1),d=(a.clientY-xe.clientY+n.y)/(s||1)+(l?l[1]-$e[1]:0)/(s||1);if(!Ze.active&&!Me){if(i&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(ce){o?(o.e+=c-(ke||0),o.f+=d-(_e||0)):o={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");I(ce,"webkitTransform",u),I(ce,"mozTransform",u),I(ce,"msTransform",u),I(ce,"transform",u),ke=c,_e=d,Ce=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ce){var e=this.options.fallbackOnBody?document.body:de,t=A(se,!0,qe,!0,e),i=this.options;if(qe){Ie=e;while("static"===I(Ie,"position")&&"none"===I(Ie,"transform")&&Ie!==document)Ie=Ie.parentNode;Ie!==document.body&&Ie!==document.documentElement?(Ie===document&&(Ie=O()),t.top+=Ie.scrollTop,t.left+=Ie.scrollLeft):Ie=O(),$e=j(Ie)}ce=se.cloneNode(!0),F(ce,i.ghostClass,!1),F(ce,i.fallbackClass,!0),F(ce,i.dragClass,!0),I(ce,"transition",""),I(ce,"transform",""),I(ce,"box-sizing","border-box"),I(ce,"margin",0),I(ce,"top",t.top),I(ce,"left",t.left),I(ce,"width",t.width),I(ce,"height",t.height),I(ce,"opacity","0.8"),I(ce,"position",qe?"absolute":"fixed"),I(ce,"zIndex","100000"),I(ce,"pointerEvents","none"),Ze.ghost=ce,e.appendChild(ce),I(ce,"transform-origin",Se/parseInt(ce.style.width)*100+"% "+Le/parseInt(ce.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,n=e.dataTransfer,a=i.options;oe("dragStart",this,{evt:e}),Ze.eventCanceled?this._onDrop():(oe("setupClone",this),Ze.eventCanceled||(pe=X(se),pe.removeAttribute("id"),pe.draggable=!1,pe.style["will-change"]="",this._hideClone(),F(pe,this.options.chosenClass,!1),Ze.clone=pe),i.cloneId=dt((function(){oe("clone",i),Ze.eventCanceled||(i.options.removeCloneOnHide||de.insertBefore(pe,se),i._hideClone(),re({sortable:i,name:"clone"}))})),!t&&F(se,a.dragClass,!0),t?(Ne=!0,i._loopId=setInterval(i._emulateDragOver,50)):(_(document,"mouseup",i._onDrop),_(document,"touchend",i._onDrop),_(document,"touchcancel",i._onDrop),n&&(n.effectAllowed="move",a.setData&&a.setData.call(i,n,se)),k(document,"drop",i),I(se,"transform","translateZ(0)")),Me=!0,i._dragStartId=dt(i._dragStarted.bind(i,t,e)),k(document,"selectstart",i),Te=!0,window.getSelection().removeAllRanges(),w&&I(document.body,"user-select","none"))},_onDragOver:function(e){var t,i,n,a,o=this.el,r=e.target,s=this.options,c=s.group,d=Ze.active,u=we===c,h=s.sort,p=ye||d,f=this,m=!1;if(!Re){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),r=T(r,s.draggable,o,!0),N("dragOver"),Ze.eventCanceled)return m;if(se.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||f._ignoreWhileAnimating===r)return j(!1);if(Ne=!1,d&&!s.disabled&&(u?h||(n=le!==de):ye===this||(this.lastPutMode=we.checkPull(this,d,se,e))&&c.checkPut(this,d,se,e))){if(a="vertical"===this._getDirection(e,r),t=A(se),N("dragOverValid"),Ze.eventCanceled)return m;if(n)return le=de,O(),this._hideClone(),N("revert"),Ze.eventCanceled||(ue?de.insertBefore(se,ue):de.appendChild(se)),j(!0);var g=R(o,s.draggable);if(!g||ot(e,a,this)&&!g.animated){if(g===se)return j(!1);if(g&&o===e.target&&(r=g),r&&(i=A(r)),!1!==tt(de,o,se,t,r,i,e,!!r))return O(),g&&g.nextSibling?o.insertBefore(se,g.nextSibling):o.appendChild(se),le=o,q(),j(!0)}else if(g&&at(e,a,this)){var v=$(o,0,s,!0);if(v===se)return j(!1);if(r=v,i=A(r),!1!==tt(de,o,se,t,r,i,e,!1))return O(),o.insertBefore(se,v),le=o,q(),j(!0)}else if(r.parentNode===o){i=A(r);var b,w,y=0,x=se.parentNode!==o,C=!We(se.animated&&se.toRect||t,r.animated&&r.toRect||i,a),k=a?"top":"left",_=P(r,"top","top")||P(se,"top","top"),S=_?_.scrollTop:void 0;if(De!==r&&(b=i[k],Ae=!1,Pe=!C&&s.invertSwap||x),y=rt(e,r,i,a,C?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,Pe,De===r),0!==y){var L=H(se);do{L-=y,w=le.children[L]}while(w&&("none"===I(w,"display")||w===ce))}if(0===y||w===r)return j(!1);De=r,Ee=y;var D=r.nextElementSibling,E=!1;E=1===y;var M=tt(de,o,se,t,r,i,e,E);if(!1!==M)return 1!==M&&-1!==M||(E=1===M),Re=!0,setTimeout(nt,30),O(),E&&!D?o.appendChild(se):r.parentNode.insertBefore(se,E?D:r),_&&G(_,0,S-_.scrollTop),le=se.parentNode,void 0===b||Pe||(Fe=Math.abs(b-A(r)[k])),q(),j(!0)}if(o.contains(se))return j(!1)}return!1}function N(s,c){oe(s,f,l({evt:e,isOwner:u,axis:a?"vertical":"horizontal",revert:n,dragRect:t,targetRect:i,canSort:h,fromSortable:p,target:r,completed:j,onMove:function(i,n){return tt(de,o,se,t,i,A(i),e,n)},changed:q},c))}function O(){N("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function j(t){return N("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(f),f!==p&&(F(se,ye?ye.options.ghostClass:d.options.ghostClass,!1),F(se,s.ghostClass,!0)),ye!==f&&f!==Ze.active?ye=f:f===Ze.active&&ye&&(ye=null),p===f&&(f._ignoreWhileAnimating=r),f.animateAll((function(){N("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(r===se&&!se.animated||r===o&&!r.animated)&&(De=null),s.dragoverBubble||e.rootEl||r===document||(se.parentNode[Y]._isOutsideThisEl(e.target),!t&&Je(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function q(){ge=H(se),be=H(se,s.draggable),re({sortable:f,name:"change",toEl:o,newIndex:ge,newDraggableIndex:be,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){_(document,"mousemove",this._onTouchMove),_(document,"touchmove",this._onTouchMove),_(document,"pointermove",this._onTouchMove),_(document,"dragover",Je),_(document,"mousemove",Je),_(document,"touchmove",Je)},_offUpEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._onDrop),_(e,"touchend",this._onDrop),_(e,"pointerup",this._onDrop),_(e,"pointercancel",this._onDrop),_(e,"touchcancel",this._onDrop),_(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;ge=H(se),be=H(se,i.draggable),oe("drop",this,{evt:e}),le=se&&se.parentNode,ge=H(se),be=H(se,i.draggable),Ze.eventCanceled||(Me=!1,Pe=!1,Ae=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ut(this.cloneId),ut(this._dragStartId),this.nativeDraggable&&(_(document,"drop",this),_(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),w&&I(document.body,"user-select",""),I(se,"transform",""),e&&(Te&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),ce&&ce.parentNode&&ce.parentNode.removeChild(ce),(de===le||ye&&"clone"!==ye.lastPutMode)&&pe&&pe.parentNode&&pe.parentNode.removeChild(pe),se&&(this.nativeDraggable&&_(se,"dragend",this),it(se),se.style["will-change"]="",Te&&!Me&&F(se,ye?ye.options.ghostClass:this.options.ghostClass,!1),F(se,this.options.chosenClass,!1),re({sortable:this,name:"unchoose",toEl:le,newIndex:null,newDraggableIndex:null,originalEvent:e}),de!==le?(ge>=0&&(re({rootEl:le,name:"add",toEl:le,fromEl:de,originalEvent:e}),re({sortable:this,name:"remove",toEl:le,originalEvent:e}),re({rootEl:le,name:"sort",toEl:le,fromEl:de,originalEvent:e}),re({sortable:this,name:"sort",toEl:le,originalEvent:e})),ye&&ye.save()):ge!==me&&ge>=0&&(re({sortable:this,name:"update",toEl:le,originalEvent:e}),re({sortable:this,name:"sort",toEl:le,originalEvent:e})),Ze.active&&(null!=ge&&-1!==ge||(ge=me,be=ve),re({sortable:this,name:"end",toEl:le,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){oe("nulling",this),de=se=le=ce=ue=pe=he=fe=xe=Ce=Te=ge=be=me=ve=De=Ee=ye=we=Ze.dragged=Ze.ghost=Ze.clone=Ze.active=null;var e=this.el;He.forEach((function(t){e.contains(t)&&(t.checked=!0)})),He.length=ke=_e=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":se&&(this._onDragOver(e),et(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e,t=[],i=this.el.children,n=0,a=i.length,o=this.options;n<a;n++)e=i[n],T(e,o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||lt(e));return t},sort:function(e,t){var i={},n=this.el;this.toArray().forEach((function(e,t){var a=n.children[t];T(a,this.options.draggable,n,!1)&&(i[e]=a)}),this),t&&this.captureAnimationState(),e.forEach((function(e){i[e]&&(n.removeChild(i[e]),n.appendChild(i[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return T(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];var n=ie.modifyOption(this,e,t);i[e]="undefined"!==typeof n?n:t,"group"===e&&Xe(i)},destroy:function(){oe("destroy",this);var e=this.el;e[Y]=null,_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart),_(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Oe.splice(Oe.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!fe){if(oe("hideClone",this),Ze.eventCanceled)return;I(pe,"display","none"),this.options.removeCloneOnHide&&pe.parentNode&&pe.parentNode.removeChild(pe),fe=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(fe){if(oe("showClone",this),Ze.eventCanceled)return;se.parentNode!=de||this.options.group.revertClone?ue?de.insertBefore(pe,ue):de.appendChild(pe):de.insertBefore(pe,se),this.options.group.revertClone&&this.animate(se,pe),I(pe,"display",""),fe=!1}}else this._hideClone()}},je&&k(document,"touchmove",(function(e){(Ze.active||Me)&&e.cancelable&&e.preventDefault()})),Ze.utils={on:k,off:_,css:I,find:N,is:function(e,t){return!!T(e,t,e,!1)},extend:B,throttle:U,closest:T,toggleClass:F,clone:X,index:H,nextTick:dt,cancelNextTick:ut,detectDirection:Ue,getChild:$,expando:Y},Ze.get=function(e){return e[Y]},Ze.mount=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Ze.utils=l(l({},Ze.utils),e.utils)),ie.mount(e)}))},Ze.create=function(e,t){return new Ze(e,t)},Ze.version=f;var ht,pt,ft,mt,gt,vt,bt=[],wt=!1;function yt(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?k(document,"dragover",this._handleAutoScroll):this.options.supportPointer?k(document,"pointermove",this._handleFallbackAutoScroll):t.touches?k(document,"touchmove",this._handleFallbackAutoScroll):k(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):(_(document,"pointermove",this._handleFallbackAutoScroll),_(document,"touchmove",this._handleFallbackAutoScroll),_(document,"mousemove",this._handleFallbackAutoScroll)),Ct(),xt(),W()},nulling:function(){gt=pt=ht=wt=vt=ft=mt=null,bt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var i=this,n=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,o=document.elementFromPoint(n,a);if(gt=e,t||this.options.forceAutoScrollFallback||v||g||w){kt(e,this.options,o,t);var r=z(o,!0);!wt||vt&&n===ft&&a===mt||(vt&&Ct(),vt=setInterval((function(){var o=z(document.elementFromPoint(n,a),!0);o!==r&&(r=o,xt()),kt(e,i.options,o,t)}),10),ft=n,mt=a)}else{if(!this.options.bubbleScroll||z(o,!0)===O())return void xt();kt(e,this.options,z(o,!1),!1)}}},r(e,{pluginName:"scroll",initializeByDefault:!0})}function xt(){bt.forEach((function(e){clearInterval(e.pid)})),bt=[]}function Ct(){clearInterval(vt)}var kt=U((function(e,t,i,n){if(t.scroll){var a,o=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,c=O(),d=!1;pt!==i&&(pt=i,xt(),ht=t.scroll,a=t.scrollFn,!0===ht&&(ht=z(i,!0)));var u=0,h=ht;do{var p=h,f=A(p),m=f.top,g=f.bottom,v=f.left,b=f.right,w=f.width,y=f.height,x=void 0,C=void 0,k=p.scrollWidth,_=p.scrollHeight,S=I(p),L=p.scrollLeft,T=p.scrollTop;p===c?(x=w<k&&("auto"===S.overflowX||"scroll"===S.overflowX||"visible"===S.overflowX),C=y<_&&("auto"===S.overflowY||"scroll"===S.overflowY||"visible"===S.overflowY)):(x=w<k&&("auto"===S.overflowX||"scroll"===S.overflowX),C=y<_&&("auto"===S.overflowY||"scroll"===S.overflowY));var D=x&&(Math.abs(b-o)<=s&&L+w<k)-(Math.abs(v-o)<=s&&!!L),E=C&&(Math.abs(g-r)<=s&&T+y<_)-(Math.abs(m-r)<=s&&!!T);if(!bt[u])for(var F=0;F<=u;F++)bt[F]||(bt[F]={});bt[u].vx==D&&bt[u].vy==E&&bt[u].el===p||(bt[u].el=p,bt[u].vx=D,bt[u].vy=E,clearInterval(bt[u].pid),0==D&&0==E||(d=!0,bt[u].pid=setInterval(function(){n&&0===this.layer&&Ze.active._onTouchMove(gt);var t=bt[this.layer].vy?bt[this.layer].vy*l:0,i=bt[this.layer].vx?bt[this.layer].vx*l:0;"function"===typeof a&&"continue"!==a.call(Ze.dragged.parentNode[Y],i,t,e,gt,bt[this.layer].el)||G(bt[this.layer].el,i,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==c&&(h=z(h,!1)));wt=d}}),30),_t=function(e){var t=e.originalEvent,i=e.putSortable,n=e.dragEl,a=e.activeSortable,o=e.dispatchSortableEvent,r=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=i||a;r();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(d)&&(o("spill"),this.onSpill({dragEl:n,putSortable:i}))}};function St(){}function Lt(){}St.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var n=$(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:_t},r(St,{pluginName:"revertOnSpill"}),Lt.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable,n=i||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:_t},r(Lt,{pluginName:"removeOnSpill"});Ze.mount(new yt),Ze.mount(Lt,St);var Tt=Ze,Dt=i("816e"),Et=i("021e"),Ft=i("c405"),It=i("5cfc"),Mt=i("9bf0"),Nt=i("eea1"),Ot={name:"articleManager",components:{MultipleTreeSelect:Nt["a"],MarkdownEditor:Dt["default"]},props:{pageTitle:{type:String,default:""},alonePage:{type:Boolean,default:!1},newArticleText:{type:String,default:""}},data:function(){return{tableMaxHeight:document.documentElement.clientHeight,newArticleDialogVisible:!1,title:this.pageTitle,hasChange:!1,articleList:[],pagination:{pageIndex:this.$route.query.page?parseInt(decodeURI(this.$route.query.page)):1,pageSize:12,total:0},categories:[],categoryIdsList:[],isFilter:!1,query:{radioStatus:"",radioUser:"my",userId:void 0,keyword:void 0,categoryIds:void 0},draftNums:0,multipleSelection:[],siteUrl:"".concat(window.location.origin,"/articles"),isEdit:!1}},computed:{},created:function(){this.$route.query.keyword&&(this.query.keyword=this.$route.query.keyword,this.isFilter=!0),this.$route.query.categoryIds&&(this.query.categoryIds=this.$route.query.categoryIds,this.isFilter=!0)},mounted:function(){var e=this;this.getArticleList(),this.categoryTree(),this.getWebsiteSetting(),this.newArticleDialogVisible=!!this.$route.query.operation,window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1)),window.addEventListener("beforeunload",(function(t){return e.beforeunloadFn(t)})),this.alonePage&&(document.body.ondrop=function(e){e.preventDefault(),e.stopPropagation()},this.rowDrop()),this.setMaxHeight();var t=this;window.onresize=function(){t.setMaxHeight()}},watch:{hasChange:function(e){window.onbeforeunload=e?function(){return"还有文件正在上传, 确定退出吗?"}:null}},methods:{setMaxHeight:function(){this.tableMaxHeight=document.documentElement.clientHeight-265},rowDrop:function(){var e=document.querySelector(".el-table__body-wrapper tbody"),t=this;Tt.create(e,{onEnd:function(e){var i=e.newIndex,n=e.oldIndex,a=t.articleList.splice(n,1)[0];t.articleList.splice(i,0,a);var o=[];t.articleList.forEach((function(e){o.push(e.id)})),Et["a"].sortMarkdown(o).then((function(){})).catch((function(){}))}})},handleSelectionChange:function(e){this.multipleSelection=e},handleDelete:function(){var e=this,t=[];this.multipleSelection.length>0&&this.multipleSelection.forEach((function(e){t.push(e.id)})),this.$confirm("此操作将永久删除选中的文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){It["a"].delete({currentDirectory:"",username:e.$store.state.user.name,fileIds:t}).then((function(){e.getArticleList()})).then((function(){e.$notify({title:"删除成功",type:"success",duration:1e3})}))}))},beforeunloadFn:function(){return"确定要退出吗？"},goBack:function(){var e=this.$route.query.operation;this.newArticleDialogVisible=!!e},getWebsiteSetting:function(){var e=this;Object(Mt["c"])({userId:this.$store.state.user.userId}).then((function(t){t.data&&(e.siteUrl=t.data.siteUrl)}))},cancelFilter:function(){this.query.userId="",this.query.keyword="",this.categoryIdsList=[],this.theFilter()},theFilter:function(){var e=this;this.query.categoryIds="",this.categoryIdsList.length>0&&(this.categoryIdsList.forEach((function(t){e.query.categoryIds+=t+","})),this.query.categoryIds=this.query.categoryIds.substring(0,this.query.categoryIds.length-1)),this.getArticleList()},theFilterUserId:function(e){this.query.userId=e,this.theFilter()},theFilterCategoty:function(e){this.categoryIdsList=[e],this.theFilter()},filterQuery:function(){this.isFilter=!1,this.query.keyword&&0!==this.query.keyword.length?this.isFilter=!0:this.query.keyword=void 0,this.query.categoryIds&&0!==this.query.categoryIds.length?this.isFilter=!0:this.query.categoryIds=void 0,this.query.userId&&0!==this.query.userId.length?this.isFilter=!0:this.query.userId=void 0,this.$route.query.operation||this.$router.push({query:{uid:this.query.userId,keyword:this.query.keyword,categoryIds:this.query.categoryIds}})},getArticleList:function(){var e=this;this.filterQuery(),Et["a"].getMarkdown({pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,userId:"my"===this.query.radioUser?this.$store.state.user.userId:this.query.userId?this.query.userId:null,isRelease:"release"===this.query.radioStatus,isDraft:"draft"===this.query.radioStatus,isAlonePage:this.alonePage,keyword:this.query.keyword,categoryIds:this.query.categoryIds}).then((function(t){e.articleList=t.data,e.pagination.total=t.count,e.$nextTick((function(){e.isLoading=!1}))})),Et["a"].getMarkdown({pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,isAlonePage:this.alonePage,isDraft:!0}).then((function(t){e.draftNums=t.count}))},currentChange:function(){this.$router.push({query:{page:this.pagination.pageIndex}}),this.getArticleList()},newArticle:function(){this.newArticleDialogVisible=!0,this.$router.push({query:{operation:"new"}}),this.isEdit=!1},editArticle:function(e){this.isEdit=!0,this.newArticleDialogVisible=!0,this.$router.push({query:{operation:"editor",id:e}}),this.$refs.editor&&this.$refs.editor.reload()},categoryTree:function(){var e=this;Ft["a"].categoryTree().then((function(t){e.categories=t.data,e.$route.query.categoryIds&&(e.query.categoryIds=e.$route.query.categoryIds,e.categoryIdsList=e.query.categoryIds.split(","))}))},handleClose:function(e){this.hasChange?this.$confirm("还有未保存的内容，确定要离开吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e()})):e()},onTitle:function(e){var t=this.$route.query.operation;"new"===t&&(this.title="撰写新文章 "+e,this.alonePage&&(this.title="创建新页面 "+e),this.isEdit=!1),"editor"===t&&(this.title="编辑："+e,this.isEdit=!0)},openDialog:function(){this.title="撰写新文章",this.alonePage&&(this.title="创建新页面")},onRelease:function(){this.newArticleDialogVisible=!1,this.closeDialog()},closeDialog:function(){this.title=this.pageTitle,this.$router.replace({path:this.$route.path}),window.onbeforeunload=null,this.hasChange=!1,this.getArticleList()}}},At=Ot,Pt=(i("481c"),i("2877")),$t=Object(Pt["a"])(At,n,a,!1,null,"2d30da0b",null);t["default"]=$t.exports},b54d:function(e,t,i){},b89d:function(e,t,i){},bab4:function(e,t,i){
/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */
(function(t,i){e.exports=i()})(0,(function(){"use strict";function e(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function t(t){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?e(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function n(e){var t=i(e,"string");return"symbol"==typeof t?t:t+""}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,n(a.key),a)}}function s(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,i){return t=n(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e){return d(e)||u(e)||h(e)||f()}function d(e){if(Array.isArray(e))return p(e)}function u(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e,t){if(e){if("string"===typeof e)return p(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var m="undefined"!==typeof window&&"undefined"!==typeof window.document,g=m?window:{},v=!(!m||!g.document.documentElement)&&"ontouchstart"in g.document.documentElement,b=!!m&&"PointerEvent"in g,w="cropper",y="all",x="crop",C="move",k="zoom",_="e",S="w",L="s",T="n",D="ne",E="nw",F="se",I="sw",M="".concat(w,"-crop"),N="".concat(w,"-disabled"),O="".concat(w,"-hidden"),A="".concat(w,"-hide"),P="".concat(w,"-invisible"),$="".concat(w,"-modal"),R="".concat(w,"-move"),H="".concat(w,"Action"),j="".concat(w,"Preview"),q="crop",z="move",B="none",V="crop",U="cropend",W="cropmove",G="cropstart",X="dblclick",K=v?"touchstart":"mousedown",Y=v?"touchmove":"mousemove",J=v?"touchend touchcancel":"mouseup",Q=b?"pointerdown":K,Z=b?"pointermove":Y,ee=b?"pointerup pointercancel":J,te="ready",ie="resize",ne="wheel",ae="zoom",oe="image/jpeg",re=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,se=/^data:/,le=/^data:image\/jpeg;base64,/,ce=/^img|canvas$/i,de=200,ue=100,he={viewMode:0,dragMode:q,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:de,minContainerHeight:ue,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},pe='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',fe=Number.isNaN||g.isNaN;function me(e){return"number"===typeof e&&!fe(e)}var ge=function(e){return e>0&&e<1/0};function ve(e){return"undefined"===typeof e}function be(e){return"object"===a(e)&&null!==e}var we=Object.prototype.hasOwnProperty;function ye(e){if(!be(e))return!1;try{var t=e.constructor,i=t.prototype;return t&&i&&we.call(i,"isPrototypeOf")}catch(n){return!1}}function xe(e){return"function"===typeof e}var Ce=Array.prototype.slice;function ke(e){return Array.from?Array.from(e):Ce.call(e)}function _e(e,t){return e&&xe(t)&&(Array.isArray(e)||me(e.length)?ke(e).forEach((function(i,n){t.call(e,i,n,e)})):be(e)&&Object.keys(e).forEach((function(i){t.call(e,e[i],i,e)}))),e}var Se=Object.assign||function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return be(e)&&i.length>0&&i.forEach((function(t){be(t)&&Object.keys(t).forEach((function(i){e[i]=t[i]}))})),e},Le=/\.\d*(?:0|9){12}\d*$/;function Te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return Le.test(e)?Math.round(e*t)/t:e}var De=/^width|height|left|top|marginLeft|marginTop$/;function Ee(e,t){var i=e.style;_e(t,(function(e,t){De.test(t)&&me(e)&&(e="".concat(e,"px")),i[t]=e}))}function Fe(e,t){return e.classList?e.classList.contains(t):e.className.indexOf(t)>-1}function Ie(e,t){if(t)if(me(e.length))_e(e,(function(e){Ie(e,t)}));else if(e.classList)e.classList.add(t);else{var i=e.className.trim();i?i.indexOf(t)<0&&(e.className="".concat(i," ").concat(t)):e.className=t}}function Me(e,t){t&&(me(e.length)?_e(e,(function(e){Me(e,t)})):e.classList?e.classList.remove(t):e.className.indexOf(t)>=0&&(e.className=e.className.replace(t,"")))}function Ne(e,t,i){t&&(me(e.length)?_e(e,(function(e){Ne(e,t,i)})):i?Ie(e,t):Me(e,t))}var Oe=/([a-z\d])([A-Z])/g;function Ae(e){return e.replace(Oe,"$1-$2").toLowerCase()}function Pe(e,t){return be(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-".concat(Ae(t)))}function $e(e,t,i){be(i)?e[t]=i:e.dataset?e.dataset[t]=i:e.setAttribute("data-".concat(Ae(t)),i)}function Re(e,t){if(be(e[t]))try{delete e[t]}catch(i){e[t]=void 0}else if(e.dataset)try{delete e.dataset[t]}catch(i){e.dataset[t]=void 0}else e.removeAttribute("data-".concat(Ae(t)))}var He=/\s\s*/,je=function(){var e=!1;if(m){var t=!1,i=function(){},n=Object.defineProperty({},"once",{get:function(){return e=!0,t},set:function(e){t=e}});g.addEventListener("test",i,n),g.removeEventListener("test",i,n)}return e}();function qe(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=i;t.trim().split(He).forEach((function(t){if(!je){var o=e.listeners;o&&o[t]&&o[t][i]&&(a=o[t][i],delete o[t][i],0===Object.keys(o[t]).length&&delete o[t],0===Object.keys(o).length&&delete e.listeners)}e.removeEventListener(t,a,n)}))}function ze(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=i;t.trim().split(He).forEach((function(t){if(n.once&&!je){var o=e.listeners,r=void 0===o?{}:o;a=function(){delete r[t][i],e.removeEventListener(t,a,n);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];i.apply(e,s)},r[t]||(r[t]={}),r[t][i]&&e.removeEventListener(t,r[t][i],n),r[t][i]=a,e.listeners=r}e.addEventListener(t,a,n)}))}function Be(e,t,i){var n;return xe(Event)&&xe(CustomEvent)?n=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0}):(n=document.createEvent("CustomEvent"),n.initCustomEvent(t,!0,!0,i)),e.dispatchEvent(n)}function Ve(e){var t=e.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ue=g.location,We=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Ge(e){var t=e.match(We);return null!==t&&(t[1]!==Ue.protocol||t[2]!==Ue.hostname||t[3]!==Ue.port)}function Xe(e){var t="timestamp=".concat((new Date).getTime());return e+(-1===e.indexOf("?")?"?":"&")+t}function Ke(e){var t=e.rotate,i=e.scaleX,n=e.scaleY,a=e.translateX,o=e.translateY,r=[];me(a)&&0!==a&&r.push("translateX(".concat(a,"px)")),me(o)&&0!==o&&r.push("translateY(".concat(o,"px)")),me(t)&&0!==t&&r.push("rotate(".concat(t,"deg)")),me(i)&&1!==i&&r.push("scaleX(".concat(i,")")),me(n)&&1!==n&&r.push("scaleY(".concat(n,")"));var s=r.length?r.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function Ye(e){var i=t({},e),n=0;return _e(e,(function(e,t){delete i[t],_e(i,(function(t){var i=Math.abs(e.startX-t.startX),a=Math.abs(e.startY-t.startY),o=Math.abs(e.endX-t.endX),r=Math.abs(e.endY-t.endY),s=Math.sqrt(i*i+a*a),l=Math.sqrt(o*o+r*r),c=(l-s)/s;Math.abs(c)>Math.abs(n)&&(n=c)}))})),n}function Je(e,i){var n=e.pageX,a=e.pageY,o={endX:n,endY:a};return i?o:t({startX:n,startY:a},o)}function Qe(e){var t=0,i=0,n=0;return _e(e,(function(e){var a=e.startX,o=e.startY;t+=a,i+=o,n+=1})),t/=n,i/=n,{pageX:t,pageY:i}}function Ze(e){var t=e.aspectRatio,i=e.height,n=e.width,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",o=ge(n),r=ge(i);if(o&&r){var s=i*t;"contain"===a&&s>n||"cover"===a&&s<n?i=n/t:n=i*t}else o?i=n/t:r&&(n=i*t);return{width:n,height:i}}function et(e){var t=e.width,i=e.height,n=e.degree;if(n=Math.abs(n)%180,90===n)return{width:i,height:t};var a=n%90*Math.PI/180,o=Math.sin(a),r=Math.cos(a),s=t*r+i*o,l=t*o+i*r;return n>90?{width:l,height:s}:{width:s,height:l}}function tt(e,t,i,n){var a=t.aspectRatio,o=t.naturalWidth,r=t.naturalHeight,s=t.rotate,l=void 0===s?0:s,d=t.scaleX,u=void 0===d?1:d,h=t.scaleY,p=void 0===h?1:h,f=i.aspectRatio,m=i.naturalWidth,g=i.naturalHeight,v=n.fillColor,b=void 0===v?"transparent":v,w=n.imageSmoothingEnabled,y=void 0===w||w,x=n.imageSmoothingQuality,C=void 0===x?"low":x,k=n.maxWidth,_=void 0===k?1/0:k,S=n.maxHeight,L=void 0===S?1/0:S,T=n.minWidth,D=void 0===T?0:T,E=n.minHeight,F=void 0===E?0:E,I=document.createElement("canvas"),M=I.getContext("2d"),N=Ze({aspectRatio:f,width:_,height:L}),O=Ze({aspectRatio:f,width:D,height:F},"cover"),A=Math.min(N.width,Math.max(O.width,m)),P=Math.min(N.height,Math.max(O.height,g)),$=Ze({aspectRatio:a,width:_,height:L}),R=Ze({aspectRatio:a,width:D,height:F},"cover"),H=Math.min($.width,Math.max(R.width,o)),j=Math.min($.height,Math.max(R.height,r)),q=[-H/2,-j/2,H,j];return I.width=Te(A),I.height=Te(P),M.fillStyle=b,M.fillRect(0,0,A,P),M.save(),M.translate(A/2,P/2),M.rotate(l*Math.PI/180),M.scale(u,p),M.imageSmoothingEnabled=y,M.imageSmoothingQuality=C,M.drawImage.apply(M,[e].concat(c(q.map((function(e){return Math.floor(Te(e))}))))),M.restore(),I}var it=String.fromCharCode;function nt(e,t,i){var n="";i+=t;for(var a=t;a<i;a+=1)n+=it(e.getUint8(a));return n}var at=/^data:.*,/;function ot(e){var t=e.replace(at,""),i=atob(t),n=new ArrayBuffer(i.length),a=new Uint8Array(n);return _e(a,(function(e,t){a[t]=i.charCodeAt(t)})),n}function rt(e,t){var i=[],n=8192,a=new Uint8Array(e);while(a.length>0)i.push(it.apply(null,ke(a.subarray(0,n)))),a=a.subarray(n);return"data:".concat(t,";base64,").concat(btoa(i.join("")))}function st(e){var t,i=new DataView(e);try{var n,a,o;if(255===i.getUint8(0)&&216===i.getUint8(1)){var r=i.byteLength,s=2;while(s+1<r){if(255===i.getUint8(s)&&225===i.getUint8(s+1)){a=s;break}s+=1}}if(a){var l=a+4,c=a+10;if("Exif"===nt(i,l,4)){var d=i.getUint16(c);if(n=18761===d,(n||19789===d)&&42===i.getUint16(c+2,n)){var u=i.getUint32(c+4,n);u>=8&&(o=c+u)}}}if(o){var h,p,f=i.getUint16(o,n);for(p=0;p<f;p+=1)if(h=o+12*p+2,274===i.getUint16(h,n)){h+=8,t=i.getUint16(h,n),i.setUint16(h,1,n);break}}}catch(m){t=1}return t}function lt(e){var t=0,i=1,n=1;switch(e){case 2:i=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,i=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:i,scaleY:n}}var ct={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,i=this.container,n=this.cropper,a=Number(t.minContainerWidth),o=Number(t.minContainerHeight);Ie(n,O),Me(e,O);var r={width:Math.max(i.offsetWidth,a>=0?a:de),height:Math.max(i.offsetHeight,o>=0?o:ue)};this.containerData=r,Ee(n,{width:r.width,height:r.height}),Ie(e,O),Me(n,O)},initCanvas:function(){var e=this.containerData,t=this.imageData,i=this.options.viewMode,n=Math.abs(t.rotate)%180===90,a=n?t.naturalHeight:t.naturalWidth,o=n?t.naturalWidth:t.naturalHeight,r=a/o,s=e.width,l=e.height;e.height*r>e.width?3===i?s=e.height*r:l=e.width/r:3===i?l=e.width/r:s=e.height*r;var c={aspectRatio:r,naturalWidth:a,naturalHeight:o,width:s,height:l};this.canvasData=c,this.limited=1===i||2===i,this.limitCanvas(!0,!0),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),c.left=(e.width-c.width)/2,c.top=(e.height-c.height)/2,c.oldLeft=c.left,c.oldTop=c.top,this.initialCanvasData=Se({},c)},limitCanvas:function(e,t){var i=this.options,n=this.containerData,a=this.canvasData,o=this.cropBoxData,r=i.viewMode,s=a.aspectRatio,l=this.cropped&&o;if(e){var c=Number(i.minCanvasWidth)||0,d=Number(i.minCanvasHeight)||0;r>1?(c=Math.max(c,n.width),d=Math.max(d,n.height),3===r&&(d*s>c?c=d*s:d=c/s)):r>0&&(c?c=Math.max(c,l?o.width:0):d?d=Math.max(d,l?o.height:0):l&&(c=o.width,d=o.height,d*s>c?c=d*s:d=c/s));var u=Ze({aspectRatio:s,width:c,height:d});c=u.width,d=u.height,a.minWidth=c,a.minHeight=d,a.maxWidth=1/0,a.maxHeight=1/0}if(t)if(r>(l?0:1)){var h=n.width-a.width,p=n.height-a.height;a.minLeft=Math.min(0,h),a.minTop=Math.min(0,p),a.maxLeft=Math.max(0,h),a.maxTop=Math.max(0,p),l&&this.limited&&(a.minLeft=Math.min(o.left,o.left+(o.width-a.width)),a.minTop=Math.min(o.top,o.top+(o.height-a.height)),a.maxLeft=o.left,a.maxTop=o.top,2===r&&(a.width>=n.width&&(a.minLeft=Math.min(0,h),a.maxLeft=Math.max(0,h)),a.height>=n.height&&(a.minTop=Math.min(0,p),a.maxTop=Math.max(0,p))))}else a.minLeft=-a.width,a.minTop=-a.height,a.maxLeft=n.width,a.maxTop=n.height},renderCanvas:function(e,t){var i=this.canvasData,n=this.imageData;if(t){var a=et({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),o=a.width,r=a.height,s=i.width*(o/i.naturalWidth),l=i.height*(r/i.naturalHeight);i.left-=(s-i.width)/2,i.top-=(l-i.height)/2,i.width=s,i.height=l,i.aspectRatio=o/r,i.naturalWidth=o,i.naturalHeight=r,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,Ee(this.canvas,Se({width:i.width,height:i.height},Ke({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,i=this.imageData,n=i.naturalWidth*(t.width/t.naturalWidth),a=i.naturalHeight*(t.height/t.naturalHeight);Se(i,{width:n,height:a,left:(t.width-n)/2,top:(t.height-a)/2}),Ee(this.image,Se({width:i.width,height:i.height},Ke(Se({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,n=Number(e.autoCropArea)||.8,a={width:t.width,height:t.height};i&&(t.height*i>t.width?a.height=a.width/i:a.width=a.height*i),this.cropBoxData=a,this.limitCropBox(!0,!0),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),a.width=Math.max(a.minWidth,a.width*n),a.height=Math.max(a.minHeight,a.height*n),a.left=t.left+(t.width-a.width)/2,a.top=t.top+(t.height-a.height)/2,a.oldLeft=a.left,a.oldTop=a.top,this.initialCropBoxData=Se({},a)},limitCropBox:function(e,t){var i=this.options,n=this.containerData,a=this.canvasData,o=this.cropBoxData,r=this.limited,s=i.aspectRatio;if(e){var l=Number(i.minCropBoxWidth)||0,c=Number(i.minCropBoxHeight)||0,d=r?Math.min(n.width,a.width,a.width+a.left,n.width-a.left):n.width,u=r?Math.min(n.height,a.height,a.height+a.top,n.height-a.top):n.height;l=Math.min(l,n.width),c=Math.min(c,n.height),s&&(l&&c?c*s>l?c=l/s:l=c*s:l?c=l/s:c&&(l=c*s),u*s>d?u=d/s:d=u*s),o.minWidth=Math.min(l,d),o.minHeight=Math.min(c,u),o.maxWidth=d,o.maxHeight=u}t&&(r?(o.minLeft=Math.max(0,a.left),o.minTop=Math.max(0,a.top),o.maxLeft=Math.min(n.width,a.left+a.width)-o.width,o.maxTop=Math.min(n.height,a.top+a.height)-o.height):(o.minLeft=0,o.minTop=0,o.maxLeft=n.width-o.width,o.maxTop=n.height-o.height))},renderCropBox:function(){var e=this.options,t=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&$e(this.face,H,i.width>=t.width&&i.height>=t.height?C:y),Ee(this.cropBox,Se({width:i.width,height:i.height},Ke({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Be(this.element,V,this.getData())}},dt={initPreview:function(){var e=this.element,t=this.crossOrigin,i=this.options.preview,n=t?this.crossOriginUrl:this.url,a=e.alt||"The image to preview",o=document.createElement("img");if(t&&(o.crossOrigin=t),o.src=n,o.alt=a,this.viewBox.appendChild(o),this.viewBoxImage=o,i){var r=i;"string"===typeof i?r=e.ownerDocument.querySelectorAll(i):i.querySelector&&(r=[i]),this.previews=r,_e(r,(function(e){var i=document.createElement("img");$e(e,j,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),t&&(i.crossOrigin=t),i.src=n,i.alt=a,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(i)}))}},resetPreview:function(){_e(this.previews,(function(e){var t=Pe(e,j);Ee(e,{width:t.width,height:t.height}),e.innerHTML=t.html,Re(e,j)}))},preview:function(){var e=this.imageData,t=this.canvasData,i=this.cropBoxData,n=i.width,a=i.height,o=e.width,r=e.height,s=i.left-t.left-e.left,l=i.top-t.top-e.top;this.cropped&&!this.disabled&&(Ee(this.viewBoxImage,Se({width:o,height:r},Ke(Se({translateX:-s,translateY:-l},e)))),_e(this.previews,(function(t){var i=Pe(t,j),c=i.width,d=i.height,u=c,h=d,p=1;n&&(p=c/n,h=a*p),a&&h>d&&(p=d/a,u=n*p,h=d),Ee(t,{width:u,height:h}),Ee(t.getElementsByTagName("img")[0],Se({width:o*p,height:r*p},Ke(Se({translateX:-s*p,translateY:-l*p},e))))})))}},ut={bind:function(){var e=this.element,t=this.options,i=this.cropper;xe(t.cropstart)&&ze(e,G,t.cropstart),xe(t.cropmove)&&ze(e,W,t.cropmove),xe(t.cropend)&&ze(e,U,t.cropend),xe(t.crop)&&ze(e,V,t.crop),xe(t.zoom)&&ze(e,ae,t.zoom),ze(i,Q,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&ze(i,ne,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&ze(i,X,this.onDblclick=this.dblclick.bind(this)),ze(e.ownerDocument,Z,this.onCropMove=this.cropMove.bind(this)),ze(e.ownerDocument,ee,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&ze(window,ie,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,i=this.cropper;xe(t.cropstart)&&qe(e,G,t.cropstart),xe(t.cropmove)&&qe(e,W,t.cropmove),xe(t.cropend)&&qe(e,U,t.cropend),xe(t.crop)&&qe(e,V,t.crop),xe(t.zoom)&&qe(e,ae,t.zoom),qe(i,Q,this.onCropStart),t.zoomable&&t.zoomOnWheel&&qe(i,ne,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&qe(i,X,this.onDblclick),qe(e.ownerDocument,Z,this.onCropMove),qe(e.ownerDocument,ee,this.onCropEnd),t.responsive&&qe(window,ie,this.onResize)}},ht={resize:function(){if(!this.disabled){var e,t,i=this.options,n=this.container,a=this.containerData,o=n.offsetWidth/a.width,r=n.offsetHeight/a.height,s=Math.abs(o-1)>Math.abs(r-1)?o:r;if(1!==s)i.restore&&(e=this.getCanvasData(),t=this.getCropBoxData()),this.render(),i.restore&&(this.setCanvasData(_e(e,(function(t,i){e[i]=t*s}))),this.setCropBoxData(_e(t,(function(e,i){t[i]=e*s}))))}},dblclick:function(){this.disabled||this.options.dragMode===B||this.setDragMode(Fe(this.dragBox,M)?z:q)},wheel:function(e){var t=this,i=Number(this.options.wheelZoomRatio)||.1,n=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){t.wheeling=!1}),50),e.deltaY?n=e.deltaY>0?1:-1:e.wheelDelta?n=-e.wheelDelta/120:e.detail&&(n=e.detail>0?1:-1),this.zoom(-n*i,e)))},cropStart:function(e){var t=e.buttons,i=e.button;if(!(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(me(t)&&1!==t||me(i)&&0!==i||e.ctrlKey))){var n,a=this.options,o=this.pointers;e.changedTouches?_e(e.changedTouches,(function(e){o[e.identifier]=Je(e)})):o[e.pointerId||0]=Je(e),n=Object.keys(o).length>1&&a.zoomable&&a.zoomOnTouch?k:Pe(e.target,H),re.test(n)&&!1!==Be(this.element,G,{originalEvent:e,action:n})&&(e.preventDefault(),this.action=n,this.cropping=!1,n===x&&(this.cropping=!0,Ie(this.dragBox,$)))}},cropMove:function(e){var t=this.action;if(!this.disabled&&t){var i=this.pointers;e.preventDefault(),!1!==Be(this.element,W,{originalEvent:e,action:t})&&(e.changedTouches?_e(e.changedTouches,(function(e){Se(i[e.identifier]||{},Je(e,!0))})):Se(i[e.pointerId||0]||{},Je(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,i=this.pointers;e.changedTouches?_e(e.changedTouches,(function(e){delete i[e.identifier]})):delete i[e.pointerId||0],t&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,Ne(this.dragBox,$,this.cropped&&this.options.modal)),Be(this.element,U,{originalEvent:e,action:t}))}}},pt={change:function(e){var t,i=this.options,n=this.canvasData,a=this.containerData,o=this.cropBoxData,r=this.pointers,s=this.action,l=i.aspectRatio,c=o.left,d=o.top,u=o.width,h=o.height,p=c+u,f=d+h,m=0,g=0,v=a.width,b=a.height,w=!0;!l&&e.shiftKey&&(l=u&&h?u/h:1),this.limited&&(m=o.minLeft,g=o.minTop,v=m+Math.min(a.width,n.width,n.left+n.width),b=g+Math.min(a.height,n.height,n.top+n.height));var M=r[Object.keys(r)[0]],N={x:M.endX-M.startX,y:M.endY-M.startY},A=function(e){switch(e){case _:p+N.x>v&&(N.x=v-p);break;case S:c+N.x<m&&(N.x=m-c);break;case T:d+N.y<g&&(N.y=g-d);break;case L:f+N.y>b&&(N.y=b-f);break}};switch(s){case y:c+=N.x,d+=N.y;break;case _:if(N.x>=0&&(p>=v||l&&(d<=g||f>=b))){w=!1;break}A(_),u+=N.x,u<0&&(s=S,u=-u,c-=u),l&&(h=u/l,d+=(o.height-h)/2);break;case T:if(N.y<=0&&(d<=g||l&&(c<=m||p>=v))){w=!1;break}A(T),h-=N.y,d+=N.y,h<0&&(s=L,h=-h,d-=h),l&&(u=h*l,c+=(o.width-u)/2);break;case S:if(N.x<=0&&(c<=m||l&&(d<=g||f>=b))){w=!1;break}A(S),u-=N.x,c+=N.x,u<0&&(s=_,u=-u,c-=u),l&&(h=u/l,d+=(o.height-h)/2);break;case L:if(N.y>=0&&(f>=b||l&&(c<=m||p>=v))){w=!1;break}A(L),h+=N.y,h<0&&(s=T,h=-h,d-=h),l&&(u=h*l,c+=(o.width-u)/2);break;case D:if(l){if(N.y<=0&&(d<=g||p>=v)){w=!1;break}A(T),h-=N.y,d+=N.y,u=h*l}else A(T),A(_),N.x>=0?p<v?u+=N.x:N.y<=0&&d<=g&&(w=!1):u+=N.x,N.y<=0?d>g&&(h-=N.y,d+=N.y):(h-=N.y,d+=N.y);u<0&&h<0?(s=I,h=-h,u=-u,d-=h,c-=u):u<0?(s=E,u=-u,c-=u):h<0&&(s=F,h=-h,d-=h);break;case E:if(l){if(N.y<=0&&(d<=g||c<=m)){w=!1;break}A(T),h-=N.y,d+=N.y,u=h*l,c+=o.width-u}else A(T),A(S),N.x<=0?c>m?(u-=N.x,c+=N.x):N.y<=0&&d<=g&&(w=!1):(u-=N.x,c+=N.x),N.y<=0?d>g&&(h-=N.y,d+=N.y):(h-=N.y,d+=N.y);u<0&&h<0?(s=F,h=-h,u=-u,d-=h,c-=u):u<0?(s=D,u=-u,c-=u):h<0&&(s=I,h=-h,d-=h);break;case I:if(l){if(N.x<=0&&(c<=m||f>=b)){w=!1;break}A(S),u-=N.x,c+=N.x,h=u/l}else A(L),A(S),N.x<=0?c>m?(u-=N.x,c+=N.x):N.y>=0&&f>=b&&(w=!1):(u-=N.x,c+=N.x),N.y>=0?f<b&&(h+=N.y):h+=N.y;u<0&&h<0?(s=D,h=-h,u=-u,d-=h,c-=u):u<0?(s=F,u=-u,c-=u):h<0&&(s=E,h=-h,d-=h);break;case F:if(l){if(N.x>=0&&(p>=v||f>=b)){w=!1;break}A(_),u+=N.x,h=u/l}else A(L),A(_),N.x>=0?p<v?u+=N.x:N.y>=0&&f>=b&&(w=!1):u+=N.x,N.y>=0?f<b&&(h+=N.y):h+=N.y;u<0&&h<0?(s=E,h=-h,u=-u,d-=h,c-=u):u<0?(s=I,u=-u,c-=u):h<0&&(s=D,h=-h,d-=h);break;case C:this.move(N.x,N.y),w=!1;break;case k:this.zoom(Ye(r),e),w=!1;break;case x:if(!N.x||!N.y){w=!1;break}t=Ve(this.cropper),c=M.startX-t.left,d=M.startY-t.top,u=o.minWidth,h=o.minHeight,N.x>0?s=N.y>0?F:D:N.x<0&&(c-=u,s=N.y>0?I:E),N.y<0&&(d-=h),this.cropped||(Me(this.cropBox,O),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}w&&(o.width=u,o.height=h,o.left=c,o.top=d,this.action=s,this.renderCropBox()),_e(r,(function(e){e.startX=e.endX,e.startY=e.endY}))}},ft={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Ie(this.dragBox,$),Me(this.cropBox,O),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=Se({},this.initialImageData),this.canvasData=Se({},this.initialCanvasData),this.cropBoxData=Se({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(Se(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Me(this.dragBox,$),Ie(this.cropBox,O)),this},replace:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,_e(this.previews,(function(t){t.getElementsByTagName("img")[0].src=e})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Me(this.cropper,N)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,Ie(this.cropper,N)),this},destroy:function(){var e=this.element;return e[w]?(e[w]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,n=i.left,a=i.top;return this.moveTo(ve(e)?e:n+Number(e),ve(t)?t:a+Number(t))},moveTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(me(e)&&(i.left=e,n=!0),me(t)&&(i.top=t,n=!0),n&&this.renderCanvas(!0)),this},zoom:function(e,t){var i=this.canvasData;return e=Number(e),e=e<0?1/(1-e):1+e,this.zoomTo(i.width*e/i.naturalWidth,null,t)},zoomTo:function(e,t,i){var n=this.options,a=this.canvasData,o=a.width,r=a.height,s=a.naturalWidth,l=a.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&n.zoomable){var c=s*e,d=l*e;if(!1===Be(this.element,ae,{ratio:e,oldRatio:o/s,originalEvent:i}))return this;if(i){var u=this.pointers,h=Ve(this.cropper),p=u&&Object.keys(u).length?Qe(u):{pageX:i.pageX,pageY:i.pageY};a.left-=(c-o)*((p.pageX-h.left-a.left)/o),a.top-=(d-r)*((p.pageY-h.top-a.top)/r)}else ye(t)&&me(t.x)&&me(t.y)?(a.left-=(c-o)*((t.x-a.left)/o),a.top-=(d-r)*((t.y-a.top)/r)):(a.left-=(c-o)/2,a.top-=(d-r)/2);a.width=c,a.height=d,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),me(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,me(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(me(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.imageData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(me(e)&&(i.scaleX=e,n=!0),me(t)&&(i.scaleY=t,n=!0),n&&this.renderCanvas(!0,!0)),this},getData:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.options,n=this.imageData,a=this.canvasData,o=this.cropBoxData;if(this.ready&&this.cropped){e={x:o.left-a.left,y:o.top-a.top,width:o.width,height:o.height};var r=n.width/n.naturalWidth;if(_e(e,(function(t,i){e[i]=t/r})),t){var s=Math.round(e.y+e.height),l=Math.round(e.x+e.width);e.x=Math.round(e.x),e.y=Math.round(e.y),e.width=l-e.x,e.height=s-e.y}}else e={x:0,y:0,width:0,height:0};return i.rotatable&&(e.rotate=n.rotate||0),i.scalable&&(e.scaleX=n.scaleX||1,e.scaleY=n.scaleY||1),e},setData:function(e){var t=this.options,i=this.imageData,n=this.canvasData,a={};if(this.ready&&!this.disabled&&ye(e)){var o=!1;t.rotatable&&me(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,o=!0),t.scalable&&(me(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,o=!0),me(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,o=!0)),o&&this.renderCanvas(!0,!0);var r=i.width/i.naturalWidth;me(e.x)&&(a.left=e.x*r+n.left),me(e.y)&&(a.top=e.y*r+n.top),me(e.width)&&(a.width=e.width*r),me(e.height)&&(a.height=e.height*r),this.setCropBoxData(a)}return this},getContainerData:function(){return this.ready?Se({},this.containerData):{}},getImageData:function(){return this.sized?Se({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&_e(["left","top","width","height","naturalWidth","naturalHeight"],(function(i){t[i]=e[i]})),t},setCanvasData:function(e){var t=this.canvasData,i=t.aspectRatio;return this.ready&&!this.disabled&&ye(e)&&(me(e.left)&&(t.left=e.left),me(e.top)&&(t.top=e.top),me(e.width)?(t.width=e.width,t.height=e.width/i):me(e.height)&&(t.height=e.height,t.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var e,t=this.cropBoxData;return this.ready&&this.cropped&&(e={left:t.left,top:t.top,width:t.width,height:t.height}),e||{}},setCropBoxData:function(e){var t,i,n=this.cropBoxData,a=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&ye(e)&&(me(e.left)&&(n.left=e.left),me(e.top)&&(n.top=e.top),me(e.width)&&e.width!==n.width&&(t=!0,n.width=e.width),me(e.height)&&e.height!==n.height&&(i=!0,n.height=e.height),a&&(t?n.height=n.width/a:i&&(n.width=n.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,i=tt(this.image,this.imageData,t,e);if(!this.cropped)return i;var n=this.getData(e.rounded),a=n.x,o=n.y,r=n.width,s=n.height,l=i.width/Math.floor(t.naturalWidth);1!==l&&(a*=l,o*=l,r*=l,s*=l);var d=r/s,u=Ze({aspectRatio:d,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),h=Ze({aspectRatio:d,width:e.minWidth||0,height:e.minHeight||0},"cover"),p=Ze({aspectRatio:d,width:e.width||(1!==l?i.width:r),height:e.height||(1!==l?i.height:s)}),f=p.width,m=p.height;f=Math.min(u.width,Math.max(h.width,f)),m=Math.min(u.height,Math.max(h.height,m));var g=document.createElement("canvas"),v=g.getContext("2d");g.width=Te(f),g.height=Te(m),v.fillStyle=e.fillColor||"transparent",v.fillRect(0,0,f,m);var b=e.imageSmoothingEnabled,w=void 0===b||b,y=e.imageSmoothingQuality;v.imageSmoothingEnabled=w,y&&(v.imageSmoothingQuality=y);var x,C,k,_,S,L,T=i.width,D=i.height,E=a,F=o;E<=-r||E>T?(E=0,x=0,k=0,S=0):E<=0?(k=-E,E=0,x=Math.min(T,r+E),S=x):E<=T&&(k=0,x=Math.min(r,T-E),S=x),x<=0||F<=-s||F>D?(F=0,C=0,_=0,L=0):F<=0?(_=-F,F=0,C=Math.min(D,s+F),L=C):F<=D&&(_=0,C=Math.min(s,D-F),L=C);var I=[E,F,x,C];if(S>0&&L>0){var M=f/r;I.push(k*M,_*M,S*M,L*M)}return v.drawImage.apply(v,[i].concat(c(I.map((function(e){return Math.floor(Te(e))}))))),g},setAspectRatio:function(e){var t=this.options;return this.disabled||ve(e)||(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,i=this.dragBox,n=this.face;if(this.ready&&!this.disabled){var a=e===q,o=t.movable&&e===z;e=a||o?e:B,t.dragMode=e,$e(i,H,e),Ne(i,M,a),Ne(i,R,o),t.cropBoxMovable||($e(n,H,e),Ne(n,M,a),Ne(n,R,o))}return this}},mt=g.Cropper,gt=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o(this,e),!t||!ce.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=Se({},he,ye(i)&&i),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return s(e,[{key:"init",value:function(){var e,t=this.element,i=t.tagName.toLowerCase();if(!t[w]){if(t[w]=this,"img"===i){if(this.isImg=!0,e=t.getAttribute("src")||"",this.originalUrl=e,!e)return;e=t.src}else"canvas"===i&&window.HTMLCanvasElement&&(e=t.toDataURL());this.load(e)}}},{key:"load",value:function(e){var t=this;if(e){this.url=e,this.imageData={};var i=this.element,n=this.options;if(n.rotatable||n.scalable||(n.checkOrientation=!1),n.checkOrientation&&window.ArrayBuffer)if(se.test(e))le.test(e)?this.read(ot(e)):this.clone();else{var a=new XMLHttpRequest,o=this.clone.bind(this);this.reloading=!0,this.xhr=a,a.onabort=o,a.onerror=o,a.ontimeout=o,a.onprogress=function(){a.getResponseHeader("content-type")!==oe&&a.abort()},a.onload=function(){t.read(a.response)},a.onloadend=function(){t.reloading=!1,t.xhr=null},n.checkCrossOrigin&&Ge(e)&&i.crossOrigin&&(e=Xe(e)),a.open("GET",e,!0),a.responseType="arraybuffer",a.withCredentials="use-credentials"===i.crossOrigin,a.send()}else this.clone()}}},{key:"read",value:function(e){var t=this.options,i=this.imageData,n=st(e),a=0,o=1,r=1;if(n>1){this.url=rt(e,oe);var s=lt(n);a=s.rotate,o=s.scaleX,r=s.scaleY}t.rotatable&&(i.rotate=a),t.scalable&&(i.scaleX=o,i.scaleY=r),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,i=e.crossOrigin,n=t;this.options.checkCrossOrigin&&Ge(t)&&(i||(i="anonymous"),n=Xe(t)),this.crossOrigin=i,this.crossOriginUrl=n;var a=document.createElement("img");i&&(a.crossOrigin=i),a.src=n||t,a.alt=e.alt||"The image to crop",this.image=a,a.onload=this.start.bind(this),a.onerror=this.stop.bind(this),Ie(a,A),e.parentNode.insertBefore(a,e.nextSibling)}},{key:"start",value:function(){var e=this,t=this.image;t.onload=null,t.onerror=null,this.sizing=!0;var i=g.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(g.navigator.userAgent),n=function(t,i){Se(e.imageData,{naturalWidth:t,naturalHeight:i,aspectRatio:t/i}),e.initialImageData=Se({},e.imageData),e.sizing=!1,e.sized=!0,e.build()};if(!t.naturalWidth||i){var a=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=a,a.onload=function(){n(a.width,a.height),i||o.removeChild(a)},a.src=t.src,i||(a.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(a))}else n(t.naturalWidth,t.naturalHeight)}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var e=this.element,t=this.options,i=this.image,n=e.parentNode,a=document.createElement("div");a.innerHTML=pe;var o=a.querySelector(".".concat(w,"-container")),r=o.querySelector(".".concat(w,"-canvas")),s=o.querySelector(".".concat(w,"-drag-box")),l=o.querySelector(".".concat(w,"-crop-box")),c=l.querySelector(".".concat(w,"-face"));this.container=n,this.cropper=o,this.canvas=r,this.dragBox=s,this.cropBox=l,this.viewBox=o.querySelector(".".concat(w,"-view-box")),this.face=c,r.appendChild(i),Ie(e,O),n.insertBefore(o,e.nextSibling),Me(i,A),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,Ie(l,O),t.guides||Ie(l.getElementsByClassName("".concat(w,"-dashed")),O),t.center||Ie(l.getElementsByClassName("".concat(w,"-center")),O),t.background&&Ie(o,"".concat(w,"-bg")),t.highlight||Ie(c,P),t.cropBoxMovable&&(Ie(c,R),$e(c,H,y)),t.cropBoxResizable||(Ie(l.getElementsByClassName("".concat(w,"-line")),O),Ie(l.getElementsByClassName("".concat(w,"-point")),O)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),xe(t.ready)&&ze(e,te,t.ready,{once:!0}),Be(e,te)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var e=this.cropper.parentNode;e&&e.removeChild(this.cropper),Me(this.element,O)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=mt,e}},{key:"setDefaults",value:function(e){Se(he,ye(e)&&e)}}])}();return Se(gt.prototype,ct,dt,ut,ht,pt,ft),gt}))},c111:function(e,t,i){"use strict";i("a6b0")},c1b6:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{queryFileType:"video",orderCustom:!0,defaultGrid:!0,sortable:e.sortable,queryCondition:e.queryCondition,emptyStatus:"还没有视频呢~"}})],1)},a=[],o=i("c41c"),r={components:{ShowFile:o["default"]},data:function(){return{sortable:{prop:"updateDate",order:"descending"},queryCondition:{isFolder:!1}}}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"07591c3a",null);t["default"]=c.exports},c1fe:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{queryFileType:"document",orderCustom:!0,defaultGrid:!0,sortable:e.sortable,queryCondition:e.queryCondition,emptyStatus:"还没有文档呢~"}})],1)},a=[],o=i("c41c"),r={components:{ShowFile:o["default"]},data:function(){return{sortable:{prop:"updateDate",order:"descending"},queryCondition:{isFolder:!1}}}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"235b8275",null);t["default"]=c.exports},c405:function(e,t,i){"use strict";var n=i("b775"),a=i("4328");t["a"]={categories:function(e){return Object(n["a"])({url:"category/list",method:"get",params:e})},categoryTree:function(e){return Object(n["a"])({url:"category/tree",method:"get",params:e})},categoryInfo:function(e){return Object(n["a"])({url:"category/info",method:"get",params:e})},add:function(e){return Object(n["a"])({url:"category/add",method:"post",data:e})},update:function(e){return Object(n["a"])({url:"category/update",method:"put",data:e})},setDefault:function(e){return Object(n["a"])({url:"category/setDefault",method:"put",params:e})},delete:function(e){return Object(n["a"])({url:"category/delete",method:"delete",params:e,paramsSerializer:function(e){return a.stringify(e,{arrayFormat:"repeat"})}})}}},c41c:function(e,t,i){"use strict";i.r(t);i("6762"),i("2fdb"),i("7f7f");var n=function(){var e=this,t=e._self._c;return t("div",[t("div",{directives:[{name:"resize",rawName:"v-resize",value:e.containerResize,expression:"containerResize"}],staticClass:"dashboard-container",attrs:{onselectstart:"return false"}},[t("v-contextmenu",{ref:"homeContextmenu",attrs:{disabled:e.contextmenuDisabled}},e._l(e.contextMenus,(function(i){return t("div",{key:i.operation},[i.child?e._e():t("v-contextmenu-item",{attrs:{divider:!!i.divider},on:{click:function(t){return e.contextmenuClick(i.operation)}}},[i.iconClass?t("svg-icon",{attrs:{"icon-class":i.iconClass}}):e._e(),e._v("\n            "+e._s(i.label)+"\n          ")],1),e._v(" "),i.child?t("v-contextmenu-submenu",{attrs:{title:i.label}},e._l(i.child,(function(i){return t("div",{key:i.operation},[i.child?e._e():t("v-contextmenu-item",{attrs:{divider:!!i.divider},on:{click:function(t){return e.contextmenuClick(i.operation)}}},[i.iconClass?t("svg-icon",{attrs:{"icon-class":i.iconClass}}):e._e(),e._v("\n                "+e._s(i.label)+"\n              ")],1),e._v(" "),i.child?t("v-contextmenu-submenu",{attrs:{title:i.label}}):e._e()],1)})),0):e._e()],1)})),0),e._v(" "),t("el-breadcrumb",{staticClass:"app-breadcrumb",attrs:{separator:""}},[e.showNavigation?t("transition-group",{attrs:{name:"breadcrumb"}},e._l(e.pathList,(function(i,n){return t("el-breadcrumb-item",{key:i.folder+n},[0===n&&e.pathList.length>1?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"返回上一级",placement:"top"}},[t("a",{on:{click:function(t){return t.preventDefault(),e.lastLink()}}},[t("svg-icon",{staticStyle:{"font-size":"24px","margin-left":"20px"},attrs:{"icon-class":"back"}}),e._v(" ")],1)]):e._e(),e._v(" "),0===n&&e.pathList.length>2?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"根目录",placement:"top"}},[t("a",{staticClass:"home-link",on:{click:function(t){return t.preventDefault(),e.handleLink(i,n)}}},[t("svg-icon",{staticStyle:{"font-size":"24px"},attrs:{"icon-class":"home"}})],1)]):e._e(),e._v(" "),t("breadcrumb-file-path",{attrs:{pathList:e.pathList,item:i,index:n},on:{clickLink:e.handleLink}})],1)})),1):e._e(),e._v(" "),t("div",{staticClass:"search-content"},[t("div",{staticClass:"search-class"},[t("el-popover",{directives:[{name:"show",rawName:"v-show",value:e.showUploadButton,expression:"showUploadButton"}],attrs:{placement:"bottom",trigger:"hover"},on:{click:e.showNewFolderClick,"after-leave":e.hideNewFolderName},model:{value:e.isShowNewFolder,callback:function(t){e.isShowNewFolder=t},expression:"isShowNewFolder"}},[t("div",{staticClass:"newFileMenu",staticStyle:{display:"block"}},[t("ul",[t("li",{on:{click:e.upload}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":"file-upload"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(""!==e.singleFileType?e.singleFileType:"上传文件"))])],1)]),e._v(" "),""===e.singleFileType?t("li",{on:{click:e.uploadFolder}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":"folder-upload"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v("上传文件夹")])],1)]):e._e(),e._v(" "),""===e.singleFileType?t("li",{on:{click:function(t){return t.preventDefault(),e.newFolder.apply(null,arguments)}}},[t("a",{staticClass:"menuitem",attrs:{href:"#"}},[t("svg-icon",{attrs:{"icon-class":"folder-add"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v("新建文件夹")])],1)]):e._e(),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showNewFolder,expression:"showNewFolder"}],staticClass:"folder-name-form"},[t("el-input",{ref:"newFolderName",attrs:{placeholder:"请输入文件夹名称",clearable:!0},on:{focus:e.setInputFocus,blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.newFolderNameClickEnter.apply(null,arguments)}},model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}},[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.newFolderLoading,expression:"newFolderLoading"}],staticClass:"el-icon-right",attrs:{slot:"append","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:e.newFolderNameClick},slot:"append"})],1)],1)])]),e._v(" "),t("button-upload",{staticStyle:{"margin-right":"5px"},attrs:{slot:"reference",name:""},nativeOn:{click:function(t){return e.upload.apply(null,arguments)}},slot:"reference"})],1),e._v(" "),t("el-input",{directives:[{name:"show",rawName:"v-show",value:e.showSearchButton,expression:"showSearchButton"}],attrs:{placeholder:"搜索",clearable:!0},on:{focus:e.setInputFocus,blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchFile(e.searchFileName)}},model:{value:e.searchFileName,callback:function(t){e.searchFileName=t},expression:"searchFileName"}},[t("el-button",{attrs:{slot:"prepend"},on:{click:function(t){return e.searchFile(e.searchFileName)}},slot:"prepend"},[t("svg-icon",{staticStyle:{"font-size":"22px"},attrs:{"icon-class":"search"}})],1)],1),e._v(" "),t("el-dropdown",{staticStyle:{height:"40px"},attrs:{size:"medium"},on:{command:e.contextmenuClick}},[t("el-button",{staticClass:"sort",attrs:{type:"text"}},[t("svg-icon",{attrs:{"icon-class":"sort"}})],1),e._v(" "),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"orderName"}},[t("span",{class:{"al-file-sort-item":!0,active:"name"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("名称")])])]),e._v(" "),t("el-dropdown-item",{attrs:{command:"orderSize"}},[t("span",{class:{"al-file-sort-item":!0,active:"size"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("大小")])])]),e._v(" "),t("el-dropdown-item",{attrs:{command:"orderUpdateDate"}},[t("span",{class:{"al-file-sort-item":!0,active:"updateDate"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("日期")])])])],1)],1),e._v(" "),t("el-button",{staticClass:"vmode",attrs:{type:"text"},on:{click:e.changeVmode}},[t("svg-icon",{attrs:{"icon-class":e.grid?"list":"grid"}})],1)],1)])],1),e._v(" "),t("div",[t("div",{staticClass:"info-statistics"},[e.tableLoading?t("span",[e._v("获取更多数据...")]):e._e(),e._v(" "),e.tableLoading?e._e():t("span",[e._v(e._s(e.finished?"已全部加载 "+e.getSummaries3:"已加载 "+e.getSummaries3))])])]),e._v(" "),t("e-vue-contextmenu",{ref:"contextShow",staticClass:"newFileMenu",class:e.menuTriangle,on:{"ctx-show":e.show,"ctx-hide":e.hide}},[t("div",{staticClass:"popper-arrow"}),e._v(" "),e._l(e.menus,(function(i,n){return t("ul",{key:i.label},["unFavorite"===i.operation||"favorite"===i.operation?t("li",{staticClass:"menu-option",on:{click:function(t){return e.menusOperations(i.operation)},mouseover:function(t){return t.preventDefault(),t.stopPropagation(),e.menuFavoriteOver(n,e.rowContextData.isFavorite)},mouseleave:function(t){return t.preventDefault(),t.stopPropagation(),e.menuFavoriteLeave(n,e.rowContextData.isFavorite)}}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)]):t("li",{on:{click:function(t){return e.menusOperations(i.operation)}}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)])])}))],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.fileList.length>0,expression:"fileList.length > 0"}],style:{width:"100%",height:e.clientHeight+"px"},attrs:{id:"v-draw-rectangle"}},[t("pl-table",{directives:[{name:"show",rawName:"v-show",value:!e.grid,expression:"!grid"},{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"fileListTable",staticStyle:{width:"100%",margin:"20px 0 0 0"},attrs:{"max-height":e.clientHeight,"default-sort":e.sortable,"highlight-current-row":!1,"empty-text":"无文件","use-virtual":!1,"row-height":51.5,border:!1,"excess-rows":10,"pagination-show":!1,stripe:"","cell-style":e.rowStyle,"height-change":!1,"row-class-name":e.tableRowClassName,"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{"selection-change":e.handleSelectionChange,"row-contextmenu":e.rowContextmenu,"cell-click":e.cellClick,"row-dblclick":e.dblclick,"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"sort-change":e.sortChange,"table-body-scroll":e.tableBodyScroll,select:e.pinSelect}},[e._l(e.tableHead,(function(i,n){return[1===n?t("pl-table-column",{key:n,attrs:{index:n,align:"center","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("icon-file",{attrs:{item:i.row,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})]}}],null,!0)}):e._e(),e._v(" "),2===n?t("pl-table-column",{key:n,attrs:{"show-overflow-tooltip":!0,"max-width":"200",index:n,prop:i.name,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom")},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.editingIndex?t("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{span:10,placeholder:"",size:"small"},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,i.row.suffix)},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.rowRename(e.renameFileName,i.row)}},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}}):t("div",{staticClass:"table-file-name"},[e._v("\n                  "+e._s(i.row.name)+"\n                  "),i.row.ossPlatform?t("el-tag",{staticClass:"pc list oss-folder",attrs:{size:"small"}},[e._v(e._s(i.row.ossPlatform)+"\n                  ")]):e._e()],1)]}}],null,!0)}):e._e(),e._v(" "),3===n&&e.showShareItem?t("pl-table-column",{key:n,attrs:{width:"50",index:n,align:"center","header-align":"center","tooltip-effect":"dark"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index!==e.cellMouseIndex||i.row.isShare&&!i.row.shareBase?e._e():t("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"分享",placement:"top"}},[t("svg-icon",{staticClass:"button-class",attrs:{title:"分享","icon-class":"share"},on:{click:function(t){return t.stopPropagation(),e.share(i.row)}}})],1)]}}],null,!0)}):e._e(),e._v(" "),4===n&&e.showMoreItem?t("pl-table-column",{key:n,staticClass:"el-icon-more",attrs:{width:"50",prop:i.name,label:i.label,index:n,align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.cellMouseIndex?t("svg-icon",{staticClass:"button-class",attrs:{"icon-class":"more"},on:{click:function(t){return t.stopPropagation(),e.moreClick(i.row,t)}}}):e._e()]}}],null,!0)},[t("template",{slot:"header"},[""!==i.name?t("svg-icon",{staticClass:"button-class",attrs:{"icon-class":"more"},on:{click:function(t){return t.stopPropagation(),e.moreOperation(t)}}}):e._e()],1)],2):e._e(),e._v(" "),5===n&&e.showSizeItem?t("pl-table-column",{key:n,attrs:{width:"200",prop:i.name,index:n,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom"),"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(e.formatSize(i.row.size)))])]}}],null,!0)}):e._e(),e._v(" "),6===n&&e.showUpdateDateItem?t("pl-table-column",{key:n,attrs:{width:"250",prop:i.name,index:n,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom"),"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:i.row.updateDate,placement:"top"}},[t("span",[e._v("   "+e._s(e.formatTime(i.row.agoTime)))])])]}}],null,!0)}):e._e()]}))],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.grid,expression:"grid"},{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"}},[t("van-checkbox-group",{ref:"checkboxGroup",on:{change:e.handleSelectionChange},model:{value:e.selectRowData,callback:function(t){e.selectRowData=t},expression:"selectRowData"}},[t("van-grid",{style:{width:"100%","max-height":e.clientHeight-25+"px",overflow:"auto","box-shadow":e.fileListScrollTop>0?"#a5a7a8 0px 0px 3px":"#ffffff 0px 0px 0px"},attrs:{square:"",center:!0,"column-num":e.gridColumnNum,gutter:10,border:!1}},e._l(e.fileList,(function(i,n){return t("van-grid-item",{key:i.id,ref:"gridItem",refInFor:!0,attrs:{title:"大小："+e.formatSize(i.size)+"\r\n"+(i.w&&i.h?"分辨率："+i.w+"x"+i.h+"\r\n":"")+"名称："+i.name+"\r\n创建时间："+i.uploadDate+"\r\n修改时间："+i.updateDate+"\r\n路径："+i.path}},[t("div",{staticClass:"grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:{background:e.selectRowData.includes(i)?"#caeaf991":"","background-size":"cover","background-position":"center",border:e.selectRowData.includes(i)?"solid 1px #409eff":""},on:{click:function(t){return e.gridItemClick(i)},dblclick:function(t){return e.fileClick(i)},contextmenu:function(t){return t.preventDefault(),e.rowContextmenu(i)}}},[t("div",{staticClass:"grid-hover-back grid-hover van-grid-item__content van-grid-item__content--center van-grid-item__content--square"},[t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0,"grid-width":e.gridColumnWidth}})],1),e._v(" "),i.index===e.editingIndex?t("el-input",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"grid-item-text",attrs:{placeholder:"",type:"textarea",autosize:"",size:"small"},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,i.suffix)},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.rowRename(e.renameFileName,i))}},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}}):t("div",[t("div",{staticClass:"grid-item-text"},[t("span",[e._v(e._s(e.gridFilename(i)))])])])],1)])])})),1)],1)],1),e._v(" "),t("table",{staticClass:"drag-table",attrs:{id:"drag-table"}})],1),e._v(" "),e.fileList.length<1&&!e.tableLoading?t("empty-file",{attrs:{emptyStatus:e.emptyStatus}}):e._e(),e._v(" "),t("img",{staticStyle:{position:"fixed",opacity:"0"},attrs:{id:"dragImage",draggable:"false",src:i("5116")}}),e._v(" "),e.selectFile?e._e():t("div",{staticClass:"number-files",attrs:{id:"numberFiles"}},[t("img",{staticClass:"icon",staticStyle:{display:"none"},attrs:{src:i("943c")}}),e._v(" "),t("div",{staticClass:"number",staticStyle:{display:"inline"}},[e._v("1个文件")]),e._v(" "),t("div",{staticClass:"operate",staticStyle:{display:"none","white-space":"nowrap"}},[e._v("\n          移动到：\n        ")]),e._v(" "),e._m(0)])],1),e._v(" "),t("sim-text-preview",{attrs:{file:e.textPreviewRow,status:e.textPreviewVisible},on:{"update:file":function(t){e.textPreviewRow=t},"update:status":function(t){e.textPreviewVisible=t}}}),e._v(" "),t("image-viewer",{attrs:{fileList:e.fileList,file:e.imagePreviewRow,status:e.imagePreviewVisible},on:{"update:status":function(t){e.imagePreviewVisible=t}}}),e._v(" "),t("video-preview",{attrs:{file:e.videoPreviewRow,status:e.videoPreviewVisible},on:{"update:status":function(t){e.videoPreviewVisible=t}}}),e._v(" "),t("office-preview",{attrs:{file:e.officePreviewRow,status:e.officePreviewVisible},on:{"update:status":function(t){e.officePreviewVisible=t}}}),e._v(" "),e.cadPreviewVisible?t("cad-preview",{attrs:{status:e.cadPreviewVisible,file:e.cadPreviewRow},on:{"update:status":function(t){e.cadPreviewVisible=t},closeDialog:e.closeHandle}}):e._e(),e._v(" "),t("el-drawer",{attrs:{title:e.rowContextData.name,visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[t("div",{staticClass:"drawer-icon"},[t("icon-file",{staticClass:"drawer-icon-font",attrs:{grid:!0,details:!0,item:e.rowContextData,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})],1),e._v(" "),t("el-form",{staticClass:"details-form"},[t("el-form-item",{attrs:{label:"名称:"}},[t("span",[e._v(e._s(e.rowContextData.name))])]),e._v(" "),t("el-form-item",{staticClass:"details-name",attrs:{label:"类型:"}},[t("span",[e._v(e._s(e.rowContextData.isFolder?"文件夹":e.rowContextData.contentType))])]),e._v(" "),e.rowContextData.music?t("div",[t("el-form-item",{attrs:{label:"🎵 歌手:"}},[t("span",[e._v(e._s(e.rowContextData.music.singer))])]),e._v(" "),t("el-form-item",{attrs:{label:"🎵 专辑:"}},[t("span",[e._v(e._s("《"+e.rowContextData.music.album+"》"))])]),e._v(" "),t("el-form-item",{attrs:{label:"🎵 歌名:"}},[t("span",[e._v(e._s("《"+e.rowContextData.music.songName+"》"))])])],1):e._e(),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.rowContextData.w&&e.rowContextData.h,expression:"rowContextData.w && rowContextData.h"}],staticClass:"details-resolution",attrs:{label:"分辨率:"}},[t("span",[e._v(e._s(e.rowContextData.w+" x "+e.rowContextData.h))])]),e._v(" "),t("el-form-item",{attrs:{label:"大小:"}},[t("span",[e._v("\n            "+e._s(e.rowContextData.size)+"字节\n            "+e._s(e.rowContextData.size>0?"("+e.formatSize(e.rowContextData.size)+")":""))])]),e._v(" "),t("el-form-item",{staticClass:"details-position",attrs:{label:"位置:"}},[t("a",{attrs:{href:"/?path="+e.rowContextData.path+"&highlight="+e.rowContextData.name}},[e._v(e._s(e.rowContextData.path))])]),e._v(" "),t("el-form-item",{attrs:{label:"创建时间:"}},[t("span",[e._v(e._s(e.rowContextData.uploadDate))])]),e._v(" "),t("el-form-item",{attrs:{label:"修改时间:"}},[t("span",[e._v(e._s(e.rowContextData.updateDate))])])],1)],1),e._v(" "),t("el-dialog",{staticClass:"open-file-dialog",attrs:{title:"提示",top:"35vh",visible:e.openCompressionVisible},on:{"update:visible":function(t){e.openCompressionVisible=t}}},[t("svg-icon",{attrs:{"icon-class":"open-folder"}}),e._v(" "),t("span",{staticClass:"dialog-msg"},[e._v("查看压缩文件")]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.unzipTo(e.openingFile)}}},[e._v("解压到...")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.unzip(e.openingFile,e.openingFile.id,!1)}}},[e._v("解压到当前目录")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.compressionFilePreview(e.openingFile)}}},[e._v("预览")])],1)],1),e._v(" "),t("message-dialog",{attrs:{title:"提示",content:"此文件不支持预览, 是否下载该文件?",show:e.notPreviewDialogVisible,"button-size":"mini",operatButtonText:"取消",confirmButtonText:"下载"},on:{"update:show":function(t){e.notPreviewDialogVisible=t},operating:function(t){e.notPreviewDialogVisible=!1},confirm:function(t){return e.determineDownload(e.openingFile)}}}),e._v(" "),t("el-dialog",{attrs:{title:"预览:"+e.compressedFileName,visible:e.compressedFileVisible},on:{"update:visible":function(t){e.compressedFileVisible=t}}},[t("file-tree",{attrs:{directoryTreeData:e.compressedFileData,tempDir:e.compressedFileTempDir}})],1),e._v(" "),t("el-dialog",{attrs:{title:e.titlePrefix+e.selectTreeNode.showName,visible:e.dialogMoveOrCopyVisible},on:{"update:visible":function(t){e.dialogMoveOrCopyVisible=t},close:e.clearTreeNode}},[e.dialogMoveOrCopyVisible?t("el-tree",{ref:"directoryTree",attrs:{data:e.directoryTreeData,"node-key":"id",props:e.directoryTreeProps,load:e.directoryTreeLoadNode,"highlight-current":!0,"default-expanded-keys":["0"],"render-content":e.renderContent,hight:"100",lazy:""},on:{"node-click":e.treeNodeClick,"node-expand":e.treeNodeExpand}}):e._e(),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",disabled:e.fileTreeAndNewFolderDisabled},on:{click:e.fileTreeAndNewFolder}},[t("i",{staticClass:"el-icon-folder-add"}),e._v("  新建文件夹\n        ")]),e._v(" "),e.unzipOperating?e._e():t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.moveFileTree}},[e._v("移 动")]),e._v(" "),e.unzipOperating?e._e():t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.copyFileTree}},[e._v("复制")]),e._v(" "),e.unzipOperating?t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmUnzip}},[e._v("解压")]):e._e(),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogMoveOrCopyVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),t("tag-dialog",{attrs:{fileList:e.tagDialogObjectList,status:e.tagDialogVisible},on:{"update:status":function(t){e.tagDialogVisible=t},onSuccess:e.allocateTagSuccess}}),e._v(" "),t("share-dialog",{attrs:{file:e.shareDialogObject,status:e.shareDialogVisible},on:{"update:file":function(t){e.shareDialogObject=t},"update:status":function(t){e.shareDialogVisible=t},onSuccess:e.shareSuccess}}),e._v(" "),t("el-dialog",{staticClass:"new-text-file-dialog",attrs:{title:e.newCreateFileDialogTitle,"close-on-click-modal":!1,visible:e.newCreateFileDialog},on:{"update:visible":function(t){e.newCreateFileDialog=t}}},[t("el-input",{ref:"newCreateFileName",staticClass:"dialog-msg",attrs:{size:"small",clearable:!0},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,"")},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createFile(e.newCreateFileName)}},model:{value:e.newCreateFileName,callback:function(t){e.newCreateFileName=t},expression:"newCreateFileName"}}),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.newCreateFileDialog=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.createFileLoading,expression:"createFileLoading"}],attrs:{size:"small",type:"primary"},on:{click:function(t){return e.createFile(e.newCreateFileName)}}},[e._v("确定")])],1)],1)],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"target"},[t("span",{staticClass:"folder",staticStyle:{display:"none","white-space":"nowrap"}},[e._v("document")])])}],o=(i("55dd"),i("386d"),i("7514"),i("a481"),i("f559"),i("20d6"),i("ac6a"),i("5df3"),i("1c4c"),i("28a5"),i("6f8e")),r=(i("c5f6"),i("2f62")),s=i("7f29"),l=i("26a1"),c=i("1000"),d=(i("9dce"),i("5cfc")),u=i("573f"),h=i("0dcf"),p=i("71e9"),f=i("2d53"),m=i("1638"),g=i("ae1f"),v=i("140f"),b=i("3293"),w=i("5a87"),y=i("9476"),x=(i("3b6a"),i("2690")),C=i("4308"),k=i("fd35"),_=i("fdd2"),S=i("dc5e"),L=i("c24f"),T=i("b311"),D=i.n(T),E=i("0dca"),F={name:"ShowFile",components:{TagDialog:E["a"],ShareDialog:S["a"],OfficePreview:k["a"],CadPreview:_["a"],EditElement:C["default"],MessageDialog:w["a"],AudioPreview:v["a"],VideoPreview:g["a"],ImageViewer:m["a"],SimTextPreview:f["a"],IconFile:h["a"],BreadcrumbFilePath:u["a"],EmptyFile:p["a"],ButtonUpload:b["a"],FileTree:y["a"]},props:{selectFile:{type:Boolean,defalut:!1},lessClientHeight:{type:Number,default:106},showUploadButton:{type:Boolean,default:!0},showSearchButton:{type:Boolean,default:!0},showShareItem:{type:Boolean,default:!0},showMoreItem:{type:Boolean,default:!0},isCollectView:{type:Boolean,default:!1},emptyStatus:{type:String,default:"空空如也~"},singleFileType:{type:String,default:""},showNavigation:{type:Boolean,default:!0},queryFileType:{type:String,default:null},defaultGrid:{type:Boolean,default:!0},orderCustom:{type:Boolean,default:!1},sortable:{type:Object,default:function(){return{prop:"",order:null}}},queryCondition:{type:Object,default:function(){return{isFolder:null}}},singleMenus:{type:Array,default:function(){return[{iconClass:"menu-open",label:"打开",operation:"open"},{iconClass:"share",label:"分享",operation:"share"},{iconClass:"tag",label:"标签",operation:"tag"},{iconClass:"menu-favorite",label:"收藏",operation:"favorite"},{iconClass:"menu-details",label:"详细信息",operation:"details"},{iconClass:"menu-rename",label:"重命名",operation:"rename"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},multipleMenus:{type:Array,default:function(){return[{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},multipleRightMenus:{type:Array,default:function(){return[{iconClass:"menu-deselect",label:"取消选定",operation:"deselect"},{iconClass:"tag",label:"标签",operation:"tag"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},contextMenus:{type:Array,default:function(){return[]}}},data:function(){return{imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),audioCoverUrl:"".concat("/api","/view/cover?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),fileMenuActive:"",path:this.$route.query.path,basePath:"/",showNewFolder:!1,isShowNewFolder:!1,listModeSearch:!1,listModeSearchOpenDir:!1,newFolderName:"新建文件夹",renameFileName:"",searchFileName:"",pathList:[{folder:""}],fileList:[],pageLoadCompleteList:[],pagination:{pageIndex:1,pageSize:50,total:0,pageSizes:[10,20,30,40,50]},isIndeterminate:!1,isSelectAll:!1,clientHeight:500,tableHead:[{name:"",label:"",index:0},{name:"",label:"",index:1},{name:"name",label:"名称",sortable:!0,index:2},{name:"",label:"",index:3},{name:"",label:"",more:!0,index:4},{name:"size",label:"大小",sortable:!0,index:5},{name:"updateDate",label:"修改日期",sortable:!0,index:6}],isJustHideMenus:!1,menusIsMultiple:!1,menus:[],contextmenuDisabled:!1,rowContextData:{},tableLoading:!0,finished:!1,newFolderLoading:!1,renameLoading:!1,menuTriangle:"",cellMouseIndex:-1,editingIndex:-1,titlePrefix:"",unzipOperating:!1,dialogMoveOrCopyVisible:!1,fileTreeAndNewFolderDisabled:!1,directoryTreeData:[],compressedFileVisible:!1,compressedFileData:[],compressedFileName:"",compressedFileTempDir:!1,selectTreeNode:{},directoryTreeProps:{label:"name",children:"children",isLeaf:"isLeaf"},dragLoop:null,positionX:0,positionY:0,grid:this.defaultGrid,vmode:this.defaultGrid?"grid":"list",gridColumnNum:-1,gridColumnWidth:120,allChecked:!1,summaries:"",shareDialogVisible:!1,shareDialogObject:{},tagDialogVisible:!1,tagDialogObjectList:[],newCreateFileDialog:!1,newCreateFileName:"",newCreateFileDialogTitle:"",createFileLoading:!1,shareLink:"",shareFileName:"",textPreviewVisible:!1,textPreviewRow:{},imagePreviewRow:{},imagePreviewVisible:!1,videoPreviewRow:{},videoPreviewVisible:!1,officePreviewRow:{},officePreviewVisible:!1,cadPreviewRow:{},cadPreviewVisible:!1,audioPreviewRow:{},audioPreviewVisible:!1,drawer:!1,rowStyleExecuting:!1,selectRowData:[],selectOrgin:-1,selectEnd:-1,selectPin:!1,inputting:!1,isCmd:!1,dragElementList:[],drawFlag:!1,fileListScrollTop:0,initFileListScrollTop:0,notPreviewDialogVisible:!1,openingFile:"",openCompressionVisible:!1,stompClient:void 0,showUpdateDateItem:!0,showSizeItem:!0,stopSortChange:!1,draging:0,getFileListed:!1,onCreateFilename:""}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(r["c"])(["message"])),Object(r["b"])(["name"])),{},{gridFilename:function(){return function(e){var t=e.name;if(e.isFolder)return t;var i=t.split("."),n=i.length>1?i.pop():"",a=i.join("."),o=this.getEffectiveLength(a,n);if(o<=14)return t;for(var r=14-(n?n.length+1+1:0),s="",l=0,c=0,d=Array.from(a);c<d.length;c++){var u=d[c],h=this.getCharLength(u);if(l+h>r)break;l+=h,s+=u}return n?s+"…"+n:s+"…"}},getSummaries2:function(){var e=0;this.fileList.forEach((function(t){e+=t.size}));var t=this.getShowSumFileAndFolder(this.fileList),i=this.getShowSumSize(e);return this.summaries=t+i,e>0?t+i:""},getSummaries3:function(){var e=0;return this.fileList.forEach((function(t){e+=t.size})),e>0?this.fileList.length+"项 "+this.getShowSumSize(e):""}}),created:function(){},watch:{$route:function(e){e.query.tagId&&this.queryCondition.tagId!==this.$route.query.tagId&&(this.queryCondition.tagId=this.$route.query.tagId,this.getFileList())},message:function(e){switch(e.event){case"msg/file/operation/fault":this.getFileList();break;case"fileSuccess":this.setOnCreateFilename(e.data);break;case"loadFileFailed":this.notPreviewDialogVisible=!0;break;case"clickMore":this.$refs.fileListTable.tableSelectData=e.data,this.preliminaryRowData();break;case"renameRow":var t=this.fileList.findIndex((function(t){return t.name===e.data.oldName}));if(t>-1){var i=this.fileList[t];i.suffix=e.data.suffix,i.name=e.data.name,this.$refs.fileListTable.clearSelection()}break;case"msg/file/change":this.onmessage(e.data);break}}},mounted:function(){var e=this;if(window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1)),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.$route.query.vmode?this.vmode=this.$route.query.vmode:this.defaultGrid?this.vmode="grid":this.vmode="list","list"===this.vmode?(this.grid=!1,this.selectFile||(this.lessClientHeight=140)):(this.grid=!0,this.selectFile||(this.lessClientHeight=106),this.containerResize()),"/"!==this.$route.query.path){var t=decodeURI(this.$route.query.path);this.pathList.splice(1,1),t.split("/").forEach((function(t,i){if(i>0){var n={};n["folder"]=t,e.pathList.push(n)}}))}this.$route.query.folder&&this.path&&localStorage.setItem(this.path,this.$route.query.folder),this.$route.query.highlight&&(this.onCreateFilename=this.$route.query.highlight,this.clearOnCreateFilename());var i=this;window.onresize=function(){i.clientHeight=document.documentElement.clientHeight-i.lessClientHeight},setTimeout((function(){e.getFileListed||e.getFileList()}),50)},beforeDestroy:function(){window.removeEventListener("keydown",this.keydown,!1),window.removeEventListener("keyup",this.keyup,!1),window.removeEventListener("popstate",this.goBack,!1),this.stompClient&&this.stompClient.unsubscribe()},directives:{focus:{inserted:function(e){var t=e.querySelector("input");t||(t=e.querySelector("textarea")),t.focus()}},resize:{bind:function(e,t){var i="",n="";function a(){var a=document.defaultView.getComputedStyle(e);i===a.width&&n===a.height||t.value(),i=a.width,n=a.height}e.__vueSetInterval__=setInterval(a,300)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},methods:{isChineseChar:function(e){return e.charCodeAt(0)>255},getCharLength:function(e){return this.isChineseChar(e)?2:1},getEffectiveLength:function(e,t){var i=this,n=Array.from(e).reduce((function(e,t){return e+i.getCharLength(t)}),0);return t?n+t.length+1:n},keydown:function(e){var t=this,i=navigator.platform.startsWith("Mac"),n=(e.key,e.c,e.keyCode),a=e.ctrlKey,o=e.metaKey;this.isCmd=i&&o||!i&&a,16===e.keyCode&&e.shiftKey&&(this.selectPin=!0),this.isCmd&&65===n&&(this.inputting||-1!==this.editingIndex?e.target.select():(this.$nextTick((function(){t.$refs.fileListTable&&t.$refs.fileListTable.toggleAllSelection()})),e.preventDefault(),e.stopPropagation()))},keyup:function(e){var t=navigator.platform.startsWith("Mac"),i=(e.key,e.c,e.keyCode,e.ctrlKey),n=e.metaKey;this.isCmd=t&&n||!t&&i,16===e.keyCode&&(this.selectPin=!1)},onmessage:function(e){var t=e.body,i=e.url,n=this.fileList.findIndex((function(e){return e.id===t.id}));if("updateFile"===i&&n>-1&&(t.m3u8&&(this.fileList[n].m3u8=t.m3u8),this.fileList[n].size=t.size,this.fileList[n].agoTime=1,this.fileList[n].updateDate=t.updateDate),"deleteFile"===i&&n>-1&&this.getFileList(),"createFile"===i){if(t.$set&&(this.onCreateFilename=t.$set.name),t&&t.name&&(this.onCreateFilename=t.name),this.path||(this.path=""),t)if(t.$set){var a=t.$set.path;a=a.replace(/\\/g,"/"),this.path+"/"===a&&this.getFileList()}else this.path+"/"===t.path&&this.getFileList();this.clearOnCreateFilename()}},clearOnCreateFilename:function(){var e=this;setTimeout((function(){e.onCreateFilename=""}),2e3)},load:function(){this.getFileList(!0)},gridItemClick:function(e){if(this.selectFile&&this.fileClick(e),this.isCmd)return this.pinSelect(null,e),void this.$refs.fileListTable.toggleRowSelection([{row:e}]);this.pinSelect(null,e)},containerResize:function(){var e=document.querySelector(".dashboard-container"),t=e.clientWidth;this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,"image"===this.queryFileType?this.gridColumnNum=Math.round((t-10)/165):this.gridColumnNum=Math.round((t-10)/135),this.gridColumnWidth=(t-11*this.gridColumnNum)/this.gridColumnNum-4.5,this.showUpdateDateItem=!(t<900),this.showSizeItem=!(t<500);var i=Math.round(this.clientHeight/(t/this.gridColumnNum));this.pagination.pageSize=i*this.gridColumnNum+this.gridColumnNum,this.rowDrop(),this.darwRectangle()},darwRectangle:function(){var e=this,t=document.querySelector(".el-table__body-wrapper");if(this.grid&&(t=document.querySelector(".van-grid")),t.onscroll=function(t){e.tableBodyScroll(null,t)},!this.selectFile){var i=this,n=function(e){return document.getElementById(e)},a=n("v-draw-rectangle"),o="rectangle1",r=0,s=0,l=0,c=0,d=0,u=0;i.drawFlag=!1;var h="el-table__row";i.grid&&(h="grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square"),a.onmousedown=null,a.onmousedown=function(e){var t=window.event||e,n=e.path||e.composedPath&&e.composedPath();if(!i.grid&&i.selectRowData.length>0){var m=n.findIndex((function(e){if("el-table__header-wrapper"===e.className)return e}));m>-1&&(i.stopSortChange=!0)}var g=n.find((function(e){if(e.className===h||"el-table__row el-table__row--striped"===e.className)return e}));if(g)i.selectRowData.includes(i.fileList[g.rowIndex])||(i.editingIndex=-1,i.isCmd||i.selectPin||(i.$refs.fileListTable.clearSelection(),i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[g.rowIndex],selected:!0}])));else if(i.editingIndex=-1,0===t.button){if(!i.isCmd&&!i.selectPin){var v=n.findIndex((function(e){return e.className===h||"el-table__row el-table__row--striped"===e.className}));v<0&&i.$refs.fileListTable.clearSelection()}var b=a.scrollTop||a.scrollTop,w=a.scrollLeft||a.scrollLeft;r=t.clientX+w,s=t.clientY+b;var y=document.createElement("div");y.id=o,y.className="draw-rectangle",y.style.left=r+"px",y.style.top=s+"px",y.style.position="fixed",y.style.border="1px dashed #2898ff",y.style.width="0px",y.style.height="0px",y.style.left="0px",y.style.top="0px",y.style.overflow="hidden",a.appendChild(y),document.onmousemove=function(e){var t=window.event||e,n=document.body.scrollTop||document.documentElement.scrollTop,a=document.body.scrollLeft||document.documentElement.scrollLeft;if(l=r-t.clientX-a>0?t.clientX+a:r,c=s-t.clientY-n>0?t.clientY+n:s,d=Math.abs(s-t.clientY-n),u=Math.abs(r-t.clientX-a),i.drawFlag=!0,!(d+u<4)){var h=document.getElementById(o);h&&(h.style.left=l+"px",h.style.top=c+"px",h.style.width=u+"px",h.style.height=d+"px",h.style.backgroundColor="#f2f5fa55"),i.drawFlag&&d+u>4&&(p||f({x:l,y:c+i.fileListScrollTop,w:u,h:d}))}},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,i.stopSortChange&&(i.stopSortChange=!1,setTimeout((function(){i.changeSelectedStyle(i.selectRowData)}),200)),setTimeout((function(){i.drawFlag=!1}),50);var t=document.getElementById(o);t&&a.removeChild(t),i.grid||(a=document.getElementById("drag-table"));var n=Array.prototype.slice.call(a.getElementsByClassName("dragingDiv"));n.forEach((function(e){return a.removeChild(e)}))}}};var p=!1,f=function(e){p=!0,i.dragElementList.forEach((function(t){m(t,e)?i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[t.rowIndex],selected:!0}]):i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[t.rowIndex],selected:!1}])})),setTimeout((function(){return p=!1}),10)},m=function(e,t){var i=e.x,n=e.y,a=t.x,o=t.y,r=e.w,s=e.h,l=t.w,c=t.h;return(i-a<=0&&a-i<r||i-a>=0&&i-a<l)&&(n-o<=0&&o-n<s||n-o>=0&&n-o<c)}}},rowDrop:function(){if(!this.selectFile){var e=null,t=this,i=null,n=-1,a="van-grid",o="van-grid-item van-grid-item--square",r="grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square";t.grid||(o="el-table__row",a="el-table__body");var s=null,c=document.querySelector(".dashboard-container"),d=document.querySelector(".el-table__body-wrapper tbody");this.grid&&(d=document.querySelector(".van-checkbox-group .van-grid"));var u=document.getElementById("v-draw-rectangle");this.grid||(u=document.getElementById("drag-table"));var h=0,p=Object(l["a"])(u),f=0,m="";setTimeout((function(){h=d.childElementCount,t.dragElementList=[];for(var e=0;e<d.childElementCount;e++){var i=d.children[e];t.grid&&(i.rowIndex!==e&&(i.rowIndex=e),i.children[0].children[0].rowIndex=e,i=i.children[0].children[0]);var n=C(i);i.w=i.offsetWidth,i.h=i.offsetHeight,i.x=n.x,i.y=n.y,n.rowIndex=i.rowIndex,t.dragElementList.push(i),i.draggable=!0,i.slot="jmal";var a=i.querySelector(".el-avatar > img");t.grid&&(a=i.querySelector(".el-image > img")),a&&(a.draggable=!1)}}),300);var g=-1,v=function(e,i){var n=e.path||e.composedPath&&e.composedPath();if("enter"===i){var s=null;e.toElement.className;if(t.grid?(e.toElement.className===o&&(s=e.toElement),e.toElement.className===a&&(s=e.fromElement)):s="v-draw-rectangle"===n[0].id||"el-table__virtual-wrapper"===n[0].className?e.toElement:n.find((function(e){if("el-table__header-wrapper"===e.className)return e})),s){if(g>-1){var l=d.children[g];x(l)}g=-1}}var c=null;return t.grid?(n[0].className===r||(c=n.find((function(e){if(e.className===r)return e}))),c):("TD"===n[0].tagName&&(c=n.find((function(e){if("el-table__row el-table__row--striped"===e.className||"el-table__row"===e.className)return e}))),c)},b=function(e){e?(t.selectRowData.forEach((function(e){var i=document.getElementById("dragingDiv"+e.index);i.style.transition="all 0.3s",i.style.top=i.original.top-(t.fileListScrollTop-t.initFileListScrollTop)+"px",i.style.left=i.original.left})),setTimeout((function(){t.selectRowData.forEach((function(e){u.removeChild(document.getElementById("dragingDiv"+e.index))}))}),300)):t.selectRowData.forEach((function(e){u.removeChild(document.getElementById("dragingDiv"+e.index))})),setTimeout((function(){t.grid?d.querySelectorAll(".grid-hover-back").forEach((function(e){e.classList.add("grid-hover")})):document.getElementsByClassName("el-table")[0].classList.add("el-table--enable-row-hover")}),350),t.draging=0};c.ondragend=function(e){t.$store.dispatch("updateMessage",{event:"onDragStart",data:!1}),e.dataTransfer.effectAllowed="none";var n=d.children[g];x(n),i.style.cursor="default",e.target.parentNode.parentNode.title=m},c.ondragstart=function(a){if(t.drawFlag||t.isCmd||t.selectPin)return a.preventDefault(),void a.stopPropagation();if(!a.target.slot||"jmal"!==a.target.slot)return!0;if(a.target.rowIndex===t.editingIndex)return a.preventDefault(),void a.stopPropagation();a.target.style.cursor="no-drop",m=a.target.parentNode.parentNode.title,a.target.parentNode.parentNode.title="",t.selectRowData.forEach((function(e,i){var n=t.dragElementList[e.index],a=n.rowIndex;s=n.cloneNode(!0),s.id="dragingDiv"+a,s.classList.add("dragingDiv"),s.classList.remove("el-table_row"),s.style.transition="all 0.3s",s.style.zIndex=-1,s.style.position="absolute";var o=t.dragElementList[a];s.style.width=o.w+"px",s.style.height=o.h+"px",s.style.left=o.x-p+"px";var r=0;if(t.grid)r=o.y-t.fileListScrollTop-o.h/2+10;else{s.firstChild.style.textAlign="center";var l=Array.prototype.slice.call(s.childNodes);l.forEach((function(e,t){if(4===t)return e.style.borderRadius="0 3px 3px 0",e.style.borderRight="1px solid #409eff",e.firstChild.style.height="44px",e.firstChild.style.lineHeight="44px",e.firstChild.style.width="80px",!0;0!==t&&1!==t&&s.removeChild(e)})),r=o.y-t.fileListScrollTop-51.5}if(s.style.top=r+"px",0===i){var c=document.getElementById("numberFiles").cloneNode(!0);c.id="numberFilesCopy",c.querySelector(".number").innerHTML=t.selectRowData.length+"个文件",s.appendChild(c)}s.original={top:r,left:s.style.left},t.initFileListScrollTop=t.fileListScrollTop,u.appendChild(s)})),f=0;var o=document.getElementById("dragImage");a.dataTransfer.setDragImage(o,10,10),t.$store.dispatch("updateMessage",{event:"onDragStart",data:!0}),t.drawFlag=!1;var r=document.getElementById("rectangle1");r&&document.getElementById("v-draw-rectangle").removeChild(r),i=a.target,n=i.rowIndex,t.cellMouseIndex=-1,e=i.style.backgroundColor,t.grid?d.querySelectorAll(".grid-hover-back").forEach((function(e){e.classList.remove("grid-hover")})):document.getElementsByClassName("el-table--enable-row-hover")[0].classList.remove("el-table--enable-row-hover"),t.draging=1},c.ondragenter=function(e){clearTimeout(w);var a=v(e,"enter");if(a){if(g!==a.rowIndex){if(g>-1){var o=d.children[g];x(o)}if(n!==a.rowIndex&&t.fileList[a.rowIndex].isFolder&&-1===t.selectRowData.findIndex((function(e){return e.index===a.rowIndex}))){i.style.cursor="copy";var r=document.getElementById("numberFilesCopy");r.style.backgroundColor="#40a9ffc9",r.querySelector(".number").style.display="none",r.querySelector(".icon").style.display="inline",r.querySelector(".operate").style.display="inline";var s=r.querySelector(".target .folder");s.style.display="inline",s.innerHTML=t.fileList[a.rowIndex].name,a.style.backgroundColor;var l="#9fcdfc99";t.grid?a.style.backgroundColor=l:a.childNodes.forEach((function(e){return e.style.backgroundColor=l}))}g=a.rowIndex}y=-1}},c.ondragover=function(e){t.selectRowData.forEach((function(t,i){var n=document.getElementById("dragingDiv"+t.index);n&&(n.style.left=e.clientX-p+3*i+10+"px",n.style.top=e.clientY-50+3*i+10+"px",0===f&&(n.style.zIndex=999,setTimeout((function(){n.style.transition=""}),300)))})),e.preventDefault(),y=-1,f++};var w=null,y=-1;c.ondragleave=function(e){clearTimeout(w);var i=v(e,"leave");i&&(t.grid||0!==i.rowIndex&&i.rowIndex!==h-1||(y=i.rowIndex,w=setTimeout((function(){if(y>-1){var e=d.children[y];x(e),g=-1}}),100)))},c.ondrop=function(){var e=t.fileList[n],i=t.fileList[g];if(e&&i&&e.id!==i.id&&i.isFolder&&!t.selectRowData.includes(i)){var a=[];t.selectRowData.forEach((function(e){a.push(e.id)})),t.$confirm("是否将选中的".concat(t.selectRowData.length,"项移动到 ").concat(i.name,"?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){t.copyOrMoveApi("move",a,i.id),b(!1)})).catch((function(){b(!0)}))}else b(!0)};var x=function(n){if(i){if(n){t.grid?(n=n.children[0].children[0],"rgba(159, 205, 252, 0.6)"===n.style.backgroundColor&&(n.style.backgroundColor=null)):"rgba(159, 205, 252, 0.6)"===n.firstChild.style.backgroundColor&&n.childNodes.forEach((function(e){e.style.backgroundColor=null})),i.style.cursor="default";var a=document.getElementById("numberFilesCopy");a&&(a.style.backgroundColor="#d2eefa66",a.querySelector(".number").style.display="inline",a.querySelector(".icon").style.display="none",a.querySelector(".operate").style.display="none",a.querySelector(".target .folder").style.display="none")}i.style.backgroundColor=e}}}function C(e){var t={x:0,y:0};while(e)t.x+=e.offsetLeft,t.y+=e.offsetTop,e=e.offsetParent;return t}},formatTime:function(e){return Object(s["c"])(e)},formatSize:function(e){return Object(s["b"])(e)},upload:function(){this.$store.dispatch("updateMessage",{event:"openUploader",data:{folder:this.$route.query.folder,currentDirectory:this.getQueryPath(),username:this.$store.state.user.name,userId:this.$store.state.user.userId}})},uploadFolder:function(){window.uploader.supportDirectory?this.$store.dispatch("updateMessage",{event:"uploadFolder",data:{folder:this.$route.query.folder,currentDirectory:this.getQueryPath(),username:this.$store.state.user.name,userId:this.$store.state.user.userId}}):this.$message({message:"该浏览器不支持上传文件夹",type:"warning"})},goBack:function(){if(this.pathList.length<=1){var e=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("/?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(e))}else this.lastLink()},lastLink:function(){this.handleLink(this.pathList[this.pathList.length-2],this.pathList.length-2)},handleLink:function(e,t,i,n){var a=this;if(e&&e.search)e.searchKey?this.searchFileByKeyWord(e.searchKey):e.row&&this.searchFileAndOpenDir(e.row),this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1));else{this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1)),this.pathList.forEach((function(e,t){0===t?a.path="":t===a.pathList.length||(a.path+="/"+a.pathList[t].folder),a.path=a.path.replace(/\\/g,"/")}));var o=localStorage.getItem(this.path);if(!i){var r=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$route.query.path,this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(o?"&folder="+o:"").concat(r))}n||(this.pagination.pageIndex=1,this.getFileList())}},newDocument:function(){window.open("/setting/website/manager-articles?operation=new","_blank")},newFolder:function(){var e=this;this.newFolderName=this.getNewFileName(this.fileList,"新建文件夹"),this.showNewFolder=!0,this.$nextTick((function(){e.$refs.newFolderName.focus(),e.$refs.newFolderName.select()}))},getNewFileName:function(e,t){var i=0,n=[];e.forEach((function(e){var t=e.name||e.label;n.push(t)}));var a=t;while(n.includes(t))if(i+=1,a.indexOf(".")>0){var o=a.substring(0,a.lastIndexOf(".")),r=a.substring(a.lastIndexOf("."));t="".concat(o).concat(i).concat(r)}else t="".concat(a).concat(i);return t},getDuplicateFileName:function(e,t){var i=0,n=[];e.forEach((function(e){var t=e.name||e.label;n.push(t)}));var a=t;while(n.includes(t))if(i+=1,a.indexOf(".")>0){var o=a.substring(0,a.lastIndexOf("."));o.indexOf(" 副本")>0&&(o=o.substring(0,o.lastIndexOf(" 副本")));var r=a.substring(a.lastIndexOf("."));t=1===i?"".concat(o," 副本").concat(r):"".concat(o," 副本").concat(i).concat(r)}else a.indexOf(" 副本")>0&&(a=a.substring(0,a.lastIndexOf(" 副本"))),t=1===i?"".concat(a," 副本"):"".concat(a," 副本").concat(i);return t},hideNewFolderName:function(){this.showNewFolder=!1,this.isShowNewFolder=!1},showNewFolderClick:function(){this.isShowNewFolder=!0},setInputFocus:function(){this.inputting=!0},setInputBlur:function(){this.inputting=!1},newFolderNameClickEnter:function(){this.newFolderNameClick()},newFolderNameClick:function(){var e=this;if(this.newFolderName){if(/[\[\]\/\\"<>\?\*]/gi.test(this.newFolderName))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});this.newFolderLoading=!0,this.createFileLoading=!0,d["a"].uploadFolder({isFolder:!0,filename:encodeURI(this.newFolderName),currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,username:this.$store.state.user.name,userId:this.$store.state.user.userId}).then((function(t){1===t.data?(e.newFolderLoading=!1,e.$message({message:"该文件夹已存在",type:"warning"})):(e.createFileLoading=!1,e.newCreateFileDialog=!1,e.newFolderLoading=!1,e.showNewFolder=!1,e.isShowNewFolder=!1,e.$notify({title:"新建文件夹成功",type:"success",duration:1e3}),e.listModeSearch?e.getFileListBySearchMode():e.getFileList())})).catch((function(){e.newFolderLoading=!1,e.createFileLoading=!1}))}else this.newFolderLoading=!1,this.$message({message:"请输入文件夹名称",type:"warning"})},createFile:function(e){var t=this;if("新建文件夹"===this.newCreateFileDialogTitle)return this.newFolderName=e,void this.newFolderNameClick();if(e){if(/[\[\]\/\\"<>\?\*]/gi.test(e))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});this.createFileLoading=!0;var i="/";this.path&&this.path.length>0&&(i=this.path);var n=e.substring(e.lastIndexOf(".")+1);d["a"].addFile({fileName:encodeURI(e),isFolder:!1,folder:this.$route.query.folder,username:this.$store.state.user.name,parentPath:encodeURI(i)}).then((function(i){switch(t.createFileLoading=!1,n&&!t.$route.query.folder){case"txt":t.textPreviewRow=i.data,t.textPreviewVisible=!0;break;case"drawio":case"mind":case"docx":case"xlsx":case"pptx":t.officePreviewRow=i.data,t.officePreviewVisible=!0;break}var a=t;t.setOnCreateFilename(e),setTimeout((function(){a.newCreateFileDialog=!1}),200)})).catch((function(){t.createFileLoading=!1}))}},searchFileByKeyWord:function(e){this.searchFile(e)},changeVmode:function(){this.grid=!this.grid,this.vmode="list",this.grid?(this.vmode="grid",this.lessClientHeight=106):(this.lessClientHeight=140,this.$refs.fileListTable.setHeight()),this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,this.path||(this.path=""),this.editingIndex=-1;var e=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(this.path).concat(this.$route.query.folder?"&folder="+this.$route.query.folder:"").concat(e)),this.rowDrop(),this.darwRectangle(),this.loadContextMenus(),this.grid||this.fileListScrollTop>0&&this.$refs.fileListTable.pagingScrollTopLeft(),this.fileListScrollTop=0},loadContextMenus:function(){var e=this;if(this.contextMenus.length<1)this.contextmenuDisabled=!0;else{var t=document.querySelector(".dashboard-container");0===this.$refs.homeContextmenu.references.length&&this.$refs.homeContextmenu.addRef({el:t,vnode:t});var i=this.contextMenus.findIndex((function(e){return"viewMode"===e.operation})),n=this.contextMenus.findIndex((function(e){return"arrangement"===e.operation}));if(i>-1){var a=this.contextMenus[i].child;this.grid?(a[0].iconClass="menu-empty",a[1].iconClass="menu-point"):(a[0].iconClass="menu-point",a[1].iconClass="menu-empty")}if(n>-1){var o=this.contextMenus[n].child,r=this.sortable.prop;o.forEach((function(t){var i=t.orderProp;i===r&&o.map((function(t){return i===t.orderProp?t.iconClass="menu-"+e.sortable.order:t.iconClass="menu-null",t}))}))}}},beforeLoadData:function(e){e?this.pagination.pageIndex++:this.pagination.pageIndex=1,this.pageLoadCompleteList[this.pagination.pageIndex]=!1,this.tableLoading=!0,this.finished=!1},loadData:function(e,t){var i=this;if(this.$refs.fileListTable){t?e.data.forEach((function(e,t){e["index"]=(i.pagination.pageIndex-1)*i.pagination.pageSize+t,i.fileList.push(e)})):(this.fileList=e.data,this.fileList.map((function(e,t){e.index=t})),this.$refs.fileListTable.reloadData(this.fileList),setTimeout((function(){i.$refs.fileListTable.reloadData(i.fileList)}),0)),this.fileList.length>=e.count&&(this.finished=!0),this.tableLoading=!1,this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,this.listModeSearch=!1,this.pagination["total"]=e.count,this.$nextTick((function(){i.containerResize(),i.tableLoading=!1,i.pageLoadCompleteList[i.pagination.pageIndex]=!0})),this.loadContextMenus(),this.highlightNewFile(),this.setMountFileOwner();var n="Object";if(this.fileList.length>0){var a=/([a-zA-Z]:\\[^*|"<>?\n]*)|(\/[^*|"<>?\n]*)/;a.test(this.fileList[0].id)||(n="File")}this.$store.dispatch("updateMessage",{event:"storageTypeChange",data:n})}},setMountFileOwner:function(){if(this.$route.query.folder&&this.fileList.length>0){var e=this.fileList[0];e.userId!==this.$store.getters.userId&&Object(L["e"])({userId:e.userId}).then((function(e){localStorage.setItem("mountFileOwner",e.data)}))}},highlightNewFile:function(){var e=this;if(this.onCreateFilename){var t=this.fileList.findIndex((function(t){return t.name===e.onCreateFilename}));if(t>-1){var i=this.fileList[t];setTimeout((function(){e.$refs.fileListTable.clearSelection(),e.$refs.fileListTable.toggleRowSelection([{row:i,selected:!0}])}),0)}}},searchFile:function(e,t){var i=this;if(e){this.beforeLoadData(t),this.pathList=[{folder:""}];var n={};n["folder"]='搜索: "'+e+'"',n["search"]=!0,n["searchKey"]=e,this.pathList.push(n);var a=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e).concat(a)),d["a"].searchFile({userId:this.$store.state.user.userId,username:this.$store.state.user.name,keyword:e,sortableProp:this.sortable.prop,order:this.sortable.order,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(e){i.loadData(e,t),i.path="",i.listModeSearch=!0,i.listModeSearchOpenDir=!1}))}},searchFileAndOpenDir:function(e,t){var i=this;this.beforeLoadData(t),d["a"].searchFileAndOpenDir({userId:this.$store.state.user.userId,username:this.$store.getters.name,id:e.id,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,folder:this.$route.query.folder}).then((function(n){i.loadData(n,t),i.listModeSearch=!0,i.listModeSearchOpenDir=e})),this.path=e.path+e.name,this.path=this.path.replace(/\\/g,"/")},openDir:function(e,t){var i=this;this.beforeLoadData(t),d["a"].searchFileAndOpenDir({userId:this.$store.state.user.userId,username:this.$store.getters.name,id:e.mountFileId||e.id,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,folder:this.$route.query.folder}).then((function(e){i.loadData(e,t)})),this.path=e.path+e.name,this.path=this.path.replace(/\\/g,"/")},getFileList:function(e){var t=this;this.getFileListed=!0,this.beforeLoadData(e),d["a"].fileList({userId:this.$store.state.user.userId,username:this.$store.state.user.name,currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,queryFileType:this.queryFileType,sortableProp:this.sortable.prop,order:this.sortable.order,isFolder:this.queryCondition.isFolder,isFavorite:this.queryCondition.isFavorite,tagId:this.queryCondition.tagId,queryCondition:this.queryCondition,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(i){t.loadData(i,e)}))},getFileListBySearchMode:function(e){var t=this;this.beforeLoadData(e),d["a"].fileList({userId:this.$store.state.user.userId,username:this.$store.state.user.name,currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(i){t.loadData(i,e)}))},getQueryPath:function(){var e=this.$route.query.basePath?this.$route.query.basePath:"/";return e&&e.lastIndexOf("/")===e.length-1&&(e=e.substring(0,e.length-1)),encodeURI(e+this.$route.query.path)},tableBodyScroll:function(e,t){this.fileListScrollTop=t.target.scrollTop;var i=t.target.scrollHeight-t.target.clientHeight-t.target.scrollTop;if(i<200&&!this.finished){if(!this.pageLoadCompleteList[this.pagination.pageIndex])return;this.listModeSearch?this.listModeSearchOpenDir?this.searchFileAndOpenDir(this.listModeSearchOpenDir,!0):this.searchFile(this.searchFileName,!0):this.getFileList(!0)}},pinSelect:function(e,t){if(this.selectPin&&this.selectOrgin>-1){var i=this.selectOrgin;this.selectEnd=t.index;var n=this.selectEnd-i;if(this.$refs.fileListTable.clearSelection(),0===n&&(this.selectOrgin=-1),n>0)for(var a=i;a<=this.selectEnd;a++)this.$refs.fileListTable.toggleRowSelection([{row:this.fileList[a],selected:!0}]),this.$refs.fileListTable.tableSelectData.push(this.fileList[a]);if(n<0)for(var o=this.selectEnd;o<=i;o++)this.$refs.fileListTable.toggleRowSelection([{row:this.fileList[o],selected:!0}]),this.$refs.fileListTable.tableSelectData.push(this.fileList[o])}this.changeSelectedStyle(this.$refs.fileListTable.tableSelectData)},sortChangeOfMenu:function(e,t){var i=this,n=document.querySelector(".el-table__header thead tr");n.childNodes.forEach((function(e){e.className.indexOf("is-sortable")>-1&&(i.removeClass(e,"descending"),i.removeClass(e,"ascending"))}));var a="ascending"===this.sortable.order?"descending":"ascending";this.addClass(n.children[t],a),this.orderCustom=!0,this.sortChange({prop:e,order:a})},sortChange:function(e){var t=e.prop,i=e.order;(this.orderCustom||this.listModeSearch)&&(this.sortable.prop=t,this.sortable.order=i,this.pagination.pageIndex=1,this.listModeSearch?this.searchFile(this.searchFileName):this.getFileList())},removeClass:function(e,t){var i=e.className;i.indexOf(t)>-1&&(e.className=i.replace(t,""))},addClass:function(e,t){if(e){e.className;e.className=e.className+" "+t}},getShowSumFileAndFolder:function(e){var t=0,i=0;e.forEach((function(e){e.isFolder?t+=1:i+=1}));var n="";t>0&&(n=t+"个文件夹");var a="";return i>0&&(a=i+"个文件"),n+" "+a},getShowSumSize:function(e){var t="";return t+=e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"K":e>=1048576&&e<1073741824?(e/1048576).toFixed(2)+"M":(e/1073741824).toFixed(2)+"G",t},selectAll:function(e){var t=this;this.isSelectAll=e,e?this.fileList.forEach((function(e){t.selectRowData.push(e)})):this.isIndeterminate=!1},handleSelectionChange:function(e){if(e.length>0){if(this.selectPin||(this.selectOrgin=e[0].index),this.selectPin)return;this.rowContextData=e[0]}this.$refs.fileListTable.tableSelectData=e,this.selectRowData=e,this.changeSelectedStyle(e)},changeSelectedStyle:function(e){if(!this.stopSortChange){var t=0;e.forEach((function(e){t+=e.size}));var i=this.tableHead[2],n=this.tableHead[4],a=this.tableHead[5],o=this.tableHead[6];if(e.length>0){var r=this.getShowSumFileAndFolder(e),s=this.getShowSumSize(t);i.label=r,i.sortable=!1,n.name="more",a.label=s,a.sortable=!1,o.label="",o.sortable=!1}else i.label="名称",i.sortable=!0,n.name="",a.label="大小",a.sortable=!0,o.label="修改日期",o.sortable=!0;this.selectRowData.length===this.fileList.length?this.allChecked=!0:this.allChecked=!1}},rowStyle:function(e){e.row,e.column;var t=e.rowIndex,i=e.columnIndex;if(this.$refs.fileListTable.tableSelectData.findIndex((function(e){return e.index===t}))>-1)return 0===i?{backgroundColor:"#e0f3fc !important",borderRadius:"3px 0 0 3px",borderLeft:"1px solid #409eff",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}:5===i?{backgroundColor:"#e0f3fc !important",borderRadius:"0 3px 3px 0",borderRight:"1px solid #409eff",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}:{backgroundColor:"#e0f3fc !important",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}},tableRowClassName:function(e){e.row,e.rowIndex},preliminaryRowData:function(e){e&&(this.rowContextData=e);var t=this.rowContextData.isFavorite;this.highlightFavorite(!!this.isCollectView||t,!1)},cellMouseEnter:function(e){1!==this.draging&&("moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex!==e.index&&this.$refs.contextShow.hideMenu(),-1!==this.editingIndex||this.$refs.contextShow.ctxVisible||this.selectRowData.length<=1&&(this.cellMouseIndex=e.index))},cellMouseLeave:function(e){if(1!==this.draging)return"moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex!==e.index?(this.$refs.contextShow.hideMenu(),void(this.$refs.contextShow.locals={})):void(this.$refs.contextShow.ctxVisible&&"moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex===e.index||(this.cellMouseIndex=-1))},dblclick:function(e){this.fileClick(e)},cellClick:function(e,t){if(this.selectFile)this.fileClick(e);else if(clearTimeout(this.Loop),-1===this.editingIndex){var i=t.index;if(2===i&&this.selectRowData.length<1&&e.index!==this.editingIndex&&(this.editingIndex=-1),this.isCmd)return this.pinSelect(null,e),void this.$refs.fileListTable.toggleRowSelection([{row:e}]);this.pinSelect(null,e)}},renameInputFocus:function(e,t){this.setInputFocus(),e.focus(),e.selectionStart=0,e.selectionEnd=e.value.length,t&&(e.selectionEnd-=t.length+1)},rowRename:function(e,t){var i=this;if(e=e.replace(/[\r\n]/g,""),e){if(/[\[\]\/\\"<>\?\*]/gi.test(e))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});var n=e.replace(/(.*\/)*([^.]+).*/gi,"$2"),a=e.replace(/.+\./,"");t.isFolder?this.rename(t,e):t.suffix!==a?this.$confirm("您确定要将扩展名“.".concat(t.suffix,"”更改为“.").concat(a,"”吗？"),"提示",{type:"warning",showClose:!1,closeOnClickModal:!1,confirmButtonText:"保持.".concat(t.suffix),cancelButtonText:"使用.".concat(a)}).then((function(){e=n+"."+t.suffix})).catch((function(){})).then((function(){i.rename(t,e)})):this.rename(t,e)}else this.editingIndex=-1},rename:function(e,t){var i=this;if(e.name!==t){this.renameLoading=!0;var n=this.fileList.findIndex((function(e){if(t===e.name)return e}));if(n>-1){var a="该文件已存在";return e.isFolder&&(a="该文件夹已存在"),this.$message({message:a,type:"warning"}),void(this.renameLoading=!1)}d["a"].rename({newFileName:encodeURI(t),username:this.$store.state.user.name,folder:this.$route.query.folder,id:e.id}).then((function(n){i.renameLoading=!1,e.name=t,e.suffix=t.replace(/.+\./,""),i.fileList[e.index]=e,i.editingIndex=-1})).then((function(){i.$refs.fileListTable.clearSelection(),i.setOnCreateFilename(t)})).catch((function(){i.renameLoading=!1,i.editingIndex=-1}))}else this.editingIndex=-1},setOnCreateFilename:function(e){this.$route.query.folder&&(this.onCreateFilename=e,this.getFileList(),this.clearOnCreateFilename())},moreOperation:function(e){this.menusIsMultiple=!0,this.menus=this.multipleMenus,this.showOperationMenus(e)},setMenus:function(e){if(this.menus=JSON.parse(JSON.stringify(this.singleMenus)),this.$route.query.folder)this.setMenusByPermission(e);else{if(e.suffix&&"md"===e.suffix&&this.menus.splice(2,0,{iconClass:"menu-edit1",label:"编辑",operation:"edit"}),e.isFolder&&e.mountFileId)for(var t=[6,5,4,3,1],i=0,n=t;i<n.length;i++){var a=n[i];this.menus.splice(a,1)}if(e.isFolder||this.menus.splice(-2,0,{iconClass:"duplicate",label:"创建副本",operation:"duplicate"}),e.isShare&&!e.shareBase||e.ossFolder){var o=this.menus.findIndex((function(e){return"share"===e.operation}));o>-1&&this.menus.splice(o,1)}e.isShare&&!e.isPrivacy&&this.menus.splice(-2,0,{iconClass:"menu-fuzhi",label:"复制下载链接",operation:"copyDownloadLink"})}this.preliminaryRowData(e)},setMenusByPermission:function(e){var t=["open","download"];this.menus=this.menus.filter((function(e){return t.includes(e.operation)})),e.operationPermissionList&&e.operationPermissionList.length>0&&(e.operationPermissionList.indexOf("PUT")>-1&&this.menus.splice(this.menus.length-1,0,{iconClass:"menu-rename",label:"重命名",operation:"rename"}),e.operationPermissionList.indexOf("UPLOAD")>-1&&!e.isFolder&&this.menus.splice(this.menus.length-1,0,{iconClass:"duplicate",label:"创建副本",operation:"duplicate"}),e.operationPermissionList.indexOf("DELETE")>-1&&this.menus.splice(this.menus.length,0,{iconClass:"menu-remove",label:"删除",operation:"remove"}))},moreClick:function(e,t){this.menusIsMultiple=!1,this.setMenus(e),this.showOperationMenus(t,{menuType:"moreClick",rowIndex:e.index})},rowContextmenu:function(e){if(!this.selectFile){this.$refs.fileListTable.tableSelectData.length>1&&this.$refs.fileListTable.tableSelectData.findIndex((function(t){return t.index===e.index}))>-1?(this.menusIsMultiple=!0,this.menus=this.multipleRightMenus,this.highlightFavorite(this.isCollectView,!1)):(this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.toggleRowSelection([{row:e}]),this.menusIsMultiple=!1,this.setMenus(e)),event.preventDefault(),this.menuTriangle="";var t={};t.pageX=event.pageX+5,t.pageY=event.pageY+2,t.clientX=event.clientX+5,t.clientY=event.clientY+2,this.$refs.contextShow.showMenu(t),this.cellMouseIndex=-1}},showOperationMenus:function(e,t){var i=e.pageY;e.target.clientHeight>0&&(i+=e.target.clientHeight/2-e.offsetY);var n={};document.body.scrollHeight-i>400?(this.menuTriangle="menu-triangle-top",n.pageX=e.pageX-78,n.pageY=i+25):(this.menuTriangle="menu-triangle-bottom",n.pageX=e.pageX-78,n.pageY=i-38*this.menus.length-36),this.isJustHideMenus||this.$refs.contextShow.showMenu(n,t)},menuFavoriteOver:function(e,t){this.highlightFavorite(!!this.isCollectView||t,!1)},menuFavoriteLeave:function(e,t){this.highlightFavorite(!!this.isCollectView||t,!1)},highlightFavorite:function(e,t){var i=this.menus.find((function(e){if("favorite"===e.operation||"unFavorite"===e.operation)return e}));i&&(e?(i.label="取消收藏",i.iconClass="menu-unfavorite-hover",i.operation="unFavorite"):(i.iconClass=t?"menu-favorite-hover":"menu-favorite",i.label="收藏",i.operation="favorite"))},show:function(){var e=this;this.contextmenuDisabled=!0,setTimeout((function(){e.contextmenuDisabled=!1}),1e3)},hide:function(){var e=this;this.isJustHideMenus=!0,setTimeout((function(){e.isJustHideMenus=!1}),100),this.cellMouseIndex=-1},contextmenuClick:function(e){switch(e){case"vmode-list":this.grid=!0,this.changeVmode();break;case"vmode-grid":this.grid=!1,this.changeVmode();break;case"orderName":this.sortChangeOfMenu("name",2);break;case"orderSize":this.sortChangeOfMenu("size",5);break;case"orderUpdateDate":this.sortChangeOfMenu("updateDate",6);break;case"refresh":this.getFileList();break;case"createTextFile":this.newCreateFileDialogTitle="新建文本文件",this.createNewFile("txt");break;case"createFolder":this.newCreateFileDialogTitle="新建文件夹",this.createNewFile("");break;case"createDrawioFile":this.newCreateFileDialogTitle="新建流程图",this.createNewFile("drawio");break;case"createMinderFile":this.newCreateFileDialogTitle="新建思维导图",this.createNewFile("mind");break;case"createWordFile":this.newCreateFileDialogTitle="新建Word文档",this.createNewFile("docx");break;case"createExcelFile":this.newCreateFileDialogTitle="新建Excel工作表",this.createNewFile("xlsx");break;case"createPPTFile":this.newCreateFileDialogTitle="新建PPT演示文档",this.createNewFile("pptx");break;case"createMarkdownFile":this.newDocument();break}},createNewFile:function(e){var t=this;"新建文件夹"===this.newCreateFileDialogTitle?this.newCreateFileName="新建文件夹":this.newCreateFileName="未命名文件.".concat(e),this.newCreateFileName=this.getNewFileName(this.fileList,this.newCreateFileName),this.newCreateFileDialog=!0,this.$nextTick((function(){var i=t.$refs.newCreateFileName.$el.querySelector(".el-input__inner");t.renameInputFocus(i,e)}))},menusOperations:function(e){switch(e){case"share":this.share();break;case"tag":this.allocateTag();break;case"favorite":this.favoriteOperating(!0);break;case"edit":window.open("/setting/website/manager-articles?operation=editor&id=".concat(this.rowContextData.id),"_blank");break;case"open":this.fileClick(this.rowContextData);break;case"deselect":this.$refs.fileListTable.clearSelection();break;case"unFavorite":this.favoriteOperating(!1);break;case"details":this.drawer=!0;break;case"rename":this.renameFileName=this.rowContextData.name,this.editingIndex=this.rowContextData.index;break;case"duplicate":this.duplicate();break;case"copy":this.moveOrCopy();break;case"download":this.downloadFile();break;case"copyDownloadLink":this.copyDownloadLink(this.rowContextData);break;case"remove":this.deleteFile();break}this.$refs.contextShow.hideMenu()},clearTreeNode:function(){},directoryTreeLoadNode:function(e,t){var i=null;if(0===e.level){var n=this;return setTimeout((function(){n.$refs.directoryTree.setCurrentKey("0")}),0),t([{id:"0",name:"全部文件"}])}e.level>1&&(i=e.data.id),d["a"].queryFileTree({userId:this.$store.state.user.userId,username:this.$store.state.user.name,fileId:i}).then((function(e){var i=e.data;return t(i)}))},treeNodeClick:function(e,t,i){this.fileTreeAndNewFolderDisabled=e.hasOwnProperty("newFolder"),this.selectTreeNode=e,this.selectTreeNode.showName=' "'+e.name+'"'},treeNodeExpand:function(e,t,i){},fileTreeAndNewFolder:function(){var e="newFolderNodeKey",t=this.$refs.directoryTree.getNode(e);null!==t&&this.$refs.directoryTree.remove(t);var i=this.$refs.directoryTree.store.currentNode.childNodes,n=this.getNewFileName(i,"新建文件夹"),a={id:e,newFolder:!0,name:n,showName:n,isLeaf:!0};this.$refs.directoryTree.append(a,this.selectTreeNode),setTimeout((function(){var e=document.getElementById("treeInput");e&&(e.value=n,e.focus(),e.select())}),100)},moveFileTree:function(){this.copyOrMove("move")},copyFileTree:function(){this.copyOrMove("copy")},confirmUnzip:function(){this.unzip(this.openingFile,this.selectTreeNode.id,!1)},showDialogMoveOrCopyVisible:function(){this.dialogMoveOrCopyVisible=!0},duplicate:function(){var e=this,t=this.getDuplicateFileName(this.fileList,this.rowContextData.name);d["a"].duplicateFile({fileId:this.rowContextData.id,newFilename:t}).then((function(){e.$message.success("创建副本成功"),e.setOnCreateFilename(t)}))},moveOrCopy:function(){this.showDialogMoveOrCopyVisible(),this.titlePrefix="移动或复制到: ",this.unzipOperating=!1;var e=this;setTimeout((function(){e.selectTreeNode=e.$refs.directoryTree.getCurrentNode(),e.selectTreeNode.showName=' "'+e.selectTreeNode.name+'"'}),100)},copyOrMove:function(e){var t=this,i="复制";"move"===e&&(i="移动");var n="/";this.selectTreeNode.path&&(n=this.selectTreeNode.path+this.selectTreeNode.name+"/");var a=[];if(this.menusIsMultiple||this.selectRowData.length>1){var o=this.$refs.fileListTable.tableSelectData.some((function(e){a.push(e.id);var o=e.path;if(o===n)return t.$message({message:"不能将文件"+i+"到自身或其子目录下",type:"warning"}),!0}));if(o)return}else this.rowContextData.id?a.push(this.rowContextData.id):a.push(this.rowContextData[0].id);this.copyOrMoveApi(e,a,this.selectTreeNode.id)},copyOrMoveApi:function(e,t,i){var n=this,a="复制";"move"===e&&(a="移动");var o=this.$message({iconClass:"el-icon-loading",type:"info",duration:0,dangerouslyUseHTMLString:!0,message:a+"中..."});this.dialogMoveOrCopyVisible=!1,d["a"][e]({userId:this.$store.state.user.userId,username:this.$store.state.user.name,froms:t,to:i}).then((function(){o.iconClass=null,o.type="success",o.message=a+"中...",n.rowContextData.isFolder&&n.$refs.directoryTree.append(n.rowContextData,i),"move"===e&&n.getFileList(),setTimeout((function(){o.close()}),1e3)})).catch((function(){o.close()}))},renderContent:function(e,t){var i=this,n=t.node,a=t.data;t.store;return a.newFolder?e("span",{class:"custom-tree-node"},[e("span",[e("svg-icon",{attrs:{"icon-class":"folder"}})]),e("span",[e("div",{class:"el-input el-input--mini el-input-tree"},[e("input",{attrs:{type:"text",autocomplete:"on",value:"新建文件夹",id:"treeInput"},class:"el-input__inner"})]),e("button",{attrs:{type:"button","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(){var e="/",t=n.parent.data;t.path&&(e=t.path+t.name+e);var o=document.getElementById("treeInput").value;d["a"].newFolder({isFolder:!0,filename:encodeURI(o),currentDirectory:i.getQueryPath(),folder:i.$route.query.folder,username:i.$store.state.user.name,userId:i.$store.state.user.userId}).then((function(e){a.newFolder=!1,a.name=o,a.id=e.data})).catch((function(){window.event.preventDefault(),window.event.stopPropagation()}))}},class:"el-button el-icon-check el-button--mini el-input-tree-button"}),e("button",{attrs:{type:"button","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(){i.$refs.directoryTree.remove(n),window.event.preventDefault(),window.event.stopPropagation()}},class:"el-button el-icon-close el-button--mini el-input-tree-button"})])]):n.expanded?e("span",{class:"custom-tree-node"},[e("svg-icon",{attrs:{"icon-class":"open-folder"}}),e("span",{style:"margin-left: 5px;"},[n.label]),e("span")]):e("span",{class:"custom-tree-node"},[e("svg-icon",{attrs:{"icon-class":"folder"}}),e("span",{style:"margin-left: 5px;"},[n.label]),e("span")])},allocateTag:function(){this.tagDialogObjectList=JSON.parse(JSON.stringify(this.$refs.fileListTable.tableSelectData)),this.tagDialogVisible=!0},allocateTagSuccess:function(){this.getFileList()},share:function(e){e&&e.id||(e=this.rowContextData.id?this.rowContextData:this.$refs.fileListTable.tableSelectData[0]),this.shareDialogObject=e,this.shareDialogObject.fileId=e.id,this.shareDialogObject.shareBase=e.shareBase,this.shareDialogVisible=!0},shareSuccess:function(e){var t=this.rowContextData.isFavorite;this.rowContextData.isFavorite=!t,this.rowContextData.isFavorite=t,this.rowContextData.shareBase=e,this.rowContextData.isShare=!0},downloadFile:function(){var e=0;if(this.$refs.fileListTable.tableSelectData.length>0?this.$refs.fileListTable.tableSelectData.forEach((function(t){e+=t.size})):e+=this.rowContextData.size,e>0){var t=[];if(this.$refs.fileListTable.tableSelectData.length>0?this.$refs.fileListTable.tableSelectData.forEach((function(e){t.push(e.id)})):t.push(this.rowContextData.id),t.length>1||this.rowContextData.isFolder)return void x["a"].packageDownload(t,this.$store.state.user.token,this.$store.state.user.name);x["a"].download(this.$store.state.user.name,this.rowContextData,this.$store.getters.token)}else this.$message({message:"所选文件为空",type:"warning"})},copyDownloadLink:function(e){var t=this,i=window.location.origin+x["a"].previewUrl(this.$store.getters.name,e,void 0,void 0),n=new D.a(".newFileMenu",{text:function(){return i}});n.on("success",(function(e){t.$message({message:"复制成功",type:"success",duration:1e3}),n.destroy()})),n.on("error",(function(e){t.$message({message:"该浏览器不支持自动复制",type:"warning",duration:1e3}),n.destroy()}))},favoriteOperating:function(e){var t=this,i=this.getSelectIdList();this.rowContextData.isFavorite=e,this.highlightFavorite(e,!0),d["a"].favoriteUrl({fileIds:i,isFavorite:e}).then((function(i){!e&&t.isCollectView&&t.removeSelectItme()})).catch((function(){t.rowContextData.isFavorite=!e}))},deleteFile:function(){var e=this,t=[],i=[];this.menusIsMultiple||this.selectRowData.length>1?(t=this.$refs.fileListTable.tableSelectData,this.$refs.fileListTable.tableSelectData.forEach((function(e){i.push(e.id)}))):i.push(this.rowContextData.id);var n=this.getShowSumFileAndFolder(t);this.$confirm("此操作将永久删除"+n+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d["a"].delete({currentDirectory:e.getQueryPath(),username:e.$store.state.user.name,fileIds:i}).then((function(){e.$route.query.folder&&e.getFileList()})).then((function(){e.$notify({title:"删除成功",type:"success",duration:1e3})}))}))},getSelectIdList:function(){var e=[];return this.selectRowData.length>1||this.menusIsMultiple?this.$refs.fileListTable.tableSelectData.forEach((function(t){e.push(t.id)})):e.push(this.rowContextData.id),e},removeSelectItme:function(){var e=this,t=[];this.$refs.fileListTable.tableSelectData.length>0&&this.$refs.fileListTable.tableSelectData.forEach((function(i){var n=e.fileList.findIndex((function(e){return e.id===i.id}));n>-1&&t.push(n)})),this.$refs.fileListTable.doLayout(),this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.tableSelectData=[],t=t.sort((function(e,t){return t-e})),setTimeout((function(){for(var i=0;i<t.length;i++)e.fileList.splice(t[i],1);e.fileList.map((function(e,t){e.index=t})),e.rowDrop(),e.darwRectangle()}),300)},compressionFilePreview:function(e){this.unzip(e,void 0,!0)},unzipTo:function(e){this.showDialogMoveOrCopyVisible(),this.titlePrefix="解压到: ",this.unzipOperating=!0;var t=this;setTimeout((function(){t.openCompressionVisible=!1,t.selectTreeNode=t.$refs.directoryTree.getCurrentNode(),t.selectTreeNode.showName=' "'+t.selectTreeNode.name+'"'}),100)},unzip:function(e,t,i){var n=this,a="解压",o=this.$message({iconClass:"el-icon-loading",type:"info",duration:0,dangerouslyUseHTMLString:!0,message:"<span>&nbsp;&nbsp;正在"+a+"</span>"});d["a"].unzip({fileId:e.id,destFileId:t}).then((function(r){o.iconClass=null,o.type="success",o.message=a+"成功",i&&(n.compressedFileData=r.data,n.compressedFileVisible=!0,n.compressedFileName=e.name,n.compressedFileTempDir=i);var s=n;setTimeout((function(){o.close(),s.openCompressionVisible=!1,e.id===t&&s.getFileList(),t&&e.id!==t&&!i&&(s.dialogMoveOrCopyVisible=!1)}),1e3)})).catch((function(){o.close()}))},fileClick:function(e){if(this.editingIndex!==e.index)if(this.openingFile=e,e.isFolder){this.editingIndex=-1;var t=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";if(this.listModeSearch){var i={};i["folder"]=e.name,i["search"]=!0,i["row"]=e,this.pathList.push(i),this.pagination.pageIndex=1,this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e.id).concat(t)),this.searchFileAndOpenDir(e)}else{var n=this.$route.path.length>1;n&&1===this.basePath.length&&(this.basePath=e.path),this.path?this.path+="/"+e.name:this.path=this.basePath+e.name,this.path=this.path.replace(this.basePath,"/");var a={folder:e.name,shareBase:e.shareBase};this.pathList.push(a),this.pagination.pageIndex=1;var o=encodeURI(this.path);this.$store.getters.userId!==e.userId&&(e.mountFileId=e.id),e.mountFileId&&localStorage.setItem(this.path,e.mountFileId),this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(o).concat(e.mountFileId?"&folder="+e.mountFileId:"").concat(t).concat(this.basePath.length>1?"&basePath="+this.basePath:"")),this.openDir(e)}}else{if(this.selectFile){var r=e,s=this.$refs.fileListTable.tableSelectData;return s.length<1||s[0].id!==e.id?(this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.toggleRowSelection([{row:e}]),this.pinSelect(null,e)):(this.$refs.fileListTable.clearSelection(),r={}),void this.$emit("selectedFile",r)}if(c["c"].cadFile.includes(e.suffix.toUpperCase()))return this.cadPreviewRow=e,void(this.cadPreviewVisible=!0);if(e.contentType.startsWith("image"))return this.imagePreviewVisible=!0,void(this.imagePreviewRow=e);if(c["c"].simText.includes(e.suffix))return this.textPreviewRow=e,void(this.textPreviewVisible=!0);if(e.contentType.indexOf("video")>-1)return this.videoPreviewVisible=!0,void(this.videoPreviewRow=e);if(e.contentType.indexOf("audio")>-1)return void this.$store.dispatch("updateMessage",{event:"onAddAudio",data:{row:e,audioCoverUrl:this.audioCoverUrl}});if(c["c"].compressedFile.includes(e.suffix))return void(this.openCompressionVisible=!0);if(e.contentType.indexOf("office")>-1||["pdf","PDF","csv","drawio","mind"].includes(e.suffix))return this.officePreviewVisible=!0,void(this.officePreviewRow=e);if(e.contentType.indexOf("utf-8")>-1)return this.textPreviewRow=e,void(this.textPreviewVisible=!0);this.notPreviewDialogVisible=!0}},forciblyOpen:function(e){this.textPreviewRow=e,this.textPreviewVisible=!0;var t=this;setTimeout((function(){t.notPreviewDialogVisible=!1}),100)},determineDownload:function(e){this.download(e),this.notPreviewDialogVisible=!1},download:function(e){x["a"].download(this.$store.state.user.name,e,this.$store.getters.token)},closeHandle:function(){this.cadPreviewVisible=!1}}},I=F,M=(i("8281"),i("2877")),N=Object(M["a"])(I,n,a,!1,null,"e78cafe0",null);t["default"]=N.exports},c4a4:function(e,t,i){},c6b1:function(e,t,i){},c726:function(e,t,i){"use strict";i("6854")},cc5e:function(e,t,i){"use strict";var n=i("b775"),a=i("4328");t["a"]={roleList:function(e){return Object(n["a"])({url:"/role/list",method:"get",params:e})},add:function(e){return Object(n["a"])({url:"/role/add",method:"post",data:e})},update:function(e){return Object(n["a"])({url:"role/update",method:"put",data:e})},delete:function(e){return Object(n["a"])({url:"/role/delete",method:"delete",params:e,paramsSerializer:function(e){return a.stringify(e,{arrayFormat:"repeat"})}})}}},cda5:function(e,t,i){},ce82:function(e,t,i){},d263:function(e,t,i){"use strict";i("386b")("fixed",(function(e){return function(){return e(this,"tt","","")}}))},d540:function(e,t,i){},d693:function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("el-select",{ref:"treeSelect",attrs:{value:e.valueTitle,clearable:e.clearable,filterable:"",placeholder:e.placeholder,"filter-method":e.filterMethod},on:{clear:e.clearHandle}},[t("el-option",{staticClass:"options",attrs:{value:e.valueTitle,label:e.valueTitle}}),e._v(" "),t("el-tree",{ref:"selectTree",attrs:{id:"tree-option",accordion:e.accordion,data:e.options,props:e.props,"empty-text":"未找到结果","node-key":e.props.value,"highlight-current":"","default-expand-all":"","expand-on-click-node":!1,"default-expanded-keys":e.defaultExpandedKey,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1)},a=[],o=(i("7f7f"),i("ac6a"),{name:"TreeSelect",props:{props:{type:Object,default:function(){return{value:"id",label:"name",children:"children"}}},options:{type:Array,default:function(){return[]}},value:{type:String,default:""},clearable:{type:Boolean,default:function(){return!0}},accordion:{type:Boolean,default:function(){return!1}},placeholder:{type:String,default:function(){return"检索关键字"}}},data:function(){return{valueId:this.value,valueTitle:"",defaultExpandedKey:[]}},mounted:function(){this.initHandle()},methods:{initHandle:function(){var e=this;this.valueId?this.$nextTick((function(){e.$refs.selectTree.setCurrentKey(e.valueId);var t=e;setTimeout((function(){t.valueTitle=t.$refs.selectTree.getNode(t.valueId).data[t.props.label]}),100),e.defaultExpandedKey=[e.valueId]})):this.valueTitle=""},handleNodeClick:function(e){this.valueTitle=e[this.props.label],this.valueId=e[this.props.value],this.defaultExpandedKey=[],this.$refs.treeSelect.blur(),this.$emit("input",this.valueId)},clearHandle:function(){this.valueTitle="",this.valueId=null,this.defaultExpandedKey=[],this.clearSelected(),this.$emit("input","")},clearSelected:function(){var e=document.querySelectorAll("#tree-option .el-tree-node");e.forEach((function(e){return e.classList.remove("is-current")}))},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},filterMethod:function(e){this.$refs.selectTree.filter(e)}},watch:{value:function(){this.valueId=this.value,this.initHandle()}}}),r=o,s=(i("7cab"),i("2877")),l=Object(s["a"])(r,n,a,!1,null,"3cdaaf24",null);t["a"]=l.exports},d86c:function(e,t,i){},d879:function(e,t,i){"use strict";i("b89d")},d935:function(e,t,i){"use strict";i("dd9d")},d9c9:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{defaultGrid:!0,orderCustom:!0,contextMenus:e.contextMenus,sortable:e.sortable}})],1)},a=[],o=(i("6762"),i("2fdb"),i("7f7f"),function(){var e=this,t=e._self._c;return t("div",[t("div",{directives:[{name:"resize",rawName:"v-resize",value:e.containerResize,expression:"containerResize"}],staticClass:"dashboard-container",attrs:{onselectstart:"return false"}},[t("v-contextmenu",{ref:"homeContextmenu",attrs:{disabled:e.contextmenuDisabled}},e._l(e.contextMenus,(function(i){return t("div",{key:i.operation},[i.child?e._e():t("v-contextmenu-item",{attrs:{divider:!!i.divider},on:{click:function(t){return e.contextmenuClick(i.operation)}}},[i.iconClass?t("svg-icon",{attrs:{"icon-class":i.iconClass}}):e._e(),e._v("\n            "+e._s(i.label)+"\n          ")],1),e._v(" "),i.child?t("v-contextmenu-submenu",{attrs:{title:i.label}},e._l(i.child,(function(i){return t("div",{key:i.operation},[i.child?e._e():t("v-contextmenu-item",{attrs:{divider:!!i.divider},on:{click:function(t){return e.contextmenuClick(i.operation)}}},[i.iconClass?t("svg-icon",{attrs:{"icon-class":i.iconClass}}):e._e(),e._v("\n                "+e._s(i.label)+"\n              ")],1),e._v(" "),i.child?t("v-contextmenu-submenu",{attrs:{title:i.label}}):e._e()],1)})),0):e._e()],1)})),0),e._v(" "),t("el-breadcrumb",{staticClass:"app-breadcrumb",attrs:{separator:""}},[e.showNavigation?t("transition-group",{attrs:{name:"breadcrumb"}},e._l(e.pathList,(function(i,n){return t("el-breadcrumb-item",{key:i.folder+n},[0===n&&e.pathList.length>1?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"返回上一级",placement:"top"}},[t("a",{on:{click:function(t){return t.preventDefault(),e.lastLink()}}},[t("svg-icon",{staticStyle:{"font-size":"24px","margin-left":"20px"},attrs:{"icon-class":"back"}}),e._v(" ")],1)]):e._e(),e._v(" "),0===n&&e.pathList.length>2?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"根目录",placement:"top"}},[t("a",{staticClass:"home-link",on:{click:function(t){return t.preventDefault(),e.handleLink(i,n)}}},[t("svg-icon",{staticStyle:{"font-size":"24px"},attrs:{"icon-class":"home"}})],1)]):e._e(),e._v(" "),t("breadcrumb-file-path",{attrs:{pathList:e.pathList,item:i,index:n},on:{clickLink:e.handleLink}})],1)})),1):e._e(),e._v(" "),t("div",{staticClass:"search-content"},[t("div",{staticClass:"search-class"},[t("el-popover",{directives:[{name:"show",rawName:"v-show",value:e.showUploadButton,expression:"showUploadButton"}],attrs:{placement:"bottom",trigger:"hover"},on:{click:e.showNewFolderClick,"after-leave":e.hideNewFolderName},model:{value:e.isShowNewFolder,callback:function(t){e.isShowNewFolder=t},expression:"isShowNewFolder"}},[t("div",{staticClass:"newFileMenu",staticStyle:{display:"block"}},[t("ul",[t("li",{on:{click:e.upload}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":"file-upload"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(""!==e.singleFileType?e.singleFileType:"上传文件"))])],1)]),e._v(" "),""===e.singleFileType?t("li",{on:{click:e.uploadFolder}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":"folder-upload"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v("上传文件夹")])],1)]):e._e(),e._v(" "),""===e.singleFileType?t("li",{on:{click:function(t){return t.preventDefault(),e.newFolder.apply(null,arguments)}}},[t("a",{staticClass:"menuitem",attrs:{href:"#"}},[t("svg-icon",{attrs:{"icon-class":"folder-add"}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v("新建文件夹")])],1)]):e._e(),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showNewFolder,expression:"showNewFolder"}],staticClass:"folder-name-form"},[t("el-input",{ref:"newFolderName",attrs:{placeholder:"请输入文件夹名称",clearable:!0},on:{focus:e.setInputFocus,blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.newFolderNameClickEnter.apply(null,arguments)}},model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}},[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.newFolderLoading,expression:"newFolderLoading"}],staticClass:"el-icon-right",attrs:{slot:"append","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:e.newFolderNameClick},slot:"append"})],1)],1)])]),e._v(" "),t("button-upload",{staticStyle:{"margin-right":"5px"},attrs:{slot:"reference",name:""},nativeOn:{click:function(t){return e.upload.apply(null,arguments)}},slot:"reference"})],1),e._v(" "),t("el-input",{directives:[{name:"show",rawName:"v-show",value:e.showSearchButton,expression:"showSearchButton"}],attrs:{placeholder:"搜索",clearable:!0},on:{focus:e.setInputFocus,blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchFile(e.searchFileName)}},model:{value:e.searchFileName,callback:function(t){e.searchFileName=t},expression:"searchFileName"}},[t("el-button",{attrs:{slot:"prepend"},on:{click:function(t){return e.searchFile(e.searchFileName)}},slot:"prepend"},[t("svg-icon",{staticStyle:{"font-size":"22px"},attrs:{"icon-class":"search"}})],1)],1),e._v(" "),t("el-dropdown",{staticStyle:{height:"40px"},attrs:{size:"medium"},on:{command:e.contextmenuClick}},[t("el-button",{staticClass:"sort",attrs:{type:"text"}},[t("svg-icon",{attrs:{"icon-class":"sort"}})],1),e._v(" "),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"orderName"}},[t("span",{class:{"al-file-sort-item":!0,active:"name"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("名称")])])]),e._v(" "),t("el-dropdown-item",{attrs:{command:"orderSize"}},[t("span",{class:{"al-file-sort-item":!0,active:"size"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("大小")])])]),e._v(" "),t("el-dropdown-item",{attrs:{command:"orderUpdateDate"}},[t("span",{class:{"al-file-sort-item":!0,active:"updateDate"===e.sortable.prop}},[t("i",{class:{"al-file-sort-item-icon":!0,"el-icon-top":"ascending"===e.sortable.order,"el-icon-bottom":"descending"===e.sortable.order}}),e._v(" "),t("span",[e._v("日期")])])])],1)],1),e._v(" "),t("el-button",{staticClass:"vmode",attrs:{type:"text"},on:{click:e.changeVmode}},[t("svg-icon",{attrs:{"icon-class":e.grid?"list":"grid"}})],1)],1)])],1),e._v(" "),t("div",[t("div",{staticClass:"info-statistics"},[e.tableLoading?t("span",[e._v("获取更多数据...")]):e._e(),e._v(" "),e.tableLoading?e._e():t("span",[e._v(e._s(e.finished?"已全部加载 "+e.getSummaries3:"已加载 "+e.getSummaries3))])])]),e._v(" "),t("e-vue-contextmenu",{ref:"contextShow",staticClass:"newFileMenu",class:e.menuTriangle,on:{"ctx-show":e.show,"ctx-hide":e.hide}},[t("div",{staticClass:"popper-arrow"}),e._v(" "),e._l(e.menus,(function(i,n){return t("ul",{key:i.label},["unFavorite"===i.operation||"favorite"===i.operation?t("li",{staticClass:"menu-option",on:{click:function(t){return e.menusOperations(i.operation)},mouseover:function(t){return t.preventDefault(),t.stopPropagation(),e.menuFavoriteOver(n,e.rowContextData.isFavorite)},mouseleave:function(t){return t.preventDefault(),t.stopPropagation(),e.menuFavoriteLeave(n,e.rowContextData.isFavorite)}}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)]):t("li",{on:{click:function(t){return e.menusOperations(i.operation)}}},[t("label",{staticClass:"menuitem"},[t("svg-icon",{attrs:{"icon-class":i.iconClass}}),e._v(" "),t("span",{staticClass:"menuitem text"},[e._v(e._s(i.label))])],1)])])}))],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.fileList.length>0,expression:"fileList.length > 0"}],style:{width:"100%",height:e.clientHeight+"px"},attrs:{id:"v-draw-rectangle"}},[t("pl-table",{directives:[{name:"show",rawName:"v-show",value:!e.grid,expression:"!grid"},{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"fileListTable",staticStyle:{width:"100%",margin:"20px 0 0 0"},attrs:{"max-height":e.clientHeight,"default-sort":e.sortable,"highlight-current-row":!1,"empty-text":"无文件","use-virtual":!1,"row-height":51.5,border:!1,"excess-rows":10,"pagination-show":!1,stripe:"","cell-style":e.rowStyle,"height-change":!1,"row-class-name":e.tableRowClassName,"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{"selection-change":e.handleSelectionChange,"row-contextmenu":e.rowContextmenu,"cell-click":e.cellClick,"row-dblclick":e.dblclick,"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"sort-change":e.sortChange,"table-body-scroll":e.tableBodyScroll,select:e.pinSelect}},[e._l(e.tableHead,(function(i,n){return[1===n?t("pl-table-column",{key:n,attrs:{index:n,align:"center","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("icon-file",{attrs:{item:i.row,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})]}}],null,!0)}):e._e(),e._v(" "),2===n?t("pl-table-column",{key:n,attrs:{"show-overflow-tooltip":!0,"max-width":"200",index:n,prop:i.name,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom")},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.editingIndex?t("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{span:10,placeholder:"",size:"small"},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,i.row.suffix)},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.rowRename(e.renameFileName,i.row)}},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}}):t("div",{staticClass:"table-file-name"},[e._v("\n                  "+e._s(i.row.name)+"\n                  "),i.row.ossPlatform?t("el-tag",{staticClass:"pc list oss-folder",attrs:{size:"small"}},[e._v(e._s(i.row.ossPlatform)+"\n                  ")]):e._e()],1)]}}],null,!0)}):e._e(),e._v(" "),4===n&&e.showMoreItem?t("pl-table-column",{key:n,staticClass:"el-icon-more",attrs:{width:"50",prop:i.name,label:i.label,index:n,align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.index===e.cellMouseIndex?t("svg-icon",{staticClass:"button-class",attrs:{"icon-class":"more"},on:{click:function(t){return t.stopPropagation(),e.moreClick(i.row,t)}}}):e._e()]}}],null,!0)},[t("template",{slot:"header"},[""!==i.name?t("svg-icon",{staticClass:"button-class",attrs:{"icon-class":"more"},on:{click:function(t){return t.stopPropagation(),e.moreOperation(t)}}}):e._e()],1)],2):e._e(),e._v(" "),5===n&&e.showSizeItem?t("pl-table-column",{key:n,attrs:{width:"200",prop:i.name,index:n,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom"),"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(e.formatSize(i.row.size)))])]}}],null,!0)}):e._e(),e._v(" "),6===n&&e.showUpdateDateItem?t("pl-table-column",{key:n,attrs:{width:"250",prop:i.name,index:n,label:i.label,"sort-orders":["ascending","descending"],sortable:!!i.sortable&&(!e.orderCustom||"custom"),"show-overflow-tooltip":!0,align:"left","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:i.row.updateDate,placement:"top"}},[t("span",[e._v("   "+e._s(e.formatTime(i.row.agoTime)))])])]}}],null,!0)}):e._e()]}))],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.grid,expression:"grid"},{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"}},[t("van-checkbox-group",{ref:"checkboxGroup",on:{change:e.handleSelectionChange},model:{value:e.selectRowData,callback:function(t){e.selectRowData=t},expression:"selectRowData"}},[t("van-grid",{style:{width:"100%","max-height":e.clientHeight-25+"px",overflow:"auto","box-shadow":e.fileListScrollTop>0?"#a5a7a8 0px 0px 3px":"#ffffff 0px 0px 0px"},attrs:{square:"",center:!0,"column-num":e.gridColumnNum,gutter:10,border:!1}},e._l(e.fileList,(function(i,n){return t("van-grid-item",{key:i.id,ref:"gridItem",refInFor:!0,attrs:{title:"大小："+e.formatSize(i.size)+"\r\n"+(i.w&&i.h?"分辨率："+i.w+"x"+i.h+"\r\n":"")+"名称："+i.name+"\r\n创建时间："+i.uploadDate+"\r\n修改时间："+i.updateDate+"\r\n路径："+i.path}},[t("div",{staticClass:"grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square",style:{background:e.selectRowData.includes(i)?"#caeaf991":"","background-size":"cover","background-position":"center",border:e.selectRowData.includes(i)?"solid 1px #409eff":""},on:{click:function(t){return e.gridItemClick(i)},dblclick:function(t){return e.fileClick(i)},contextmenu:function(t){return t.preventDefault(),e.rowContextmenu(i)}}},[t("div",{staticClass:"grid-hover-back grid-hover van-grid-item__content van-grid-item__content--center van-grid-item__content--square"},[t("div",{staticClass:"grid-item-icon"},[t("icon-file",{attrs:{item:i,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl,grid:!0,"grid-width":e.gridColumnWidth}})],1),e._v(" "),i.index===e.editingIndex?t("el-input",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"grid-item-text",attrs:{placeholder:"",type:"textarea",autosize:"",size:"small"},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,i.suffix)},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.rowRename(e.renameFileName,i))}},model:{value:e.renameFileName,callback:function(t){e.renameFileName=t},expression:"renameFileName"}}):t("div",[t("div",{staticClass:"grid-item-text"},[t("span",[e._v(e._s(e.gridFilename(i)))])])])],1)])])})),1)],1)],1),e._v(" "),t("table",{staticClass:"drag-table",attrs:{id:"drag-table"}})],1),e._v(" "),e.fileList.length<1&&!e.tableLoading?t("empty-file",{attrs:{emptyStatus:e.emptyStatus}}):e._e(),e._v(" "),t("img",{staticStyle:{position:"fixed",opacity:"0"},attrs:{id:"dragImage",draggable:"false",src:i("5116")}}),e._v(" "),e.selectFile?e._e():t("div",{staticClass:"number-files",attrs:{id:"numberFiles"}},[t("img",{staticClass:"icon",staticStyle:{display:"none"},attrs:{src:i("943c")}}),e._v(" "),t("div",{staticClass:"number",staticStyle:{display:"inline"}},[e._v("1个文件")]),e._v(" "),t("div",{staticClass:"operate",staticStyle:{display:"none","white-space":"nowrap"}},[e._v("\n          移动到：\n        ")]),e._v(" "),e._m(0)])],1),e._v(" "),t("sim-text-preview",{attrs:{file:e.textPreviewRow,status:e.textPreviewVisible,"is-together":e.isTogether},on:{"update:file":function(t){e.textPreviewRow=t},"update:status":function(t){e.textPreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}}),e._v(" "),t("image-viewer",{attrs:{fileList:e.fileList,file:e.imagePreviewRow,status:e.imagePreviewVisible},on:{"update:status":function(t){e.imagePreviewVisible=t}}}),e._v(" "),t("video-preview",{attrs:{file:e.videoPreviewRow,status:e.videoPreviewVisible},on:{"update:status":function(t){e.videoPreviewVisible=t}}}),e._v(" "),t("office-preview",{attrs:{file:e.officePreviewRow,status:e.officePreviewVisible,"is-together":e.isTogether},on:{"update:status":function(t){e.officePreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}}),e._v(" "),e.cadPreviewVisible?t("cad-preview",{attrs:{status:e.cadPreviewVisible,file:e.cadPreviewRow,"is-together":e.isTogether,"space-flag":e.spaceFlag},on:{"update:status":function(t){e.cadPreviewVisible=t},"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t},closeDialog:e.closeHandle}}):e._e(),e._v(" "),t("el-drawer",{attrs:{title:e.rowContextData.name,visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[t("div",{staticClass:"drawer-icon"},[t("icon-file",{staticClass:"drawer-icon-font",attrs:{grid:!0,details:!0,item:e.rowContextData,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})],1),e._v(" "),t("el-form",{staticClass:"details-form"},[t("el-form-item",{attrs:{label:"名称:"}},[t("span",[e._v(e._s(e.rowContextData.name))])]),e._v(" "),t("el-form-item",{staticClass:"details-name",attrs:{label:"类型:"}},[t("span",[e._v(e._s(e.rowContextData.isFolder?"文件夹":e.rowContextData.contentType))])]),e._v(" "),e.rowContextData.music?t("div",[t("el-form-item",{attrs:{label:"🎵 歌手:"}},[t("span",[e._v(e._s(e.rowContextData.music.singer))])]),e._v(" "),t("el-form-item",{attrs:{label:"🎵 专辑:"}},[t("span",[e._v(e._s("《"+e.rowContextData.music.album+"》"))])]),e._v(" "),t("el-form-item",{attrs:{label:"🎵 歌名:"}},[t("span",[e._v(e._s("《"+e.rowContextData.music.songName+"》"))])])],1):e._e(),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.rowContextData.w&&e.rowContextData.h,expression:"rowContextData.w && rowContextData.h"}],staticClass:"details-resolution",attrs:{label:"分辨率:"}},[t("span",[e._v(e._s(e.rowContextData.w+" x "+e.rowContextData.h))])]),e._v(" "),t("el-form-item",{attrs:{label:"大小:"}},[t("span",[e._v("\n            "+e._s(e.rowContextData.size)+"字节\n            "+e._s(e.rowContextData.size>0?"("+e.formatSize(e.rowContextData.size)+")":""))])]),e._v(" "),t("el-form-item",{staticClass:"details-position",attrs:{label:"位置:"}},[t("a",{attrs:{href:"/?path="+e.rowContextData.path+"&highlight="+e.rowContextData.name}},[e._v(e._s(e.rowContextData.path))])]),e._v(" "),t("el-form-item",{attrs:{label:"创建时间:"}},[t("span",[e._v(e._s(e.rowContextData.uploadDate))])]),e._v(" "),t("el-form-item",{attrs:{label:"修改时间:"}},[t("span",[e._v(e._s(e.rowContextData.updateDate))])])],1)],1),e._v(" "),t("el-dialog",{staticClass:"open-file-dialog",attrs:{title:"提示",top:"35vh",visible:e.openCompressionVisible},on:{"update:visible":function(t){e.openCompressionVisible=t}}},[t("svg-icon",{attrs:{"icon-class":"open-folder"}}),e._v(" "),t("span",{staticClass:"dialog-msg"},[e._v("查看压缩文件")]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.unzipTo(e.openingFile)}}},[e._v("解压到...")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.unzip(e.openingFile,e.openingFile.id,!1)}}},[e._v("解压到当前目录")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.compressionFilePreview(e.openingFile)}}},[e._v("预览")])],1)],1),e._v(" "),t("message-dialog",{attrs:{title:"提示",content:"此文件不支持预览, 是否下载该文件?",show:e.notPreviewDialogVisible,"button-size":"mini",operatButtonText:"取消",confirmButtonText:"下载"},on:{"update:show":function(t){e.notPreviewDialogVisible=t},operating:function(t){e.notPreviewDialogVisible=!1},confirm:function(t){return e.determineDownload(e.openingFile)}}}),e._v(" "),t("el-dialog",{attrs:{title:"预览:"+e.compressedFileName,visible:e.compressedFileVisible},on:{"update:visible":function(t){e.compressedFileVisible=t}}},[t("file-tree",{attrs:{directoryTreeData:e.compressedFileData,tempDir:e.compressedFileTempDir,"is-together":e.isTogether},on:{"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}})],1),e._v(" "),t("el-dialog",{attrs:{title:e.titlePrefix+e.selectTreeNode.showName,visible:e.dialogMoveOrCopyVisible},on:{"update:visible":function(t){e.dialogMoveOrCopyVisible=t},close:e.clearTreeNode}},[e.dialogMoveOrCopyVisible?t("el-tree",{ref:"directoryTree",attrs:{data:e.directoryTreeData,"node-key":"id",props:e.directoryTreeProps,load:e.directoryTreeLoadNode,"highlight-current":!0,"default-expanded-keys":["0"],"render-content":e.renderContent,hight:"100",lazy:""},on:{"node-click":e.treeNodeClick,"node-expand":e.treeNodeExpand}}):e._e(),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",disabled:e.fileTreeAndNewFolderDisabled},on:{click:e.fileTreeAndNewFolder}},[t("i",{staticClass:"el-icon-folder-add"}),e._v("  新建文件夹\n        ")]),e._v(" "),e.unzipOperating?e._e():t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.moveFileTree}},[e._v("移 动")]),e._v(" "),e.unzipOperating?e._e():t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.copyFileTree}},[e._v("复制")]),e._v(" "),e.unzipOperating?t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmUnzip}},[e._v("解压")]):e._e(),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogMoveOrCopyVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),t("tag-dialog",{attrs:{fileList:e.tagDialogObjectList,status:e.tagDialogVisible,api:e.api},on:{"update:status":function(t){e.tagDialogVisible=t},onSuccess:e.allocateTagSuccess}}),e._v(" "),t("share-dialog",{attrs:{file:e.shareDialogObject,status:e.shareDialogVisible},on:{"update:file":function(t){e.shareDialogObject=t},"update:status":function(t){e.shareDialogVisible=t},onSuccess:e.shareSuccess}}),e._v(" "),t("el-dialog",{staticClass:"new-text-file-dialog",attrs:{title:e.newCreateFileDialogTitle,"close-on-click-modal":!1,visible:e.newCreateFileDialog},on:{"update:visible":function(t){e.newCreateFileDialog=t}}},[t("el-input",{ref:"newCreateFileName",staticClass:"dialog-msg",attrs:{size:"small",clearable:!0},on:{focus:function(t){return e.renameInputFocus(t.currentTarget,"")},blur:function(t){return e.setInputBlur()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createFile(e.newCreateFileName)}},model:{value:e.newCreateFileName,callback:function(t){e.newCreateFileName=t},expression:"newCreateFileName"}}),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.newCreateFileDialog=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.createFileLoading,expression:"createFileLoading"}],attrs:{size:"small",type:"primary"},on:{click:function(t){return e.createFile(e.newCreateFileName)}}},[e._v("确定")])],1)],1)],1)}),r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"target"},[t("span",{staticClass:"folder",staticStyle:{display:"none","white-space":"nowrap"}},[e._v("document")])])}],s=(i("55dd"),i("386d"),i("7514"),i("a481"),i("f559"),i("20d6"),i("ac6a"),i("5df3"),i("1c4c"),i("28a5"),i("6f8e")),l=(i("c5f6"),i("2f62")),c=i("7f29"),d=i("26a1"),u=i("1000"),h=(i("9dce"),i("5580")),p=i("573f"),f=i("0dcf"),m=i("71e9"),g=i("2d53"),v=i("1638"),b=i("ae1f"),w=i("140f"),y=i("3293"),x=i("5a87"),C=i("9476"),k=(i("3b6a"),i("2690")),_=i("4308"),S=i("fd35"),L=i("fdd2"),T=i("dc5e"),D=i("c24f"),E=i("b311"),F=i.n(E),I=i("0dca"),M={name:"ShowFile",components:{TagDialog:I["a"],ShareDialog:T["a"],OfficePreview:S["a"],CadPreview:L["a"],EditElement:_["default"],MessageDialog:x["a"],AudioPreview:w["a"],VideoPreview:b["a"],ImageViewer:v["a"],SimTextPreview:g["a"],IconFile:f["a"],BreadcrumbFilePath:p["a"],EmptyFile:m["a"],ButtonUpload:y["a"],FileTree:C["a"]},props:{selectFile:{type:Boolean,defalut:!1},lessClientHeight:{type:Number,default:106},showUploadButton:{type:Boolean,default:!0},showSearchButton:{type:Boolean,default:!0},showShareItem:{type:Boolean,default:!0},showMoreItem:{type:Boolean,default:!0},isCollectView:{type:Boolean,default:!1},emptyStatus:{type:String,default:"空空如也~"},singleFileType:{type:String,default:""},showNavigation:{type:Boolean,default:!0},queryFileType:{type:String,default:null},defaultGrid:{type:Boolean,default:!0},orderCustom:{type:Boolean,default:!1},sortable:{type:Object,default:function(){return{prop:"",order:null}}},queryCondition:{type:Object,default:function(){return{isFolder:null}}},singleMenus:{type:Array,default:function(){return[{iconClass:"menu-open",label:"打开",operation:"open"},{iconClass:"menu-details",label:"详细信息",operation:"details"},{iconClass:"menu-rename",label:"重命名",operation:"rename"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},multipleMenus:{type:Array,default:function(){return[{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},multipleRightMenus:{type:Array,default:function(){return[{iconClass:"menu-deselect",label:"取消选定",operation:"deselect"},{iconClass:"menu-copy",label:"移动或复制",operation:"copy"},{iconClass:"menu-download",label:"下载",operation:"download"},{iconClass:"menu-remove",label:"删除",operation:"remove"}]}},contextMenus:{type:Array,default:function(){return[]}}},data:function(){return{imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),audioCoverUrl:"".concat("/api","/view/cover?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),fileMenuActive:"",path:this.$route.query.path,basePath:"/",showNewFolder:!1,isShowNewFolder:!1,listModeSearch:!1,listModeSearchOpenDir:!1,newFolderName:"新建文件夹",renameFileName:"",searchFileName:"",pathList:[{folder:""}],fileList:[],pageLoadCompleteList:[],pagination:{pageIndex:1,pageSize:50,total:0,pageSizes:[10,20,30,40,50]},isIndeterminate:!1,isSelectAll:!1,clientHeight:500,tableHead:[{name:"",label:"",index:0},{name:"",label:"",index:1},{name:"name",label:"名称",sortable:!0,index:2},{name:"",label:"",index:3},{name:"",label:"",more:!0,index:4},{name:"size",label:"大小",sortable:!0,index:5},{name:"updateDate",label:"修改日期",sortable:!0,index:6}],isJustHideMenus:!1,menusIsMultiple:!1,menus:[],contextmenuDisabled:!1,rowContextData:{},tableLoading:!0,finished:!1,newFolderLoading:!1,renameLoading:!1,menuTriangle:"",cellMouseIndex:-1,editingIndex:-1,titlePrefix:"",unzipOperating:!1,dialogMoveOrCopyVisible:!1,fileTreeAndNewFolderDisabled:!1,directoryTreeData:[],compressedFileVisible:!1,compressedFileData:[],compressedFileName:"",compressedFileTempDir:!1,selectTreeNode:{},directoryTreeProps:{label:"name",children:"children",isLeaf:"isLeaf"},dragLoop:null,positionX:0,positionY:0,grid:this.defaultGrid,vmode:this.defaultGrid?"grid":"list",gridColumnNum:-1,gridColumnWidth:120,allChecked:!1,summaries:"",shareDialogVisible:!1,shareDialogObject:{},tagDialogVisible:!1,tagDialogObjectList:[],newCreateFileDialog:!1,newCreateFileName:"",newCreateFileDialogTitle:"",createFileLoading:!1,shareLink:"",shareFileName:"",textPreviewVisible:!1,textPreviewRow:{},imagePreviewRow:{},imagePreviewVisible:!1,videoPreviewRow:{},videoPreviewVisible:!1,officePreviewRow:{},officePreviewVisible:!1,cadPreviewRow:{},cadPreviewVisible:!1,audioPreviewRow:{},audioPreviewVisible:!1,drawer:!1,rowStyleExecuting:!1,selectRowData:[],selectOrgin:-1,selectEnd:-1,selectPin:!1,inputting:!1,isCmd:!1,dragElementList:[],drawFlag:!1,fileListScrollTop:0,initFileListScrollTop:0,notPreviewDialogVisible:!1,openingFile:"",openCompressionVisible:!1,stompClient:void 0,showUpdateDateItem:!0,showSizeItem:!0,stopSortChange:!1,draging:0,getFileListed:!1,onCreateFilename:"",isTogether:!0,api:h["a"]}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["c"])(["message"])),Object(l["b"])(["name"])),{},{gridFilename:function(){return function(e){var t=e.name;if(e.isFolder)return t;var i=t.split("."),n=i.length>1?i.pop():"",a=i.join("."),o=this.getEffectiveLength(a,n);if(o<=14)return t;for(var r=14-(n?n.length+1+1:0),s="",l=0,c=0,d=Array.from(a);c<d.length;c++){var u=d[c],h=this.getCharLength(u);if(l+h>r)break;l+=h,s+=u}return n?s+"…"+n:s+"…"}},getSummaries2:function(){var e=0;this.fileList.forEach((function(t){e+=t.size}));var t=this.getShowSumFileAndFolder(this.fileList),i=this.getShowSumSize(e);return this.summaries=t+i,e>0?t+i:""},getSummaries3:function(){var e=0;return this.fileList.forEach((function(t){e+=t.size})),e>0?this.fileList.length+"项 "+this.getShowSumSize(e):""}}),created:function(){},watch:{$route:function(e){e.query.tagId&&this.queryCondition.tagId!==this.$route.query.tagId&&(this.queryCondition.tagId=this.$route.query.tagId,this.getFileList())},message:function(e){switch(e.event){case"msg/file/operation/fault":this.getFileList();break;case"fileSuccess":this.setOnCreateFilename(e.data);break;case"loadFileFailed":this.notPreviewDialogVisible=!0;break;case"clickMore":this.$refs.fileListTable.tableSelectData=e.data,this.preliminaryRowData();break;case"renameRow":var t=this.fileList.findIndex((function(t){return t.name===e.data.oldName}));if(t>-1){var i=this.fileList[t];i.suffix=e.data.suffix,i.name=e.data.name,this.$refs.fileListTable.clearSelection()}break;case"msg/file/change":this.onmessage(e.data);break}}},mounted:function(){var e=this;if(window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1)),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.$route.query.vmode?this.vmode=this.$route.query.vmode:this.defaultGrid?this.vmode="grid":this.vmode="list","list"===this.vmode?(this.grid=!1,this.selectFile||(this.lessClientHeight=140)):(this.grid=!0,this.selectFile||(this.lessClientHeight=106),this.containerResize()),"/"!==this.$route.query.path){var t=decodeURI(this.$route.query.path);this.pathList.splice(1,1),t.split("/").forEach((function(t,i){if(i>0){var n={};n["folder"]=t,e.pathList.push(n)}}))}this.$route.query.folder&&this.path&&localStorage.setItem(this.path,this.$route.query.folder),this.$route.query.highlight&&(this.onCreateFilename=this.$route.query.highlight,this.clearOnCreateFilename());var i=this;window.onresize=function(){i.clientHeight=document.documentElement.clientHeight-i.lessClientHeight},setTimeout((function(){e.getFileListed||e.getFileList()}),50)},beforeDestroy:function(){window.removeEventListener("keydown",this.keydown,!1),window.removeEventListener("keyup",this.keyup,!1),window.removeEventListener("popstate",this.goBack,!1),this.stompClient&&this.stompClient.unsubscribe()},directives:{focus:{inserted:function(e){var t=e.querySelector("input");t||(t=e.querySelector("textarea")),t.focus()}},resize:{bind:function(e,t){var i="",n="";function a(){var a=document.defaultView.getComputedStyle(e);i===a.width&&n===a.height||t.value(),i=a.width,n=a.height}e.__vueSetInterval__=setInterval(a,300)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},methods:{isChineseChar:function(e){return e.charCodeAt(0)>255},getCharLength:function(e){return this.isChineseChar(e)?2:1},getEffectiveLength:function(e,t){var i=this,n=Array.from(e).reduce((function(e,t){return e+i.getCharLength(t)}),0);return t?n+t.length+1:n},keydown:function(e){var t=this,i=navigator.platform.startsWith("Mac"),n=(e.key,e.c,e.keyCode),a=e.ctrlKey,o=e.metaKey;this.isCmd=i&&o||!i&&a,16===e.keyCode&&e.shiftKey&&(this.selectPin=!0),this.isCmd&&65===n&&(this.inputting||-1!==this.editingIndex?e.target.select():(this.$nextTick((function(){t.$refs.fileListTable&&t.$refs.fileListTable.toggleAllSelection()})),e.preventDefault(),e.stopPropagation()))},keyup:function(e){var t=navigator.platform.startsWith("Mac"),i=(e.key,e.c,e.keyCode,e.ctrlKey),n=e.metaKey;this.isCmd=t&&n||!t&&i,16===e.keyCode&&(this.selectPin=!1)},onmessage:function(e){var t=e.body,i=e.url,n=this.fileList.findIndex((function(e){return e.id===t.id}));if("updateFile"===i&&n>-1&&(t.m3u8&&(this.fileList[n].m3u8=t.m3u8),this.fileList[n].size=t.size,this.fileList[n].agoTime=1,this.fileList[n].updateDate=t.updateDate),"deleteFile"===i&&n>-1&&this.getFileList(),"createFile"===i){if(t.$set&&(this.onCreateFilename=t.$set.name),t&&t.name&&(this.onCreateFilename=t.name),this.path||(this.path=""),t)if(t.$set){var a=t.$set.path;a=a.replace(/\\/g,"/"),this.path+"/"===a&&this.getFileList()}else this.path+"/"===t.path&&this.getFileList();this.clearOnCreateFilename()}},clearOnCreateFilename:function(){var e=this;setTimeout((function(){e.onCreateFilename=""}),2e3)},load:function(){this.getFileList(!0)},gridItemClick:function(e){if(this.selectFile&&this.fileClick(e),this.isCmd)return this.pinSelect(null,e),void this.$refs.fileListTable.toggleRowSelection([{row:e}]);this.pinSelect(null,e)},containerResize:function(){var e=document.querySelector(".dashboard-container"),t=e.clientWidth;this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,"image"===this.queryFileType?this.gridColumnNum=Math.round((t-10)/165):this.gridColumnNum=Math.round((t-10)/135),this.gridColumnWidth=(t-11*this.gridColumnNum)/this.gridColumnNum-4.5,this.showUpdateDateItem=!(t<900),this.showSizeItem=!(t<500);var i=Math.round(this.clientHeight/(t/this.gridColumnNum));this.pagination.pageSize=i*this.gridColumnNum+this.gridColumnNum,this.rowDrop(),this.darwRectangle()},darwRectangle:function(){var e=this,t=document.querySelector(".el-table__body-wrapper");if(this.grid&&(t=document.querySelector(".van-grid")),t.onscroll=function(t){e.tableBodyScroll(null,t)},!this.selectFile){var i=this,n=function(e){return document.getElementById(e)},a=n("v-draw-rectangle"),o="rectangle1",r=0,s=0,l=0,c=0,d=0,u=0;i.drawFlag=!1;var h="el-table__row";i.grid&&(h="grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square"),a.onmousedown=null,a.onmousedown=function(e){var t=window.event||e,n=e.path||e.composedPath&&e.composedPath();if(!i.grid&&i.selectRowData.length>0){var m=n.findIndex((function(e){if("el-table__header-wrapper"===e.className)return e}));m>-1&&(i.stopSortChange=!0)}var g=n.find((function(e){if(e.className===h||"el-table__row el-table__row--striped"===e.className)return e}));if(g)i.selectRowData.includes(i.fileList[g.rowIndex])||(i.editingIndex=-1,i.isCmd||i.selectPin||(i.$refs.fileListTable.clearSelection(),i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[g.rowIndex],selected:!0}])));else if(i.editingIndex=-1,0===t.button){if(!i.isCmd&&!i.selectPin){var v=n.findIndex((function(e){return e.className===h||"el-table__row el-table__row--striped"===e.className}));v<0&&i.$refs.fileListTable.clearSelection()}var b=a.scrollTop||a.scrollTop,w=a.scrollLeft||a.scrollLeft;r=t.clientX+w,s=t.clientY+b;var y=document.createElement("div");y.id=o,y.className="draw-rectangle",y.style.left=r+"px",y.style.top=s+"px",y.style.position="fixed",y.style.border="1px dashed #2898ff",y.style.width="0px",y.style.height="0px",y.style.left="0px",y.style.top="0px",y.style.overflow="hidden",a.appendChild(y),document.onmousemove=function(e){var t=window.event||e,n=document.body.scrollTop||document.documentElement.scrollTop,a=document.body.scrollLeft||document.documentElement.scrollLeft;if(l=r-t.clientX-a>0?t.clientX+a:r,c=s-t.clientY-n>0?t.clientY+n:s,d=Math.abs(s-t.clientY-n),u=Math.abs(r-t.clientX-a),i.drawFlag=!0,!(d+u<4)){var h=document.getElementById(o);h&&(h.style.left=l+"px",h.style.top=c+"px",h.style.width=u+"px",h.style.height=d+"px",h.style.backgroundColor="#f2f5fa55"),i.drawFlag&&d+u>4&&(p||f({x:l,y:c+i.fileListScrollTop,w:u,h:d}))}},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,i.stopSortChange&&(i.stopSortChange=!1,setTimeout((function(){i.changeSelectedStyle(i.selectRowData)}),200)),setTimeout((function(){i.drawFlag=!1}),50);var t=document.getElementById(o);t&&a.removeChild(t),i.grid||(a=document.getElementById("drag-table"));var n=Array.prototype.slice.call(a.getElementsByClassName("dragingDiv"));n.forEach((function(e){return a.removeChild(e)}))}}};var p=!1,f=function(e){p=!0,i.dragElementList.forEach((function(t){m(t,e)?i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[t.rowIndex],selected:!0}]):i.$refs.fileListTable.toggleRowSelection([{row:i.fileList[t.rowIndex],selected:!1}])})),setTimeout((function(){return p=!1}),10)},m=function(e,t){var i=e.x,n=e.y,a=t.x,o=t.y,r=e.w,s=e.h,l=t.w,c=t.h;return(i-a<=0&&a-i<r||i-a>=0&&i-a<l)&&(n-o<=0&&o-n<s||n-o>=0&&n-o<c)}}},rowDrop:function(){if(!this.selectFile){var e=null,t=this,i=null,n=-1,a="van-grid",o="van-grid-item van-grid-item--square",r="grid-item van-grid-item__content van-grid-item__content--center van-grid-item__content--square";t.grid||(o="el-table__row",a="el-table__body");var s=null,l=document.querySelector(".dashboard-container"),c=document.querySelector(".el-table__body-wrapper tbody");this.grid&&(c=document.querySelector(".van-checkbox-group .van-grid"));var u=document.getElementById("v-draw-rectangle");this.grid||(u=document.getElementById("drag-table"));var h=0,p=Object(d["a"])(u),f=0,m="";setTimeout((function(){h=c.childElementCount,t.dragElementList=[];for(var e=0;e<c.childElementCount;e++){var i=c.children[e];t.grid&&(i.rowIndex!==e&&(i.rowIndex=e),i.children[0].children[0].rowIndex=e,i=i.children[0].children[0]);var n=C(i);i.w=i.offsetWidth,i.h=i.offsetHeight,i.x=n.x,i.y=n.y,n.rowIndex=i.rowIndex,t.dragElementList.push(i),i.draggable=!0,i.slot="jmal";var a=i.querySelector(".el-avatar > img");t.grid&&(a=i.querySelector(".el-image > img")),a&&(a.draggable=!1)}}),300);var g=-1,v=function(e,i){var n=e.path||e.composedPath&&e.composedPath();if("enter"===i){var s=null;e.toElement.className;if(t.grid?(e.toElement.className===o&&(s=e.toElement),e.toElement.className===a&&(s=e.fromElement)):s="v-draw-rectangle"===n[0].id||"el-table__virtual-wrapper"===n[0].className?e.toElement:n.find((function(e){if("el-table__header-wrapper"===e.className)return e})),s){if(g>-1){var l=c.children[g];x(l)}g=-1}}var d=null;return t.grid?(n[0].className===r||(d=n.find((function(e){if(e.className===r)return e}))),d):("TD"===n[0].tagName&&(d=n.find((function(e){if("el-table__row el-table__row--striped"===e.className||"el-table__row"===e.className)return e}))),d)},b=function(e){e?(t.selectRowData.forEach((function(e){var i=document.getElementById("dragingDiv"+e.index);i.style.transition="all 0.3s",i.style.top=i.original.top-(t.fileListScrollTop-t.initFileListScrollTop)+"px",i.style.left=i.original.left})),setTimeout((function(){t.selectRowData.forEach((function(e){u.removeChild(document.getElementById("dragingDiv"+e.index))}))}),300)):t.selectRowData.forEach((function(e){u.removeChild(document.getElementById("dragingDiv"+e.index))})),setTimeout((function(){t.grid?c.querySelectorAll(".grid-hover-back").forEach((function(e){e.classList.add("grid-hover")})):document.getElementsByClassName("el-table")[0].classList.add("el-table--enable-row-hover")}),350),t.draging=0};l.ondragend=function(e){t.$store.dispatch("updateMessage",{event:"onDragStart",data:!1}),e.dataTransfer.effectAllowed="none";var n=c.children[g];x(n),i.style.cursor="default",e.target.parentNode.parentNode.title=m},l.ondragstart=function(a){if(t.drawFlag||t.isCmd||t.selectPin)return a.preventDefault(),void a.stopPropagation();if(!a.target.slot||"jmal"!==a.target.slot)return!0;if(a.target.rowIndex===t.editingIndex)return a.preventDefault(),void a.stopPropagation();a.target.style.cursor="no-drop",m=a.target.parentNode.parentNode.title,a.target.parentNode.parentNode.title="",t.selectRowData.forEach((function(e,i){var n=t.dragElementList[e.index],a=n.rowIndex;s=n.cloneNode(!0),s.id="dragingDiv"+a,s.classList.add("dragingDiv"),s.classList.remove("el-table_row"),s.style.transition="all 0.3s",s.style.zIndex=-1,s.style.position="absolute";var o=t.dragElementList[a];s.style.width=o.w+"px",s.style.height=o.h+"px",s.style.left=o.x-p+"px";var r=0;if(t.grid)r=o.y-t.fileListScrollTop-o.h/2+10;else{s.firstChild.style.textAlign="center";var l=Array.prototype.slice.call(s.childNodes);l.forEach((function(e,t){if(4===t)return e.style.borderRadius="0 3px 3px 0",e.style.borderRight="1px solid #409eff",e.firstChild.style.height="44px",e.firstChild.style.lineHeight="44px",e.firstChild.style.width="80px",!0;0!==t&&1!==t&&s.removeChild(e)})),r=o.y-t.fileListScrollTop-51.5}if(s.style.top=r+"px",0===i){var c=document.getElementById("numberFiles").cloneNode(!0);c.id="numberFilesCopy",c.querySelector(".number").innerHTML=t.selectRowData.length+"个文件",s.appendChild(c)}s.original={top:r,left:s.style.left},t.initFileListScrollTop=t.fileListScrollTop,u.appendChild(s)})),f=0;var o=document.getElementById("dragImage");a.dataTransfer.setDragImage(o,10,10),t.$store.dispatch("updateMessage",{event:"onDragStart",data:!0}),t.drawFlag=!1;var r=document.getElementById("rectangle1");r&&document.getElementById("v-draw-rectangle").removeChild(r),i=a.target,n=i.rowIndex,t.cellMouseIndex=-1,e=i.style.backgroundColor,t.grid?c.querySelectorAll(".grid-hover-back").forEach((function(e){e.classList.remove("grid-hover")})):document.getElementsByClassName("el-table--enable-row-hover")[0].classList.remove("el-table--enable-row-hover"),t.draging=1},l.ondragenter=function(e){clearTimeout(w);var a=v(e,"enter");if(a){if(g!==a.rowIndex){if(g>-1){var o=c.children[g];x(o)}if(n!==a.rowIndex&&t.fileList[a.rowIndex].isFolder&&-1===t.selectRowData.findIndex((function(e){return e.index===a.rowIndex}))){i.style.cursor="copy";var r=document.getElementById("numberFilesCopy");r.style.backgroundColor="#40a9ffc9",r.querySelector(".number").style.display="none",r.querySelector(".icon").style.display="inline",r.querySelector(".operate").style.display="inline";var s=r.querySelector(".target .folder");s.style.display="inline",s.innerHTML=t.fileList[a.rowIndex].name,a.style.backgroundColor;var l="#9fcdfc99";t.grid?a.style.backgroundColor=l:a.childNodes.forEach((function(e){return e.style.backgroundColor=l}))}g=a.rowIndex}y=-1}},l.ondragover=function(e){t.selectRowData.forEach((function(t,i){var n=document.getElementById("dragingDiv"+t.index);n&&(n.style.left=e.clientX-p+3*i+10+"px",n.style.top=e.clientY-50+3*i+10+"px",0===f&&(n.style.zIndex=999,setTimeout((function(){n.style.transition=""}),300)))})),e.preventDefault(),y=-1,f++};var w=null,y=-1;l.ondragleave=function(e){clearTimeout(w);var i=v(e,"leave");i&&(t.grid||0!==i.rowIndex&&i.rowIndex!==h-1||(y=i.rowIndex,w=setTimeout((function(){if(y>-1){var e=c.children[y];x(e),g=-1}}),100)))},l.ondrop=function(){var e=t.fileList[n],i=t.fileList[g];if(e&&i&&e.id!==i.id&&i.isFolder&&!t.selectRowData.includes(i)){var a=[];t.selectRowData.forEach((function(e){a.push(e.id)})),t.$confirm("是否将选中的".concat(t.selectRowData.length,"项移动到 ").concat(i.name,"?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){t.copyOrMoveApi("move",a,i.id),b(!1)})).catch((function(){b(!0)}))}else b(!0)};var x=function(n){if(i){if(n){t.grid?(n=n.children[0].children[0],"rgba(159, 205, 252, 0.6)"===n.style.backgroundColor&&(n.style.backgroundColor=null)):"rgba(159, 205, 252, 0.6)"===n.firstChild.style.backgroundColor&&n.childNodes.forEach((function(e){e.style.backgroundColor=null})),i.style.cursor="default";var a=document.getElementById("numberFilesCopy");a&&(a.style.backgroundColor="#d2eefa66",a.querySelector(".number").style.display="inline",a.querySelector(".icon").style.display="none",a.querySelector(".operate").style.display="none",a.querySelector(".target .folder").style.display="none")}i.style.backgroundColor=e}}}function C(e){var t={x:0,y:0};while(e)t.x+=e.offsetLeft,t.y+=e.offsetTop,e=e.offsetParent;return t}},formatTime:function(e){return Object(c["c"])(e)},formatSize:function(e){return Object(c["b"])(e)},upload:function(){this.$store.dispatch("updateMessage",{event:"openUploader",data:{folder:this.$route.query.folder,currentDirectory:this.getQueryPath(),username:this.$store.state.user.name,userId:this.$store.state.user.userId,isTogether:!0}})},uploadFolder:function(){window.uploader.supportDirectory?this.$store.dispatch("updateMessage",{event:"uploadFolder",data:{folder:this.$route.query.folder,currentDirectory:this.getQueryPath(),username:this.$store.state.user.name,userId:this.$store.state.user.userId,isTogether:!0}}):this.$message({message:"该浏览器不支持上传文件夹",type:"warning"})},goBack:function(){if(this.pathList.length<=1){var e=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("/?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(e))}else this.lastLink()},lastLink:function(){this.handleLink(this.pathList[this.pathList.length-2],this.pathList.length-2)},handleLink:function(e,t,i,n){var a=this;if(e&&e.search)e.searchKey?this.searchFileByKeyWord(e.searchKey):e.row&&this.searchFileAndOpenDir(e.row),this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1));else{this.pathList.splice(this.pathList.findIndex((function(e,i){return i===t+1})),this.pathList.length-(t+1)),this.pathList.forEach((function(e,t){0===t?a.path="":t===a.pathList.length||(a.path+="/"+a.pathList[t].folder),a.path=a.path.replace(/\\/g,"/")}));var o=localStorage.getItem(this.path);if(!i){var r=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$route.query.path,this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(encodeURI(this.path)).concat(o?"&folder="+o:"").concat(r))}n||(this.pagination.pageIndex=1,this.getFileList())}},newDocument:function(){window.open("/setting/website/manager-articles?operation=new","_blank")},newFolder:function(){var e=this;this.newFolderName=this.getNewFileName(this.fileList,"新建文件夹"),this.showNewFolder=!0,this.$nextTick((function(){e.$refs.newFolderName.focus(),e.$refs.newFolderName.select()}))},getNewFileName:function(e,t){var i=0,n=[];e.forEach((function(e){var t=e.name||e.label;n.push(t)}));var a=t;while(n.includes(t))if(i+=1,a.indexOf(".")>0){var o=a.substring(0,a.lastIndexOf(".")),r=a.substring(a.lastIndexOf("."));t="".concat(o).concat(i).concat(r)}else t="".concat(a).concat(i);return t},getDuplicateFileName:function(e,t){var i=0,n=[];e.forEach((function(e){var t=e.name||e.label;n.push(t)}));var a=t;while(n.includes(t))if(i+=1,a.indexOf(".")>0){var o=a.substring(0,a.lastIndexOf("."));o.indexOf(" 副本")>0&&(o=o.substring(0,o.lastIndexOf(" 副本")));var r=a.substring(a.lastIndexOf("."));t=1===i?"".concat(o," 副本").concat(r):"".concat(o," 副本").concat(i).concat(r)}else a.indexOf(" 副本")>0&&(a=a.substring(0,a.lastIndexOf(" 副本"))),t=1===i?"".concat(a," 副本"):"".concat(a," 副本").concat(i);return t},hideNewFolderName:function(){this.showNewFolder=!1,this.isShowNewFolder=!1},showNewFolderClick:function(){this.isShowNewFolder=!0},setInputFocus:function(){this.inputting=!0},setInputBlur:function(){this.inputting=!1},newFolderNameClickEnter:function(){this.newFolderNameClick()},newFolderNameClick:function(){var e=this;if(this.newFolderName){if(/[\[\]\/\\"<>\?\*]/gi.test(this.newFolderName))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});this.newFolderLoading=!0,this.createFileLoading=!0,h["a"].uploadFolder({isFolder:!0,filename:encodeURI(this.newFolderName),currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,username:this.$store.state.user.name,userId:this.$store.state.user.userId}).then((function(t){1===t.data?(e.newFolderLoading=!1,e.$message({message:"该文件夹已存在",type:"warning"})):(e.createFileLoading=!1,e.newCreateFileDialog=!1,e.newFolderLoading=!1,e.showNewFolder=!1,e.isShowNewFolder=!1,e.$notify({title:"新建文件夹成功",type:"success",duration:1e3}),e.listModeSearch?e.getFileListBySearchMode():e.getFileList())})).catch((function(){e.newFolderLoading=!1,e.createFileLoading=!1}))}else this.newFolderLoading=!1,this.$message({message:"请输入文件夹名称",type:"warning"})},createFile:function(e){var t=this;if("新建文件夹"===this.newCreateFileDialogTitle)return this.newFolderName=e,void this.newFolderNameClick();if(e){if(/[\[\]\/\\"<>\?\*]/gi.test(e))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});this.createFileLoading=!0;var i="/";this.path&&this.path.length>0&&(i=this.path);var n=e.substring(e.lastIndexOf(".")+1);h["a"].addFile({fileName:encodeURI(e),isFolder:!1,folder:this.$route.query.folder,username:this.$store.state.user.name,parentPath:encodeURI(i)}).then((function(i){switch(t.createFileLoading=!1,n&&!t.$route.query.folder){case"txt":t.textPreviewRow=i.data,t.textPreviewVisible=!0;break;case"drawio":case"mind":case"docx":case"xlsx":case"pptx":t.officePreviewRow=i.data,t.officePreviewVisible=!0;break}var a=t;t.setOnCreateFilename(e),setTimeout((function(){a.newCreateFileDialog=!1}),200)})).catch((function(){t.createFileLoading=!1}))}},searchFileByKeyWord:function(e){this.searchFile(e)},changeVmode:function(){this.grid=!this.grid,this.vmode="list",this.grid?(this.vmode="grid",this.lessClientHeight=106):(this.lessClientHeight=140,this.$refs.fileListTable.setHeight()),this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,this.path||(this.path=""),this.editingIndex=-1;var e=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(this.path).concat(this.$route.query.folder?"&folder="+this.$route.query.folder:"").concat(e)),this.rowDrop(),this.darwRectangle(),this.loadContextMenus(),this.grid||this.fileListScrollTop>0&&this.$refs.fileListTable.pagingScrollTopLeft(),this.fileListScrollTop=0},loadContextMenus:function(){var e=this;if(this.contextMenus.length<1)this.contextmenuDisabled=!0;else{var t=document.querySelector(".dashboard-container");0===this.$refs.homeContextmenu.references.length&&this.$refs.homeContextmenu.addRef({el:t,vnode:t});var i=this.contextMenus.findIndex((function(e){return"viewMode"===e.operation})),n=this.contextMenus.findIndex((function(e){return"arrangement"===e.operation}));if(i>-1){var a=this.contextMenus[i].child;this.grid?(a[0].iconClass="menu-empty",a[1].iconClass="menu-point"):(a[0].iconClass="menu-point",a[1].iconClass="menu-empty")}if(n>-1){var o=this.contextMenus[n].child,r=this.sortable.prop;o.forEach((function(t){var i=t.orderProp;i===r&&o.map((function(t){return i===t.orderProp?t.iconClass="menu-"+e.sortable.order:t.iconClass="menu-null",t}))}))}}},beforeLoadData:function(e){e?this.pagination.pageIndex++:this.pagination.pageIndex=1,this.pageLoadCompleteList[this.pagination.pageIndex]=!1,this.tableLoading=!0,this.finished=!1},loadData:function(e,t){var i=this;if(this.$refs.fileListTable){t?e.data.forEach((function(e,t){e["index"]=(i.pagination.pageIndex-1)*i.pagination.pageSize+t,i.fileList.push(e)})):(this.fileList=e.data,this.fileList.map((function(e,t){e.index=t})),this.$refs.fileListTable.reloadData(this.fileList),setTimeout((function(){i.$refs.fileListTable.reloadData(i.fileList)}),0)),this.fileList.length>=e.count&&(this.finished=!0),this.tableLoading=!1,this.clientHeight=document.documentElement.clientHeight-this.lessClientHeight,this.listModeSearch=!1,this.pagination["total"]=e.count,this.$nextTick((function(){i.containerResize(),i.tableLoading=!1,i.pageLoadCompleteList[i.pagination.pageIndex]=!0})),this.loadContextMenus(),this.highlightNewFile(),this.setMountFileOwner();var n="Object";if(this.fileList.length>0){var a=/([a-zA-Z]:\\[^*|"<>?\n]*)|(\/[^*|"<>?\n]*)/;a.test(this.fileList[0].id)||(n="File")}this.$store.dispatch("updateMessage",{event:"storageTypeChange",data:n})}},setMountFileOwner:function(){if(this.$route.query.folder&&this.fileList.length>0){var e=this.fileList[0];e.userId!==this.$store.getters.userId&&Object(D["e"])({userId:e.userId}).then((function(e){localStorage.setItem("mountFileOwner",e.data)}))}},highlightNewFile:function(){var e=this;if(this.onCreateFilename){var t=this.fileList.findIndex((function(t){return t.name===e.onCreateFilename}));if(t>-1){var i=this.fileList[t];setTimeout((function(){e.$refs.fileListTable.clearSelection(),e.$refs.fileListTable.toggleRowSelection([{row:i,selected:!0}])}),0)}}},searchFile:function(e,t){var i=this;if(e){this.beforeLoadData(t),this.pathList=[{folder:""}];var n={};n["folder"]='搜索: "'+e+'"',n["search"]=!0,n["searchKey"]=e,this.pathList.push(n);var a=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e).concat(a)),h["a"].searchFile({userId:this.$store.state.user.userId,username:this.$store.state.user.name,keyword:e,sortableProp:this.sortable.prop,order:this.sortable.order,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(e){i.loadData(e,t),i.path="",i.listModeSearch=!0,i.listModeSearchOpenDir=!1}))}},searchFileAndOpenDir:function(e,t){var i=this;this.beforeLoadData(t),h["a"].searchFileAndOpenDir({userId:this.$store.state.user.userId,username:this.$store.getters.name,id:e.id,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,folder:this.$route.query.folder}).then((function(n){i.loadData(n,t),i.listModeSearch=!0,i.listModeSearchOpenDir=e})),this.path=e.path+e.name,this.path=this.path.replace(/\\/g,"/")},openDir:function(e,t){var i=this;this.beforeLoadData(t),h["a"].searchFileAndOpenDir({userId:this.$store.state.user.userId,username:this.$store.getters.name,id:e.mountFileId||e.id,currentDirectory:this.getQueryPath(),pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize,folder:this.$route.query.folder}).then((function(e){i.loadData(e,t)})),this.path=e.path+e.name,this.path=this.path.replace(/\\/g,"/")},getFileList:function(e){var t=this;this.getFileListed=!0,this.beforeLoadData(e),h["a"].fileList({userId:this.$store.state.user.userId,username:this.$store.state.user.name,currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,queryFileType:this.queryFileType,sortableProp:this.sortable.prop,order:this.sortable.order,isFolder:this.queryCondition.isFolder,isFavorite:this.queryCondition.isFavorite,tagId:this.queryCondition.tagId,queryCondition:this.queryCondition,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(i){t.loadData(i,e)}))},getFileListBySearchMode:function(e){var t=this;this.beforeLoadData(e),h["a"].fileList({userId:this.$store.state.user.userId,username:this.$store.state.user.name,currentDirectory:this.getQueryPath(),folder:this.$route.query.folder,pageIndex:this.pagination.pageIndex,pageSize:this.pagination.pageSize}).then((function(i){t.loadData(i,e)}))},getQueryPath:function(){var e=this.$route.query.basePath?this.$route.query.basePath:"/";return e&&e.lastIndexOf("/")===e.length-1&&(e=e.substring(0,e.length-1)),encodeURI(e+this.$route.query.path)},tableBodyScroll:function(e,t){this.fileListScrollTop=t.target.scrollTop;var i=t.target.scrollHeight-t.target.clientHeight-t.target.scrollTop;if(i<200&&!this.finished){if(!this.pageLoadCompleteList[this.pagination.pageIndex])return;this.listModeSearch?this.listModeSearchOpenDir?this.searchFileAndOpenDir(this.listModeSearchOpenDir,!0):this.searchFile(this.searchFileName,!0):this.getFileList(!0)}},pinSelect:function(e,t){if(this.selectPin&&this.selectOrgin>-1){var i=this.selectOrgin;this.selectEnd=t.index;var n=this.selectEnd-i;if(this.$refs.fileListTable.clearSelection(),0===n&&(this.selectOrgin=-1),n>0)for(var a=i;a<=this.selectEnd;a++)this.$refs.fileListTable.toggleRowSelection([{row:this.fileList[a],selected:!0}]),this.$refs.fileListTable.tableSelectData.push(this.fileList[a]);if(n<0)for(var o=this.selectEnd;o<=i;o++)this.$refs.fileListTable.toggleRowSelection([{row:this.fileList[o],selected:!0}]),this.$refs.fileListTable.tableSelectData.push(this.fileList[o])}this.changeSelectedStyle(this.$refs.fileListTable.tableSelectData)},sortChangeOfMenu:function(e,t){var i=this,n=document.querySelector(".el-table__header thead tr");n.childNodes.forEach((function(e){e.className.indexOf("is-sortable")>-1&&(i.removeClass(e,"descending"),i.removeClass(e,"ascending"))}));var a="ascending"===this.sortable.order?"descending":"ascending";this.addClass(n.children[t],a),this.orderCustom=!0,this.sortChange({prop:e,order:a})},sortChange:function(e){var t=e.prop,i=e.order;(this.orderCustom||this.listModeSearch)&&(this.sortable.prop=t,this.sortable.order=i,this.pagination.pageIndex=1,this.listModeSearch?this.searchFile(this.searchFileName):this.getFileList())},removeClass:function(e,t){var i=e.className;i.indexOf(t)>-1&&(e.className=i.replace(t,""))},addClass:function(e,t){if(e){e.className;e.className=e.className+" "+t}},getShowSumFileAndFolder:function(e){var t=0,i=0;e.forEach((function(e){e.isFolder?t+=1:i+=1}));var n="";t>0&&(n=t+"个文件夹");var a="";return i>0&&(a=i+"个文件"),n+" "+a},getShowSumSize:function(e){var t="";return t+=e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"K":e>=1048576&&e<1073741824?(e/1048576).toFixed(2)+"M":(e/1073741824).toFixed(2)+"G",t},selectAll:function(e){var t=this;this.isSelectAll=e,e?this.fileList.forEach((function(e){t.selectRowData.push(e)})):this.isIndeterminate=!1},handleSelectionChange:function(e){if(e.length>0){if(this.selectPin||(this.selectOrgin=e[0].index),this.selectPin)return;this.rowContextData=e[0]}this.$refs.fileListTable.tableSelectData=e,this.selectRowData=e,this.changeSelectedStyle(e)},changeSelectedStyle:function(e){if(!this.stopSortChange){var t=0;e.forEach((function(e){t+=e.size}));var i=this.tableHead[2],n=this.tableHead[4],a=this.tableHead[5],o=this.tableHead[6];if(e.length>0){var r=this.getShowSumFileAndFolder(e),s=this.getShowSumSize(t);i.label=r,i.sortable=!1,n.name="more",a.label=s,a.sortable=!1,o.label="",o.sortable=!1}else i.label="名称",i.sortable=!0,n.name="",a.label="大小",a.sortable=!0,o.label="修改日期",o.sortable=!0;this.selectRowData.length===this.fileList.length?this.allChecked=!0:this.allChecked=!1}},rowStyle:function(e){e.row,e.column;var t=e.rowIndex,i=e.columnIndex;if(this.$refs.fileListTable.tableSelectData.findIndex((function(e){return e.index===t}))>-1)return 0===i?{backgroundColor:"#e0f3fc !important",borderRadius:"3px 0 0 3px",borderLeft:"1px solid #409eff",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}:5===i?{backgroundColor:"#e0f3fc !important",borderRadius:"0 3px 3px 0",borderRight:"1px solid #409eff",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}:{backgroundColor:"#e0f3fc !important",borderTop:"1px solid #409eff",borderBottom:"1px solid #409eff"}},tableRowClassName:function(e){e.row,e.rowIndex},preliminaryRowData:function(e){e&&(this.rowContextData=e);var t=this.rowContextData.isFavorite;this.highlightFavorite(!!this.isCollectView||t,!1)},cellMouseEnter:function(e){1!==this.draging&&("moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex!==e.index&&this.$refs.contextShow.hideMenu(),-1!==this.editingIndex||this.$refs.contextShow.ctxVisible||this.selectRowData.length<=1&&(this.cellMouseIndex=e.index))},cellMouseLeave:function(e){if(1!==this.draging)return"moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex!==e.index?(this.$refs.contextShow.hideMenu(),void(this.$refs.contextShow.locals={})):void(this.$refs.contextShow.ctxVisible&&"moreClick"===this.$refs.contextShow.locals.menuType&&this.$refs.contextShow.locals.rowIndex===e.index||(this.cellMouseIndex=-1))},dblclick:function(e){this.fileClick(e)},cellClick:function(e,t){if(this.selectFile)this.fileClick(e);else if(clearTimeout(this.Loop),-1===this.editingIndex){var i=t.index;if(2===i&&this.selectRowData.length<1&&e.index!==this.editingIndex&&(this.editingIndex=-1),this.isCmd)return this.pinSelect(null,e),void this.$refs.fileListTable.toggleRowSelection([{row:e}]);this.pinSelect(null,e)}},renameInputFocus:function(e,t){this.setInputFocus(),e.focus(),e.selectionStart=0,e.selectionEnd=e.value.length,t&&(e.selectionEnd-=t.length+1)},rowRename:function(e,t){var i=this;if(e=e.replace(/[\r\n]/g,""),e){if(/[\[\]\/\\"<>\?\*]/gi.test(e))return void this.$message({message:"文件名不能包含以下字符:<,>,|,*,?,,/,[,]",type:"warning"});var n=e.replace(/(.*\/)*([^.]+).*/gi,"$2"),a=e.replace(/.+\./,"");t.isFolder?this.rename(t,e):t.suffix!==a?this.$confirm("您确定要将扩展名“.".concat(t.suffix,"”更改为“.").concat(a,"”吗？"),"提示",{type:"warning",showClose:!1,closeOnClickModal:!1,confirmButtonText:"保持.".concat(t.suffix),cancelButtonText:"使用.".concat(a)}).then((function(){e=n+"."+t.suffix})).catch((function(){})).then((function(){i.rename(t,e)})):this.rename(t,e)}else this.editingIndex=-1},rename:function(e,t){var i=this;if(e.name!==t){this.renameLoading=!0;var n=this.fileList.findIndex((function(e){if(t===e.name)return e}));if(n>-1){var a="该文件已存在";return e.isFolder&&(a="该文件夹已存在"),this.$message({message:a,type:"warning"}),void(this.renameLoading=!1)}h["a"].rename({newFileName:encodeURI(t),username:this.$store.state.user.name,folder:this.$route.query.folder,id:e.id}).then((function(n){i.renameLoading=!1,e.name=t,e.suffix=t.replace(/.+\./,""),i.fileList[e.index]=e,i.editingIndex=-1})).then((function(){i.$refs.fileListTable.clearSelection(),i.setOnCreateFilename(t)})).catch((function(){i.renameLoading=!1,i.editingIndex=-1}))}else this.editingIndex=-1},setOnCreateFilename:function(e){this.$route.query.folder&&(this.onCreateFilename=e,this.getFileList(),this.clearOnCreateFilename())},moreOperation:function(e){this.menusIsMultiple=!0,this.menus=this.multipleMenus,this.showOperationMenus(e)},setMenus:function(e){if(this.menus=JSON.parse(JSON.stringify(this.singleMenus)),this.$route.query.folder)this.setMenusByPermission(e);else{if(e.isFolder&&e.mountFileId)for(var t=[6,5,4,3,1],i=0,n=t;i<n.length;i++){var a=n[i];this.menus.splice(a,1)}if(e.isFolder||this.menus.splice(-2,0,{iconClass:"duplicate",label:"创建副本",operation:"duplicate"}),e.isShare&&!e.shareBase||e.ossFolder){var o=this.menus.findIndex((function(e){return"share"===e.operation}));o>-1&&this.menus.splice(o,1)}e.isShare&&!e.isPrivacy&&this.menus.splice(-2,0,{iconClass:"menu-fuzhi",label:"复制下载链接",operation:"copyDownloadLink"})}this.preliminaryRowData(e)},setMenusByPermission:function(e){var t=["open","download"];this.menus=this.menus.filter((function(e){return t.includes(e.operation)})),e.operationPermissionList&&e.operationPermissionList.length>0&&(e.operationPermissionList.indexOf("PUT")>-1&&this.menus.splice(this.menus.length-1,0,{iconClass:"menu-rename",label:"重命名",operation:"rename"}),e.operationPermissionList.indexOf("UPLOAD")>-1&&!e.isFolder&&this.menus.splice(this.menus.length-1,0,{iconClass:"duplicate",label:"创建副本",operation:"duplicate"}),e.operationPermissionList.indexOf("DELETE")>-1&&this.menus.splice(this.menus.length,0,{iconClass:"menu-remove",label:"删除",operation:"remove"}))},moreClick:function(e,t){this.menusIsMultiple=!1,this.setMenus(e),this.showOperationMenus(t,{menuType:"moreClick",rowIndex:e.index})},rowContextmenu:function(e){if(!this.selectFile){this.$refs.fileListTable.tableSelectData.length>1&&this.$refs.fileListTable.tableSelectData.findIndex((function(t){return t.index===e.index}))>-1?(this.menusIsMultiple=!0,this.menus=this.multipleRightMenus,this.highlightFavorite(this.isCollectView,!1)):(this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.toggleRowSelection([{row:e}]),this.menusIsMultiple=!1,this.setMenus(e)),event.preventDefault(),this.menuTriangle="";var t={};t.pageX=event.pageX+5,t.pageY=event.pageY+2,t.clientX=event.clientX+5,t.clientY=event.clientY+2,this.$refs.contextShow.showMenu(t),this.cellMouseIndex=-1}},showOperationMenus:function(e,t){var i=e.pageY;e.target.clientHeight>0&&(i+=e.target.clientHeight/2-e.offsetY);var n={};document.body.scrollHeight-i>400?(this.menuTriangle="menu-triangle-top",n.pageX=e.pageX-78,n.pageY=i+25):(this.menuTriangle="menu-triangle-bottom",n.pageX=e.pageX-78,n.pageY=i-38*this.menus.length-36),this.isJustHideMenus||this.$refs.contextShow.showMenu(n,t)},menuFavoriteOver:function(e,t){this.highlightFavorite(!!this.isCollectView||t,!1)},menuFavoriteLeave:function(e,t){this.highlightFavorite(!!this.isCollectView||t,!1)},highlightFavorite:function(e,t){var i=this.menus.find((function(e){if("favorite"===e.operation||"unFavorite"===e.operation)return e}));i&&(e?(i.label="取消收藏",i.iconClass="menu-unfavorite-hover",i.operation="unFavorite"):(i.iconClass=t?"menu-favorite-hover":"menu-favorite",i.label="收藏",i.operation="favorite"))},show:function(){var e=this;this.contextmenuDisabled=!0,setTimeout((function(){e.contextmenuDisabled=!1}),1e3)},hide:function(){var e=this;this.isJustHideMenus=!0,setTimeout((function(){e.isJustHideMenus=!1}),100),this.cellMouseIndex=-1},contextmenuClick:function(e){switch(e){case"vmode-list":this.grid=!0,this.changeVmode();break;case"vmode-grid":this.grid=!1,this.changeVmode();break;case"orderName":this.sortChangeOfMenu("name",2);break;case"orderSize":this.sortChangeOfMenu("size",5);break;case"orderUpdateDate":this.sortChangeOfMenu("updateDate",6);break;case"refresh":this.getFileList();break;case"createTextFile":this.newCreateFileDialogTitle="新建文本文件",this.createNewFile("txt");break;case"createFolder":this.newCreateFileDialogTitle="新建文件夹",this.createNewFile("");break;case"createDrawioFile":this.newCreateFileDialogTitle="新建流程图",this.createNewFile("drawio");break;case"createMinderFile":this.newCreateFileDialogTitle="新建思维导图",this.createNewFile("mind");break;case"createWordFile":this.newCreateFileDialogTitle="新建Word文档",this.createNewFile("docx");break;case"createExcelFile":this.newCreateFileDialogTitle="新建Excel工作表",this.createNewFile("xlsx");break;case"createPPTFile":this.newCreateFileDialogTitle="新建PPT演示文档",this.createNewFile("pptx");break;case"createMarkdownFile":this.newDocument();break}},createNewFile:function(e){var t=this;"新建文件夹"===this.newCreateFileDialogTitle?this.newCreateFileName="新建文件夹":this.newCreateFileName="未命名文件.".concat(e),this.newCreateFileName=this.getNewFileName(this.fileList,this.newCreateFileName),this.newCreateFileDialog=!0,this.$nextTick((function(){var i=t.$refs.newCreateFileName.$el.querySelector(".el-input__inner");t.renameInputFocus(i,e)}))},menusOperations:function(e){switch(e){case"share":this.share();break;case"tag":this.allocateTag();break;case"favorite":this.favoriteOperating(!0);break;case"edit":window.open("/setting/website/manager-articles?operation=editor&id=".concat(this.rowContextData.id),"_blank");break;case"open":this.fileClick(this.rowContextData);break;case"deselect":this.$refs.fileListTable.clearSelection();break;case"unFavorite":this.favoriteOperating(!1);break;case"details":this.drawer=!0;break;case"rename":this.renameFileName=this.rowContextData.name,this.editingIndex=this.rowContextData.index;break;case"duplicate":this.duplicate();break;case"copy":this.moveOrCopy();break;case"download":this.downloadFile();break;case"copyDownloadLink":this.copyDownloadLink(this.rowContextData);break;case"remove":this.deleteFile();break}this.$refs.contextShow.hideMenu()},clearTreeNode:function(){},directoryTreeLoadNode:function(e,t){var i=null;if(0===e.level){var n=this;return setTimeout((function(){n.$refs.directoryTree.setCurrentKey("0")}),0),t([{id:"0",name:"全部文件"}])}e.level>1&&(i=e.data.id),h["a"].queryFileTree({userId:this.$store.state.user.userId,username:this.$store.state.user.name,fileId:i}).then((function(e){var i=e.data;return t(i)}))},treeNodeClick:function(e,t,i){this.fileTreeAndNewFolderDisabled=e.hasOwnProperty("newFolder"),this.selectTreeNode=e,this.selectTreeNode.showName=' "'+e.name+'"'},treeNodeExpand:function(e,t,i){},fileTreeAndNewFolder:function(){var e="newFolderNodeKey",t=this.$refs.directoryTree.getNode(e);null!==t&&this.$refs.directoryTree.remove(t);var i=this.$refs.directoryTree.store.currentNode.childNodes,n=this.getNewFileName(i,"新建文件夹"),a={id:e,newFolder:!0,name:n,showName:n,isLeaf:!0};this.$refs.directoryTree.append(a,this.selectTreeNode),setTimeout((function(){var e=document.getElementById("treeInput");e&&(e.value=n,e.focus(),e.select())}),100)},moveFileTree:function(){this.copyOrMove("move")},copyFileTree:function(){this.copyOrMove("copy")},confirmUnzip:function(){this.unzip(this.openingFile,this.selectTreeNode.id,!1)},showDialogMoveOrCopyVisible:function(){this.dialogMoveOrCopyVisible=!0},duplicate:function(){var e=this,t=this.getDuplicateFileName(this.fileList,this.rowContextData.name);h["a"].duplicateFile({fileId:this.rowContextData.id,newFilename:t}).then((function(){e.$message.success("创建副本成功"),e.setOnCreateFilename(t)}))},moveOrCopy:function(){this.showDialogMoveOrCopyVisible(),this.titlePrefix="移动或复制到: ",this.unzipOperating=!1;var e=this;setTimeout((function(){e.selectTreeNode=e.$refs.directoryTree.getCurrentNode(),e.selectTreeNode.showName=' "'+e.selectTreeNode.name+'"'}),100)},copyOrMove:function(e){var t=this,i="复制";"move"===e&&(i="移动");var n="/";this.selectTreeNode.path&&(n=this.selectTreeNode.path+this.selectTreeNode.name+"/");var a=[];if(this.menusIsMultiple||this.selectRowData.length>1){var o=this.$refs.fileListTable.tableSelectData.some((function(e){a.push(e.id);var o=e.path;if(o===n)return t.$message({message:"不能将文件"+i+"到自身或其子目录下",type:"warning"}),!0}));if(o)return}else this.rowContextData.id?a.push(this.rowContextData.id):a.push(this.rowContextData[0].id);this.copyOrMoveApi(e,a,this.selectTreeNode.id)},copyOrMoveApi:function(e,t,i){var n=this,a="复制";"move"===e&&(a="移动");var o=this.$message({iconClass:"el-icon-loading",type:"info",duration:0,dangerouslyUseHTMLString:!0,message:a+"中..."});this.dialogMoveOrCopyVisible=!1,h["a"][e]({userId:this.$store.state.user.userId,username:this.$store.state.user.name,froms:t,to:i}).then((function(){o.iconClass=null,o.type="success",o.message=a+"中...",n.rowContextData.isFolder&&n.$refs.directoryTree.append(n.rowContextData,i),"move"===e&&n.getFileList(),setTimeout((function(){o.close()}),1e3)})).catch((function(){o.close()}))},renderContent:function(e,t){var i=this,n=t.node,a=t.data;t.store;return a.newFolder?e("span",{class:"custom-tree-node"},[e("span",[e("svg-icon",{attrs:{"icon-class":"folder"}})]),e("span",[e("div",{class:"el-input el-input--mini el-input-tree"},[e("input",{attrs:{type:"text",autocomplete:"on",value:"新建文件夹",id:"treeInput"},class:"el-input__inner"})]),e("button",{attrs:{type:"button","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(){var e="/",t=n.parent.data;t.path&&(e=t.path+t.name+e);var o=document.getElementById("treeInput").value;h["a"].newFolder({isFolder:!0,filename:encodeURI(o),currentDirectory:i.getQueryPath(),folder:i.$route.query.folder,username:i.$store.state.user.name,userId:i.$store.state.user.userId}).then((function(e){a.newFolder=!1,a.name=o,a.id=e.data})).catch((function(){window.event.preventDefault(),window.event.stopPropagation()}))}},class:"el-button el-icon-check el-button--mini el-input-tree-button"}),e("button",{attrs:{type:"button","element-loading-spinner":"el-icon-loading","element-loading-background":"#f6f7fa88"},on:{click:function(){i.$refs.directoryTree.remove(n),window.event.preventDefault(),window.event.stopPropagation()}},class:"el-button el-icon-close el-button--mini el-input-tree-button"})])]):n.expanded?e("span",{class:"custom-tree-node"},[e("svg-icon",{attrs:{"icon-class":"open-folder"}}),e("span",{style:"margin-left: 5px;"},[n.label]),e("span")]):e("span",{class:"custom-tree-node"},[e("svg-icon",{attrs:{"icon-class":"folder"}}),e("span",{style:"margin-left: 5px;"},[n.label]),e("span")])},allocateTag:function(){this.tagDialogObjectList=JSON.parse(JSON.stringify(this.$refs.fileListTable.tableSelectData)),this.tagDialogVisible=!0},allocateTagSuccess:function(){this.getFileList()},share:function(e){e&&e.id||(e=this.rowContextData.id?this.rowContextData:this.$refs.fileListTable.tableSelectData[0]),this.shareDialogObject=e,this.shareDialogObject.fileId=e.id,this.shareDialogObject.shareBase=e.shareBase,this.shareDialogVisible=!0},shareSuccess:function(e){var t=this.rowContextData.isFavorite;this.rowContextData.isFavorite=!t,this.rowContextData.isFavorite=t,this.rowContextData.shareBase=e,this.rowContextData.isShare=!0},downloadFile:function(){var e=0;if(this.$refs.fileListTable.tableSelectData.length>0?this.$refs.fileListTable.tableSelectData.forEach((function(t){e+=t.size})):e+=this.rowContextData.size,e>0){var t=[];if(this.$refs.fileListTable.tableSelectData.length>0?this.$refs.fileListTable.tableSelectData.forEach((function(e){t.push(e.id)})):t.push(this.rowContextData.id),t.length>1||this.rowContextData.isFolder)return void k["a"].packageDownloadTogether(t,this.$store.state.user.token,this.$store.state.user.name);k["a"].download(this.$store.state.user.name,this.rowContextData,this.$store.getters.token)}else this.$message({message:"所选文件为空",type:"warning"})},copyDownloadLink:function(e){var t=this,i=window.location.origin+k["a"].previewUrl(this.$store.getters.name,e,void 0,void 0),n=new F.a(".newFileMenu",{text:function(){return i}});n.on("success",(function(e){t.$message({message:"复制成功",type:"success",duration:1e3}),n.destroy()})),n.on("error",(function(e){t.$message({message:"该浏览器不支持自动复制",type:"warning",duration:1e3}),n.destroy()}))},favoriteOperating:function(e){var t=this,i=this.getSelectIdList();this.rowContextData.isFavorite=e,this.highlightFavorite(e,!0),h["a"].favoriteUrl({fileIds:i,isFavorite:e}).then((function(i){!e&&t.isCollectView&&t.removeSelectItme()})).catch((function(){t.rowContextData.isFavorite=!e}))},deleteFile:function(){var e=this,t=[],i=[];this.menusIsMultiple||this.selectRowData.length>1?(t=this.$refs.fileListTable.tableSelectData,this.$refs.fileListTable.tableSelectData.forEach((function(e){i.push(e.id)}))):i.push(this.rowContextData.id);var n=this.getShowSumFileAndFolder(t);this.$confirm("此操作将永久删除"+n+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){h["a"].delete({currentDirectory:e.getQueryPath(),username:e.$store.state.user.name,fileIds:i}).then((function(){e.$route.query.folder&&e.getFileList()})).then((function(){e.$notify({title:"删除成功",type:"success",duration:1e3})}))}))},getSelectIdList:function(){var e=[];return this.selectRowData.length>1||this.menusIsMultiple?this.$refs.fileListTable.tableSelectData.forEach((function(t){e.push(t.id)})):e.push(this.rowContextData.id),e},removeSelectItme:function(){var e=this,t=[];this.$refs.fileListTable.tableSelectData.length>0&&this.$refs.fileListTable.tableSelectData.forEach((function(i){var n=e.fileList.findIndex((function(e){return e.id===i.id}));n>-1&&t.push(n)})),this.$refs.fileListTable.doLayout(),this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.tableSelectData=[],t=t.sort((function(e,t){return t-e})),setTimeout((function(){for(var i=0;i<t.length;i++)e.fileList.splice(t[i],1);e.fileList.map((function(e,t){e.index=t})),e.rowDrop(),e.darwRectangle()}),300)},compressionFilePreview:function(e){this.unzip(e,void 0,!0)},unzipTo:function(e){this.showDialogMoveOrCopyVisible(),this.titlePrefix="解压到: ",this.unzipOperating=!0;var t=this;setTimeout((function(){t.openCompressionVisible=!1,t.selectTreeNode=t.$refs.directoryTree.getCurrentNode(),t.selectTreeNode.showName=' "'+t.selectTreeNode.name+'"'}),100)},unzip:function(e,t,i){var n=this,a="解压",o=this.$message({iconClass:"el-icon-loading",type:"info",duration:0,dangerouslyUseHTMLString:!0,message:"<span>&nbsp;&nbsp;正在"+a+"</span>"});h["a"].unzip({fileId:e.id,destFileId:t}).then((function(r){o.iconClass=null,o.type="success",o.message=a+"成功",i&&(n.compressedFileData=r.data,n.compressedFileVisible=!0,n.compressedFileName=e.name,n.compressedFileTempDir=i);var s=n;setTimeout((function(){o.close(),s.openCompressionVisible=!1,e.id===t&&s.getFileList(),t&&e.id!==t&&!i&&(s.dialogMoveOrCopyVisible=!1)}),1e3)})).catch((function(){o.close()}))},fileClick:function(e){if(this.editingIndex!==e.index)if(this.openingFile=e,e.isFolder){this.editingIndex=-1;var t=this.$route.query.tagId?"&tagId=".concat(this.$route.query.tagId):"";if(this.listModeSearch){var i={};i["folder"]=e.name,i["search"]=!0,i["row"]=e,this.pathList.push(i),this.pagination.pageIndex=1,this.$router.push("?vmode=".concat(this.vmode,"&search-file=").concat(e.id).concat(t)),this.searchFileAndOpenDir(e)}else{var n=this.$route.path.length>1;n&&1===this.basePath.length&&(this.basePath=e.path),this.path?this.path+="/"+e.name:this.path=this.basePath+e.name,this.path=this.path.replace(this.basePath,"/");var a={folder:e.name,shareBase:e.shareBase};this.pathList.push(a),this.pagination.pageIndex=1;var o=encodeURI(this.path);this.$store.getters.userId!==e.userId&&(e.mountFileId=e.id),e.mountFileId&&localStorage.setItem(this.path,e.mountFileId),this.$router.push("?vmode=".concat(this.vmode,"&path=").concat(o).concat(e.mountFileId?"&folder="+e.mountFileId:"").concat(t).concat(this.basePath.length>1?"&basePath="+this.basePath:"")),this.openDir(e)}}else{if(this.selectFile){var r=e,s=this.$refs.fileListTable.tableSelectData;return s.length<1||s[0].id!==e.id?(this.$refs.fileListTable.clearSelection(),this.$refs.fileListTable.toggleRowSelection([{row:e}]),this.pinSelect(null,e)):(this.$refs.fileListTable.clearSelection(),r={}),void this.$emit("selectedFile",r)}if(u["c"].cadFile.includes(e.suffix.toUpperCase()))return this.cadPreviewRow=e,void(this.cadPreviewVisible=!0);if(e.contentType.startsWith("image"))return this.imagePreviewVisible=!0,void(this.imagePreviewRow=e);if(u["c"].simText.includes(e.suffix))return this.textPreviewRow=e,void(this.textPreviewVisible=!0);if(e.contentType.indexOf("video")>-1)return this.videoPreviewVisible=!0,void(this.videoPreviewRow=e);if(e.contentType.indexOf("audio")>-1)return void this.$store.dispatch("updateMessage",{event:"onAddAudio",data:{row:e,audioCoverUrl:this.audioCoverUrl}});if(u["c"].compressedFile.includes(e.suffix))return void(this.openCompressionVisible=!0);if(e.contentType.indexOf("office")>-1||["pdf","PDF","csv","drawio","mind"].includes(e.suffix))return this.officePreviewVisible=!0,void(this.officePreviewRow=e);if(e.contentType.indexOf("utf-8")>-1)return this.textPreviewRow=e,void(this.textPreviewVisible=!0);this.notPreviewDialogVisible=!0}},forciblyOpen:function(e){this.textPreviewRow=e,this.textPreviewVisible=!0;var t=this;setTimeout((function(){t.notPreviewDialogVisible=!1}),100)},determineDownload:function(e){this.download(e),this.notPreviewDialogVisible=!1},download:function(e){k["a"].download(this.$store.state.user.name,e,this.$store.getters.token)},closeHandle:function(){this.cadPreviewVisible=!1}}},N=M,O=(i("5caa"),i("2877")),A=Object(O["a"])(N,o,r,!1,null,"ab78194a",null),P=A.exports,$={components:{ShowFile:P},data:function(){return{sortable:{prop:"name",order:"ascending"},contextMenus:[{label:"查看",operation:"viewMode",child:[{iconClass:this.grid?"":"menu-point",label:"列表",operation:"vmode-list"},{iconClass:this.grid?"menu-point":"",label:"缩略图",operation:"vmode-grid"}]},{label:"排列方式",operation:"arrangement",child:[{label:"名称",operation:"orderName",orderProp:"name"},{label:"大小",operation:"orderSize",orderProp:"size"},{label:"日期",operation:"orderUpdateDate",orderProp:"updateDate"}]},{label:"刷新",operation:"refresh"},{divider:!0,operation:"divider"},{label:"新建",operation:"create",child:[{label:"文件夹",operation:"createFolder",iconClass:"folder"},{divider:!0,operation:"divider"},{label:"文本",operation:"createTextFile",iconClass:"file-txt"},{label:"思维导图",operation:"createMinderFile",iconClass:"file-mind"},{label:"流程图",operation:"createDrawioFile",iconClass:"file-drawio"},{label:"Word",operation:"createWordFile",iconClass:"file-word"},{label:"Excel",operation:"createExcelFile",iconClass:"file-excel"},{label:"PPT",operation:"createPPTFile",iconClass:"file-ppt"}]}]}}},R=$,H=Object(O["a"])(R,n,a,!1,null,"135bf960",null);t["default"]=H.exports},dc5e:function(e,t,i){"use strict";i("7f7f");var n=function(){var e=this,t=e._self._c;return t("di",[t("el-dialog",{staticStyle:{"{'font-weight'":"600}"},attrs:{title:"分享文件",visible:e.shareDialogVisible},on:{"update:visible":function(t){e.shareDialogVisible=t},close:e.shareDialogClose}},[t("div",[t("div",{staticClass:"share-content"},[t("div",{staticClass:"share-icon"},[t("icon-file",{staticClass:"share-icon-font",attrs:{item:e.file,grid:!0,details:!0,"image-url":e.imageUrl,"audio-cover-url":e.audioCoverUrl}})],1),e._v(" "),t("div",{staticClass:"share-filename"},[this.file.shareId?t("a",{attrs:{href:"/?path="+e.filenamePath+"&highlight="+e.file.name}},[e._v(e._s(e.filename))]):t("span",[e._v(e._s(e.filename))])]),e._v(" "),t("div",[t("el-form",{ref:"form",staticClass:"share-option",attrs:{model:e.shareOption,"label-width":"86px",size:"mini"}},[t("el-form-item",{attrs:{label:e.shareOptionConfig.linkLabel}},[e.shareOptionConfig.shared?e._e():t("el-col",{staticClass:"share-expires-data",attrs:{span:e.shareOptionConfig.shared?9:20}},[t("el-form-item",{attrs:{prop:"expiresDateOption"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small"},on:{change:e.expiresDateOptionChange},model:{value:e.shareOption.expiresDateOption,callback:function(t){e.$set(e.shareOption,"expiresDateOption",t)},expression:"shareOption.expiresDateOption"}},[t("el-option",{attrs:{label:"30天有效",value:0}}),e._v(" "),t("el-option",{attrs:{label:"永久有效",value:1}}),e._v(" "),t("el-option",{attrs:{label:"自定义",value:2}})],1)],1)],1),e._v(" "),e.shareOptionConfig.shared?t("el-col",{staticClass:"shared-expires-text",attrs:{span:12}},[e._v("到期时间")]):e._e(),e._v(" "),e.shareOptionConfig.shared?e._e():t("el-col",{attrs:{span:1}},[e._v(" ")]),e._v(" "),2===e.shareOption.expiresDateOption?t("el-col",{staticClass:"share-expires-data",attrs:{span:12}},[t("el-form-item",{attrs:{prop:"expiresDate"}},[t("el-date-picker",{ref:"expiresDatePicker",attrs:{size:"small",clearable:!1,type:"date",placeholder:e.shareOption.expiresDate?"选择到期时间":"永久有效",align:"right",format:"yyyy-MM-dd HH:mm","value-format":"timestamp","picker-options":e.pickerOptions},on:{change:e.pickerChange},model:{value:e.shareOption.expiresDate,callback:function(t){e.$set(e.shareOption,"expiresDate",t)},expression:"shareOption.expiresDate"}})],1)],1):e._e()],1),e._v(" "),e.shareOptionConfig.shared?e._e():t("el-form-item",{staticClass:"share-option-form",attrs:{label:"分享形式",width:"100"}},[t("el-col",{attrs:{span:20}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.shareOption.isPrivacy,callback:function(t){e.$set(e.shareOption,"isPrivacy",t)},expression:"shareOption.isPrivacy"}},[t("el-option",{attrs:{label:"公开链接",value:!1}}),e._v(" "),t("el-option",{attrs:{label:"私密链接",value:!0}})],1)],1)],1),e._v(" "),t("el-col",{staticClass:"share-link"},[e.shareOptionConfig.shared?t("el-input",{attrs:{size:"small",readonly:"readonly"},model:{value:e.shareLink,callback:function(t){e.shareLink=t},expression:"shareLink"}},[t("el-popover",{staticClass:"share-link-qrcode",attrs:{slot:"append",placement:"right",trigger:"hover"},slot:"append"},[t("img",{attrs:{alt:"qrcode-share-link",src:e.qrCodeshareLink}}),e._v(" "),t("el-button",{staticClass:"qrcode-btn tag-share-link",attrs:{slot:"reference","data-clipboard-text":e.shareLink},on:{click:function(t){return e.copyShareLink("链接复制成功")}},slot:"reference"},[t("svg-icon",{staticClass:"qrcode",attrs:{"icon-class":"qrcode"}})],1)],1)],1):e._e(),e._v(" "),e.shareOptionConfig.shared&&e.shareOption.isPrivacy?t("el-input",{staticClass:"share-link-code",attrs:{size:"small",readonly:"readonly"},model:{value:e.extractionCode,callback:function(t){e.extractionCode=t},expression:"extractionCode"}},[t("template",{slot:"prepend"},[e._v("提取码")])],2):e._e(),e._v(" "),e.shareOptionConfig.shared&&e.shareOption.isPrivacy?t("el-collapse",{attrs:{accordion:""}},[t("el-collapse-item",{attrs:{title:"操作权限"}},[t("el-checkbox-group",{on:{change:e.permissionActionChange},model:{value:e.shareOption.operationPermissionList,callback:function(t){e.$set(e.shareOption,"operationPermissionList",t)},expression:"shareOption.operationPermissionList"}},[t("el-checkbox",{attrs:{label:"UPLOAD"}},[e._v("上传")]),e._v(" "),t("el-checkbox",{attrs:{label:"PUT"}},[e._v("修改")]),e._v(" "),t("el-checkbox",{attrs:{label:"DELETE"}},[e._v("删除")])],1)],1)],1):e._e()],1)],1)],1)])]),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.shareOptionConfig.shared?e._e():t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.generateShareLinkLoading,expression:"generateShareLinkLoading"}],attrs:{size:"small",type:"primary"},on:{click:e.submitShare}},[e._v("创建分享\n      ")]),e._v(" "),e.shareOptionConfig.shared&&e.shareOption.isPrivacy?t("el-button",{staticClass:"tag-share-link",attrs:{size:"small","data-clipboard-text":e.file.name+" "+e.shareLink+" 提取码："+e.extractionCode},on:{click:function(t){return e.copyShareLink("口令复制成功")}}},[e._v("复制口令\n      ")]):e._e(),e._v(" "),e.shareOptionConfig.shared?t("el-button",{staticClass:"tag-share-link",attrs:{size:"small",type:"primary","data-clipboard-text":e.shareLink},on:{click:function(t){return e.copyShareLink("链接复制成功")}}},[e._v("复制链接\n      ")]):e._e()],1)])],1)},a=[],o=i("c1df"),r=i.n(o),s=i("0dcf"),l=i("5cfc"),c=i("b311"),d=i.n(c),u=i("00a1"),h=i("d055"),p=i.n(h),f={name:"ShareDialog",components:{Icon:u["a"],IconFile:s["a"]},props:{fileId:{type:String,default:""},file:{type:Object,default:function(){return{}}},status:{type:Boolean,default:!1}},data:function(){return{imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),audioCoverUrl:"".concat("/api","/view/cover?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),shareDialogVisible:!1,generateShareLinkLoading:!1,pickerOptions:{disabledDate:function(e){var t=new Date,i=t.setDate(t.getDate()),n=t.setDate(t.getDate()+3e4);return e.getTime()<new Date(i).getTime()||e.getTime()>new Date(n).getTime()},firstDayOfWeek:1,shortcuts:[{text:"7天后",onClick:function(e){var t=new Date;t.setTime(t.getTime()+6048e5),e.$emit("pick",t)}},{text:"30天后",onClick:function(e){var t=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",t)}},{text:"半年后",onClick:function(e){var t=new Date;t.setTime(t.getTime()+15768e6),e.$emit("pick",t)}},{text:"一年后",onClick:function(e){var t=new Date;t.setTime(t.getTime()+315792e5),e.$emit("pick",t)}},{text:"永久",onClick:function(e){e.$emit("pick",0)}}]},shareOption:{expiresDateOption:1,isPrivacy:!1,expiresDate:"",operationPermissionList:void 0},shareLink:"",qrCodeshareLink:"",extractionCode:"",shareOptionConfig:{shared:!1,linkLabel:"选择有效期"},filename:""}},computed:{filenamePath:function(){return this.filename.slice(0,this.filename.lastIndexOf("/"))}},watch:{status:function(e){var t=this;e&&(this.filename=this.file.name,this.shareDialogVisible=!0,this.file.shareId?(l["a"].getFileInfoById({id:this.file.fileId}).then((function(e){t.filename=e.data.path+t.file.name})),this.shareOptionConfig.shared=!0,this.shareOptionConfig.linkLabel="分享链接",this.setShareLink(this.getShareLink(this.file.shareId)),this.shareOption.isPrivacy=this.file.isPrivacy,this.shareOption.operationPermissionList=this.file.operationPermissionList||[],this.file.expireDate&&(this.shareOption.expiresDate=r()(this.file.expireDate).format("x")),this.shareOption.expiresDateOption=2,this.extractionCode=this.file.extractionCode):(this.shareOptionConfig.shared=!1,this.shareOptionConfig.linkLabel="选择有效期",this.shareOption.isPrivacy=!1,this.shareOption.expiresDate=null,this.shareOption.expiresDateOption=1))}},methods:{permissionActionChange:function(){this.createShare()},setShareLink:function(e){var t=this;this.shareLink=e,p.a.toDataURL(e).then((function(e){t.qrCodeshareLink=e})).catch((function(e){console.error(e)}))},shareDialogClose:function(){this.shareOptionConfig.shared=!1,this.$emit("update:status",this.shareDialogVisible)},expiresDateOptionChange:function(){var e=this;2===this.shareOption.expiresDateOption&&this.$nextTick((function(){e.$refs.expiresDatePicker.focus()}))},pickerChange:function(e){e<(new Date).getTime()&&(this.shareOption.expiresDate=null),this.shareOptionConfig.shared&&this.createShare(!0)},submitShare:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.shareOption.operationPermissionList=void 0,e.createShare()}))},timeFormat:function(e){return r()(e).format("yyyy-MM-DD HH:mm")},getShareLink:function(e){return window.location.origin+"/s?s="+e},createShare:function(e){var t,i=this;switch(this.generateShareLinkLoading=!0,this.shareOption.expiresDateOption){case 0:var n=(new Date).getTime()+2592e6;t=this.timeFormat(n),this.shareOption.expiresDate=n;break;case 2:this.shareOption.expiresDate&&(t=this.timeFormat(this.shareOption.expiresDate))}l["a"].generate({userId:this.$store.state.user.userId,fileId:this.file.fileId,isFolder:this.file.isFolder,expireDate:t,isPrivacy:this.shareOption.isPrivacy,operationPermissionList:this.shareOption.operationPermissionList}).then((function(n){if(n.data){var a=n.data,o=a.shareId,r=a.extractionCode,s=a.operationPermissionList;i.setShareLink(i.getShareLink(o)),i.generateShareLinkLoading=!1,i.shareOptionConfig.shared=!0,i.shareOption.expiresDateOption=2,i.shareOptionConfig.linkLabel="分享链接",i.extractionCode=r,i.shareOption.operationPermissionList=s||[],i.$emit("onSuccess",o),e&&(t||(t="永久有效"),i.$emit("onUpdateExpireData",o,t),i.$message({duration:3e3,dangerouslyUseHTMLString:!0,iconClass:"el-icon-success",message:"<strong>&nbsp;&nbsp;有效期已设置为: <span>"+t+"</span> </strong>"}))}})).catch((function(){i.generateShareLinkLoading=!1}))},copyShareLink:function(e){var t=this,i=new d.a(".tag-share-link");i.on("success",(function(n){t.$message({message:e,type:"success",duration:3e3}),i.destroy()})),i.on("error",(function(e){t.$message({message:"该浏览器不支持自动复制",type:"warning",duration:1e3}),i.destroy()}))}}},m=f,g=(i("84a7"),i("2877")),v=Object(g["a"])(m,n,a,!1,null,"0865bea8",null);t["a"]=v.exports},dd9d:function(e,t,i){},ddb3:function(e,t,i){},ddfe:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("log-list",{attrs:{type:"LOGIN","table-header":e.tableHeader}})],1)},a=[],o=i("4d8d"),r={components:{LogList:o["default"]},data:function(){return{tableHeader:[{prop:"username",label:"账号",sortable:"custom"},{prop:"showName",label:"用户名",sortable:"custom"},{prop:"ip",label:"IP地址",sortable:"custom"},{prop:"deviceModel",label:"设备型号",sortable:"custom"},{prop:"operatingSystem",label:"操作系统",sortable:"custom"},{prop:"browser",label:"浏览器",sortable:"custom"},{prop:"status",minWidth:80,label:"状态",tag:!0,formatData:function(e){return 0===e?[{name:"登录成功",type:"success"}]:[{name:"登录失败",type:"danger"}]}},{prop:"remarks",label:"备注",sortable:"custom"},{prop:"createTime",label:"创建时间",minWidth:150,sortable:"custom"}]}}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"02daad4f",null);t["default"]=c.exports},de32:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{queryFileType:"image",orderCustom:!0,sortable:e.sortable,queryCondition:e.queryCondition,emptyStatus:"还没有图片呢~"}})],1)},a=[],o=i("c41c"),r={components:{ShowFile:o["default"]},data:function(){return{sortable:{prop:"updateDate",order:"descending"},queryCondition:{isFolder:!1}}}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"75bb1bd0",null);t["default"]=c.exports},dee2:function(e,t,i){},e053:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{defaultGrid:!0,orderCustom:!0,sortable:e.sortable,queryCondition:e.queryCondition,showNavigation:!0}})],1)},a=[],o=i("c41c"),r={components:{ShowFile:o["default"]},data:function(){return{sortable:{prop:"updateDate",order:"descending"},queryCondition:{isFolder:!1}}}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"893c4cf8",null);t["default"]=c.exports},e054:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("show-file",{attrs:{queryFileType:"audio",orderCustom:!0,defaultGrid:!0,sortable:e.sortable,queryCondition:e.queryCondition,singleFileType:"音乐",emptyStatus:"还没有音乐呢~"}})],1)},a=[],o=i("c41c"),r={components:{ShowFile:o["default"]},data:function(){return{sortable:{prop:"updateDate",order:"descending"},queryCondition:{isFolder:!1}}}},s=r,l=i("2877"),c=Object(l["a"])(s,n,a,!1,null,"0ed7f2c0",null);t["default"]=c.exports},e222:function(e,t,i){"use strict";i("b54d")},e874:function(e,t,i){"use strict";i("4108")},ebc4:function(e,t,i){},ec0f:function(e,t,i){},ed66:function(e,t,i){},eea1:function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("el-select",{ref:"treeSelect",attrs:{size:e.size,clearable:e.clearable,multiple:"","collapse-tags":e.collapseTags,placeholder:e.placeholder},on:{clear:e.clearHandle,"remove-tag":e.removeTag},model:{value:e.valueTitles,callback:function(t){e.valueTitles=t},expression:"valueTitles"}},[e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),t("el-tree",{ref:"selectTree",staticClass:"multiple-tree",attrs:{"node-key":"id",data:e.options,props:e.props,"icon-class":"-","check-on-click-node":!0,"expand-on-click-node":!1,"check-strictly":!0,"highlight-current":!1,"default-expand-all":"","default-checked-keys":e.value,"show-checkbox":""},on:{check:e.selectNode}})],2)},a=[],o=(i("7f7f"),{name:"MultipleTreeSelect",props:{props:{type:Object,default:function(){return{value:"id",label:"name",children:"children"}}},options:{type:Array,default:function(){return[]}},value:{type:Array,default:function(){return[]}},clearable:{type:Boolean,default:function(){return!0}},accordion:{type:Boolean,default:function(){return!1}},placeholder:{type:String,default:function(){return"请选择"}},size:{type:String,default:"small"},collapseTags:{type:Boolean,default:function(){return!1}},selectPackUp:{type:Boolean,default:function(){return!1}}},data:function(){return{valueIds:this.value,valueTitles:[],data:[]}},mounted:function(){this.initHandle()},methods:{initHandle:function(){var e=this;this.valueIds?this.$nextTick((function(){e.$refs.selectTree.setCheckedKeys(e.valueIds);var t=e;setTimeout((function(){t.valueIds.length>0?t.valueTitles=t.$refs.selectTree.getCheckedNodes().map((function(e){return e.name})):t.valueTitles=[]}),100)})):this.valueTitles=[]},selectNode:function(e,t){this.valueIds=t.checkedKeys,this.$emit("input",this.valueIds),this.selectPackUp&&this.$refs.treeSelect.blur()},removeTag:function(e){this.valueTitles=this.valueTitles.filter((function(t){return t!==e}));var t=this.$refs.selectTree.getCheckedKeys(),i=this.$refs.selectTree.getCheckedNodes().filter((function(t){return t.name===e}))[0].id;t=t.filter((function(e){return e!==i})),this.valueIds=t,this.$refs.selectTree.setCheckedKeys(t),this.$emit("input",this.valueIds)},clearHandle:function(){this.valueTitles=[],this.valueIds=[],this.$refs.selectTree.setCheckedKeys([]),this.$emit("input",this.valueIds)}},watch:{value:function(e){this.valueIds=e,this.initHandle()}}}),r=o,s=(i("82ca"),i("2877")),l=Object(s["a"])(r,n,a,!1,null,"39fc518d",null);t["a"]=l.exports},f2c7:function(e,t,i){},f2e7:function(e,t,i){},f406:function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload-input-image"},[t("el-row",[t("el-col",{attrs:{xs:24}},[t("select-file",{attrs:{title:"选择图片",visible:e.dialogSelectFile},on:{select:e.selectedFile,"update:visible":function(t){e.dialogSelectFile=t}}}),e._v(" "),t("div",{staticClass:"upload"},[e.enableSelect?t("el-button",{staticClass:"upload-select-btn",attrs:{title:"选择文件",type:"primary",size:"small",icon:"el-icon-folder",circle:""},on:{click:function(t){e.dialogSelectFile=!0}}}):e._e(),e._v(" "),t("el-upload",{ref:"uploadRef",staticClass:"upload",attrs:{action:"/api/upload-markdown-image",headers:e.headers,data:e.extraData,name:"files",accept:e.accept,"show-file-list":!1,"file-list":e.fileList,limit:1,"before-upload":e.handleBeforeUpload,"on-success":e.handleSuccess,"on-remove":e.handleFileListRemove,"on-progress":e.handleProgress}},[t("el-button",{attrs:{title:"上传",type:"primary",size:"small",icon:"el-icon-upload2",circle:""}}),e._v(" "),e.desc.length>0?t("span",[e._v(e._s(e.desc))]):e._e(),e._v(" "),e.uploadState>0?t("div",{staticClass:"url-desc",attrs:{slot:"tip"},slot:"tip"},[t("span",{directives:[{name:"show",rawName:"v-show",value:1===e.uploadState,expression:"uploadState === 1"}]},[e._v("图片上传中"+e._s(e.uploadPercentage)+"%")]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:2===e.uploadState,expression:"uploadState === 2"}]},[e._v("图片上传成功")]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:3===e.uploadState,expression:"uploadState === 3"}]},[e._v("该图片不支持自动上传")]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:4===e.uploadState,expression:"uploadState === 4"}]},[e._v("图片加载中")]),e._v(" "),t("i",{class:{"el-icon-loading":1===e.uploadState||4===e.uploadState,"el-icon-check":2===e.uploadState,"el-icon-warning-outline":3===e.uploadState}})]):e._e()],1)],1)],1),e._v(" "),t("el-col",{attrs:{xs:24}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[t("el-input",{attrs:{autosize:e.intputAutosize,placeholder:(e.enableUrl?"请输入图片的url 或 ":"")+e.placeholder,type:"textarea",width:"100%"},on:{change:e.change,input:e.input,focus:function(t){e.isLocked=!0}},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}}),e._v(" "),t("div",{attrs:{slot:"content"},slot:"content"},[t("el-image",{style:{maxWidth:e.tipImageMaxWidth+"px"},attrs:{src:e.currentValue,fit:"contain"},on:{load:e.loadSuccess}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])],1)],1)],1)],1)],1)},a=[],o=(i("28a5"),i("a481"),i("f559"),i("7f7f"),i("c5f6"),i("5cfc")),r=i("2690"),s=i("8ea6"),l={name:"UploadImageInput",components:{SelectFile:s["a"]},props:{value:{type:String,default:""},accept:{type:String,default:"image/*"},tipImageMaxWidth:{type:Number,default:250},placeholder:{type:String,default:"点击上传"},intputAutosize:{type:Object,default:function(){return{minRows:1,maxRows:6}}},enableSelect:{type:Boolean,default:!0},enableUrl:{type:Boolean,default:!0},desc:{type:String,default:""}},data:function(){return{headers:{"jmal-token":this.$store.state.user.token,name:this.$store.state.user.name,username:this.$store.state.user.name,userId:this.$store.state.user.userId},extraData:{username:this.$store.state.user.name,userId:this.$store.state.user.userId},currentValue:this.value,fileList:[],isLocked:!1,timer:null,uploadState:0,uploadTip:"",dialogSelectFile:!1,uploadPercentage:0}},watch:{value:function(e){this.currentValue=e}},methods:{change:function(e){this.isLocked=!1,this.$emit("input",e)},input:function(e){},selectedFile:function(e){var t=this;o["a"].setPublic({fileId:e.id}).then((function(){t.currentValue=window.location.origin+r["a"].previewUrl(t.$store.state.user.name,e,void 0),t.change(t.currentValue)}))},handleBeforeUpload:function(){this.uploadState=1},handleProgress:function(e,t){this.onpregress(0|t.percentage)},onpregress:function(e){this.uploadPercentage=e},handleSuccess:function(e){0===e.code&&e.data&&e.data.length>0&&this.format(e.data[0].filepath,e.data[0].filename),this.uploadSuccessAfter()},uploadSuccessAfter:function(){this.uploadState=2,this.fileList=[];var e=this;setTimeout((function(){e.uploadState=0}),3e3)},handleFileListRemove:function(e,t){this.fileList=t},format:function(e){this.currentValue=r["a"].markdownPreviewUrl(e),this.change(this.currentValue)},urlToBlob:function(e,t){var i=this,n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="blob",n.onload=function(){200===this.status&&t&&t(this.response)},n.onerror=function(){i.uploadState=3},n.send()},loadSuccess:function(){if(null==this.timer&&this.enableUrl){if(this.isLocked){var e=this;this.timer=setTimeout((function(){e.currentValue.startsWith(window.location.origin)||(e.uploadState=4,e.urlToBlob(e.currentValue,(function(t){e.uploadState=1;var i=e.getFileNameByUrl(e.currentValue);if(t.type.startsWith("image")&&i.indexOf(".")){var n=t.type.replace("image/",".");i+=n}var a=new window.File([t],i,{type:t.type}),o=new FormData;o.append("files",a),o.append("username",e.$store.state.user.name),o.append("userId",e.$store.state.user.userId),e.uploadImage(e,o)})))}),300)}}else clearTimeout(this.timer),this.timer=null},uploadImage:function(e,t){axios.post("/api/upload-markdown-image",t,{headers:{"Content-Type":"multipart/form-data","jmal-token":e.$store.state.user.token,name:e.$store.getters.name},onUploadProgress:function(t){e.onpregress(t.loaded/t.total*100|0)}}).then((function(t){var i=t.data.data[0];e.format(i.filepath,i.filename),e.uploadSuccessAfter(),e.$refs.uploadRef.clearFiles()}))},getFileNameByUrl:function(e){var t=/[a-zA-z]+:\/\/[^\s]*/;if(t.test(e)){e.indexOf("-1")>-1&&(e=e.split("?")[0]);var i=e.split("/");return i[i.length-1]}}}},c=l,d=(i("a221"),i("2877")),u=Object(d["a"])(c,n,a,!1,null,"3670a4e1",null);t["a"]=u.exports},f620:function(e,t,i){"use strict";i.r(t);var n=i("7f3a"),a=(i("7f7f"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-dialog",{staticClass:"dialog-form",attrs:{width:"400px",title:e.dialogTitle,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"managerForm",attrs:{size:"medium","label-width":"90px",model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:"角色名称:",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入角色名称",width:"100%"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"角色标识:",prop:"code"}},[t("el-input",{attrs:{placeholder:"请输入角色标识"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"备注:",prop:"remarks"}},[t("el-input",{attrs:Object(n["a"])(Object(n["a"])({type:"textarea",autosize:""},"autosize",{minRows:3,maxRows:6}),"placeholder","请输入备注"),model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary",loading:e.updateLoading},nativeOn:{click:function(t){return t.preventDefault(),e.onSave()}}},[e._v("保 存")])],1)],1),e._v(" "),t("el-dialog",{attrs:{width:"400px",title:"分配权限",visible:e.dialogAuthVisible},on:{"update:visible":function(t){e.dialogAuthVisible=t}}},[t("el-scrollbar",[t("el-tree",{ref:"authTree",staticStyle:{"max-height":"50vh"},attrs:{data:e.menuList,"check-strictly":!0,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.menuCheckedList,props:{value:"id",label:"name"}}})],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogAuthVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary",loading:e.updateLoading},nativeOn:{click:function(t){return t.preventDefault(),e.saveAuth()}}},[e._v("保 存")])],1)],1),e._v(" "),t("el-card",{staticClass:"box-card table-search-header"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"box-card-header"},[t("el-form",{ref:"queryForm",staticClass:"search-form",attrs:{size:"medium","label-width":"77px",model:e.queryCondition,rules:e.rules}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{sm:12,md:6}},[t("el-form-item",{attrs:{label:"角色名称:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.name,callback:function(t){e.$set(e.queryCondition,"name",t)},expression:"queryCondition.name"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:6}},[t("el-form-item",{attrs:{label:"角色标识:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.code,callback:function(t){e.$set(e.queryCondition,"code",t)},expression:"queryCondition.code"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:5,xl:6}},[t("el-form-item",{attrs:{label:"备注:","label-width":"50px"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.queryCondition.remarks,callback:function(t){e.$set(e.queryCondition,"remarks",t)},expression:"queryCondition.remarks"}})],1)],1),e._v(" "),t("el-col",{attrs:{sm:12,md:7,xl:6}},[t("div",{staticClass:"el-form-actions"},[t("el-button",{staticClass:"card-btn-icon",attrs:{size:"medium",icon:"el-icon-search",type:"primary"},on:{click:function(t){return e.getRoleList()}}},[e._v("查询")]),e._v(" "),t("el-button",{staticClass:"card-btn-icon",attrs:{size:"medium",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.add()}}},[e._v("添加")]),e._v(" "),t("el-button",{staticClass:"card-btn-icon",attrs:{disabled:e.multipleSelection.length<1,size:"medium",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.handleSelectDelete()}}},[e._v("删除")])],1)])],1)],1)],1)]),e._v(" "),t("table-list",{attrs:{"less-client-height":280,tableData:e.dataList,loading:e.loading,tableHeader:e.tableHeader,pagination:e.pagination},on:{pageChange:e.pageChange,sizeChange:e.pageChange,selectFun:e.selectFun,sortChange:e.sortChange}})],1)],1)}),o=[],r=(i("ac6a"),i("20d6"),i("ae4a")),s=(i("96cf"),i("97bf")),l=i("6f8e"),c=i("cc5e"),d=i("1f27"),u=i("7c83"),h={components:{TableList:u["a"]},props:{},data:function(){var e=this;return{title:"角色管理",dataList:[],menuList:[],menuCheckedList:[],loading:!1,dialogVisible:!1,dialogAuthVisible:!1,dialogTitle:"",updateLoading:!1,updateAuthLoading:!1,valid:!0,form:{name:"",code:"",remarks:"",menuIds:[]},pagination:{pageIndex:1,pageSize:15,pageTotal:0},queryCondition:{name:"",code:"",remarks:"",sortProp:"",sortOrder:""},tableHeader:[{prop:"name",label:"角色名称",minWidth:110,sortable:"custom"},{prop:"code",label:"角色标识",minWidth:110,sortable:"custom"},{prop:"remarks",label:"备注",minWidth:110,sortable:"custom"},{prop:"createTime",label:"创建时间",minWidth:110,sortable:"custom"},{label:"操作",minWidth:this.$pc?0:160,active:[{name:"修改",icon:"el-icon-edit",handle:function(t){return e.handleEdit(t.id)}},{name:"分配权限",icon:"el-icon-finished",handle:function(t){return e.authorization(t.id)}}]}],multipleSelection:[],rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],code:[{required:!0,message:"请输入角色标识",trigger:"blur"}]},editMove:1}},computed:{},mounted:function(){this.getRoleList(),this.getMenuTree(),this.resize()},methods:{resize:function(){var e=document.querySelector(".container").clientWidth,t=e<=768;this.tableHeader[2].disabled=t,this.tableHeader[3].disabled=t},selectFun:function(e){this.multipleSelection=e.backData},sortChange:function(e){var t=e.backData;this.queryCondition.sortProp=t.prop,this.queryCondition.sortOrder=t.order,this.getRoleList()},pageChange:function(e){this.pagination=e.backData,this.getRoleList()},getRoleList:function(){var e=this;this.loading=!0,c["a"].roleList(Object(l["a"])({page:this.pagination.pageIndex,pageSize:this.pagination.pageSize},this.queryCondition)).then((function(t){e.dataList=t.data,e.pagination.pageTotal=t.count,e.loading=!1}))},getMenuTree:function(){var e=this;d["a"].menuTree().then((function(t){e.menuList=t.data}))},add:function(){var e=Object(s["a"])(Object(r["a"])().m((function e(){return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return this.dialogVisible=!0,this.dialogTitle="添加角色",this.editMove=1,e.n=1,this.$nextTick();case 1:this.$refs.managerForm.resetFields();case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),setFormData:function(){var e=new FormData;for(var t in this.form)this.form.hasOwnProperty(t)&&e.append(t,this.form[t]);return e.delete("createTime"),e.delete("updateTime"),e},onSave:function(){var e=this;this.$refs.managerForm.validate((function(t){if(e.valid=t,!t)return!1;e.updateLoading=!0,1===e.editMove&&e.addRole(e.setFormData()),2===e.editMove&&e.updateRole(e.setFormData())}))},saveAuth:function(){this.form.menuIds=this.$refs.authTree.getCheckedKeys(),this.updateRole(this.setFormData())},authorization:function(e){i("51ff");this.dialogAuthVisible=!0;var t=this.dataList.findIndex((function(t){return t.id===e})),n=this.dataList[t];this.form=n,this.$refs.authTree?this.$refs.authTree.setCheckedKeys(n.menuIds):this.menuCheckedList=n.menuIds},handleEdit:function(e){this.editMove=2,this.dialogVisible=!0,this.dialogTitle="修改角色";var t=this.dataList.findIndex((function(t){return t.id===e}));this.form=this.dataList[t]},handleSelectDelete:function(){var e=this;this.$confirm("确定要删除选中的角色吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=[];e.multipleSelection.forEach((function(e){t.push(e.id)})),e.deleteRole(t)}))},handleDelete:function(e){var t=this;this.$confirm("确定要删除此角色吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteRole(e)}))},deleteRole:function(e){var t=this;c["a"].delete({roleIds:e}).then((function(){t.onSuccess("删除成功!")})).catch((function(){t.onError()}))},updateRole:function(e){var t=this;c["a"].update(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},addRole:function(e){var t=this;c["a"].add(e).then((function(){t.onSuccess()})).catch((function(){t.onError()}))},onSuccess:function(e){this.getRoleList();var t="保存成功!";e&&(t=e),this.updateLoading=!1,this.dialogVisible=!1,this.dialogAuthVisible=!1,this.$message({message:t,type:"success",duration:1e3})},onError:function(){this.updateLoading=!1}}},p=h,f=(i("3185"),i("2877")),m=Object(f["a"])(p,a,o,!1,null,"4c658264",null);t["default"]=m.exports},f8f5:function(e,t,i){},f969:function(e,t,i){},f9ca:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("select-file",{attrs:{title:"选择头像",visible:e.dialogSelectFile},on:{select:e.selectedFile,"update:visible":function(t){e.dialogSelectFile=t}}}),e._v(" "),t("el-dialog",{staticClass:"dialog-avatar",attrs:{title:"修改头像",visible:e.dialogAvatar},on:{"update:visible":function(t){e.dialogAvatar=t},close:e.handleCloseDialogAvatar}},[t("cropper-dialog",{ref:"cropperDialog",attrs:{"file-img":e.fileImg,"select-img":e.selectedImgRow,avatar:e.userInfo.avatar},on:{noCropSave:e.saveNoCropAvatar,croppedCanvas:e.saveAvatar}})],1),e._v(" "),t("el-dialog",{staticClass:"dialog-cm",attrs:{width:"400px",title:e.passwordFormTitle,visible:e.dialogChangePassword},on:{"update:visible":function(t){e.dialogChangePassword=t}}},[t("el-form",{ref:"passwordForm",attrs:{size:"medium",model:e.passwordForm,rules:e.rules,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.validOldPass,expression:"!validOldPass"}],attrs:{label:"旧密码",prop:"oldPassword"}},[t("el-input",{attrs:{type:"password","show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSavePassword.apply(null,arguments)}},model:{value:e.passwordForm.oldPassword,callback:function(t){e.$set(e.passwordForm,"oldPassword",t)},expression:"passwordForm.oldPassword"}})],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.validOldPass,expression:"validOldPass"}],attrs:{label:"新密码",prop:"password"}},[t("el-input",{ref:"newPasswordInput",attrs:{type:"password","show-password":""},model:{value:e.passwordForm.password,callback:function(t){e.$set(e.passwordForm,"password",t)},expression:"passwordForm.password"}})],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.validOldPass,expression:"validOldPass"}],attrs:{label:"确认新密码",prop:"checkPass"}},[t("el-input",{attrs:{type:"password","show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSavePassword.apply(null,arguments)}},model:{value:e.passwordForm.checkPass,callback:function(t){e.$set(e.passwordForm,"checkPass",t)},expression:"passwordForm.checkPass"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("a",{staticClass:"forget-password",on:{click:e.forget}},[e._v("忘记密码?")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogChangePassword=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",loading:e.userUpdateLoading,type:"primary"},on:{click:e.onSavePassword}},[e._v("确 定")])],1)],1),e._v(" "),t("el-form",{ref:"cusomerInfoForm",attrs:{model:e.cusomerInfoForm,"label-width":"80px"}},[t("el-form-item",{staticClass:"form-item-avatar",attrs:{label:"头像"}},[t("div",{staticStyle:{height:"100px",width:"100px"}},[t("el-avatar",{staticClass:"avatar-value",attrs:{icon:"el-icon-user-solid",shape:"circle",size:100,fit:"fit",src:e.srcImage}})],1),e._v(" "),t("div",{staticClass:"avatar-button"},[t("el-button",{attrs:{title:"选择文件",type:"primary",icon:"el-icon-folder",circle:""},on:{click:e.selectImg}}),e._v(" "),t("el-button",{attrs:{title:"上传",type:"primary",icon:"el-icon-upload2",circle:""},on:{click:e.uploadImg}}),e._v(" "),t("input",{ref:"selectImg",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.changImg}})],1)]),e._v(" "),t("el-form-item",{attrs:{label:"密码"}},[t("el-button",{attrs:{size:"mini",round:""},on:{click:e.changePassword}},[e._v("修改密码")])],1),e._v(" "),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{staticClass:"input-none-width",model:{value:e.cusomerInfoForm.showName,callback:function(t){e.$set(e.cusomerInfoForm,"showName",t)},expression:"cusomerInfoForm.showName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"标语"}},[t("el-input",{staticClass:"form-slogan",model:{value:e.cusomerInfoForm.slogan,callback:function(t){e.$set(e.cusomerInfoForm,"slogan",t)},expression:"cusomerInfoForm.slogan"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"个人简介"}},[t("el-input",{staticClass:"form-slogan",attrs:{type:"textarea"},model:{value:e.cusomerInfoForm.introduction,callback:function(t){e.$set(e.cusomerInfoForm,"introduction",t)},expression:"cusomerInfoForm.introduction"}})],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.percentage>0,expression:"percentage > 0"}],attrs:{label:"使用情况"}},[t("el-progress",{staticClass:"quota-space",attrs:{percentage:e.percentage,format:e.progressFormat,color:e.customColors}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"medium",loading:e.userUpdateLoading},on:{click:e.onSubmit}},[e._v("保 存")])],1)],1)],1)},a=[],o=(i("c5f6"),i("ae4a")),r=(i("6762"),i("2fdb"),i("96cf"),i("97bf")),s=(i("7f7f"),i("c24f")),l=i("7f29"),c=i("74e6"),d=i("8ea6"),u=(i("2690"),{name:"cusomerInfo",components:{CropperDialog:c["a"],SelectFile:d["a"]},props:{},data:function(){var e=this,t=function(t,i,n){""===i?n(new Error("请再次输入密码")):i!==e.passwordForm.password?n(new Error("两次输入密码不一致!")):n()};return{imageUrl:"".concat("/api","/view/thumbnail?jmal-token=").concat(this.$store.state.user.token,"&name=").concat(this.$store.state.user.name,"&id="),title:"个人信息",userUpdateLoading:!1,dialogAvatar:!1,dialogChangePassword:!1,cropper:"",percentage:0,userInfo:{},customColors:[{color:"#f56c6c",percentage:100},{color:"#e6a23c",percentage:80},{color:"#5cb87a",percentage:60},{color:"#1989fa",percentage:40},{color:"#6f7ad3",percentage:20}],cusomerInfoForm:{},passwordForm:{oldPassword:"",password:"",checkPass:""},srcImage:"",fileImg:new Blob,selectedImgRow:{},rules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{min:6,message:"密码不能小于6个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码不能小于6个字符",trigger:"blur"}],checkPass:[{required:!0,validator:t,trigger:"blur"}]},validOldPass:!1,passwordFormTitle:"",dialogSelectFile:!1}},computed:{},mounted:function(){this.getInfo()},methods:{uploadImg:function(){this.$refs.selectImg.click()},selectImg:function(){this.dialogSelectFile=!0},selectedFile:function(e){this.dialogAvatar=!0,this.selectedImgRow=e,this.$refs.cropperDialog&&this.$refs.cropperDialog.setSelectImg(this.selectedImgRow)},handleCloseDialogAvatar:function(){this.$refs.selectImg.value=""},changImg:function(e){var t=e.target.files;t.length<1||(t[0].size/1024/1024>5?this.$message({message:"选择的图片不能超过5M",type:"warning"}):(this.fileImg=t[0],this.dialogAvatar=!0,this.selectedImgRow={},this.$refs.cropperDialog&&this.$refs.cropperDialog.changImg(t[0])))},getInfo:function(){var e=this;Object(s["c"])().then(function(){var t=Object(r["a"])(Object(o["a"])().m((function t(n){return Object(o["a"])().w((function(t){while(1)switch(t.n){case 0:return e.userInfo=n.data,e.userInfo.roles&&e.userInfo.roles.includes("admin")&&e.$emit("isAdmin",!0),t.n=1,e.$nextTick();case 1:e.cusomerInfoForm=e.userInfo,e.srcImage=e.userInfo.avatar?e.imageUrl+e.userInfo.avatar:i("889b");case 2:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}())},changePassword:function(){var e=Object(r["a"])(Object(o["a"])().m((function e(){return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:return this.validOldPass=!1,this.dialogChangePassword=!0,e.n=1,this.$nextTick();case 1:this.passwordFormTitle="旧密码",this.$refs.passwordForm.resetFields();case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onSubmit:function(){this.userUpdate(this.setFormData())},forget:function(){this.$alert("请联系管理员重置密码","提示",{confirmButtonText:"确定"})},onSavePassword:function(){var e=this;this.validOldPass?this.$refs.passwordForm.validate((function(t){if(e.valid=t,t){if(e.validOldPass){e.userUpdateLoading=!0;var i=new FormData;i.append("id",e.$store.state.user.userId),i.append("password",e.passwordForm.password),Object(s["n"])(i).then((function(){e.userUpdateLoading=!1,e.dialogChangePassword=!1})).catch((function(){e.userUpdateLoading=!1}))}return!0}return!1})):(this.userUpdateLoading=!0,Object(s["q"])({id:this.$store.state.user.userId,password:this.passwordForm.oldPassword}).then((function(){e.userUpdateLoading=!1,e.validOldPass=!0,e.passwordFormTitle="新密码";var t=e;setTimeout((function(){t.$refs.newPasswordInput.focus()}))})).catch((function(){e.userUpdateLoading=!1})))},progressFormat:function(){var e=this.userInfo.takeUpSpace/1024/1024/1024,t=this.userInfo.quota;if(e&&t>0){var i=Number((e/t*100).toFixed(1));return this.percentage=i>100?100:i,"".concat(this.percentage,"% (").concat(Object(l["b"])(this.userInfo.takeUpSpace),"/").concat(t,"GB)")}},setFormData:function(){var e=new FormData;for(var t in this.cusomerInfoForm)this.cusomerInfoForm.hasOwnProperty(t)&&"avatar"!==t&&e.append(t,this.cusomerInfoForm[t]);return e.delete("createTime"),e.delete("updateTime"),e},saveAvatar:function(e,t){this.dialogAvatar=!1,this.srcImage=e;var i=new FormData;i.append("id",this.$store.state.user.userId),i.append("blobAvatar",t),this.userUpdate(i,e)},blobToFile:function(e){return new window.File([e],e.name,{type:e.type})},saveNoCropAvatar:function(e){this.dialogAvatar=!1;var t=new FormData;t.append("id",this.$store.state.user.userId),t.append("avatar",e),this.userUpdate(t)},userUpdate:function(e,t){var i=this;this.userUpdateLoading=!0,Object(s["p"])(e).then((function(n){i.userUpdateLoading=!1,i.$message({message:"保存成功!",type:"success",duration:1e3}),(t||n.data)&&(i.srcImage=i.imageUrl+n.data,i.$store.state.user.avatar=n.data),null!=e.get("showName")&&(i.$store.state.user.showName=e.get("showName"))})).catch((function(){i.userUpdateLoading=!1}))}}}),h=u,p=(i("61cb"),i("2877")),f=Object(p["a"])(h,n,a,!1,null,"6dd4da6a",null);t["default"]=f.exports},f9f9:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{staticClass:"dialog-form",attrs:{width:"600px",title:"详情",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"managerForm",attrs:{size:"medium","label-width":"90px",model:e.detailsData}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"操作人:"}},[t("div",[e._v(e._s(e.detailsData.showName)+"("+e._s(e.detailsData.username)+")")])]),e._v(" "),t("el-form-item",{attrs:{label:"操作模块:"}},[t("div",[e._v(e._s(e.detailsData.operationModule))])]),e._v(" "),t("el-form-item",{attrs:{label:"设备型号:"}},[t("div",[e._v(e._s(e.detailsData.deviceModel))])]),e._v(" "),t("el-form-item",{attrs:{label:"浏览器:"}},[t("div",[e._v(e._s(e.detailsData.browser))])]),e._v(" "),t("el-form-item",{attrs:{label:"方式:"}},[t("div",[e._v(e._s(e.detailsData.method))])])],1),e._v(" "),t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"操作时间:"}},[t("div",[e._v(e._s(e.detailsData.createTime))])]),e._v(" "),t("el-form-item",{attrs:{label:"操作功能:"}},[t("div",[e._v(e._s(e.detailsData.operationFun))])]),e._v(" "),t("el-form-item",{attrs:{label:"操作系统:"}},[t("div",[e._v(e._s(e.detailsData.operatingSystem))])]),e._v(" "),t("el-form-item",{attrs:{label:"请求耗时:"}},[t("div",[e._v(e._s(e.detailsData.time)+"ms")])]),e._v(" "),t("el-form-item",{attrs:{label:"请求状态:"}},[t("el-tag",{attrs:{size:"mini",type:0===e.detailsData.status?"success":"danger"}},[e._v("\n              "+e._s(0===e.detailsData.status?"正常":"异常")+"\n            ")])],1)],1)],1),e._v(" "),t("el-divider"),e._v(" "),t("el-row",[t("el-col",[t("el-form-item",{attrs:{label:"IP地址:"}},[t("div",[e._v(e._s(e.detailsData.ip+" "+e.ipInfo))])])],1),e._v(" "),t("el-col",[t("el-form-item",{attrs:{label:"请求地址:"}},[t("div",[e._v(e._s(e.detailsData.url))])])],1),e._v(" "),t("el-col",[t("el-form-item",{attrs:{label:"备注:"}},[t("div",[e._v(e._s(e.detailsData.remarks))])])],1)],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("关闭")])],1)],1),e._v(" "),t("log-list",{attrs:{type:"OPERATION","table-header":e.tableHeader}})],1)},a=[],o=i("4d8d"),r={components:{LogList:o["default"]},data:function(){var e=this;return{tableHeader:[{prop:"username",label:"账号",minWidth:105,sortable:"custom"},{prop:"showName",label:"用户名",minWidth:105,sortable:"custom"},{prop:"ip",label:"IP地址",minWidth:105,sortable:"custom"},{prop:"operationModule",label:"操作模块",minWidth:105,sortable:"custom"},{prop:"operationFun",label:"操作功能",minWidth:105,sortable:"custom"},{prop:"url",label:"请求地址",minWidth:105,sortable:"custom"},{prop:"method",label:"方式",minWidth:75,sortable:"custom"},{prop:"status",minWidth:75,label:"状态",tag:!0,sortable:"custom",formatData:function(e){return 0===e?[{name:"正常",type:"success"}]:[{name:"异常",type:"danger"}]}},{prop:"time",label:"耗时",minWidth:75,sortable:"custom",formatData:function(e){return e+"ms"}},{prop:"createTime",label:"创建时间",minWidth:150,sortable:"custom"},{label:"操作",minWidth:75,active:[{name:"详情",icon:"el-icon-view",handle:function(t){return e.details(t)}}]}],dialogVisible:!1,detailsData:{},ipInfo:{}}},methods:{details:function(e){this.detailsData=e;var t=e.ipInfo;this.ipInfo="",t&&(this.ipInfo="".concat(t.country?t.country+"|":"").concat(t.area?t.area+"|":"").concat(t.province?t.province+"|":"").concat(t.city?t.city+"|":"").concat(t.operators?t.operators:"")),this.dialogVisible=!0}}},s=r,l=(i("1f5c"),i("2877")),c=Object(l["a"])(s,n,a,!1,null,"1141d9cb",null);t["default"]=c.exports},fce2:function(e,t,i){"use strict";i("217e")},fdd2:function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{staticStyle:{"{'padding'":"10px}"},attrs:{title:"图纸信息",visible:e.status,top:"7.5vh",width:"80%","close-on-click-modal":!1,footer:null,"before-close":e.handleClose},on:{"update:visible":function(t){e.status=t}}},[t("ForgeViewer",{ref:"forgeViewer",attrs:{file:e.file,isTogether:e.isTogether,spaceFlag:e.spaceFlag},on:{"update:isTogether":function(t){e.isTogether=t},"update:is-together":function(t){e.isTogether=t}}})],1)],1)},a=[],o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"containerl"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showViewer,expression:"showViewer"}],staticClass:"mt-2"},[e._m(0)]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loader,expression:"loader"}],attrs:{"element-loading-text":e.loaderMessage,"element-loading-spinner":e.loaderIcon,"element-loading-background":"rgba(0, 0, 0, 0.8)"}},[t("div",{attrs:{id:"forgeViewer"}}),e._v(" "),t("div",{staticClass:"mt-3 d-flex justify-center"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showViewer,expression:"showViewer"}],staticClass:"mr-2 text-white",attrs:{id:"lockCameraBtn",type:"danger",width:"150"}},[e._v("\n        Lock Camera\n      ")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showViewer,expression:"showViewer"}],staticClass:"ml-2 text-white",attrs:{id:"UnlockCameraBtn",type:"primary",width:"150"}},[e._v("\n        Unlock Camera\n      ")])],1)])])},r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex justify-space-between"},[t("span",{staticClass:"font-weight-bold text-uppercase text-grey-darken-2"},[e._v("\n        Items Selected: "),t("span",{staticClass:"text-red-darken-2",attrs:{id:"items-selected"}},[e._v("0")])]),e._v(" "),t("span",{staticClass:"font-weight-bold text-uppercase text-grey-darken-2"},[e._v("\n        Navigation Tool: "),t("span",{staticClass:"text-red-darken-2",attrs:{id:"navigation-tool"}},[e._v("orbit")])])])}],s=i("6f8e"),l=(i("6b54"),i("34ef"),i("7f7f"),i("ae4a")),c=(i("96cf"),i("97bf")),d=i("2f62"),u=i("b639"),h=i("4328"),p=null,f=null,m=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t,i){var n,a,o,r,s;return Object(l["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return n=btoa("".concat(t,":").concat(i)),a=h.stringify({grant_type:"client_credentials",scope:"data:read data:write data:create bucket:create bucket:read bucket:delete"}),o={method:"post",maxBodyLength:1/0,url:"https://developer.api.autodesk.com/authentication/v2/token",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic ".concat(n)},data:a},e.p=1,e.n=2,axios.request(o);case 2:return r=e.v,e.n=3,r.data.access_token;case 3:return p=e.v,e.a(2,p);case 4:return e.p=4,s=e.v,console.log(s.message),e.a(2,{error:s.message})}}),e,null,[[1,4]])})));return function(t,i){return e.apply(this,arguments)}}(),g=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t,i){var n,a,o;return Object(l["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return n={method:"get",url:"https://developer.api.autodesk.com/oss/v2/buckets/".concat(t,"/objects/").concat(i,"/signeds3upload"),headers:{Authorization:"Bearer ".concat(p)}},e.p=1,e.n=2,axios.request(n);case 2:return a=e.v,e.n=3,a.data;case 3:return e.a(2,e.v);case 4:return e.p=4,o=e.v,e.a(2,{error:o})}}),e,null,[[1,4]])})));return function(t,i){return e.apply(this,arguments)}}(),v=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t,i){var n,a,o;return Object(l["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return n={method:"put",url:t,headers:{"Content-Type":"application/octet-stream"},data:i},e.p=1,e.n=2,axios.request(n);case 2:return a=e.v,e.a(2,a.data);case 3:e.p=3,o=e.v,console.log(o);case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(t,i){return e.apply(this,arguments)}}(),b=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t,i,n){var a,o,r,s;return Object(l["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return a=JSON.stringify({uploadKey:n}),o={method:"post",url:"https://developer.api.autodesk.com/oss/v2/buckets/".concat(t,"/objects/").concat(i,"/signeds3upload"),headers:{Authorization:"Bearer ".concat(p),"Content-Type":"application/json","x-ads-meta-Content-Type":"application/octet-stream"},data:a},e.p=1,e.n=2,axios.request(o);case 2:return r=e.v,e.a(2,r.data);case 3:e.p=3,s=e.v,console.log(s);case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(t,i,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t,i,n){var a,o,r,s;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,g(t,i);case 1:return a=e.v,o=a.urls,r=a.uploadKey,e.n=2,v(o[0],n);case 2:return e.n=3,b(t,i,r);case 3:return s=e.v,e.a(2,s)}}),e)})));return function(t,i,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t,i){var n,a,o;return Object(l["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return n={method:"delete",url:"https://developer.api.autodesk.com/oss/v2/buckets/".concat(t,"/objects/").concat(i),headers:{Authorization:"Bearer ".concat(p)}},e.p=1,e.n=2,axios.request(n);case 2:a=e.v,console.log(a.data),e.n=4;break;case 3:e.p=3,o=e.v,console.log(o);case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(t,i){return e.apply(this,arguments)}}(),x=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t){var i,n,a,o;return Object(l["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return i=JSON.stringify({input:{urn:t},output:{formats:[{type:"svf",views:["2d","3d"]}]}}),n={method:"post",maxBodyLength:1/0,url:"https://developer.api.autodesk.com/modelderivative/v2/designdata/job",headers:{Authorization:"Bearer ".concat(p),"Content-Type":"application/json","x-ads-force":"false"},data:i},e.p=1,e.n=2,axios.request(n);case 2:return a=e.v,e.a(2,a.data);case 3:return e.p=3,o=e.v,e.a(2,{error:o})}}),e,null,[[1,3]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t){var i,n,a;return Object(l["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return i={method:"get",maxBodyLength:1/0,url:"https://developer.api.autodesk.com/modelderivative/v2/designdata/".concat(t,"/manifest"),headers:{Authorization:"Bearer ".concat(p)}},e.p=1,e.n=2,axios.request(i);case 2:return n=e.v,e.a(2,n.data);case 3:return e.p=3,a=e.v,e.a(2,{error:a})}}),e,null,[[1,3]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(){var t;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:t={env:"AutodeskProduction2",api:"streamingV2",accessToken:p},Autodesk.Viewing.Initializer(t,(function(){var e={extensions:["AwesomeExtension","EventReactExtension","ToolbarExtension"]},t=document.getElementById("forgeViewer");f=new Autodesk.Viewing.GuiViewer3D(t,e);var i=f.start();i>0?console.error("Failed to Initialize Forge Viewer!"):console.log("Autodesk Forge Initialization Completed Successfully!")}));case 1:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t){var i,n,a;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:a=function(){console.error("Failed fetch Forge manifest")},n=function(e){var t=e.getRoot().getDefaultGeometry();f.loadDocumentNode(e,t)},i="urn:".concat(t),Autodesk.Viewing.Document.load(i,n,a);case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=i("2690"),L={props:{file:{type:Object,default:function(){return{}}},status:{type:Boolean,default:!1},isTogether:{type:Boolean,default:function(){return!1}},spaceFlag:{type:String,default:void 0}},components:{},data:function(){return{loader:!0,loaderMessage:"正在初始化视窗...",loaderIcon:"el-icon-message-solid",showViewer:!1,translationStatus:"",selectedFile:null,fileUrl:"",objectId:"",objectKey:""}},mounted:function(){var e=Object(c["a"])(Object(l["a"])().m((function e(){return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.genView();case 1:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{genView:function(){var e=Object(c["a"])(Object(l["a"])().m((function e(){return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.init();case 1:return e.n=2,this.addFile();case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),init:function(){var e=Object(c["a"])(Object(l["a"])().m((function e(){return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,m("SJEVtYcdw2XfDwcCsJVBy1ctAAYm1mMqNyIxguxplCTtaD6B","Cl7SMY6vSqtCzle7hTGOOdKla319LobfwRqqEKy5PXcUmfh4AlS2wCbO4IXrNsbE");case 1:return e.n=2,k();case 2:return e.a(2)}}),e)})));function t(){return e.apply(this,arguments)}return t}(),addFile:function(){var e=Object(c["a"])(Object(l["a"])().m((function e(){var t,i,n=this;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return t=this,this.fileUrl=window.location.origin+S["a"].previewUrl(this.$store.state.user.name,t.$props.file,this.$store.getters.token),e.n=1,fetch(this.fileUrl).then((function(e){return e.blob()})).then((function(e){t.selectedFile=new File([e],t.$props.file.name,{type:t.$props.file.contentType})})).catch((function(e){console.error("Fetch error:",e)}));case 1:i=new FileReader,i.onload=function(){var e=Object(c["a"])(Object(l["a"])().m((function e(i){var a,o;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return a=new Uint8Array(i.target.result),e.n=1,w("xdzncloud",t.$props.file.name,a);case 1:if(o=e.v,!o.objectId){e.n=2;break}return t.objectId=o.objectId,t.objectKey=o.objectKey,e.n=2,n.PrepareModelForViewer(t.objectId);case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.readAsArrayBuffer(t.selectedFile);case 2:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),PrepareModelForViewer:function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t){var i,n,a,o=this;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return i=u["Buffer"].from(t).toString("base64"),e.n=1,x(i);case 1:n=e.v,"created"===n.result?this._viewModel(i):"success"===n.result?a=setInterval(Object(c["a"])(Object(l["a"])().m((function e(){var t;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,C(i);case 1:t=e.v,o.translationStatus=t.status,o.loaderMessage="转码进度: "+t.progress,"success"===o.translationStatus?(clearInterval(a),setTimeout((function(){o._viewModel(i)}),2e3)):"failed"!==o.translationStatus&&"timeout"!==o.translationStatus||(console.log("Translation Model Status",o.translationStatus),o.loaderMessage="Translation Model Status："+o.translationStatus,clearInterval(a));case 2:return e.a(2)}}),e)}))),2500):(this.loaderMessage="无法转码该格式的模型",this.loaderIcon="el-icon-error");case 2:return e.a(2)}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),_viewModel:function(){var e=Object(c["a"])(Object(l["a"])().m((function e(t){var i;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return this.showViewer=!0,this.loaderMessage="正在渲染模型...",e.n=1,_(t);case 1:if(this.loader=!1,i=document.querySelector(".adsk-viewing-viewer"),i){e.n=2;break}return e.a(2);case 2:i.style.maxHeight="775px",i.style.position="relative";case 3:return e.a(2)}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),DeleteModel:function(){y("xdzncloud",this.objectKey)}},computed:Object(s["a"])({},Object(d["c"])(["blueColor","redColor"]))},T=L,D=(i("0fd6"),i("2877")),E=Object(D["a"])(T,o,r,!1,null,null,null),F=E.exports,I={name:"CadPreview",components:{ForgeViewer:F},props:{file:{type:Object,default:function(){return{}}},status:{type:Boolean,default:!1},isTogether:{type:Boolean,default:function(){return!1}},spaceFlag:{type:String,default:void 0}},data:function(){return{}},mounted:function(){console.log(this.file)},methods:{handleClose:function(){this.$refs.forgeViewer.DeleteModel(),this.$emit("closeDialog")}}},M=I,N=Object(D["a"])(M,n,a,!1,null,"4d4dedd5",null);t["a"]=N.exports},fea9:function(e,t,i){},ff41:function(e,t,i){!function(t,i){e.exports=i()}(0,(function(){return(()=>{var e={14:e=>{var t=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},i=-1;t.Diff=function(e,t){return[e,t]},t.prototype.diff_main=function(e,i,n,a){void 0===a&&(a=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var o=a;if(null==e||null==i)throw new Error("Null input. (diff_main)");if(e==i)return e?[new t.Diff(0,e)]:[];void 0===n&&(n=!0);var r=n,s=this.diff_commonPrefix(e,i),l=e.substring(0,s);e=e.substring(s),i=i.substring(s),s=this.diff_commonSuffix(e,i);var c=e.substring(e.length-s);e=e.substring(0,e.length-s),i=i.substring(0,i.length-s);var d=this.diff_compute_(e,i,r,o);return l&&d.unshift(new t.Diff(0,l)),c&&d.push(new t.Diff(0,c)),this.diff_cleanupMerge(d),d},t.prototype.diff_compute_=function(e,n,a,o){var r;if(!e)return[new t.Diff(1,n)];if(!n)return[new t.Diff(i,e)];var s=e.length>n.length?e:n,l=e.length>n.length?n:e,c=s.indexOf(l);if(-1!=c)return r=[new t.Diff(1,s.substring(0,c)),new t.Diff(0,l),new t.Diff(1,s.substring(c+l.length))],e.length>n.length&&(r[0][0]=r[2][0]=i),r;if(1==l.length)return[new t.Diff(i,e),new t.Diff(1,n)];var d=this.diff_halfMatch_(e,n);if(d){var u=d[0],h=d[1],p=d[2],f=d[3],m=d[4],g=this.diff_main(u,p,a,o),v=this.diff_main(h,f,a,o);return g.concat([new t.Diff(0,m)],v)}return a&&e.length>100&&n.length>100?this.diff_lineMode_(e,n,o):this.diff_bisect_(e,n,o)},t.prototype.diff_lineMode_=function(e,n,a){var o=this.diff_linesToChars_(e,n);e=o.chars1,n=o.chars2;var r=o.lineArray,s=this.diff_main(e,n,!1,a);this.diff_charsToLines_(s,r),this.diff_cleanupSemantic(s),s.push(new t.Diff(0,""));for(var l=0,c=0,d=0,u="",h="";l<s.length;){switch(s[l][0]){case 1:d++,h+=s[l][1];break;case i:c++,u+=s[l][1];break;case 0:if(c>=1&&d>=1){s.splice(l-c-d,c+d),l=l-c-d;for(var p=this.diff_main(u,h,!1,a),f=p.length-1;f>=0;f--)s.splice(l,0,p[f]);l+=p.length}d=0,c=0,u="",h=""}l++}return s.pop(),s},t.prototype.diff_bisect_=function(e,n,a){for(var o=e.length,r=n.length,s=Math.ceil((o+r)/2),l=s,c=2*s,d=new Array(c),u=new Array(c),h=0;h<c;h++)d[h]=-1,u[h]=-1;d[l+1]=0,u[l+1]=0;for(var p=o-r,f=p%2!=0,m=0,g=0,v=0,b=0,w=0;w<s&&!((new Date).getTime()>a);w++){for(var y=-w+m;y<=w-g;y+=2){for(var x=l+y,C=(T=y==-w||y!=w&&d[x-1]<d[x+1]?d[x+1]:d[x-1]+1)-y;T<o&&C<r&&e.charAt(T)==n.charAt(C);)T++,C++;if(d[x]=T,T>o)g+=2;else if(C>r)m+=2;else if(f&&(S=l+p-y)>=0&&S<c&&-1!=u[S]&&T>=(_=o-u[S]))return this.diff_bisectSplit_(e,n,T,C,a)}for(var k=-w+v;k<=w-b;k+=2){for(var _,S=l+k,L=(_=k==-w||k!=w&&u[S-1]<u[S+1]?u[S+1]:u[S-1]+1)-k;_<o&&L<r&&e.charAt(o-_-1)==n.charAt(r-L-1);)_++,L++;if(u[S]=_,_>o)b+=2;else if(L>r)v+=2;else if(!f){var T;if((x=l+p-k)>=0&&x<c&&-1!=d[x])if(C=l+(T=d[x])-x,T>=(_=o-_))return this.diff_bisectSplit_(e,n,T,C,a)}}}return[new t.Diff(i,e),new t.Diff(1,n)]},t.prototype.diff_bisectSplit_=function(e,t,i,n,a){var o=e.substring(0,i),r=t.substring(0,n),s=e.substring(i),l=t.substring(n),c=this.diff_main(o,r,!1,a),d=this.diff_main(s,l,!1,a);return c.concat(d)},t.prototype.diff_linesToChars_=function(e,t){var i=[],n={};function a(e){for(var t="",a=0,r=-1,s=i.length;r<e.length-1;){-1==(r=e.indexOf("\n",a))&&(r=e.length-1);var l=e.substring(a,r+1);(n.hasOwnProperty?n.hasOwnProperty(l):void 0!==n[l])?t+=String.fromCharCode(n[l]):(s==o&&(l=e.substring(a),r=e.length),t+=String.fromCharCode(s),n[l]=s,i[s++]=l),a=r+1}return t}i[0]="";var o=4e4,r=a(e);return o=65535,{chars1:r,chars2:a(t),lineArray:i}},t.prototype.diff_charsToLines_=function(e,t){for(var i=0;i<e.length;i++){for(var n=e[i][1],a=[],o=0;o<n.length;o++)a[o]=t[n.charCodeAt(o)];e[i][1]=a.join("")}},t.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var i=0,n=Math.min(e.length,t.length),a=n,o=0;i<a;)e.substring(o,a)==t.substring(o,a)?o=i=a:n=a,a=Math.floor((n-i)/2+i);return a},t.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var i=0,n=Math.min(e.length,t.length),a=n,o=0;i<a;)e.substring(e.length-a,e.length-o)==t.substring(t.length-a,t.length-o)?o=i=a:n=a,a=Math.floor((n-i)/2+i);return a},t.prototype.diff_commonOverlap_=function(e,t){var i=e.length,n=t.length;if(0==i||0==n)return 0;i>n?e=e.substring(i-n):i<n&&(t=t.substring(0,i));var a=Math.min(i,n);if(e==t)return a;for(var o=0,r=1;;){var s=e.substring(a-r),l=t.indexOf(s);if(-1==l)return o;r+=l,0!=l&&e.substring(a-r)!=t.substring(0,r)||(o=r,r++)}},t.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var i=e.length>t.length?e:t,n=e.length>t.length?t:e;if(i.length<4||2*n.length<i.length)return null;var a=this;function o(e,t,i){for(var n,o,r,s,l=e.substring(i,i+Math.floor(e.length/4)),c=-1,d="";-1!=(c=t.indexOf(l,c+1));){var u=a.diff_commonPrefix(e.substring(i),t.substring(c)),h=a.diff_commonSuffix(e.substring(0,i),t.substring(0,c));d.length<h+u&&(d=t.substring(c-h,c)+t.substring(c,c+u),n=e.substring(0,i-h),o=e.substring(i+u),r=t.substring(0,c-h),s=t.substring(c+u))}return 2*d.length>=e.length?[n,o,r,s,d]:null}var r,s,l,c,d,u=o(i,n,Math.ceil(i.length/4)),h=o(i,n,Math.ceil(i.length/2));return u||h?(r=h?u&&u[4].length>h[4].length?u:h:u,e.length>t.length?(s=r[0],l=r[1],c=r[2],d=r[3]):(c=r[0],d=r[1],s=r[2],l=r[3]),[s,l,c,d,r[4]]):null},t.prototype.diff_cleanupSemantic=function(e){for(var n=!1,a=[],o=0,r=null,s=0,l=0,c=0,d=0,u=0;s<e.length;)0==e[s][0]?(a[o++]=s,l=d,c=u,d=0,u=0,r=e[s][1]):(1==e[s][0]?d+=e[s][1].length:u+=e[s][1].length,r&&r.length<=Math.max(l,c)&&r.length<=Math.max(d,u)&&(e.splice(a[o-1],0,new t.Diff(i,r)),e[a[o-1]+1][0]=1,o--,s=--o>0?a[o-1]:-1,l=0,c=0,d=0,u=0,r=null,n=!0)),s++;for(n&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),s=1;s<e.length;){if(e[s-1][0]==i&&1==e[s][0]){var h=e[s-1][1],p=e[s][1],f=this.diff_commonOverlap_(h,p),m=this.diff_commonOverlap_(p,h);f>=m?(f>=h.length/2||f>=p.length/2)&&(e.splice(s,0,new t.Diff(0,p.substring(0,f))),e[s-1][1]=h.substring(0,h.length-f),e[s+1][1]=p.substring(f),s++):(m>=h.length/2||m>=p.length/2)&&(e.splice(s,0,new t.Diff(0,h.substring(0,m))),e[s-1][0]=1,e[s-1][1]=p.substring(0,p.length-m),e[s+1][0]=i,e[s+1][1]=h.substring(m),s++),s++}s++}},t.prototype.diff_cleanupSemanticLossless=function(e){function i(e,i){if(!e||!i)return 6;var n=e.charAt(e.length-1),a=i.charAt(0),o=n.match(t.nonAlphaNumericRegex_),r=a.match(t.nonAlphaNumericRegex_),s=o&&n.match(t.whitespaceRegex_),l=r&&a.match(t.whitespaceRegex_),c=s&&n.match(t.linebreakRegex_),d=l&&a.match(t.linebreakRegex_),u=c&&e.match(t.blanklineEndRegex_),h=d&&i.match(t.blanklineStartRegex_);return u||h?5:c||d?4:o&&!s&&l?3:s||l?2:o||r?1:0}for(var n=1;n<e.length-1;){if(0==e[n-1][0]&&0==e[n+1][0]){var a=e[n-1][1],o=e[n][1],r=e[n+1][1],s=this.diff_commonSuffix(a,o);if(s){var l=o.substring(o.length-s);a=a.substring(0,a.length-s),o=l+o.substring(0,o.length-s),r=l+r}for(var c=a,d=o,u=r,h=i(a,o)+i(o,r);o.charAt(0)===r.charAt(0);){a+=o.charAt(0),o=o.substring(1)+r.charAt(0),r=r.substring(1);var p=i(a,o)+i(o,r);p>=h&&(h=p,c=a,d=o,u=r)}e[n-1][1]!=c&&(c?e[n-1][1]=c:(e.splice(n-1,1),n--),e[n][1]=d,u?e[n+1][1]=u:(e.splice(n+1,1),n--))}n++}},t.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,t.whitespaceRegex_=/\s/,t.linebreakRegex_=/[\r\n]/,t.blanklineEndRegex_=/\n\r?\n$/,t.blanklineStartRegex_=/^\r?\n\r?\n/,t.prototype.diff_cleanupEfficiency=function(e){for(var n=!1,a=[],o=0,r=null,s=0,l=!1,c=!1,d=!1,u=!1;s<e.length;)0==e[s][0]?(e[s][1].length<this.Diff_EditCost&&(d||u)?(a[o++]=s,l=d,c=u,r=e[s][1]):(o=0,r=null),d=u=!1):(e[s][0]==i?u=!0:d=!0,r&&(l&&c&&d&&u||r.length<this.Diff_EditCost/2&&l+c+d+u==3)&&(e.splice(a[o-1],0,new t.Diff(i,r)),e[a[o-1]+1][0]=1,o--,r=null,l&&c?(d=u=!0,o=0):(s=--o>0?a[o-1]:-1,d=u=!1),n=!0)),s++;n&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push(new t.Diff(0,""));for(var n,a=0,o=0,r=0,s="",l="";a<e.length;)switch(e[a][0]){case 1:r++,l+=e[a][1],a++;break;case i:o++,s+=e[a][1],a++;break;case 0:o+r>1?(0!==o&&0!==r&&(0!==(n=this.diff_commonPrefix(l,s))&&(a-o-r>0&&0==e[a-o-r-1][0]?e[a-o-r-1][1]+=l.substring(0,n):(e.splice(0,0,new t.Diff(0,l.substring(0,n))),a++),l=l.substring(n),s=s.substring(n)),0!==(n=this.diff_commonSuffix(l,s))&&(e[a][1]=l.substring(l.length-n)+e[a][1],l=l.substring(0,l.length-n),s=s.substring(0,s.length-n))),a-=o+r,e.splice(a,o+r),s.length&&(e.splice(a,0,new t.Diff(i,s)),a++),l.length&&(e.splice(a,0,new t.Diff(1,l)),a++),a++):0!==a&&0==e[a-1][0]?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,r=0,o=0,s="",l=""}""===e[e.length-1][1]&&e.pop();var c=!1;for(a=1;a<e.length-1;)0==e[a-1][0]&&0==e[a+1][0]&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)==e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),c=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),c=!0)),a++;c&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,t){var n,a=0,o=0,r=0,s=0;for(n=0;n<e.length&&(1!==e[n][0]&&(a+=e[n][1].length),e[n][0]!==i&&(o+=e[n][1].length),!(a>t));n++)r=a,s=o;return e.length!=n&&e[n][0]===i?s:s+(t-r)},t.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,a=/</g,o=/>/g,r=/\n/g,s=0;s<e.length;s++){var l=e[s][0],c=e[s][1].replace(n,"&amp;").replace(a,"&lt;").replace(o,"&gt;").replace(r,"&para;<br>");switch(l){case 1:t[s]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case i:t[s]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:t[s]="<span>"+c+"</span>"}}return t.join("")},t.prototype.diff_text1=function(e){for(var t=[],i=0;i<e.length;i++)1!==e[i][0]&&(t[i]=e[i][1]);return t.join("")},t.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==i&&(t[n]=e[n][1]);return t.join("")},t.prototype.diff_levenshtein=function(e){for(var t=0,n=0,a=0,o=0;o<e.length;o++){var r=e[o][0],s=e[o][1];switch(r){case 1:n+=s.length;break;case i:a+=s.length;break;case 0:t+=Math.max(n,a),n=0,a=0}}return t+Math.max(n,a)},t.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case i:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,n){for(var a=[],o=0,r=0,s=n.split(/\t/g),l=0;l<s.length;l++){var c=s[l].substring(1);switch(s[l].charAt(0)){case"+":try{a[o++]=new t.Diff(1,decodeURI(c))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var d=parseInt(c,10);if(isNaN(d)||d<0)throw new Error("Invalid number in diff_fromDelta: "+c);var u=e.substring(r,r+=d);"="==s[l].charAt(0)?a[o++]=new t.Diff(0,u):a[o++]=new t.Diff(i,u);break;default:if(s[l])throw new Error("Invalid diff operation in diff_fromDelta: "+s[l])}}if(r!=e.length)throw new Error("Delta length ("+r+") does not equal source text length ("+e.length+").");return a},t.prototype.match_main=function(e,t,i){if(null==e||null==t||null==i)throw new Error("Null input. (match_main)");return i=Math.max(0,Math.min(i,e.length)),e==t?0:e.length?e.substring(i,i+t.length)==t?i:this.match_bitap_(e,t,i):-1},t.prototype.match_bitap_=function(e,t,i){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var n=this.match_alphabet_(t),a=this;function o(e,n){var o=e/t.length,r=Math.abs(i-n);return a.Match_Distance?o+r/a.Match_Distance:r?1:o}var r=this.Match_Threshold,s=e.indexOf(t,i);-1!=s&&(r=Math.min(o(0,s),r),-1!=(s=e.lastIndexOf(t,i+t.length))&&(r=Math.min(o(0,s),r)));var l,c,d=1<<t.length-1;s=-1;for(var u,h=t.length+e.length,p=0;p<t.length;p++){for(l=0,c=h;l<c;)o(p,i+c)<=r?l=c:h=c,c=Math.floor((h-l)/2+l);h=c;var f=Math.max(1,i-c+1),m=Math.min(i+c,e.length)+t.length,g=Array(m+2);g[m+1]=(1<<p)-1;for(var v=m;v>=f;v--){var b=n[e.charAt(v-1)];if(g[v]=0===p?(g[v+1]<<1|1)&b:(g[v+1]<<1|1)&b|(u[v+1]|u[v])<<1|1|u[v+1],g[v]&d){var w=o(p,v-1);if(w<=r){if(r=w,!((s=v-1)>i))break;f=Math.max(1,2*i-s)}}}if(o(p+1,i)>r)break;u=g}return s},t.prototype.match_alphabet_=function(e){for(var t={},i=0;i<e.length;i++)t[e.charAt(i)]=0;for(i=0;i<e.length;i++)t[e.charAt(i)]|=1<<e.length-i-1;return t},t.prototype.patch_addContext_=function(e,i){if(0!=i.length){if(null===e.start2)throw Error("patch not initialized");for(var n=i.substring(e.start2,e.start2+e.length1),a=0;i.indexOf(n)!=i.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)a+=this.Patch_Margin,n=i.substring(e.start2-a,e.start2+e.length1+a);a+=this.Patch_Margin;var o=i.substring(e.start2-a,e.start2);o&&e.diffs.unshift(new t.Diff(0,o));var r=i.substring(e.start2+e.length1,e.start2+e.length1+a);r&&e.diffs.push(new t.Diff(0,r)),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+r.length,e.length2+=o.length+r.length}},t.prototype.patch_make=function(e,n,a){var o,r;if("string"==typeof e&&"string"==typeof n&&void 0===a)o=e,(r=this.diff_main(o,n,!0)).length>2&&(this.diff_cleanupSemantic(r),this.diff_cleanupEfficiency(r));else if(e&&"object"==typeof e&&void 0===n&&void 0===a)r=e,o=this.diff_text1(r);else if("string"==typeof e&&n&&"object"==typeof n&&void 0===a)o=e,r=n;else{if("string"!=typeof e||"string"!=typeof n||!a||"object"!=typeof a)throw new Error("Unknown call format to patch_make.");o=e,r=a}if(0===r.length)return[];for(var s=[],l=new t.patch_obj,c=0,d=0,u=0,h=o,p=o,f=0;f<r.length;f++){var m=r[f][0],g=r[f][1];switch(c||0===m||(l.start1=d,l.start2=u),m){case 1:l.diffs[c++]=r[f],l.length2+=g.length,p=p.substring(0,u)+g+p.substring(u);break;case i:l.length1+=g.length,l.diffs[c++]=r[f],p=p.substring(0,u)+p.substring(u+g.length);break;case 0:g.length<=2*this.Patch_Margin&&c&&r.length!=f+1?(l.diffs[c++]=r[f],l.length1+=g.length,l.length2+=g.length):g.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(l,h),s.push(l),l=new t.patch_obj,c=0,h=p,d=u)}1!==m&&(d+=g.length),m!==i&&(u+=g.length)}return c&&(this.patch_addContext_(l,h),s.push(l)),s},t.prototype.patch_deepCopy=function(e){for(var i=[],n=0;n<e.length;n++){var a=e[n],o=new t.patch_obj;o.diffs=[];for(var r=0;r<a.diffs.length;r++)o.diffs[r]=new t.Diff(a.diffs[r][0],a.diffs[r][1]);o.start1=a.start1,o.start2=a.start2,o.length1=a.length1,o.length2=a.length2,i[n]=o}return i},t.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var a=0,o=[],r=0;r<e.length;r++){var s,l,c=e[r].start2+a,d=this.diff_text1(e[r].diffs),u=-1;if(d.length>this.Match_MaxBits?-1!=(s=this.match_main(t,d.substring(0,this.Match_MaxBits),c))&&(-1==(u=this.match_main(t,d.substring(d.length-this.Match_MaxBits),c+d.length-this.Match_MaxBits))||s>=u)&&(s=-1):s=this.match_main(t,d,c),-1==s)o[r]=!1,a-=e[r].length2-e[r].length1;else if(o[r]=!0,a=s-c,d==(l=-1==u?t.substring(s,s+d.length):t.substring(s,u+this.Match_MaxBits)))t=t.substring(0,s)+this.diff_text2(e[r].diffs)+t.substring(s+d.length);else{var h=this.diff_main(d,l,!1);if(d.length>this.Match_MaxBits&&this.diff_levenshtein(h)/d.length>this.Patch_DeleteThreshold)o[r]=!1;else{this.diff_cleanupSemanticLossless(h);for(var p,f=0,m=0;m<e[r].diffs.length;m++){var g=e[r].diffs[m];0!==g[0]&&(p=this.diff_xIndex(h,f)),1===g[0]?t=t.substring(0,s+p)+g[1]+t.substring(s+p):g[0]===i&&(t=t.substring(0,s+p)+t.substring(s+this.diff_xIndex(h,f+g[1].length))),g[0]!==i&&(f+=g[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),o]},t.prototype.patch_addPadding=function(e){for(var i=this.Patch_Margin,n="",a=1;a<=i;a++)n+=String.fromCharCode(a);for(a=0;a<e.length;a++)e[a].start1+=i,e[a].start2+=i;var o=e[0],r=o.diffs;if(0==r.length||0!=r[0][0])r.unshift(new t.Diff(0,n)),o.start1-=i,o.start2-=i,o.length1+=i,o.length2+=i;else if(i>r[0][1].length){var s=i-r[0][1].length;r[0][1]=n.substring(r[0][1].length)+r[0][1],o.start1-=s,o.start2-=s,o.length1+=s,o.length2+=s}return 0==(r=(o=e[e.length-1]).diffs).length||0!=r[r.length-1][0]?(r.push(new t.Diff(0,n)),o.length1+=i,o.length2+=i):i>r[r.length-1][1].length&&(s=i-r[r.length-1][1].length,r[r.length-1][1]+=n.substring(0,s),o.length1+=s,o.length2+=s),n},t.prototype.patch_splitMax=function(e){for(var n=this.Match_MaxBits,a=0;a<e.length;a++)if(!(e[a].length1<=n)){var o=e[a];e.splice(a--,1);for(var r=o.start1,s=o.start2,l="";0!==o.diffs.length;){var c=new t.patch_obj,d=!0;for(c.start1=r-l.length,c.start2=s-l.length,""!==l&&(c.length1=c.length2=l.length,c.diffs.push(new t.Diff(0,l)));0!==o.diffs.length&&c.length1<n-this.Patch_Margin;){var u=o.diffs[0][0],h=o.diffs[0][1];1===u?(c.length2+=h.length,s+=h.length,c.diffs.push(o.diffs.shift()),d=!1):u===i&&1==c.diffs.length&&0==c.diffs[0][0]&&h.length>2*n?(c.length1+=h.length,r+=h.length,d=!1,c.diffs.push(new t.Diff(u,h)),o.diffs.shift()):(h=h.substring(0,n-c.length1-this.Patch_Margin),c.length1+=h.length,r+=h.length,0===u?(c.length2+=h.length,s+=h.length):d=!1,c.diffs.push(new t.Diff(u,h)),h==o.diffs[0][1]?o.diffs.shift():o.diffs[0][1]=o.diffs[0][1].substring(h.length))}l=(l=this.diff_text2(c.diffs)).substring(l.length-this.Patch_Margin);var p=this.diff_text1(o.diffs).substring(0,this.Patch_Margin);""!==p&&(c.length1+=p.length,c.length2+=p.length,0!==c.diffs.length&&0===c.diffs[c.diffs.length-1][0]?c.diffs[c.diffs.length-1][1]+=p:c.diffs.push(new t.Diff(0,p))),d||e.splice(++a,0,c)}}},t.prototype.patch_toText=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e[i];return t.join("")},t.prototype.patch_fromText=function(e){var n=[];if(!e)return n;for(var a=e.split("\n"),o=0,r=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;o<a.length;){var s=a[o].match(r);if(!s)throw new Error("Invalid patch string: "+a[o]);var l=new t.patch_obj;for(n.push(l),l.start1=parseInt(s[1],10),""===s[2]?(l.start1--,l.length1=1):"0"==s[2]?l.length1=0:(l.start1--,l.length1=parseInt(s[2],10)),l.start2=parseInt(s[3],10),""===s[4]?(l.start2--,l.length2=1):"0"==s[4]?l.length2=0:(l.start2--,l.length2=parseInt(s[4],10)),o++;o<a.length;){var c=a[o].charAt(0);try{var d=decodeURI(a[o].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+d)}if("-"==c)l.diffs.push(new t.Diff(i,d));else if("+"==c)l.diffs.push(new t.Diff(1,d));else if(" "==c)l.diffs.push(new t.Diff(0,d));else{if("@"==c)break;if(""!==c)throw new Error('Invalid patch mode "'+c+'" in: '+d)}o++}}return n},(t.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case i:e="-";break;case 0:e=" "}t[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=t,e.exports.diff_match_patch=t,e.exports.DIFF_DELETE=i,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},872:(e,t,i)=>{"use strict";i.d(t,{default:()=>N});var n=i(478),a=i(156),o=i(314),r=i(730),s=i(66),l=i(218),c=i(702),d=function(e){void 0===e&&(e=document);var t=function(e){var t=document.createElement("img");t.src=e.getAttribute("data-src"),t.addEventListener("load",(function(){e.getAttribute("style")||e.getAttribute("class")||e.getAttribute("width")||e.getAttribute("height")||t.naturalHeight>t.naturalWidth&&t.naturalWidth/t.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&t.naturalHeight>window.innerHeight-40&&(e.style.height=window.innerHeight-40+"px"),e.src=t.src})),e.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return e.querySelectorAll("img").forEach((function(e){e.getAttribute("data-src")&&t(e)})),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),e.querySelectorAll("img").forEach((function(e){window.vditorImageIntersectionObserver.observe(e)}))):(window.vditorImageIntersectionObserver=new IntersectionObserver((function(e){e.forEach((function(e){(void 0===e.isIntersecting?0!==e.intersectionRatio:e.isIntersecting)&&e.target.getAttribute("data-src")&&t(e.target)}))})),e.querySelectorAll("img").forEach((function(e){window.vditorImageIntersectionObserver.observe(e)})))},u=i(466),h=i(554),p=i(40),f=i(563),m=i(749),g=i(818),v=i(408),b=i(54),w=i(227),y=i(526),x=i(827),C=i(640),k=i(895),_=i(393),S=function(e,t){if(void 0===t&&(t="zh_CN"),"undefined"!=typeof speechSynthesis&&"undefined"!=typeof SpeechSynthesisUtterance){var i='<svg><use xlink:href="#vditor-icon-play"></use></svg>',n='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||(i='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',n='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var a=document.querySelector(".vditor-speech");if(!a){(a=document.createElement("div")).className="vditor-speech",document.body.insertAdjacentElement("beforeend",a);var o=function(){var e,i;return speechSynthesis.getVoices().forEach((function(n){n.lang===t.replace("_","-")&&(e=n),n.default&&(i=n)})),e||(e=i),e};void 0!==speechSynthesis.onvoiceschanged&&(speechSynthesis.onvoiceschanged=o);var r=o();a.onclick=function(){if("vditor-speech"===a.className){var e=new SpeechSynthesisUtterance(a.getAttribute("data-text"));e.voice=r,e.onend=function(){a.className="vditor-speech",speechSynthesis.cancel(),a.innerHTML=i},speechSynthesis.speak(e),a.className="vditor-speech vditor-speech--current",a.innerHTML=n}else speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),a.innerHTML=n):(speechSynthesis.pause(),a.innerHTML=i));(0,_.Hc)(window.vditorSpeechRange)},document.body.addEventListener("click",(function(){""===getSelection().toString().trim()&&"block"===a.style.display&&(a.className="vditor-speech",speechSynthesis.cancel(),a.style.display="none")}))}e.addEventListener("mouseup",(function(e){var t=getSelection().toString().trim();if(speechSynthesis.cancel(),""!==getSelection().toString().trim()){window.vditorSpeechRange=getSelection().getRangeAt(0).cloneRange();var n=getSelection().getRangeAt(0).getBoundingClientRect();a.innerHTML=i,a.style.display="block",a.style.top=n.top+n.height+document.querySelector("html").scrollTop-20+"px",a.style.left=e.clientX+2+"px",a.setAttribute("data-text",t)}else"block"===a.style.display&&(a.className="vditor-speech",a.style.display="none")}))}},L=function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,s)}l((n=n.apply(e,t||[])).next())}))},T=function(e,t){var i,n,a,o,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!((a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(6===o[0]&&r.label<a[1]){r.label=a[1],a=o;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(o);break}a[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],n=0}finally{i=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},D=function(e){var t={anchor:0,cdn:b.g.CDN,customEmoji:{},emojiPath:(e&&e.emojiPath||b.g.CDN)+"/dist/images/emoji",hljs:b.g.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:b.g.MARKDOWN_OPTIONS,math:b.g.MATH_OPTIONS,mode:"light",speech:{enable:!1},theme:b.g.THEME_OPTIONS};return(0,C.T)(t,e)},E=function(e,t){var i=D(t);return(0,y.G)(i.cdn+"/dist/js/lute/lute.min.js","vditorLuteScript").then((function(){var n=(0,k.X)({autoSpace:i.markdown.autoSpace,codeBlockPreview:i.markdown.codeBlockPreview,emojiSite:i.emojiPath,emojis:i.customEmoji,fixTermTypo:i.markdown.fixTermTypo,footnotes:i.markdown.footnotes,headingAnchor:0!==i.anchor,inlineMathDigit:i.math.inlineDigit,lazyLoadImage:i.lazyLoadImage,linkBase:i.markdown.linkBase,linkPrefix:i.markdown.linkPrefix,listStyle:i.markdown.listStyle,mark:i.markdown.mark,mathBlockPreview:i.markdown.mathBlockPreview,paragraphBeginningSpace:i.markdown.paragraphBeginningSpace,sanitize:i.markdown.sanitize,toc:i.markdown.toc});return(null==t?void 0:t.renderers)&&n.SetJSRenderers({renderers:{Md2HTML:t.renderers}}),n.SetHeadingID(!0),n.Md2HTML(e)}))},F=function(e,t,i){return L(void 0,void 0,void 0,(function(){var a,g,b;return T(this,(function(C){switch(C.label){case 0:return a=D(i),[4,E(t,a)];case 1:if(g=C.sent(),a.transform&&(g=a.transform(g)),e.innerHTML=g,e.classList.add("vditor-reset"),a.i18n)return[3,5];if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(a.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return b="vditorI18nScript"+a.lang,document.querySelectorAll('head script[id^="vditorI18nScript"]').forEach((function(e){e.id!==b&&document.head.removeChild(e)})),[4,(0,y.G)(a.cdn+"/dist/js/i18n/"+a.lang+".js",b)];case 3:C.sent(),C.label=4;case 4:return[3,6];case 5:window.VditorI18n=a.i18n,C.label=6;case 6:return a.icon?[4,(0,y.G)(a.cdn+"/dist/js/icons/"+a.icon+".js","vditorIconScript")]:[3,8];case 7:C.sent(),C.label=8;case 8:return(0,w.Z)(a.theme.current,a.theme.path),1===a.anchor&&e.classList.add("vditor-reset--anchor"),(0,r.O)(e),(0,c.s)(a.hljs,e,a.cdn),(0,u.H)(e,{cdn:a.cdn,math:a.math}),(0,p.i)(e,a.cdn,a.mode),(0,f.K)(e,a.cdn,a.mode),(0,s.P)(e,a.cdn),(0,l.v)(e,a.cdn),(0,o.p)(e,a.cdn,a.mode),(0,m.P)(e,a.cdn,a.mode),(0,v.B)(e,a.cdn),(0,n.Q)(e,a.cdn),(0,h.Y)(e),a.speech.enable&&S(e),0!==a.anchor&&(k=a.anchor,document.querySelectorAll(".vditor-anchor").forEach((function(e){1===k&&e.classList.add("vditor-anchor--left"),e.onclick=function(){var t=e.getAttribute("href").substr(1),i=document.getElementById("vditorAnchor-"+t).offsetTop;document.querySelector("html").scrollTop=i}})),window.onhashchange=function(){var e=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));e&&(document.querySelector("html").scrollTop=e.offsetTop)}),a.after&&a.after(),a.lazyLoadImage&&d(e),e.addEventListener("click",(function(t){var i=(0,x.lG)(t.target,"SPAN");if(i&&(0,x.fb)(i,"vditor-toc")){var n=e.querySelector("#"+i.getAttribute("data-target-id"));n&&window.scrollTo(window.scrollX,n.offsetTop)}})),[2]}var k}))}))},I=i(863),M=i(312);const N=function(){function e(){}return e.adapterRender=a,e.previewImage=I.E,e.codeRender=r.O,e.graphvizRender=l.v,e.highlightRender=c.s,e.mathRender=u.H,e.mermaidRender=p.i,e.markmapRender=f.K,e.flowchartRender=s.P,e.chartRender=o.p,e.abcRender=n.Q,e.mindmapRender=m.P,e.plantumlRender=v.B,e.outlineRender=g.k,e.mediaRender=h.Y,e.speechRender=S,e.lazyLoadImageRender=d,e.md2html=E,e.preview=F,e.setCodeTheme=M.Y,e.setContentTheme=w.Z,e}()},54:(e,t,i)=>{"use strict";i.d(t,{H:()=>n,g:()=>a});var n="3.9.3",a=function(){function e(){}return e.ZWSP="​",e.DROP_EDITOR="application/editor",e.MOBILE_WIDTH=520,e.CLASS_MENU_DISABLED="vditor-menu--disabled",e.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],e.CODE_THEME=["abap","algol","algol_nu","arduino","autumn","borland","bw","colorful","dracula","emacs","friendly","fruity","github","igor","lovelace","manni","monokai","monokailight","murphy","native","paraiso-dark","paraiso-light","pastie","perldoc","pygments","rainbow_dash","rrt","solarized-dark","solarized-dark256","solarized-light","swapoff","tango","trac","vim","vs","xcode","ant-design"],e.CODE_LANGUAGES=["mermaid","echarts","mindmap","plantuml","abc","graphviz","flowchart","apache","js","ts","html","markmap","properties","apache","bash","c","csharp","cpp","css","coffeescript","diff","go","xml","http","json","java","javascript","kotlin","less","lua","makefile","markdown","nginx","objectivec","php","php-template","perl","plaintext","python","python-repl","r","ruby","rust","scss","sql","shell","swift","ini","typescript","vbnet","yaml","ada","clojure","dart","erb","fortran","gradle","haskell","julia","julia-repl","lisp","matlab","pgsql","powershell","sql_more","stata","cmake","mathematica","solidity","yul"],e.CDN="https://unpkg.com/vditor@3.9.3",e.MARKDOWN_OPTIONS={autoSpace:!1,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},e.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},e.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},e.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:e.CDN+"/dist/css/content-theme"},e}()},478:(e,t,i)=>{"use strict";i.d(t,{Q:()=>r});var n=i(54),a=i(526),o=i(156),r=function(e,t){void 0===e&&(e=document),void 0===t&&(t=n.g.CDN);var i=o.abcRenderAdapter.getElements(e);i.length>0&&(0,a.G)(t+"/dist/js/abcjs/abcjs_basic.min.js","vditorAbcjsScript").then((function(){i.forEach((function(e){e.parentElement.classList.contains("vditor-wysiwyg__pre")||e.parentElement.classList.contains("vditor-ir__marker--pre")||"true"!==e.getAttribute("data-processed")&&(ABCJS.renderAbc(e,o.abcRenderAdapter.getCode(e).trim()),e.style.overflowX="auto",e.setAttribute("data-processed","true"))}))}))}},156:(e,t,i)=>{"use strict";i.r(t),i.d(t,{mathRenderAdapter:()=>n,mermaidRenderAdapter:()=>a,markmapRenderAdapter:()=>o,mindmapRenderAdapter:()=>r,chartRenderAdapter:()=>s,abcRenderAdapter:()=>l,graphvizRenderAdapter:()=>c,flowchartRenderAdapter:()=>d,plantumlRenderAdapter:()=>u});var n={getCode:function(e){return e.textContent},getElements:function(e){return e.querySelectorAll(".language-math")}},a={getCode:function(e){return e.textContent},getElements:function(e){return e.querySelectorAll(".language-mermaid")}},o={getCode:function(e){return e.textContent},getElements:function(e){return e.querySelectorAll(".language-markmap")}},r={getCode:function(e){return e.getAttribute("data-code")},getElements:function(e){return e.querySelectorAll(".language-mindmap")}},s={getCode:function(e){return e.innerText},getElements:function(e){return e.querySelectorAll(".language-echarts")}},l={getCode:function(e){return e.textContent},getElements:function(e){return e.querySelectorAll(".language-abc")}},c={getCode:function(e){return e.textContent},getElements:function(e){return e.querySelectorAll(".language-graphviz")}},d={getCode:function(e){return e.textContent},getElements:function(e){return e.querySelectorAll(".language-flowchart")}},u={getCode:function(e){return e.textContent},getElements:function(e){return e.querySelectorAll(".language-plantuml")}}},314:(e,t,i)=>{"use strict";i.d(t,{p:()=>r});var n=i(54),a=i(526),o=i(156),r=function(e,t,i){void 0===e&&(e=document),void 0===t&&(t=n.g.CDN);var r=o.chartRenderAdapter.getElements(e);r.length>0&&(0,a.G)(t+"/dist/js/echarts/echarts.min.js","vditorEchartsScript").then((function(){r.forEach((function(e){if(!e.parentElement.classList.contains("vditor-wysiwyg__pre")&&!e.parentElement.classList.contains("vditor-ir__marker--pre")){var t=o.chartRenderAdapter.getCode(e).trim();if(t)try{if("true"===e.getAttribute("data-processed"))return;var n=JSON.parse(t);echarts.init(e,"dark"===i?"dark":void 0).setOption(n),e.setAttribute("data-processed","true")}catch(t){e.className="vditor-reset--error",e.innerHTML="echarts render error: <br>"+t}}}))}))}},730:(e,t,i)=>{"use strict";i.d(t,{O:()=>o});var n=i(51),a=i(54),o=function(e){e.querySelectorAll("pre > code").forEach((function(t,i){var o,r,s;if(!t.parentElement.classList.contains("vditor-wysiwyg__pre")&&!t.parentElement.classList.contains("vditor-ir__marker--pre")&&!(t.classList.contains("language-mermaid")||t.classList.contains("language-flowchart")||t.classList.contains("language-echarts")||t.classList.contains("language-mindmap")||t.classList.contains("language-plantuml")||t.classList.contains("language-markmap")||t.classList.contains("language-abc")||t.classList.contains("language-graphviz")||t.classList.contains("language-math")||t.style.maxHeight.indexOf("px")>-1||e.classList.contains("vditor-preview")&&i>5)){var l=t.innerText;if(t.classList.contains("highlight-chroma")){var c=document.createElement("code");c.innerHTML=t.innerHTML,c.querySelectorAll(".highlight-ln").forEach((function(e){e.remove()})),l=c.innerText}else l.endsWith("\n")&&(l=l.substr(0,l.length-1));var d='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(d='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var u=document.createElement("div");u.className="vditor-copy",u.innerHTML='<span aria-label="'+((null===(o=window.VditorI18n)||void 0===o?void 0:o.copy)||"复制")+"\"\nonmouseover=\"this.setAttribute('aria-label', '"+((null===(r=window.VditorI18n)||void 0===r?void 0:r.copy)||"复制")+"')\"\nclass=\"vditor-tooltipped vditor-tooltipped__w\"\nonclick=\"this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '"+((null===(s=window.VditorI18n)||void 0===s?void 0:s.copied)||"已复制")+"')\">"+d+"</span>";var h=document.createElement("textarea");h.value=(0,n.X)(l),u.insertAdjacentElement("afterbegin",h),t.before(u),t.style.maxHeight=window.outerHeight-40+"px",t.insertAdjacentHTML("afterend",'<span style="position: absolute">'+a.g.ZWSP+"</span>")}}))}},66:(e,t,i)=>{"use strict";i.d(t,{P:()=>r});var n=i(54),a=i(526),o=i(156),r=function(e,t){void 0===t&&(t=n.g.CDN);var i=o.flowchartRenderAdapter.getElements(e);0!==i.length&&(0,a.G)(t+"/dist/js/flowchart.js/flowchart.min.js","vditorFlowchartScript").then((function(){i.forEach((function(e){if("true"!==e.getAttribute("data-processed")){var t=flowchart.parse(o.flowchartRenderAdapter.getCode(e));e.innerHTML="",t.drawSVG(e),e.setAttribute("data-processed","true")}}))}))}},218:(e,t,i)=>{"use strict";i.d(t,{v:()=>r});var n=i(54),a=i(526),o=i(156),r=function(e,t){void 0===t&&(t=n.g.CDN);var i=o.graphvizRenderAdapter.getElements(e);0!==i.length&&(0,a.G)(t+"/dist/js/graphviz/viz.js","vditorGraphVizScript").then((function(){i.forEach((function(e){var t=o.graphvizRenderAdapter.getCode(e);if(!e.parentElement.classList.contains("vditor-wysiwyg__pre")&&!e.parentElement.classList.contains("vditor-ir__marker--pre")&&"true"!==e.getAttribute("data-processed")&&""!==t.trim()){try{var i=new Blob(["importScripts('"+document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js")+"');"],{type:"application/javascript"}),n=(window.URL||window.webkitURL).createObjectURL(i),a=new Worker(n);new Viz({worker:a}).renderSVGElement(t).then((function(t){e.innerHTML=t.outerHTML})).catch((function(t){e.innerHTML="graphviz render error: <br>"+t,e.className="vditor-reset--error"}))}catch(e){console.error("graphviz error",e)}e.setAttribute("data-processed","true")}}))}))}},702:(e,t,i)=>{"use strict";i.d(t,{s:()=>r});var n=i(54),a=i(526),o=i(578),r=function(e,t,i){void 0===t&&(t=document),void 0===i&&(i=n.g.CDN);var r=e.style;n.g.CODE_THEME.includes(r)||(r="github");var s=document.getElementById("vditorHljsStyle"),l=i+"/dist/js/highlight.js/styles/"+r+".css";s&&s.href!==l&&s.remove(),(0,o.c)(i+"/dist/js/highlight.js/styles/"+r+".css","vditorHljsStyle"),!1!==e.enable&&0!==t.querySelectorAll("pre > code").length&&(0,a.G)(i+"/dist/js/highlight.js/highlight.pack.js","vditorHljsScript").then((function(){(0,a.G)(i+"/dist/js/highlight.js/solidity.min.js","vditorHljsSolidityScript").then((function(){(0,a.G)(i+"/dist/js/highlight.js/yul.min.js","vditorHljsYulScript").then((function(){t.querySelectorAll("pre > code").forEach((function(t){if(!t.parentElement.classList.contains("vditor-ir__marker--pre")&&!t.parentElement.classList.contains("vditor-wysiwyg__pre")&&!(t.classList.contains("language-mermaid")||t.classList.contains("language-flowchart")||t.classList.contains("language-echarts")||t.classList.contains("language-mindmap")||t.classList.contains("language-plantuml")||t.classList.contains("language-abc")||t.classList.contains("language-graphviz")||t.classList.contains("language-math"))&&(""!==e.defaultLang&&-1===t.className.indexOf("language-")&&t.classList.add("language-"+e.defaultLang),hljs.highlightElement(t),e.lineNumber)){t.classList.add("vditor-linenumber");var i=t.querySelector(".vditor-linenumber__temp");i||((i=document.createElement("div")).className="vditor-linenumber__temp",t.insertAdjacentElement("beforeend",i));var n=getComputedStyle(t).whiteSpace,a=!1;"pre-wrap"!==n&&"pre-line"!==n||(a=!0);var o="",r=t.textContent.split(/\r\n|\r|\n/g);r.pop(),r.map((function(e){var t="";a&&(i.textContent=e||"\n",t=' style="height:'+i.getBoundingClientRect().height+'px"'),o+="<span"+t+"></span>"})),i.style.display="none",o='<span class="vditor-linenumber__rows">'+o+"</span>",t.insertAdjacentHTML("beforeend",o)}}))}))}))}))}},563:(e,t,i)=>{"use strict";i.d(t,{K:()=>l});var n=i(54),a=i(526),o=i(156),r={},s=function(e,t){var i=window.markmap,n=i.Transformer,a=i.Markmap,o=i.deriveOptions,s=(i.globalCSS,new n);e.innerHTML='<svg style="width:100%"></svg>';var l=e.firstChild,c=a.create(l,null),d=function(e,t){var i=e.transform(t),n=Object.keys(i.features).filter((function(e){return!r[e]}));n.forEach((function(e){r[e]=!0}));var a=e.getAssets(n),o=a.styles,s=a.scripts,l=window.markmap;return o&&l.loadCSS(o),s&&l.loadJS(s),i}(s,t),u=d.root,h=d.frontmatter,p=o(null==h?void 0:h.markmap);c.setData(u,p),c.fit()},l=function(e,t,i){void 0===t&&(t=n.g.CDN);var r=o.markmapRenderAdapter.getElements(e);0!==r.length&&(0,a.G)(t+"/src/js/markmap/markmap.min.js","vditorMermaidScript").then((function(){r.forEach((function(e){var t=o.markmapRenderAdapter.getCode(e);if("true"!==e.getAttribute("data-processed")&&""!==t.trim()){var i=document.createElement("div");i.className="language-markmap",e.parentNode.appendChild(i),s(i,t),"CODE"==e.parentNode.childNodes[0].nodeName&&e.parentNode.removeChild(e.parentNode.childNodes[0])}}))}))}},466:(e,t,i)=>{"use strict";i.d(t,{H:()=>l});var n=i(54),a=i(526),o=i(578),r=i(51),s=i(156),l=function(e,t){var i=s.mathRenderAdapter.getElements(e);if(0!==i.length){var l={cdn:n.g.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(t&&t.math&&(t.math=Object.assign({},l.math,t.math)),"KaTeX"===(t=Object.assign({},l,t)).math.engine)(0,o.c)(t.cdn+"/dist/js/katex/katex.min.css","vditorKatexStyle"),(0,a.G)(t.cdn+"/dist/js/katex/katex.min.js","vditorKatexScript").then((function(){(0,a.G)(t.cdn+"/dist/js/katex/mhchem.min.js","vditorKatexChemScript").then((function(){i.forEach((function(e){if(!e.parentElement.classList.contains("vditor-wysiwyg__pre")&&!e.parentElement.classList.contains("vditor-ir__marker--pre")&&!e.getAttribute("data-math")){var t=(0,r.X)(s.mathRenderAdapter.getCode(e));e.setAttribute("data-math",t);try{e.innerHTML=katex.renderToString(t,{displayMode:"DIV"===e.tagName,output:"html"})}catch(t){e.innerHTML=t.message,e.className="language-math vditor-reset--error"}e.addEventListener("copy",(function(e){e.stopPropagation(),e.preventDefault();var t=e.currentTarget.closest(".language-math");e.clipboardData.setData("text/html",t.innerHTML),e.clipboardData.setData("text/plain",t.getAttribute("data-math"))}))}}))}))}));else if("MathJax"===t.math.engine){window.MathJax||(window.MathJax={loader:{paths:{mathjax:t.cdn+"/dist/js/mathjax"}},startup:{typeset:!1},tex:{macros:t.math.macros}}),(0,a.J)(t.cdn+"/dist/js/mathjax/tex-svg-full.js","protyleMathJaxScript");var c=function(e,t){var i=(0,r.X)(e.textContent).trim(),n=window.MathJax.getMetricsFor(e);n.display="DIV"===e.tagName,window.MathJax.tex2svgPromise(i,n).then((function(n){e.innerHTML="",e.setAttribute("data-math",i),e.append(n),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var a=n.querySelector('[data-mml-node="merror"]');a&&""!==a.textContent.trim()&&(e.innerHTML=a.textContent.trim(),e.className="vditor-reset--error"),t&&t()}))};window.MathJax.startup.promise.then((function(){for(var e=[],t=function(t){var n=i[t];n.parentElement.classList.contains("vditor-wysiwyg__pre")||n.parentElement.classList.contains("vditor-ir__marker--pre")||n.getAttribute("data-math")||!(0,r.X)(n.textContent).trim()||e.push((function(e){t===i.length-1?c(n):c(n,e)}))},n=0;n<i.length;n++)t(n);!function(e){if(0!==e.length){var t=0,i=e[e.length-1],n=function(){var a=e[t++];a===i?a():a(n)};n()}}(e)}))}}}},554:(e,t,i)=>{"use strict";i.d(t,{Y:()=>n});var n=function(e){e&&e.querySelectorAll("a").forEach((function(e){var t=e.getAttribute("href");t&&(t.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?function(e,t){e.insertAdjacentHTML("afterend",'<video controls="controls" src="'+t+'"></video>'),e.remove()}(e,t):t.match(/^.+.(mp3|wav|flac)$/)?function(e,t){e.insertAdjacentHTML("afterend",'<audio controls="controls" src="'+t+'"></audio>'),e.remove()}(e,t):function(e,t){var i=t.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),n=t.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),a=t.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),o=t.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),r=t.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),s=t.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),l=t.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),c=t.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);i&&11===i[1].length?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'+i[1]+(i[2]?"?start="+i[2]:"")+'"></iframe>'),e.remove()):n&&n[1]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'+n[1]+'"></iframe>'),e.remove()):a&&a[1]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='+a[1]+'"></iframe>'),e.remove()):o&&o[1]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video"\n src="//coub.com/embed/'+o[1]+'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>'),e.remove()):r&&r[0]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video"\n src="https://www.facebook.com/plugins/video.php?href='+encodeURIComponent(r[0])+'"></iframe>'),e.remove()):s&&s[2]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video"\n src="https://www.dailymotion.com/embed/video/'+s[2]+'"></iframe>'),e.remove()):l&&l[1]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video"\n src="//player.bilibili.com/player.html?bvid='+l[1]+'"></iframe>'),e.remove()):c&&c[1]&&(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'+c[1]+'"></iframe>'),e.remove())}(e,t))}))}},40:(e,t,i)=>{"use strict";i.d(t,{i:()=>r});var n=i(54),a=i(526),o=i(156),r=function(e,t,i){void 0===t&&(t=n.g.CDN);var r=o.mermaidRenderAdapter.getElements(e);0!==r.length&&(0,a.G)(t+"/dist/js/mermaid/mermaid.min.js","vditorMermaidScript").then((function(){var e={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8},gantt:{leftPadding:75,rightPadding:20}};"dark"===i&&(e.theme="dark"),mermaid.initialize(e),r.forEach((function(e){var t=o.mermaidRenderAdapter.getCode(e);"true"!==e.getAttribute("data-processed")&&""!==t.trim()&&(mermaid.init(void 0,e),e.setAttribute("data-processed","true"))}))}))}},749:(e,t,i)=>{"use strict";i.d(t,{P:()=>r});var n=i(54),a=i(526),o=i(156),r=function(e,t,i){void 0===e&&(e=document),void 0===t&&(t=n.g.CDN);var r=o.mindmapRenderAdapter.getElements(e);r.length>0&&(0,a.G)(t+"/dist/js/echarts/echarts.min.js","vditorEchartsScript").then((function(){r.forEach((function(e){if(!e.parentElement.classList.contains("vditor-wysiwyg__pre")&&!e.parentElement.classList.contains("vditor-ir__marker--pre")){var t=o.mindmapRenderAdapter.getCode(e);if(t)try{if("true"===e.getAttribute("data-processed"))return;echarts.init(e,"dark"===i?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(t))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(e,t){var i;return(null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.children)?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),e.setAttribute("data-processed","true")}catch(t){e.className="vditor-reset--error",e.innerHTML="mindmap render error: <br>"+t}}}))}))}},818:(e,t,i)=>{"use strict";i.d(t,{k:()=>o});var n=i(64),a=i(466),o=function(e,t,i){var o="",r=[];if(Array.from(e.children).forEach((function(e,t){if((0,n.W)(e)){if(i){var a=e.id.lastIndexOf("_");e.id=e.id.substring(0,-1===a?void 0:a)+"_"+t}r.push(e.id),o+=e.outerHTML.replace("<wbr>","")}})),""===o)return t.innerHTML="","";var s=document.createElement("div");if(i)i.lute.SetToC(!0),"wysiwyg"!==i.currentMode||i.preview.element.contains(e)?"ir"!==i.currentMode||i.preview.element.contains(e)?s.innerHTML=i.lute.HTML2VditorDOM("<p>[ToC]</p>"+o):s.innerHTML=i.lute.SpinVditorIRDOM("<p>[ToC]</p>"+o):s.innerHTML=i.lute.SpinVditorDOM("<p>[ToC]</p>"+o),i.lute.SetToC(i.options.preview.markdown.toc);else{t.classList.add("vditor-outline");var l=Lute.New();l.SetToC(!0),s.innerHTML=l.HTML2VditorDOM("<p>[ToC]</p>"+o)}var c=s.firstElementChild.querySelectorAll("li > span[data-target-id]");return c.forEach((function(e,t){if(e.nextElementSibling&&"UL"===e.nextElementSibling.tagName){var i="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(i='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),e.innerHTML=i+"<span>"+e.innerHTML+"</span>"}else e.innerHTML="<svg></svg><span>"+e.innerHTML+"</span>";e.setAttribute("data-target-id",r[t])})),o=s.firstElementChild.innerHTML,0===c.length?(t.innerHTML="",o):(t.innerHTML=o,i&&(0,a.H)(t,{cdn:i.options.cdn,math:i.options.preview.math}),t.firstElementChild.addEventListener("click",(function(n){for(var a=n.target;a&&!a.isEqualNode(t);){if(a.classList.contains("vditor-outline__action")){a.classList.contains("vditor-outline__action--close")?(a.classList.remove("vditor-outline__action--close"),a.parentElement.nextElementSibling.setAttribute("style","display:block")):(a.classList.add("vditor-outline__action--close"),a.parentElement.nextElementSibling.setAttribute("style","display:none")),n.preventDefault(),n.stopPropagation();break}if(a.getAttribute("data-target-id")){n.preventDefault(),n.stopPropagation();var o=document.getElementById(a.getAttribute("data-target-id"));if(!o)return;if(i)if("auto"===i.options.height){var r=o.offsetTop+i.element.offsetTop;i.options.toolbarConfig.pin||(r+=i.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,r)}else i.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,i.element.offsetTop),i.preview.element.contains(e)?e.parentElement.scrollTop=o.offsetTop:e.scrollTop=o.offsetTop;else window.scrollTo(window.scrollX,o.offsetTop);break}a=a.parentElement}})),o)}},408:(e,t,i)=>{"use strict";i.d(t,{B:()=>r});var n=i(54),a=i(526),o=i(156),r=function(e,t){void 0===e&&(e=document),void 0===t&&(t=n.g.CDN);var i=o.plantumlRenderAdapter.getElements(e);0!==i.length&&(0,a.G)(t+"/dist/js/plantuml/plantuml-encoder.min.js","vditorPlantumlScript").then((function(){i.forEach((function(e){if(!e.parentElement.classList.contains("vditor-wysiwyg__pre")&&!e.parentElement.classList.contains("vditor-ir__marker--pre")){var t=o.plantumlRenderAdapter.getCode(e).trim();if(t)try{e.innerHTML='<img src="http://www.plantuml.com/plantuml/svg/~1'+plantumlEncoder.encode(t)+'">'}catch(t){e.className="vditor-reset--error",e.innerHTML="plantuml render error: <br>"+t}}}))}))}},895:(e,t,i)=>{"use strict";i.d(t,{X:()=>n});var n=function(e){var t=Lute.New();return t.PutEmojis(e.emojis),t.SetEmojiSite(e.emojiSite),t.SetHeadingAnchor(e.headingAnchor),t.SetInlineMathAllowDigitAfterOpenMarker(e.inlineMathDigit),t.SetAutoSpace(e.autoSpace),t.SetToC(e.toc),t.SetFootnotes(e.footnotes),t.SetFixTermTypo(e.fixTermTypo),t.SetVditorCodeBlockPreview(e.codeBlockPreview),t.SetVditorMathBlockPreview(e.mathBlockPreview),t.SetSanitize(e.sanitize),t.SetChineseParagraphBeginningSpace(e.paragraphBeginningSpace),t.SetRenderListStyle(e.listStyle),t.SetLinkBase(e.linkBase),t.SetLinkPrefix(e.linkPrefix),t.SetMark(e.mark),e.lazyLoadImage&&t.SetImageLazyLoading(e.lazyLoadImage),t}},863:(e,t,i)=>{"use strict";i.d(t,{E:()=>n});var n=function(e,t,i){void 0===t&&(t="zh_CN"),void 0===i&&(i="classic");var n=e.getBoundingClientRect();document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'+("dark"===i?" vditor--dark":"")+'">\n    <div class="vditor-img__bar">\n      <span class="vditor-img__btn" data-deg="0">\n        <svg><use xlink:href="#vditor-icon-redo"></use></svg>\n        '+window.VditorI18n.spin+"\n      </span>\n      <span class=\"vditor-img__btn\"  onclick=\"this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''\">\n        X &nbsp;"+window.VditorI18n.close+'\n      </span>\n    </div>\n    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = \'\';document.body.style.overflow = \'\'">\n      <img style="width: '+e.width+"px;height:"+e.height+"px;transform: translate3d("+n.left+"px, "+(n.top-36)+'px, 0)" src="'+e.getAttribute("src")+'">\n    </div>\n</div>'),document.body.style.overflow="hidden";var a=document.querySelector(".vditor-img img"),o="translate3d("+Math.max(0,window.innerWidth-e.naturalWidth)/2+"px, "+Math.max(0,window.innerHeight-36-e.naturalHeight)/2+"px, 0)";setTimeout((function(){a.setAttribute("style","transition: transform .3s ease-in-out;transform: "+o),setTimeout((function(){a.parentElement.scrollTo((a.parentElement.scrollWidth-a.parentElement.clientWidth)/2,(a.parentElement.scrollHeight-a.parentElement.clientHeight)/2)}),400)}));var r=document.querySelector(".vditor-img__btn");r.addEventListener("click",(function(){var t=parseInt(r.getAttribute("data-deg"),10)+90;t/90%2==1&&e.naturalWidth>a.parentElement.clientHeight?a.style.transform="translate3d("+Math.max(0,window.innerWidth-e.naturalWidth)/2+"px, "+(e.naturalWidth/2-e.naturalHeight/2)+"px, 0) rotateZ("+t+"deg)":a.style.transform=o+" rotateZ("+t+"deg)",r.setAttribute("data-deg",t.toString()),setTimeout((function(){a.parentElement.scrollTo((a.parentElement.scrollWidth-a.parentElement.clientWidth)/2,(a.parentElement.scrollHeight-a.parentElement.clientHeight)/2)}),400)}))}},312:(e,t,i)=>{"use strict";i.d(t,{Y:()=>o});var n=i(54),a=i(578),o=function(e,t){void 0===t&&(t=n.g.CDN),n.g.CODE_THEME.includes(e)||(e="github");var i=document.getElementById("vditorHljsStyle"),o=t+"/dist/js/highlight.js/styles/"+e+".css";i?i.href!==o&&(i.remove(),(0,a.c)(o,"vditorHljsStyle")):(0,a.c)(o,"vditorHljsStyle")}},227:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(578),a=function(e,t){if(e&&t){var i=document.getElementById("vditorContentTheme"),a=t+"/"+e+".css";i?i.getAttribute("href")!==a&&(i.remove(),(0,n.c)(a,"vditorContentTheme")):(0,n.c)(a,"vditorContentTheme")}}},526:(e,t,i)=>{"use strict";i.d(t,{J:()=>n,G:()=>a});var n=function(e,t){if(document.getElementById(t))return!1;var i=new XMLHttpRequest;i.open("GET",e,!1),i.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),i.send("");var n=document.createElement("script");n.type="text/javascript",n.text=i.responseText,n.id=t,document.head.appendChild(n)},a=function(e,t){return new Promise((function(i,n){if(document.getElementById(t))return i(),!1;var a=document.createElement("script");a.src=e,a.async=!0,document.head.appendChild(a),a.onload=function(){if(document.getElementById(t))return a.remove(),i(),!1;a.id=t,i()}}))}},578:(e,t,i)=>{"use strict";i.d(t,{c:()=>n});var n=function(e,t){if(!document.getElementById(t)){var i=document.createElement("link");i.id=t,i.rel="stylesheet",i.type="text/css",i.href=e,document.getElementsByTagName("head")[0].appendChild(i)}}},51:(e,t,i)=>{"use strict";i.d(t,{X:()=>n});var n=function(e){return e.replace(/\u00a0/g," ")}},794:(e,t,i)=>{"use strict";i.d(t,{G6:()=>n,vU:()=>a,pK:()=>o,Le:()=>r,yl:()=>s,ns:()=>l,i7:()=>c});var n=function(){return navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")},a=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},o=function(){try{return"undefined"!=typeof localStorage}catch(e){return!1}},r=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},s=function(e){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!(!e.metaKey||e.ctrlKey):!(e.metaKey||!e.ctrlKey)},l=function(e){return/Mac/.test(navigator.platform)||"iPhone"===navigator.platform?e.indexOf("⇧")>-1&&a()&&(e=e.replace(";",":").replace("=","+").replace("-","_")):(e=(e=e.startsWith("⌘")?e.replace("⌘","⌘+"):e.startsWith("⌥")&&"⌘"!==e.substr(1,1)?e.replace("⌥","⌥+"):e.replace("⇧⌘","⌘+⇧+").replace("⌥⌘","⌥+⌘+")).replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt")).indexOf("Shift")>-1&&(e=e.replace(";",":").replace("=","+").replace("-","_")),e},c=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},827:(e,t,i)=>{"use strict";i.d(t,{JQ:()=>a,E2:()=>o,O9:()=>r,a1:()=>s,F9:()=>l,lG:()=>c,fb:()=>d,DX:()=>u});var n=i(64),a=function(e,t){for(var i=d(e,t),n=!1,a=!1;i&&!i.classList.contains("vditor-reset")&&!a;)(n=d(i.parentElement,t))?i=n:a=!0;return i||!1},o=function(e,t){for(var i=(0,n.S)(e,t),a=!1,o=!1;i&&!i.classList.contains("vditor-reset")&&!o;)(a=(0,n.S)(i.parentElement,t))?i=a:o=!0;return i||!1},r=function(e){var t=o(e,"UL"),i=o(e,"OL"),n=t;return i&&(!t||t&&i.contains(t))&&(n=i),n},s=function(e,t,i){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);for(var n=e,a=!1;n&&!a&&!n.classList.contains("vditor-reset");)n.getAttribute(t)===i?a=!0:n=n.parentElement;return a&&n},l=function(e){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);var t=e,i=!1,n=s(e,"data-block","0");if(n)return n;for(;t&&!i&&!t.classList.contains("vditor-reset");)"H1"===t.tagName||"H2"===t.tagName||"H3"===t.tagName||"H4"===t.tagName||"H5"===t.tagName||"H6"===t.tagName||"P"===t.tagName||"BLOCKQUOTE"===t.tagName||"OL"===t.tagName||"UL"===t.tagName?i=!0:t=t.parentElement;return i&&t},c=function(e,t){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);for(var i=e,n=!1;i&&!n&&!i.classList.contains("vditor-reset");)i.nodeName===t?n=!0:i=i.parentElement;return n&&i},d=function(e,t){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);for(var i=e,n=!1;i&&!n&&!i.classList.contains("vditor-reset");)i.classList.contains(t)?n=!0:i=i.parentElement;return n&&i},u=function(e){for(;e&&e.lastChild;)e=e.lastChild;return e}},64:(e,t,i)=>{"use strict";i.d(t,{S:()=>n,W:()=>a});var n=function(e,t){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);for(var i=e,n=!1;i&&!n&&!i.classList.contains("vditor-reset");)0===i.nodeName.indexOf(t)?n=!0:i=i.parentElement;return n&&i},a=function(e){var t=n(e,"H");return!(!t||2!==t.tagName.length||"HR"===t.tagName)&&t}},640:(e,t,i)=>{"use strict";i.d(t,{T:()=>n});var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i={},a=function(e){for(var t in e)e.hasOwnProperty(t)&&("[object Object]"===Object.prototype.toString.call(e[t])?i[t]=n(i[t],e[t]):i[t]=e[t])},o=0;o<e.length;o++)a(e[o]);return i}},393:(e,t,i)=>{"use strict";i.d(t,{zh:()=>r,Ny:()=>s,Gb:()=>l,Hc:()=>c,im:()=>d,$j:()=>u,ib:()=>h,oC:()=>p});var n=i(54),a=i(794),o=i(827),r=function(e){var t,i=e[e.currentMode].element;return getSelection().rangeCount>0&&(t=getSelection().getRangeAt(0),i.isEqualNode(t.startContainer)||i.contains(t.startContainer))?t:e[e.currentMode].range?e[e.currentMode].range:(i.focus(),(t=i.ownerDocument.createRange()).setStart(i,0),t.collapse(!0),t)},s=function(e){var t=window.getSelection().getRangeAt(0);if(!e.contains(t.startContainer)&&!(0,o.fb)(t.startContainer,"vditor-panel--none"))return{left:0,top:0};var i,n=e.parentElement.getBoundingClientRect();if(0===t.getClientRects().length)if(3===t.startContainer.nodeType){var a=t.startContainer.parentElement;if(!(a&&a.getClientRects().length>0))return{left:0,top:0};i=a.getClientRects()[0]}else{var r=t.startContainer.children;if(r[t.startOffset]&&r[t.startOffset].getClientRects().length>0)i=r[t.startOffset].getClientRects()[0];else if(t.startContainer.childNodes.length>0){var s=t.cloneRange();t.selectNode(t.startContainer.childNodes[Math.max(0,t.startOffset-1)]),i=t.getClientRects()[0],t.setEnd(s.endContainer,s.endOffset),t.setStart(s.startContainer,s.startOffset)}else i=t.startContainer.getClientRects()[0];if(!i){for(var l=t.startContainer.childNodes[t.startOffset];!l.getClientRects||l.getClientRects&&0===l.getClientRects().length;)l=l.parentElement;i=l.getClientRects()[0]}}else i=t.getClientRects()[0];return{left:i.left-n.left,top:i.top-n.top}},l=function(e,t){if(!t){if(0===getSelection().rangeCount)return!1;t=getSelection().getRangeAt(0)}var i=t.commonAncestorContainer;return e.isEqualNode(i)||e.contains(i)},c=function(e){var t=window.getSelection();t.removeAllRanges(),t.addRange(e)},d=function(e,t,i){var n={end:0,start:0};if(!i){if(0===getSelection().rangeCount)return n;i=window.getSelection().getRangeAt(0)}if(l(t,i)){var a=i.cloneRange();e.childNodes[0]&&e.childNodes[0].childNodes[0]?a.setStart(e.childNodes[0].childNodes[0],0):a.selectNodeContents(e),a.setEnd(i.startContainer,i.startOffset),n.start=a.toString().length,n.end=n.start+i.toString().length}return n},u=function(e,t,i){var n=0,a=0,o=i.childNodes[a],r=!1,s=!1;e=Math.max(0,e),t=Math.max(0,t);var l=i.ownerDocument.createRange();for(l.setStart(o||i,0),l.collapse(!0);!s&&o;){var d=n+o.textContent.length;if(!r&&e>=n&&e<=d&&(0===e?l.setStart(o,0):3===o.childNodes[0].nodeType?l.setStart(o.childNodes[0],e-n):o.nextSibling?l.setStartBefore(o.nextSibling):l.setStartAfter(o),r=!0,e===t)){s=!0;break}r&&t>=n&&t<=d&&(0===t?l.setEnd(o,0):3===o.childNodes[0].nodeType?l.setEnd(o.childNodes[0],t-n):o.nextSibling?l.setEndBefore(o.nextSibling):l.setEndAfter(o),s=!0),n=d,o=i.childNodes[++a]}return!s&&i.childNodes[a-1]&&l.setStartBefore(i.childNodes[a-1]),c(l),l},h=function(e,t){var i=e.querySelector("wbr");if(i){if(i.previousElementSibling)if(i.previousElementSibling.isSameNode(i.previousSibling)){if(i.previousElementSibling.lastChild)return t.setStartBefore(i),t.collapse(!0),c(t),!(0,a.i7)()||"EM"!==i.previousElementSibling.tagName&&"STRONG"!==i.previousElementSibling.tagName&&"S"!==i.previousElementSibling.tagName||(t.insertNode(document.createTextNode(n.g.ZWSP)),t.collapse(!1)),void i.remove();t.setStartAfter(i.previousElementSibling)}else t.setStart(i.previousSibling,i.previousSibling.textContent.length);else i.previousSibling?t.setStart(i.previousSibling,i.previousSibling.textContent.length):i.nextSibling?3===i.nextSibling.nodeType?t.setStart(i.nextSibling,0):t.setStartBefore(i.nextSibling):t.setStart(i.parentElement,0);t.collapse(!0),i.remove(),c(t)}},p=function(e,t){var i=document.createElement("div");i.innerHTML=e;var n=i.querySelectorAll("p");1===n.length&&!n[0].previousSibling&&!n[0].nextSibling&&t[t.currentMode].element.children.length>0&&"P"===i.firstElementChild.tagName&&(e=n[0].innerHTML.trim());var a=document.createElement("div");a.innerHTML=e;var s=r(t);if(""!==s.toString()&&(t[t.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),a.firstElementChild&&"0"===a.firstElementChild.getAttribute("data-block")){a.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var l=(0,o.F9)(s.startContainer);l?l.insertAdjacentHTML("afterend",a.innerHTML):t[t.currentMode].element.insertAdjacentHTML("beforeend",a.innerHTML),h(t[t.currentMode].element,s)}else{var d=document.createElement("template");d.innerHTML=e,s.insertNode(d.content.cloneNode(!0)),s.collapse(!1),c(s)}}}},t={};function i(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";i.d(n,{default:()=>Wi});var e,t=i(872),a=i(54),o=i(51),r=function(e){return"sv"===e.currentMode?(0,o.X)((e.sv.element.textContent+"\n").replace(/\n\n$/,"\n")):"wysiwyg"===e.currentMode?e.lute.VditorDOM2Md(e.wysiwyg.element.innerHTML):"ir"===e.currentMode?e.lute.VditorIRDOM2Md(e.ir.element.innerHTML):""},s=i(526),l=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return e.prototype.renderEchart=function(e){var t=this;"block"===e.devtools.element.style.display&&(0,s.G)(e.options.cdn+"/dist/js/echarts/echarts.min.js","vditorEchartsScript").then((function(){t.ASTChart||(t.ASTChart=echarts.init(e.devtools.element.lastElementChild));try{t.element.lastElementChild.style.display="block",t.element.firstElementChild.innerHTML="",t.ASTChart.setOption({series:[{data:JSON.parse(e.lute.RenderEChartsJSON(r(e))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),t.ASTChart.resize()}catch(e){t.element.lastElementChild.style.display="none",t.element.firstElementChild.innerHTML=e}}))},e}(),c=i(794),d=function(e,t){t.forEach((function(t){if(e[t]){var i=e[t].children[0];i&&i.classList.contains("vditor-menu--current")&&i.classList.remove("vditor-menu--current")}}))},u=function(e,t){t.forEach((function(t){if(e[t]){var i=e[t].children[0];i&&!i.classList.contains("vditor-menu--current")&&i.classList.add("vditor-menu--current")}}))},h=function(e,t){t.forEach((function(t){if(e[t]){var i=e[t].children[0];i&&i.classList.contains(a.g.CLASS_MENU_DISABLED)&&i.classList.remove(a.g.CLASS_MENU_DISABLED)}}))},p=function(e,t){t.forEach((function(t){if(e[t]){var i=e[t].children[0];i&&!i.classList.contains(a.g.CLASS_MENU_DISABLED)&&i.classList.add(a.g.CLASS_MENU_DISABLED)}}))},f=function(e,t){t.forEach((function(t){e[t]&&e[t]&&(e[t].style.display="none")}))},m=function(e,t){t.forEach((function(t){e[t]&&e[t]&&(e[t].style.display="block")}))},g=function(e,t,i){t.includes("subToolbar")&&(e.toolbar.element.querySelectorAll(".vditor-hint").forEach((function(e){i&&e.isEqualNode(i)||(e.style.display="none")})),e.toolbar.elements.emoji&&(e.toolbar.elements.emoji.lastElementChild.style.display="none")),t.includes("hint")&&(e.hint.element.style.display="none"),e.wysiwyg.popover&&t.includes("popover")&&(e.wysiwyg.popover.style.display="none")},v=function(e,t,i,n){i.addEventListener((0,c.Le)(),(function(n){n.preventDefault(),n.stopPropagation(),i.classList.contains(a.g.CLASS_MENU_DISABLED)||(e.toolbar.element.querySelectorAll(".vditor-hint--current").forEach((function(e){e.classList.remove("vditor-hint--current")})),"block"===t.style.display?t.style.display="none":(g(e,["subToolbar","hint","popover"],i.parentElement.parentElement),i.classList.contains("vditor-tooltipped")||i.classList.add("vditor-hint--current"),t.style.display="block",e.toolbar.element.getBoundingClientRect().right-i.getBoundingClientRect().right<250?t.classList.add("vditor-panel--left"):t.classList.remove("vditor-panel--left")))}))},b=i(827),w=i(64),y=function(e,t,i,n){n&&console.log(e+" - "+i+": "+t)},x=i(478),C=i(314),k=i(730),_=i(66),S=i(218),L=i(702),T=i(466),D=i(40),E=i(563),F=i(749),I=i(408),M=function(e,t){if(e)if("html-block"!==e.parentElement.getAttribute("data-type")){var i=e.firstElementChild.className.replace("language-","");"abc"===i?(0,x.Q)(e,t.options.cdn):"mermaid"===i?(0,D.i)(e,t.options.cdn,t.options.theme):"markmap"===i?(0,E.K)(e,t.options.cdn,t.options.theme):"flowchart"===i?(0,_.P)(e,t.options.cdn):"echarts"===i?(0,C.p)(e,t.options.cdn,t.options.theme):"mindmap"===i?(0,F.P)(e,t.options.cdn,t.options.theme):"plantuml"===i?(0,I.B)(e,t.options.cdn):"graphviz"===i?(0,S.v)(e,t.options.cdn):"math"===i?(0,T.H)(e,{cdn:t.options.cdn,math:t.options.preview.math}):((0,L.s)(Object.assign({},t.options.preview.hljs),e,t.options.cdn),(0,k.O)(e)),e.setAttribute("data-render","1")}else e.setAttribute("data-render","1")},N=i(393),O=function(e){if("sv"!==e.currentMode){var t=e[e.currentMode].element,i=e.outline.render(e);""===i&&(i="[ToC]"),t.querySelectorAll('[data-type="toc-block"]').forEach((function(t){t.innerHTML=i,(0,T.H)(t,{cdn:e.options.cdn,math:e.options.preview.math})}))}},A=function(e,t){var i=(0,b.lG)(e.target,"SPAN");if(i&&(0,b.fb)(i,"vditor-toc")){var n=t[t.currentMode].element.querySelector("#"+i.getAttribute("data-target-id"));if(n)if("auto"===t.options.height){var a=n.offsetTop+t.element.offsetTop;t.options.toolbarConfig.pin||(a+=t.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,a)}else t.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,t.element.offsetTop),t[t.currentMode].element.scrollTop=n.offsetTop}},P=function(e,t,i,n){if(e.previousElementSibling&&e.previousElementSibling.classList.contains("vditor-toc")){if("Backspace"===i.key&&0===(0,N.im)(e,t[t.currentMode].element,n).start)return e.previousElementSibling.remove(),ct(t),!0;if(it(t,i,n,e,e.previousElementSibling))return!0}if(e.nextElementSibling&&e.nextElementSibling.classList.contains("vditor-toc")){if("Delete"===i.key&&(0,N.im)(e,t[t.currentMode].element,n).start>=e.textContent.trimRight().length)return e.nextElementSibling.remove(),ct(t),!0;if(tt(t,i,n,e,e.nextElementSibling))return!0}if("Backspace"===i.key||"Delete"===i.key){var a=(0,b.fb)(n.startContainer,"vditor-toc");if(a)return a.remove(),ct(t),!0}},$=function(e,t,i,n){void 0===i&&(i=!1);var o=(0,b.F9)(t.startContainer);if(o&&!i&&"code-block"!==o.getAttribute("data-type")){if(st(o.innerHTML)&&o.previousElementSibling||lt(o.innerHTML))return;for(var s=(0,N.im)(o,e.ir.element,t).start,l=!0,c=s-1;c>o.textContent.substr(0,s).lastIndexOf("\n");c--)if(" "!==o.textContent.charAt(c)&&"\t"!==o.textContent.charAt(c)){l=!1;break}0===s&&(l=!1);var d=!0;for(c=s-1;c<o.textContent.length;c++)if(" "!==o.textContent.charAt(c)&&"\n"!==o.textContent.charAt(c)){d=!1;break}if(l)return void("function"==typeof e.options.input&&e.options.input(r(e)));if(d&&!(0,b.fb)(t.startContainer,"vditor-ir__marker")){var u=t.startContainer.previousSibling;return u&&3!==u.nodeType&&u.classList.contains("vditor-ir__node--expand")&&u.classList.remove("vditor-ir__node--expand"),void("function"==typeof e.options.input&&e.options.input(r(e)))}}if(e.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach((function(e){e.classList.remove("vditor-ir__node--expand")})),o||(o=e.ir.element),!o.querySelector("wbr")){var h=(0,b.fb)(t.startContainer,"vditor-ir__preview");h?h.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):t.insertNode(document.createElement("wbr"))}o.querySelectorAll("[style]").forEach((function(e){e.removeAttribute("style")})),"link-ref-defs-block"===o.getAttribute("data-type")&&(o=e.ir.element);var p,f=o.isEqualNode(e.ir.element),m=(0,b.a1)(o,"data-type","footnotes-block"),g="";if(f)g=o.innerHTML;else{var v=(0,w.S)(t.startContainer,"BLOCKQUOTE"),x=(0,b.O9)(t.startContainer);if(x&&(o=x),v&&(!x||x&&!v.contains(x))&&(o=v),m&&(o=m),g=o.outerHTML,"UL"===o.tagName||"OL"===o.tagName){var C=o.previousElementSibling,k=o.nextElementSibling;!C||"UL"!==C.tagName&&"OL"!==C.tagName||(g=C.outerHTML+g,C.remove()),!k||"UL"!==k.tagName&&"OL"!==k.tagName||(g+=k.outerHTML,k.remove()),g=g.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else o.previousElementSibling&&""!==o.previousElementSibling.textContent.replace(a.g.ZWSP,"")&&n&&"insertParagraph"===n.inputType&&(g=o.previousElementSibling.outerHTML+g,o.previousElementSibling.remove());o.innerText.startsWith("```")||(e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach((function(e){e&&!o.isEqualNode(e)&&(g+=e.outerHTML,e.remove())})),e.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach((function(e){e&&!o.isEqualNode(e)&&(g+=e.outerHTML,e.remove())})))}if(y("SpinVditorIRDOM",g,"argument",e.options.debugger),g=e.lute.SpinVditorIRDOM(g),y("SpinVditorIRDOM",g,"result",e.options.debugger),f)o.innerHTML=g;else if(o.outerHTML=g,m){var _=(0,b.a1)(e.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(_){var S=_.textContent,L=S.substring(1,S.indexOf("]:")),T=e.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'+L+'"]');T&&T.setAttribute("aria-label",S.substr(L.length+3).trim().substr(0,24))}}var D,E=e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");E.forEach((function(e,t){0===t?p=e:(p.insertAdjacentHTML("beforeend",e.innerHTML),e.remove())})),E.length>0&&e.ir.element.insertAdjacentElement("beforeend",E[0]);var F=e.ir.element.querySelectorAll("[data-type='footnotes-block']");F.forEach((function(e,t){0===t?D=e:(D.insertAdjacentHTML("beforeend",e.innerHTML),e.remove())})),F.length>0&&e.ir.element.insertAdjacentElement("beforeend",F[0]),(0,N.ib)(e.ir.element,t),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach((function(t){M(t,e)})),O(e),Tt(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},R=function(e,t){if(""===e)return!1;if(-1===e.indexOf("⇧")&&-1===e.indexOf("⌘")&&-1===e.indexOf("⌥"))return!((0,c.yl)(t)||t.altKey||t.shiftKey||t.code!==e);if("⇧Tab"===e)return!((0,c.yl)(t)||t.altKey||!t.shiftKey||"Tab"!==t.code);var i=e.split("");if(e.startsWith("⌥")){var n=3===i.length?i[2]:i[1];return!((3===i.length?!(0,c.yl)(t):(0,c.yl)(t))||!t.altKey||t.shiftKey||t.code!==(/^[0-9]$/.test(n)?"Digit":"Key")+n)}"⌘Enter"===e&&(i=["⌘","Enter"]);var a=i.length>2&&"⇧"===i[0],o=a?i[2]:i[1];return!a||!(0,c.vU)()&&/Mac/.test(navigator.platform)||("-"===o?o="_":"="===o&&(o="+")),!(!(0,c.yl)(t)||t.key.toLowerCase()!==o.toLowerCase()||t.altKey||!(!a&&!t.shiftKey||a&&t.shiftKey))},H=function(e,t){t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach((function(e){e.classList.remove("vditor-ir__node--expand")}));var i=(0,b.JQ)(e.startContainer,"vditor-ir__node"),n=!e.collapsed&&(0,b.JQ)(e.endContainer,"vditor-ir__node");if(e.collapsed||i&&i===n){i&&(i.classList.add("vditor-ir__node--expand"),i.classList.remove("vditor-ir__node--hidden"),(0,N.Hc)(e));var a=function(e){var t=e.startContainer;if(3===t.nodeType&&t.nodeValue.length!==e.startOffset)return!1;for(var i=t.nextSibling;i&&""===i.textContent;)i=i.nextSibling;if(!i){var n=(0,b.fb)(t,"vditor-ir__marker");if(n&&!n.nextSibling){var a=t.parentElement.parentElement.nextSibling;if(a&&3!==a.nodeType&&a.classList.contains("vditor-ir__node"))return a}return!1}return!(!i||3===i.nodeType||!i.classList.contains("vditor-ir__node")||i.getAttribute("data-block"))&&i}(e);if(a)return a.classList.add("vditor-ir__node--expand"),void a.classList.remove("vditor-ir__node--hidden");var o=function(e){var t=e.startContainer,i=t.previousSibling;return!(3!==t.nodeType||0!==e.startOffset||!i||3===i.nodeType||!i.classList.contains("vditor-ir__node")||i.getAttribute("data-block"))&&i}(e);return o?(o.classList.add("vditor-ir__node--expand"),void o.classList.remove("vditor-ir__node--hidden")):void 0}},j=i(863),q=function(e,t){var i,n=getSelection().getRangeAt(0).cloneRange(),a=n.startContainer;3!==n.startContainer.nodeType&&"DIV"===n.startContainer.tagName&&(a=n.startContainer.childNodes[n.startOffset-1]);var o=(0,b.a1)(a,"data-block","0");if(o&&t&&("deleteContentBackward"===t.inputType||" "===t.data)){for(var r=(0,N.im)(o,e.sv.element,n).start,s=!0,l=r-1;l>o.textContent.substr(0,r).lastIndexOf("\n");l--)if(" "!==o.textContent.charAt(l)&&"\t"!==o.textContent.charAt(l)){s=!1;break}if(0===r&&(s=!1),s)return void Ae(e);if("deleteContentBackward"===t.inputType){var c=(0,b.a1)(a,"data-type","code-block-open-marker")||(0,b.a1)(a,"data-type","code-block-close-marker");if(c){var d;if("code-block-close-marker"===c.getAttribute("data-type")&&(d=Me(a,"code-block-open-marker")))return d.textContent=c.textContent,void Ae(e);if("code-block-open-marker"===c.getAttribute("data-type")&&(d=Me(a,"code-block-close-marker",!1)))return d.textContent=c.textContent,void Ae(e)}var u=(0,b.a1)(a,"data-type","math-block-open-marker");if(u){var h=u.nextElementSibling.nextElementSibling;return void(h&&"math-block-close-marker"===h.getAttribute("data-type")&&(h.remove(),Ae(e)))}o.querySelectorAll('[data-type="code-block-open-marker"]').forEach((function(e){1===e.textContent.length&&e.remove()})),o.querySelectorAll('[data-type="code-block-close-marker"]').forEach((function(e){1===e.textContent.length&&e.remove()}));var p=(0,b.a1)(a,"data-type","heading-marker");if(p&&-1===p.textContent.indexOf("#"))return void Ae(e)}if((" "===t.data||"deleteContentBackward"===t.inputType)&&((0,b.a1)(a,"data-type","padding")||(0,b.a1)(a,"data-type","li-marker")||(0,b.a1)(a,"data-type","task-marker")||(0,b.a1)(a,"data-type","blockquote-marker")))return void Ae(e)}if(o&&"$$"===o.textContent.trimRight())Ae(e);else{o||(o=e.sv.element),"link-ref-defs-block"===(null===(i=o.firstElementChild)||void 0===i?void 0:i.getAttribute("data-type"))&&(o=e.sv.element),(0,b.a1)(a,"data-type","footnotes-link")&&(o=e.sv.element),-1===o.textContent.indexOf(Lute.Caret)&&n.insertNode(document.createTextNode(Lute.Caret)),o.querySelectorAll("[style]").forEach((function(e){e.removeAttribute("style")})),o.querySelectorAll("font").forEach((function(e){e.outerHTML=e.innerHTML}));var f,m=o.textContent,g=o.isEqualNode(e.sv.element);g?m=o.textContent:(o.previousElementSibling&&(m=o.previousElementSibling.textContent+m,o.previousElementSibling.remove()),o.previousElementSibling&&0===m.indexOf("---\n")&&(m=o.previousElementSibling.textContent+m,o.previousElementSibling.remove()),o.innerText.startsWith("```")||(e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach((function(e,t){0===t&&e&&!o.isEqualNode(e.parentElement)&&(m+="\n"+e.parentElement.textContent,e.parentElement.remove())})),e.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach((function(e,t){0===t&&e&&!o.isEqualNode(e.parentElement)&&(m+="\n"+e.parentElement.textContent,e.parentElement.remove())})))),m=Ne(m,e),g?o.innerHTML=m:o.outerHTML=m;var v,w=e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']");w.forEach((function(e,t){0===t?f=e.parentElement:(f.lastElementChild.remove(),f.insertAdjacentHTML("beforeend",""+e.parentElement.innerHTML),e.parentElement.remove())})),w.length>0&&e.sv.element.insertAdjacentElement("beforeend",f);var y=e.sv.element.querySelectorAll("[data-type='footnotes-link']");y.forEach((function(e,t){0===t?v=e.parentElement:(v.lastElementChild.remove(),v.insertAdjacentHTML("beforeend",""+e.parentElement.innerHTML),e.parentElement.remove())})),y.length>0&&e.sv.element.insertAdjacentElement("beforeend",v),(0,N.ib)(e.sv.element,n),De(e),Ae(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})}},z=i(227),B=function(e){"dark"===e.options.theme?e.element.classList.add("vditor--dark"):e.element.classList.remove("vditor--dark")},V=function(e){var t=window.innerWidth<=a.g.MOBILE_WIDTH?10:35;if("none"!==e.wysiwyg.element.parentElement.style.display){var i=(e.wysiwyg.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.wysiwyg.element.style.padding="10px "+Math.max(t,i)+"px"}"none"!==e.ir.element.parentElement.style.display&&(i=(e.ir.element.parentElement.clientWidth-e.options.preview.maxWidth)/2,e.ir.element.style.padding="10px "+Math.max(t,i)+"px"),"block"!==e.preview.element.style.display?e.toolbar.element.style.paddingLeft=Math.max(5,parseInt(e[e.currentMode].element.style.paddingLeft||"0",10)+("left"===e.options.outline.position?e.outline.element.offsetWidth:0))+"px":e.toolbar.element.style.paddingLeft=5+("left"===e.options.outline.position?e.outline.element.offsetWidth:0)+"px"},U=function(e){if(e.options.typewriterMode){var t=window.innerHeight;"number"==typeof e.options.height?(t=e.options.height,"number"==typeof e.options.minHeight&&(t=Math.max(t,e.options.minHeight)),t=Math.min(window.innerHeight,t)):t=e.element.clientHeight,e.element.classList.contains("vditor--fullscreen")&&(t=window.innerHeight),e[e.currentMode].element.style.setProperty("--editor-bottom",(t-e.toolbar.element.offsetHeight)/2+"px")}};function W(){window.removeEventListener("resize",e)}var G,X,K=function(t){U(t),W(),window.addEventListener("resize",e=function(){V(t),U(t)});var i=(0,c.pK)()&&localStorage.getItem(t.options.cache.id);return t.options.cache.enable&&i||(t.options.value?i=t.options.value:t.originalInnerHTML?i=t.lute.HTML2Md(t.originalInnerHTML):t.options.cache.enable||(i="")),i||""},Y=function(e){clearTimeout(e[e.currentMode].hlToolbarTimeoutId),e[e.currentMode].hlToolbarTimeoutId=window.setTimeout((function(){if("false"!==e[e.currentMode].element.getAttribute("contenteditable")&&(0,N.Gb)(e[e.currentMode].element)){d(e.toolbar.elements,a.g.EDIT_TOOLBARS),h(e.toolbar.elements,a.g.EDIT_TOOLBARS);var t=(0,N.zh)(e),i=t.startContainer;3===t.startContainer.nodeType&&(i=t.startContainer.parentElement),i.classList.contains("vditor-reset")&&(i=i.childNodes[t.startOffset]),("sv"===e.currentMode?(0,b.a1)(i,"data-type","heading"):(0,w.W)(i))&&u(e.toolbar.elements,["headings"]),("sv"===e.currentMode?(0,b.a1)(i,"data-type","blockquote"):(0,b.lG)(i,"BLOCKQUOTE"))&&u(e.toolbar.elements,["quote"]),(0,b.a1)(i,"data-type","strong")&&u(e.toolbar.elements,["bold"]),(0,b.a1)(i,"data-type","em")&&u(e.toolbar.elements,["italic"]),(0,b.a1)(i,"data-type","s")&&u(e.toolbar.elements,["strike"]),(0,b.a1)(i,"data-type","a")&&u(e.toolbar.elements,["link"]);var n=(0,b.lG)(i,"LI");n?(n.classList.contains("vditor-task")?u(e.toolbar.elements,["check"]):"OL"===n.parentElement.tagName?u(e.toolbar.elements,["ordered-list"]):"UL"===n.parentElement.tagName&&u(e.toolbar.elements,["list"]),h(e.toolbar.elements,["outdent","indent"])):p(e.toolbar.elements,["outdent","indent"]),(0,b.a1)(i,"data-type","code-block")&&(p(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),u(e.toolbar.elements,["code"])),(0,b.a1)(i,"data-type","code")&&(p(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),u(e.toolbar.elements,["inline-code"])),(0,b.a1)(i,"data-type","table")&&p(e.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}}),200)},J=function(e,t){void 0===t&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),clearTimeout(e.wysiwyg.afterRenderTimeoutId),e.wysiwyg.afterRenderTimeoutId=window.setTimeout((function(){if(!e.wysiwyg.composingLock){var i=r(e);"function"==typeof e.options.input&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,c.pK)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}}),e.options.undoDelay)},Q=function(e){for(var t="",i=e.nextSibling;i;)3===i.nodeType?t+=i.textContent:t+=i.outerHTML,i=i.nextSibling;return t},Z=function(e){for(var t="",i=e.previousSibling;i;)t=3===i.nodeType?i.textContent+t:i.outerHTML+t,i=i.previousSibling;return t},ee=function(e,t){Array.from(e.wysiwyg.element.childNodes).find((function(i){if(3===i.nodeType){var n=document.createElement("p");n.setAttribute("data-block","0"),n.textContent=i.textContent;var a=3===t.startContainer.nodeType?t.startOffset:i.textContent.length;return i.parentNode.insertBefore(n,i),i.remove(),t.setStart(n.firstChild,Math.min(n.firstChild.textContent.length,a)),t.collapse(!0),(0,N.Hc)(t),!0}if(!i.getAttribute("data-block"))return"P"===i.tagName?i.remove():("DIV"===i.tagName?(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'+i.innerHTML+"</p>"):"BR"===i.tagName?i.outerHTML='<p data-block="0">'+i.outerHTML+"<wbr></p>":(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'+i.outerHTML+"</p>"),(0,N.ib)(e.wysiwyg.element,t),t=getSelection().getRangeAt(0)),!0}))},te=function(e,t){var i=(0,N.zh)(e),n=(0,b.F9)(i.startContainer);n||(n=i.startContainer.childNodes[i.startOffset]),n||0!==e.wysiwyg.element.children.length||(n=e.wysiwyg.element),n&&!n.classList.contains("vditor-wysiwyg__block")&&(i.insertNode(document.createElement("wbr")),"<wbr>"===n.innerHTML.trim()&&(n.innerHTML="<wbr><br>"),"BLOCKQUOTE"===n.tagName||n.classList.contains("vditor-reset")?n.innerHTML="<"+t+' data-block="0">'+n.innerHTML.trim()+"</"+t+">":n.outerHTML="<"+t+' data-block="0">'+n.innerHTML.trim()+"</"+t+">",(0,N.ib)(e.wysiwyg.element,i),O(e))},ie=function(e){var t=getSelection().getRangeAt(0),i=(0,b.F9)(t.startContainer);i||(i=t.startContainer.childNodes[t.startOffset]),i&&(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'+i.innerHTML+"</p>",(0,N.ib)(e.wysiwyg.element,t)),e.wysiwyg.popover.style.display="none"},ne=function(e,t,i){void 0===i&&(i=!0);var n=e.previousElementSibling,a=n.ownerDocument.createRange();"CODE"===n.tagName?(n.style.display="inline-block",i?a.setStart(n.firstChild,1):a.selectNodeContents(n)):(n.style.display="block",n.firstChild.firstChild||n.firstChild.appendChild(document.createTextNode("")),a.selectNodeContents(n.firstChild)),i?a.collapse(!0):a.collapse(!1),(0,N.Hc)(a),e.firstElementChild.classList.contains("language-mindmap")||De(t)},ae=function(e,t){if(R("⇧⌘X",t)){var i=e.wysiwyg.popover.querySelector('[data-type="remove"]');return i&&i.click(),t.preventDefault(),!0}},oe=function(e){clearTimeout(e.wysiwyg.hlToolbarTimeoutId),e.wysiwyg.hlToolbarTimeoutId=window.setTimeout((function(){if("false"!==e.wysiwyg.element.getAttribute("contenteditable")&&(0,N.Gb)(e.wysiwyg.element)){d(e.toolbar.elements,a.g.EDIT_TOOLBARS),h(e.toolbar.elements,a.g.EDIT_TOOLBARS);var t=getSelection().getRangeAt(0),i=t.startContainer;i=3===t.startContainer.nodeType?t.startContainer.parentElement:i.childNodes[t.startOffset>=i.childNodes.length?i.childNodes.length-1:t.startOffset];var n=(0,b.a1)(i,"data-type","footnotes-block");if(n)return e.wysiwyg.popover.innerHTML="",de(n,e),void re(e,n);var o=(0,b.lG)(i,"LI");o?(o.classList.contains("vditor-task")?u(e.toolbar.elements,["check"]):"OL"===o.parentElement.tagName?u(e.toolbar.elements,["ordered-list"]):"UL"===o.parentElement.tagName&&u(e.toolbar.elements,["list"]),h(e.toolbar.elements,["outdent","indent"])):p(e.toolbar.elements,["outdent","indent"]),(0,b.lG)(i,"BLOCKQUOTE")&&u(e.toolbar.elements,["quote"]),((0,b.lG)(i,"B")||(0,b.lG)(i,"STRONG"))&&u(e.toolbar.elements,["bold"]),((0,b.lG)(i,"I")||(0,b.lG)(i,"EM"))&&u(e.toolbar.elements,["italic"]),((0,b.lG)(i,"STRIKE")||(0,b.lG)(i,"S"))&&u(e.toolbar.elements,["strike"]),e.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach((function(e){e.classList.remove("vditor-comment--focus")}));var r=(0,b.fb)(i,"vditor-comment");if(r){var s=r.getAttribute("data-cmtids").split(" ");if(s.length>1&&r.nextSibling.isSameNode(r.nextElementSibling)){var l=r.nextElementSibling.getAttribute("data-cmtids").split(" ");s.find((function(e){if(l.includes(e))return s=[e],!0}))}e.wysiwyg.element.querySelectorAll(".vditor-comment").forEach((function(e){e.getAttribute("data-cmtids").indexOf(s[0])>-1&&e.classList.add("vditor-comment--focus")}))}var f=(0,b.lG)(i,"A");f&&u(e.toolbar.elements,["link"]);var m=(0,b.lG)(i,"TABLE"),g=(0,w.W)(i);(0,b.lG)(i,"CODE")?(0,b.lG)(i,"PRE")?(p(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),u(e.toolbar.elements,["code"])):(p(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),u(e.toolbar.elements,["inline-code"])):g?(p(e.toolbar.elements,["bold"]),u(e.toolbar.elements,["headings"])):m&&p(e.toolbar.elements,["table"]);var v=(0,b.fb)(i,"vditor-toc");if(v)return e.wysiwyg.popover.innerHTML="",de(v,e),void re(e,v);var y=(0,w.S)(i,"BLOCKQUOTE");if(y&&(e.wysiwyg.popover.innerHTML="",le(t,y,e),ce(t,y,e),de(y,e),re(e,y)),o&&(e.wysiwyg.popover.innerHTML="",le(t,o,e),ce(t,o,e),de(o,e),re(e,o)),m){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var x=function(){var e=m.rows.length,t=m.rows[0].cells.length,i=parseInt($.value,10)||e,n=parseInt(H.value,10)||t;if(i!==e||t!==n){if(t!==n)for(var a=n-t,o=0;o<m.rows.length;o++)if(a>0)for(var r=0;r<a;r++)0===o?m.rows[o].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):m.rows[o].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var s=t-1;s>=n;s--)m.rows[o].cells[s].remove();if(e!==i){var l=i-e;if(l>0){for(var c="<tr>",d=0;d<n;d++)c+="<td> </td>";for(var u=0;u<l;u++)m.querySelector("tbody")?m.querySelector("tbody").insertAdjacentHTML("beforeend",c):m.querySelector("thead").insertAdjacentHTML("afterend",c+"</tr>")}else for(d=e-1;d>=i;d--)m.rows[d].remove(),1===m.rows.length&&m.querySelector("tbody").remove()}}},C=function(i){rt(m,i),"right"===i?(L.classList.remove("vditor-icon--current"),T.classList.remove("vditor-icon--current"),D.classList.add("vditor-icon--current")):"center"===i?(L.classList.remove("vditor-icon--current"),D.classList.remove("vditor-icon--current"),T.classList.add("vditor-icon--current")):(T.classList.remove("vditor-icon--current"),D.classList.remove("vditor-icon--current"),L.classList.add("vditor-icon--current")),(0,N.Hc)(t),J(e)},k=(0,b.lG)(i,"TD"),_=(0,b.lG)(i,"TH"),S="left";k?S=k.getAttribute("align")||"left":_&&(S=_.getAttribute("align")||"center");var L=document.createElement("button");L.setAttribute("type","button"),L.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,c.ns)("⇧⌘L")+">"),L.setAttribute("data-type","left"),L.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',L.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+("left"===S?" vditor-icon--current":""),L.onclick=function(){C("left")};var T=document.createElement("button");T.setAttribute("type","button"),T.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,c.ns)("⇧⌘C")+">"),T.setAttribute("data-type","center"),T.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',T.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+("center"===S?" vditor-icon--current":""),T.onclick=function(){C("center")};var D=document.createElement("button");D.setAttribute("type","button"),D.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,c.ns)("⇧⌘R")+">"),D.setAttribute("data-type","right"),D.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',D.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+("right"===S?" vditor-icon--current":""),D.onclick=function(){C("right")};var E=document.createElement("button");E.setAttribute("type","button"),E.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,c.ns)("⌘=")+">"),E.setAttribute("data-type","insertRow"),E.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',E.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",E.onclick=function(){var i=getSelection().getRangeAt(0).startContainer,n=(0,b.lG)(i,"TD")||(0,b.lG)(i,"TH");n&&pt(e,t,n)};var F=document.createElement("button");F.setAttribute("type","button"),F.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,c.ns)("⇧⌘F")+">"),F.setAttribute("data-type","insertRow"),F.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',F.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",F.onclick=function(){var i=getSelection().getRangeAt(0).startContainer,n=(0,b.lG)(i,"TD")||(0,b.lG)(i,"TH");n&&ft(e,t,n)};var I=document.createElement("button");I.setAttribute("type","button"),I.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,c.ns)("⇧⌘=")+">"),I.setAttribute("data-type","insertColumn"),I.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',I.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",I.onclick=function(){var t=getSelection().getRangeAt(0).startContainer,i=(0,b.lG)(t,"TD")||(0,b.lG)(t,"TH");i&&mt(e,m,i)};var O=document.createElement("button");O.setAttribute("type","button"),O.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,c.ns)("⇧⌘G")+">"),O.setAttribute("data-type","insertColumn"),O.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',O.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",O.onclick=function(){var t=getSelection().getRangeAt(0).startContainer,i=(0,b.lG)(t,"TD")||(0,b.lG)(t,"TH");i&&mt(e,m,i,"beforebegin")};var A=document.createElement("button");A.setAttribute("type","button"),A.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,c.ns)("⌘-")+">"),A.setAttribute("data-type","deleteRow"),A.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',A.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",A.onclick=function(){var i=getSelection().getRangeAt(0).startContainer,n=(0,b.lG)(i,"TD")||(0,b.lG)(i,"TH");n&&gt(e,t,n)};var P=document.createElement("button");P.setAttribute("type","button"),P.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,c.ns)("⇧⌘-")+">"),P.setAttribute("data-type","deleteColumn"),P.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',P.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",P.onclick=function(){var i=getSelection().getRangeAt(0).startContainer,n=(0,b.lG)(i,"TD")||(0,b.lG)(i,"TH");n&&vt(e,t,m,n)},(X=document.createElement("span")).setAttribute("aria-label",window.VditorI18n.row),X.className="vditor-tooltipped vditor-tooltipped__n";var $=document.createElement("input");X.appendChild($),$.type="number",$.min="1",$.className="vditor-input",$.style.width="42px",$.style.textAlign="center",$.setAttribute("placeholder",window.VditorI18n.row),$.value=m.rows.length.toString(),$.oninput=function(){x()},$.onkeydown=function(i){if(!i.isComposing)return"Tab"===i.key?(H.focus(),H.select(),void i.preventDefault()):void(ae(e,i)||pe(i,t))};var R=document.createElement("span");R.setAttribute("aria-label",window.VditorI18n.column),R.className="vditor-tooltipped vditor-tooltipped__n";var H=document.createElement("input");R.appendChild(H),H.type="number",H.min="1",H.className="vditor-input",H.style.width="42px",H.style.textAlign="center",H.setAttribute("placeholder",window.VditorI18n.column),H.value=m.rows[0].cells.length.toString(),H.oninput=function(){x()},H.onkeydown=function(i){if(!i.isComposing)return"Tab"===i.key?($.focus(),$.select(),void i.preventDefault()):void(ae(e,i)||pe(i,t))},le(t,m,e),ce(t,m,e),de(m,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",L),e.wysiwyg.popover.insertAdjacentElement("beforeend",T),e.wysiwyg.popover.insertAdjacentElement("beforeend",D),e.wysiwyg.popover.insertAdjacentElement("beforeend",F),e.wysiwyg.popover.insertAdjacentElement("beforeend",E),e.wysiwyg.popover.insertAdjacentElement("beforeend",O),e.wysiwyg.popover.insertAdjacentElement("beforeend",I),e.wysiwyg.popover.insertAdjacentElement("beforeend",A),e.wysiwyg.popover.insertAdjacentElement("beforeend",P),e.wysiwyg.popover.insertAdjacentElement("beforeend",X),e.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),e.wysiwyg.popover.insertAdjacentElement("beforeend",R),re(e,m)}var j=(0,b.a1)(i,"data-type","link-ref");j&&se(e,j,t);var q=(0,b.a1)(i,"data-type","footnotes-ref");if(q){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="",(X=document.createElement("span")).setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,c.ns)("⌥Enter")+">"),X.className="vditor-tooltipped vditor-tooltipped__n";var z=document.createElement("input");X.appendChild(z),z.className="vditor-input",z.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,c.ns)("⌥Enter")+">"),z.style.width="120px",z.value=q.getAttribute("data-footnotes-label"),z.oninput=function(){""!==z.value.trim()&&q.setAttribute("data-footnotes-label",z.value)},z.onkeydown=function(i){i.isComposing||ae(e,i)||pe(i,t)},de(q,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",X),re(e,q)}var B=(0,b.fb)(i,"vditor-wysiwyg__block"),V=!!B&&B.getAttribute("data-type").indexOf("block")>-1;if(e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach((function(e){(!B||B&&V&&!B.contains(e))&&(e.previousElementSibling.style.display="none")})),B&&V){if(e.wysiwyg.popover.innerHTML="",le(t,B,e),ce(t,B,e),de(B,e),"code-block"===B.getAttribute("data-type")){var U=document.createElement("span");U.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,c.ns)("⌥Enter")+">"),U.className="vditor-tooltipped vditor-tooltipped__n";var W=document.createElement("input");U.appendChild(W);var G=B.firstElementChild.firstElementChild;W.className="vditor-input",W.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,c.ns)("⌥Enter")+">"),W.value=G.className.indexOf("language-")>-1?G.className.split("-")[1].split(" ")[0]:"",W.oninput=function(i){""!==W.value.trim()?G.className="language-"+W.value:(G.className="",e.hint.recentLanguage=""),B.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(B.lastElementChild.innerHTML=B.firstElementChild.innerHTML,M(B.lastElementChild,e)),J(e),1===i.detail&&(t.setStart(G.firstChild,0),t.collapse(!0),(0,N.Hc)(t))},W.onkeydown=function(i){if(!i.isComposing&&!ae(e,i)){if("Escape"===i.key&&"block"===e.hint.element.style.display)return e.hint.element.style.display="none",void i.preventDefault();e.hint.select(i,e),pe(i,t)}},W.onkeyup=function(t){if(!t.isComposing&&"Enter"!==t.key&&"ArrowUp"!==t.key&&"Escape"!==t.key&&"ArrowDown"!==t.key){var i=[],n=W.value.substring(0,W.selectionStart);a.g.CODE_LANGUAGES.forEach((function(e){e.indexOf(n.toLowerCase())>-1&&i.push({html:e,value:e})})),e.hint.genHTML(i,n,e),t.preventDefault()}},e.wysiwyg.popover.insertAdjacentElement("beforeend",U)}re(e,B)}else B=void 0;if(g){var X;e.wysiwyg.popover.innerHTML="",(X=document.createElement("span")).setAttribute("aria-label","ID<"+(0,c.ns)("⌥Enter")+">"),X.className="vditor-tooltipped vditor-tooltipped__n";var K=document.createElement("input");X.appendChild(K),K.className="vditor-input",K.setAttribute("placeholder","ID<"+(0,c.ns)("⌥Enter")+">"),K.style.width="120px",K.value=g.getAttribute("data-id")||"",K.oninput=function(){g.setAttribute("data-id",K.value)},K.onkeydown=function(i){i.isComposing||ae(e,i)||pe(i,t)},le(t,g,e),ce(t,g,e),de(g,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",X),re(e,g)}if(f&&he(e,f,t),!(y||o||m||B||f||j||q||g||v)){var Y=(0,b.a1)(i,"data-block","0");Y&&Y.parentElement.isEqualNode(e.wysiwyg.element)?(e.wysiwyg.popover.innerHTML="",le(t,Y,e),ce(t,Y,e),de(Y,e),re(e,Y)):e.wysiwyg.popover.style.display="none"}e.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach((function(e){e.style.display="none"}));var Q=(0,b.a1)(t.startContainer,"data-type","backslash");Q&&(Q.querySelector("span").style.display="inline")}}),200)},re=function(e,t){var i=t,n=(0,b.lG)(t,"TABLE");n&&(i=n),e.wysiwyg.popover.style.left="0",e.wysiwyg.popover.style.display="block",e.wysiwyg.popover.style.top=Math.max(-8,i.offsetTop-21-e.wysiwyg.element.scrollTop)+"px",e.wysiwyg.popover.style.left=Math.min(i.offsetLeft,e.wysiwyg.element.clientWidth-e.wysiwyg.popover.clientWidth)+"px",e.wysiwyg.popover.setAttribute("data-top",(i.offsetTop-21).toString())},se=function(e,t,i){void 0===i&&(i=getSelection().getRangeAt(0)),e.wysiwyg.popover.innerHTML="";var n=function(){""!==o.value.trim()&&("IMG"===t.tagName?t.setAttribute("alt",o.value):t.textContent=o.value),""!==s.value.trim()&&t.setAttribute("data-link-label",s.value)},a=document.createElement("span");a.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),a.className="vditor-tooltipped vditor-tooltipped__n";var o=document.createElement("input");a.appendChild(o),o.className="vditor-input",o.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),o.style.width="120px",o.value=t.getAttribute("alt")||t.textContent,o.oninput=function(){n()},o.onkeydown=function(n){ae(e,n)||pe(n,i)||ue(e,t,n,s)};var r=document.createElement("span");r.setAttribute("aria-label",window.VditorI18n.linkRef),r.className="vditor-tooltipped vditor-tooltipped__n";var s=document.createElement("input");r.appendChild(s),s.className="vditor-input",s.setAttribute("placeholder",window.VditorI18n.linkRef),s.value=t.getAttribute("data-link-label"),s.oninput=function(){n()},s.onkeydown=function(n){ae(e,n)||pe(n,i)||ue(e,t,n,o)},de(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",a),e.wysiwyg.popover.insertAdjacentElement("beforeend",r),re(e,t)},le=function(e,t,i){var n=t.previousElementSibling;if(n&&(t.parentElement.isEqualNode(i.wysiwyg.element)||"LI"===t.tagName)){var a=document.createElement("button");a.setAttribute("type","button"),a.setAttribute("data-type","up"),a.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,c.ns)("⇧⌘U")+">"),a.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',a.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",a.onclick=function(){e.insertNode(document.createElement("wbr")),n.insertAdjacentElement("beforebegin",t),(0,N.ib)(i.wysiwyg.element,e),J(i),oe(i),De(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",a)}},ce=function(e,t,i){var n=t.nextElementSibling;if(n&&(t.parentElement.isEqualNode(i.wysiwyg.element)||"LI"===t.tagName)){var a=document.createElement("button");a.setAttribute("type","button"),a.setAttribute("data-type","down"),a.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,c.ns)("⇧⌘D")+">"),a.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',a.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",a.onclick=function(){e.insertNode(document.createElement("wbr")),n.insertAdjacentElement("afterend",t),(0,N.ib)(i.wysiwyg.element,e),J(i),oe(i),De(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",a)}},de=function(e,t){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","remove"),i.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,c.ns)("⇧⌘X")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){var i=(0,N.zh)(t);i.setStartAfter(e),(0,N.Hc)(i),e.remove(),J(t),oe(t),["H1","H2","H3","H4","H5","H6"].includes(e.tagName)&&O(t)},t.wysiwyg.popover.insertAdjacentElement("beforeend",i)},ue=function(e,t,i,n){if(!i.isComposing){if("Tab"===i.key)return n.focus(),n.select(),void i.preventDefault();if(!(0,c.yl)(i)&&!i.shiftKey&&i.altKey&&"Enter"===i.key){var o=(0,N.zh)(e);t.insertAdjacentHTML("afterend",a.g.ZWSP),o.setStartAfter(t.nextSibling),o.collapse(!0),(0,N.Hc)(o),i.preventDefault()}}},he=function(e,t,i){e.wysiwyg.popover.innerHTML="";var n=function(){""!==o.value.trim()&&(t.innerHTML=o.value),t.setAttribute("href",s.value),t.setAttribute("title",c.value),J(e)};t.querySelectorAll("[data-marker]").forEach((function(e){e.removeAttribute("data-marker")}));var a=document.createElement("span");a.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),a.className="vditor-tooltipped vditor-tooltipped__n";var o=document.createElement("input");a.appendChild(o),o.className="vditor-input",o.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),o.style.width="120px",o.value=t.innerHTML||"",o.oninput=function(){n()},o.onkeydown=function(n){ae(e,n)||pe(n,i)||ue(e,t,n,s)};var r=document.createElement("span");r.setAttribute("aria-label",window.VditorI18n.link),r.className="vditor-tooltipped vditor-tooltipped__n";var s=document.createElement("input");r.appendChild(s),s.className="vditor-input",s.setAttribute("placeholder",window.VditorI18n.link),s.value=t.getAttribute("href")||"",s.oninput=function(){n()},s.onkeydown=function(n){ae(e,n)||pe(n,i)||ue(e,t,n,c)};var l=document.createElement("span");l.setAttribute("aria-label",window.VditorI18n.tooltipText),l.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");l.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.tooltipText),c.style.width="60px",c.value=t.getAttribute("title")||"",c.oninput=function(){n()},c.onkeydown=function(n){ae(e,n)||pe(n,i)||ue(e,t,n,o)},de(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",a),e.wysiwyg.popover.insertAdjacentElement("beforeend",r),e.wysiwyg.popover.insertAdjacentElement("beforeend",l),re(e,t)},pe=function(e,t){if(!(0,c.yl)(e)&&!e.shiftKey&&"Enter"===e.key||"Escape"===e.key)return t&&(0,N.Hc)(t),e.preventDefault(),e.stopPropagation(),!0},fe=function(e){"wysiwyg"===e.currentMode?oe(e):"ir"===e.currentMode&&Y(e)},me=function(e,t,i){void 0===i&&(i={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var n=e.wysiwyg.element;n.innerHTML=e.lute.Md2VditorDOM(t),n.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach((function(t){M(t,e),t.previousElementSibling.setAttribute("style","display:none")})),J(e,i)},ge=function(e,t,i){for(var n=e.startContainer.parentElement,o=!1,r="",s="",l=function(e){var t=Z(e.startContainer),i=Q(e.startContainer),n=e.startContainer.textContent,o=e.startOffset,r="",s="";return(""!==n.substr(0,o)&&n.substr(0,o)!==a.g.ZWSP||t)&&(r=""+t+n.substr(0,o)),(""!==n.substr(o)&&n.substr(o)!==a.g.ZWSP||i)&&(s=""+n.substr(o)+i),{afterHTML:s,beforeHTML:r}}(e),c=l.beforeHTML,d=l.afterHTML;n&&!o;){var u=n.tagName;if("STRIKE"===u&&(u="S"),"I"===u&&(u="EM"),"B"===u&&(u="STRONG"),"S"===u||"STRONG"===u||"EM"===u){var h="",p="",f="";"0"!==n.parentElement.getAttribute("data-block")&&(p=Z(n),f=Q(n)),(c||p)&&(c=h=p+"<"+u+">"+c+"</"+u+">"),("bold"===i&&"STRONG"===u||"italic"===i&&"EM"===u||"strikeThrough"===i&&"S"===u)&&(h+=""+r+a.g.ZWSP+"<wbr>"+s,o=!0),(d||f)&&(h+=d="<"+u+">"+d+"</"+u+">"+f),"0"!==n.parentElement.getAttribute("data-block")?(n=n.parentElement).innerHTML=h:(n.outerHTML=h,n=n.parentElement),r="<"+u+">"+r,s="</"+u+">"+s}else o=!0}(0,N.ib)(t.wysiwyg.element,e)},ve=function(e,t){var i,n=this;this.element=document.createElement("div"),t.className&&(i=this.element.classList).add.apply(i,t.className.split(" "));var o=t.hotkey?" <"+(0,c.ns)(t.hotkey)+">":"";2===t.level&&(o=t.hotkey?" &lt;"+(0,c.ns)(t.hotkey)+"&gt;":"");var r=t.tip?t.tip+o:""+window.VditorI18n[t.name]+o,s="upload"===t.name?"div":"button";if(2===t.level)this.element.innerHTML="<"+s+' data-type="'+t.name+'">'+r+"</"+s+">";else{this.element.classList.add("vditor-toolbar__item");var l=document.createElement(s);l.setAttribute("data-type",t.name),l.className="vditor-tooltipped vditor-tooltipped__"+t.tipPosition,l.setAttribute("aria-label",r),l.innerHTML=t.icon,this.element.appendChild(l)}t.prefix&&this.element.children[0].addEventListener((0,c.Le)(),(function(i){i.preventDefault(),n.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)||("wysiwyg"===e.currentMode?function(e,t,i){if(!(e.wysiwyg.composingLock&&i instanceof CustomEvent)){var n=!0,o=!0;e.wysiwyg.element.querySelector("wbr")&&e.wysiwyg.element.querySelector("wbr").remove();var r=(0,N.zh)(e),s=t.getAttribute("data-type");if(t.classList.contains("vditor-menu--current"))if("strike"===s&&(s="strikeThrough"),"quote"===s){var l=(0,b.lG)(r.startContainer,"BLOCKQUOTE");l||(l=r.startContainer.childNodes[r.startOffset]),l&&(n=!1,t.classList.remove("vditor-menu--current"),r.insertNode(document.createElement("wbr")),l.outerHTML=""===l.innerHTML.trim()?'<p data-block="0">'+l.innerHTML+"</p>":l.innerHTML,(0,N.ib)(e.wysiwyg.element,r))}else if("inline-code"===s){var c=(0,b.lG)(r.startContainer,"CODE");c||(c=r.startContainer.childNodes[r.startOffset]),c&&(c.outerHTML=c.innerHTML.replace(a.g.ZWSP,"")+"<wbr>",(0,N.ib)(e.wysiwyg.element,r))}else"link"===s?r.collapsed?(r.selectNode(r.startContainer.parentElement),document.execCommand("unlink",!1,"")):document.execCommand("unlink",!1,""):"check"===s||"list"===s||"ordered-list"===s?(nt(e,r,s),(0,N.ib)(e.wysiwyg.element,r),n=!1,t.classList.remove("vditor-menu--current")):(n=!1,t.classList.remove("vditor-menu--current"),""===r.toString()?ge(r,e,s):document.execCommand(s,!1,""));else{0===e.wysiwyg.element.childNodes.length&&(e.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,N.ib)(e.wysiwyg.element,r));var u=(0,b.F9)(r.startContainer);if("quote"===s){if(u||(u=r.startContainer.childNodes[r.startOffset]),u){n=!1,t.classList.add("vditor-menu--current"),r.insertNode(document.createElement("wbr"));var h=(0,b.lG)(r.startContainer,"LI");h&&u.contains(h)?h.innerHTML='<blockquote data-block="0">'+h.innerHTML+"</blockquote>":u.outerHTML='<blockquote data-block="0">'+u.outerHTML+"</blockquote>",(0,N.ib)(e.wysiwyg.element,r)}}else if("check"===s||"list"===s||"ordered-list"===s)nt(e,r,s,!1),(0,N.ib)(e.wysiwyg.element,r),n=!1,d(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current");else if("inline-code"===s){if(""===r.toString())(p=document.createElement("code")).textContent=a.g.ZWSP,r.insertNode(p),r.setStart(p.firstChild,1),r.collapse(!0),(0,N.Hc)(r);else if(3===r.startContainer.nodeType){var p=document.createElement("code");r.surroundContents(p),r.insertNode(p),(0,N.Hc)(r)}t.classList.add("vditor-menu--current")}else if("code"===s)(p=document.createElement("div")).className="vditor-wysiwyg__block",p.setAttribute("data-type","code-block"),p.setAttribute("data-block","0"),p.setAttribute("data-marker","```"),""===r.toString()?p.innerHTML="<pre><code><wbr>\n</code></pre>":(p.innerHTML="<pre><code>"+r.toString()+"<wbr></code></pre>",r.deleteContents()),r.insertNode(p),u&&(u.outerHTML=e.lute.SpinVditorDOM(u.outerHTML)),(0,N.ib)(e.wysiwyg.element,r),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach((function(t){M(t,e)})),t.classList.add("vditor-menu--disabled");else if("link"===s){if(""===r.toString()){var f=document.createElement("a");f.innerText=a.g.ZWSP,r.insertNode(f),r.setStart(f.firstChild,1),r.collapse(!0),he(e,f,r);var m=e.wysiwyg.popover.querySelector("input");m.value="",m.focus(),o=!1}else{(p=document.createElement("a")).setAttribute("href",""),p.innerHTML=r.toString(),r.surroundContents(p),r.insertNode(p),(0,N.Hc)(r),he(e,p,r);var g=e.wysiwyg.popover.querySelectorAll("input");g[0].value=p.innerText,g[1].focus()}n=!1,t.classList.add("vditor-menu--current")}else if("table"===s){var v='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(""===r.toString().trim())u&&""===u.innerHTML.trim().replace(a.g.ZWSP,"")?u.outerHTML=v:document.execCommand("insertHTML",!1,v),r.selectNode(e.wysiwyg.element.querySelector("wbr").previousSibling),e.wysiwyg.element.querySelector("wbr").remove(),(0,N.Hc)(r);else{v='<table data-block="0"><thead><tr>';var w=r.toString().split("\n"),y=w[0].split(",").length>w[0].split("\t").length?",":"\t";w.forEach((function(e,t){0===t?(e.split(y).forEach((function(e,t){v+=0===t?"<th>"+e+"<wbr></th>":"<th>"+e+"</th>"})),v+="</tr></thead>"):(v+=1===t?"<tbody><tr>":"<tr>",e.split(y).forEach((function(e){v+="<td>"+e+"</td>"})),v+="</tr>")})),v+="</tbody></table>",document.execCommand("insertHTML",!1,v),(0,N.ib)(e.wysiwyg.element,r)}n=!1,t.classList.add("vditor-menu--disabled")}else if("line"===s){if(u){var x='<hr data-block="0"><p data-block="0"><wbr>\n</p>';""===u.innerHTML.trim()?u.outerHTML=x:u.insertAdjacentHTML("afterend",x),(0,N.ib)(e.wysiwyg.element,r)}}else if(n=!1,t.classList.add("vditor-menu--current"),"strike"===s&&(s="strikeThrough"),""!==r.toString()||"bold"!==s&&"italic"!==s&&"strikeThrough"!==s)document.execCommand(s,!1,"");else{var C="strong";"italic"===s?C="em":"strikeThrough"===s&&(C="s"),(p=document.createElement(C)).textContent=a.g.ZWSP,r.insertNode(p),p.previousSibling&&p.previousSibling.textContent===a.g.ZWSP&&(p.previousSibling.textContent=""),r.setStart(p.firstChild,1),r.collapse(!0),(0,N.Hc)(r)}}n&&oe(e),o&&J(e)}}(e,n.element.children[0],i):"ir"===e.currentMode?Ft(e,n.element.children[0],t.prefix||"",t.suffix||""):$e(e,n.element.children[0],t.prefix||"",t.suffix||""))}))},be=(G=function(e,t){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},G(e,t)},function(e,t){function i(){this.constructor=e}G(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),we=function(e,t,i){var n;if("string"!=typeof i?(g(e,["subToolbar","hint"]),i.preventDefault(),n=r(e)):n=i,e.currentMode!==t||"string"==typeof i){if(e.devtools&&e.devtools.renderEchart(e),"both"===e.options.preview.mode&&"sv"===t?e.preview.element.style.display="block":e.preview.element.style.display="none",h(e.toolbar.elements,a.g.EDIT_TOOLBARS),d(e.toolbar.elements,a.g.EDIT_TOOLBARS),p(e.toolbar.elements,["outdent","indent"]),"ir"===t)f(e.toolbar.elements,["both"]),m(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="block",e.lute.SetVditorIR(!0),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!1),e.currentMode="ir",e.ir.element.innerHTML=e.lute.Md2VditorIRDOM(n),Tt(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),V(e),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach((function(t){M(t,e)})),e.ir.element.querySelectorAll(".vditor-toc").forEach((function(t){(0,T.H)(t,{cdn:e.options.cdn,math:e.options.preview.math})}));else if("wysiwyg"===t)f(e.toolbar.elements,["both"]),m(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="block",e.ir.element.parentElement.style.display="none",e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!0),e.lute.SetVditorSV(!1),e.currentMode="wysiwyg",V(e),me(e,n,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),e.wysiwyg.element.querySelectorAll(".vditor-toc").forEach((function(t){(0,T.H)(t,{cdn:e.options.cdn,math:e.options.preview.math})})),e.wysiwyg.popover.style.display="none";else if("sv"===t){m(e.toolbar.elements,["both"]),f(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="none",("both"===e.options.preview.mode||"editor"===e.options.preview.mode)&&(e.sv.element.style.display="block"),e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!0),e.currentMode="sv";var o=Ne(n,e);"<div data-block='0'></div>"===o&&(o=""),e.sv.element.innerHTML=o,Ae(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),V(e)}e.undo.resetIcon(e),"string"!=typeof i&&(e[e.currentMode].element.focus(),fe(e)),O(e),U(e),e.toolbar.elements["edit-mode"]&&(e.toolbar.elements["edit-mode"].querySelectorAll("button").forEach((function(e){e.classList.remove("vditor-menu--current")})),e.toolbar.elements["edit-mode"].querySelector('button[data-mode="'+e.currentMode+'"]').classList.add("vditor-menu--current")),e.outline.toggle(e,"sv"!==e.currentMode&&e.options.outline.enable,"string"!=typeof i)}},ye=function(e){function t(t,i){var n=e.call(this,t,i)||this,a=document.createElement("div");return a.className="vditor-hint"+(2===i.level?"":" vditor-panel--arrow"),a.innerHTML='<button data-mode="wysiwyg">'+window.VditorI18n.wysiwyg+" &lt;"+(0,c.ns)("⌥⌘7")+'></button>\n<button data-mode="ir">'+window.VditorI18n.instantRendering+" &lt;"+(0,c.ns)("⌥⌘8")+'></button>\n<button data-mode="sv">'+window.VditorI18n.splitView+" &lt;"+(0,c.ns)("⌥⌘9")+"></button>",n.element.appendChild(a),n._bindEvent(t,a,i),n}return be(t,e),t.prototype._bindEvent=function(e,t,i){var n=this.element.children[0];v(e,t,n,i.level),t.children.item(0).addEventListener((0,c.Le)(),(function(t){we(e,"wysiwyg",t),t.preventDefault(),t.stopPropagation()})),t.children.item(1).addEventListener((0,c.Le)(),(function(t){we(e,"ir",t),t.preventDefault(),t.stopPropagation()})),t.children.item(2).addEventListener((0,c.Le)(),(function(t){we(e,"sv",t),t.preventDefault(),t.stopPropagation()}))},t}(ve),xe=function(e,t){return(0,N.Gb)(e,t)?getSelection().toString():""},Ce=function(e,t){t.addEventListener("focus",(function(){e.options.focus&&e.options.focus(r(e)),g(e,["subToolbar","hint"])}))},ke=function(e,t){t.addEventListener("dblclick",(function(t){"IMG"===t.target.tagName&&(e.options.image.preview?e.options.image.preview(t.target):e.options.image.isPreview&&(0,j.E)(t.target,e.options.lang,e.options.theme))}))},_e=function(e,t){t.addEventListener("blur",(function(t){if("ir"===e.currentMode){var i=e.ir.element.querySelector(".vditor-ir__node--expand");i&&i.classList.remove("vditor-ir__node--expand")}else"wysiwyg"!==e.currentMode||e.wysiwyg.selectPopover.contains(t.relatedTarget)||e.wysiwyg.hideComment();e[e.currentMode].range=(0,N.zh)(e),e.options.blur&&e.options.blur(r(e))}))},Se=function(e,t){t.addEventListener("dragstart",(function(e){e.dataTransfer.setData(a.g.DROP_EDITOR,a.g.DROP_EDITOR)})),t.addEventListener("drop",(function(t){t.dataTransfer.getData(a.g.DROP_EDITOR)?ct(e):(t.dataTransfer.types.includes("Files")||t.dataTransfer.types.includes("text/html"))&&St(e,t,{pasteCode:function(e){document.execCommand("insertHTML",!1,e)}})}))},Le=function(e,t,i){t.addEventListener("copy",(function(t){return i(t,e)}))},Te=function(e,t,i){t.addEventListener("cut",(function(t){i(t,e),e.options.comment.enable&&"wysiwyg"===e.currentMode&&e.wysiwyg.getComments(e),document.execCommand("delete")}))},De=function(e){if("wysiwyg"===e.currentMode&&e.options.comment.enable&&e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)),e.options.typewriterMode){var t=e[e.currentMode].element,i=(0,N.Ny)(t).top;"auto"!==e.options.height||e.element.classList.contains("vditor--fullscreen")||window.scrollTo(window.scrollX,i+e.element.offsetTop+e.toolbar.element.offsetHeight-window.innerHeight/2+10),("auto"!==e.options.height||e.element.classList.contains("vditor--fullscreen"))&&(t.scrollTop=i+t.scrollTop-t.clientHeight/2+10)}},Ee=function(e,t){t.addEventListener("keydown",(function(t){if(!t.isComposing&&e.options.keydown&&e.options.keydown(t),!(e.options.hint.extend.length>1||e.toolbar.elements.emoji)||!e.hint.select(t,e)){if(e.options.comment.enable&&"wysiwyg"===e.currentMode&&("Backspace"===t.key||R("⌘X",t))&&e.wysiwyg.getComments(e),"sv"===e.currentMode){if(function(e,t){var i,n,a,o,r;if(e.sv.composingLock=t.isComposing,t.isComposing)return!1;if(-1!==t.key.indexOf("Arrow")||"Meta"===t.key||"Control"===t.key||"Alt"===t.key||"Shift"===t.key||"CapsLock"===t.key||"Escape"===t.key||/^F\d{1,2}$/.test(t.key)||e.undo.recordFirstPosition(e,t),"Enter"!==t.key&&"Tab"!==t.key&&"Backspace"!==t.key&&-1===t.key.indexOf("Arrow")&&!(0,c.yl)(t)&&"Escape"!==t.key)return!1;var s=(0,N.zh)(e),l=s.startContainer;3!==s.startContainer.nodeType&&"DIV"===s.startContainer.tagName&&(l=s.startContainer.childNodes[s.startOffset-1]);var d=(0,b.a1)(l,"data-type","text"),u=(0,b.a1)(l,"data-type","blockquote-marker");if(!u&&0===s.startOffset&&d&&d.previousElementSibling&&"blockquote-marker"===d.previousElementSibling.getAttribute("data-type")&&(u=d.previousElementSibling),u&&"Enter"===t.key&&!(0,c.yl)(t)&&!t.altKey&&""===u.nextElementSibling.textContent.trim()&&(0,N.im)(u,e.sv.element,s).start===u.textContent.length)return"padding"===(null===(i=u.previousElementSibling)||void 0===i?void 0:i.getAttribute("data-type"))&&u.previousElementSibling.setAttribute("data-action","enter-remove"),u.remove(),Ae(e),t.preventDefault(),!0;var h=(0,b.a1)(l,"data-type","li-marker"),p=(0,b.a1)(l,"data-type","task-marker"),f=h;if(f||p&&"task-marker"!==p.nextElementSibling.getAttribute("data-type")&&(f=p),f||0!==s.startOffset||!d||!d.previousElementSibling||"li-marker"!==d.previousElementSibling.getAttribute("data-type")&&"task-marker"!==d.previousElementSibling.getAttribute("data-type")||(f=d.previousElementSibling),f){var m=(0,N.im)(f,e.sv.element,s).start,g="task-marker"===f.getAttribute("data-type"),v=f;if(g&&(v=f.previousElementSibling.previousElementSibling.previousElementSibling),m===f.textContent.length){if("Enter"===t.key&&!(0,c.yl)(t)&&!t.altKey&&!t.shiftKey&&""===f.nextElementSibling.textContent.trim())return"padding"===(null===(n=v.previousElementSibling)||void 0===n?void 0:n.getAttribute("data-type"))?(v.previousElementSibling.remove(),q(e)):(g&&(v.remove(),f.previousElementSibling.previousElementSibling.remove(),f.previousElementSibling.remove()),f.nextElementSibling.remove(),f.remove(),Ae(e)),t.preventDefault(),!0;if("Tab"===t.key)return v.insertAdjacentHTML("beforebegin",'<span data-type="padding">'+v.textContent.replace(/\S/g," ")+"</span>"),/^\d/.test(v.textContent)&&(v.textContent=v.textContent.replace(/^\d{1,}/,"1"),s.selectNodeContents(f.firstChild),s.collapse(!1)),q(e),t.preventDefault(),!0}}if(ut(e,s,t))return!0;var y=(0,b.a1)(l,"data-block","0"),x=(0,w.S)(l,"SPAN");if("Enter"===t.key&&!(0,c.yl)(t)&&!t.altKey&&!t.shiftKey&&y){var C=!1,k=y.textContent.match(/^\n+/);(0,N.im)(y,e.sv.element).start<=(k?k[0].length:0)&&(C=!0);var _="\n";if(x){if("enter-remove"===(null===(a=x.previousElementSibling)||void 0===a?void 0:a.getAttribute("data-action")))return x.previousElementSibling.remove(),Ae(e),t.preventDefault(),!0;_+=Oe(x)}return s.insertNode(document.createTextNode(_)),s.collapse(!1),y&&""!==y.textContent.trim()&&!C?q(e):Ae(e),t.preventDefault(),!0}if("Backspace"===t.key&&!(0,c.yl)(t)&&!t.altKey&&!t.shiftKey){if(x&&"newline"===(null===(o=x.previousElementSibling)||void 0===o?void 0:o.getAttribute("data-type"))&&1===(0,N.im)(x,e.sv.element,s).start&&-1===x.getAttribute("data-type").indexOf("code-block-"))return s.setStart(x,0),s.extractContents(),""!==x.textContent.trim()?q(e):Ae(e),t.preventDefault(),!0;if(y&&0===(0,N.im)(y,e.sv.element,s).start&&y.previousElementSibling){s.extractContents();var S=y.previousElementSibling.lastElementChild;return"newline"===S.getAttribute("data-type")&&(S.remove(),S=y.previousElementSibling.lastElementChild),"newline"!==S.getAttribute("data-type")&&(S.insertAdjacentHTML("afterend",y.innerHTML),y.remove()),""===y.textContent.trim()||(null===(r=y.previousElementSibling)||void 0===r?void 0:r.querySelector('[data-type="code-block-open-marker"]'))?("newline"!==S.getAttribute("data-type")&&(s.selectNodeContents(S.lastChild),s.collapse(!1)),Ae(e)):q(e),t.preventDefault(),!0}}return!1}(e,t))return}else if("wysiwyg"===e.currentMode){if(function(e,t){if(e.wysiwyg.composingLock=t.isComposing,t.isComposing)return!1;-1!==t.key.indexOf("Arrow")||"Meta"===t.key||"Control"===t.key||"Alt"===t.key||"Shift"===t.key||"CapsLock"===t.key||"Escape"===t.key||/^F\d{1,2}$/.test(t.key)||e.undo.recordFirstPosition(e,t);var i=(0,N.zh)(e),n=i.startContainer;if(!Xe(t,e,n))return!1;if(Ke(i,e,t),kt(i),"Enter"!==t.key&&"Tab"!==t.key&&"Backspace"!==t.key&&-1===t.key.indexOf("Arrow")&&!(0,c.yl)(t)&&"Escape"!==t.key&&"Delete"!==t.key)return!1;var o=(0,b.F9)(n),r=(0,b.lG)(n,"P");if(ht(t,e,r,i))return!0;if(dt(i,e,r,t))return!0;if(bt(e,t,i))return!0;var s=(0,b.fb)(n,"vditor-wysiwyg__block");if(s){if("Escape"===t.key&&2===s.children.length)return e.wysiwyg.popover.style.display="none",s.firstElementChild.style.display="none",e.wysiwyg.element.blur(),t.preventDefault(),!0;if(!(0,c.yl)(t)&&!t.shiftKey&&t.altKey&&"Enter"===t.key&&"code-block"===s.getAttribute("data-type")){var l=e.wysiwyg.popover.querySelector(".vditor-input");return l.focus(),l.select(),t.preventDefault(),!0}if("0"===s.getAttribute("data-block")){if(wt(e,t,s.firstElementChild,i))return!0;if(tt(e,t,i,s.firstElementChild,s))return!0;if("yaml-front-matter"!==s.getAttribute("data-type")&&it(e,t,i,s.firstElementChild,s))return!0}}if(yt(e,i,t,r))return!0;var d=(0,b.E2)(n,"BLOCKQUOTE");if(d&&!t.shiftKey&&t.altKey&&"Enter"===t.key){(0,c.yl)(t)?i.setStartBefore(d):i.setStartAfter(d),(0,N.Hc)(i);var u=document.createElement("p");return u.setAttribute("data-block","0"),u.innerHTML="\n",i.insertNode(u),i.collapse(!0),(0,N.Hc)(i),J(e),De(e),t.preventDefault(),!0}var h,p=(0,w.W)(n);if(p){if("H6"===p.tagName&&n.textContent.length===i.startOffset&&!(0,c.yl)(t)&&!t.shiftKey&&!t.altKey&&"Enter"===t.key){var f=document.createElement("p");return f.textContent="\n",f.setAttribute("data-block","0"),n.parentElement.insertAdjacentElement("afterend",f),i.setStart(f,0),(0,N.Hc)(i),J(e),De(e),t.preventDefault(),!0}var m;if(R("⌘=",t))return(m=parseInt(p.tagName.substr(1),10)-1)>0&&(te(e,"h"+m),J(e)),t.preventDefault(),!0;if(R("⌘-",t))return(m=parseInt(p.tagName.substr(1),10)+1)<7&&(te(e,"h"+m),J(e)),t.preventDefault(),!0;"Backspace"!==t.key||(0,c.yl)(t)||t.shiftKey||t.altKey||1!==p.textContent.length||ie(e)}if(xt(e,i,t))return!0;if(t.altKey&&"Enter"===t.key&&!(0,c.yl)(t)&&!t.shiftKey){var g=(0,b.lG)(n,"A"),v=(0,b.a1)(n,"data-type","link-ref"),y=(0,b.a1)(n,"data-type","footnotes-ref");if(g||v||y||p&&2===p.tagName.length){var x=e.wysiwyg.popover.querySelector("input");x.focus(),x.select()}}if(ae(e,t))return!0;if(R("⇧⌘U",t)&&(h=e.wysiwyg.popover.querySelector('[data-type="up"]')))return h.click(),t.preventDefault(),!0;if(R("⇧⌘D",t)&&(h=e.wysiwyg.popover.querySelector('[data-type="down"]')))return h.click(),t.preventDefault(),!0;if(ut(e,i,t))return!0;if(!(0,c.yl)(t)&&t.shiftKey&&!t.altKey&&"Enter"===t.key&&"LI"!==n.parentElement.tagName&&"P"!==n.parentElement.tagName)return["STRONG","STRIKE","S","I","EM","B"].includes(n.parentElement.tagName)?i.insertNode(document.createTextNode("\n"+a.g.ZWSP)):i.insertNode(document.createTextNode("\n")),i.collapse(!1),(0,N.Hc)(i),J(e),De(e),t.preventDefault(),!0;if("Backspace"===t.key&&!(0,c.yl)(t)&&!t.shiftKey&&!t.altKey&&""===i.toString()){if(Ct(e,i,t,r))return!0;if(o){if(o.previousElementSibling&&o.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&"0"===o.previousElementSibling.getAttribute("data-block")&&"UL"!==o.tagName&&"OL"!==o.tagName){var C=(0,N.im)(o,e.wysiwyg.element,i).start;if(0===C&&0===i.startOffset||1===C&&o.innerText.startsWith(a.g.ZWSP))return ne(o.previousElementSibling.lastElementChild,e,!1),""===o.innerHTML.trim().replace(a.g.ZWSP,"")&&(o.remove(),J(e)),t.preventDefault(),!0}var k=i.startOffset;if(""===i.toString()&&3===n.nodeType&&"\n"===n.textContent.charAt(k-2)&&n.textContent.charAt(k-1)!==a.g.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(n.parentElement.tagName))return n.textContent=n.textContent.substring(0,k-1)+a.g.ZWSP,i.setStart(n,k),i.collapse(!0),J(e),t.preventDefault(),!0;n.textContent===a.g.ZWSP&&1===i.startOffset&&!n.previousSibling&&function(e){for(var t=e.startContainer.nextSibling;t&&""===t.textContent;)t=t.nextSibling;return!(!t||3===t.nodeType||"CODE"!==t.tagName&&"math-inline"!==t.getAttribute("data-type")&&"html-entity"!==t.getAttribute("data-type")&&"html-inline"!==t.getAttribute("data-type"))}(i)&&(n.textContent=""),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach((function(e){e.firstElementChild.style.display="inline",e.lastElementChild.style.display="none"})),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach((function(e){e.firstElementChild.style.display="inline",e.lastElementChild.style.display="none"}))}}if((0,c.vU)()&&1===i.startOffset&&n.textContent.indexOf(a.g.ZWSP)>-1&&n.previousSibling&&3!==n.previousSibling.nodeType&&"CODE"===n.previousSibling.tagName&&("Backspace"===t.key||"ArrowLeft"===t.key))return i.selectNodeContents(n.previousSibling),i.collapse(!1),t.preventDefault(),!0;if(_t(t,o,i))return t.preventDefault(),!0;if(Ye(i,t.key),"ArrowDown"===t.key){var _=n.nextSibling;_&&3!==_.nodeType&&"math-inline"===_.getAttribute("data-type")&&i.setStartAfter(_)}return!(!o||!P(o,e,t,i)||(t.preventDefault(),0))}(e,t))return}else if("ir"===e.currentMode&&function(e,t){if(e.ir.composingLock=t.isComposing,t.isComposing)return!1;-1!==t.key.indexOf("Arrow")||"Meta"===t.key||"Control"===t.key||"Alt"===t.key||"Shift"===t.key||"CapsLock"===t.key||"Escape"===t.key||/^F\d{1,2}$/.test(t.key)||e.undo.recordFirstPosition(e,t);var i=(0,N.zh)(e),n=i.startContainer;if(!Xe(t,e,n))return!1;if(Ke(i,e,t),kt(i),"Enter"!==t.key&&"Tab"!==t.key&&"Backspace"!==t.key&&-1===t.key.indexOf("Arrow")&&!(0,c.yl)(t)&&"Escape"!==t.key&&"Delete"!==t.key)return!1;var o=(0,b.a1)(n,"data-newline","1");if(!(0,c.yl)(t)&&!t.altKey&&!t.shiftKey&&"Enter"===t.key&&o&&i.startOffset<o.textContent.length){var r=o.previousElementSibling;r&&(i.insertNode(document.createTextNode(r.textContent)),i.collapse(!1));var s=o.nextSibling;s&&(i.insertNode(document.createTextNode(s.textContent)),i.collapse(!0))}var l=(0,b.lG)(n,"P");if(ht(t,e,l,i))return!0;if(dt(i,e,l,t))return!0;if(yt(e,i,t,l))return!0;var d=(0,b.fb)(n,"vditor-ir__marker--pre");if(d&&"PRE"===d.tagName){var u=d.firstChild;if(wt(e,t,d,i))return!0;if(("math-block"===u.getAttribute("data-type")||"html-block"===u.getAttribute("data-type"))&&it(e,t,i,u,d.parentElement))return!0;if(tt(e,t,i,u,d.parentElement))return!0}var h=(0,b.a1)(n,"data-type","code-block-info");if(h){if("Enter"===t.key||"Tab"===t.key)return i.selectNodeContents(h.nextElementSibling.firstChild),i.collapse(!0),t.preventDefault(),g(e,["hint"]),!0;if("Backspace"===t.key){var p=(0,N.im)(h,e.ir.element).start;1===p&&i.setStart(n,0),2===p&&(e.hint.recentLanguage="")}if(it(e,t,i,h,h.parentElement))return g(e,["hint"]),!0}var f=(0,b.lG)(n,"TD")||(0,b.lG)(n,"TH");if(t.key.indexOf("Arrow")>-1&&f){var m=Qe(f);if(m&&it(e,t,i,f,m))return!0;var v=Ze(f);if(v&&tt(e,t,i,f,v))return!0}if(bt(e,t,i))return!0;if(xt(e,i,t))return!0;if(ut(e,i,t))return!0;var y=(0,w.W)(n);if(y){var x;if(R("⌘=",t))return(x=y.querySelector(".vditor-ir__marker--heading"))&&x.textContent.trim().length>1&&Dt(e,x.textContent.substr(1)),t.preventDefault(),!0;if(R("⌘-",t))return(x=y.querySelector(".vditor-ir__marker--heading"))&&x.textContent.trim().length<6&&Dt(e,x.textContent.trim()+"# "),t.preventDefault(),!0}var C=(0,b.F9)(n);if("Backspace"===t.key&&!(0,c.yl)(t)&&!t.shiftKey&&!t.altKey&&""===i.toString()){if(Ct(e,i,t,l))return!0;if(C&&C.previousElementSibling&&"UL"!==C.tagName&&"OL"!==C.tagName&&("code-block"===C.previousElementSibling.getAttribute("data-type")||"math-block"===C.previousElementSibling.getAttribute("data-type"))){var k=(0,N.im)(C,e.ir.element,i).start;if(0===k||1===k&&C.innerText.startsWith(a.g.ZWSP))return i.selectNodeContents(C.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),i.collapse(!1),H(i,e),""===C.textContent.trim().replace(a.g.ZWSP,"")&&(C.remove(),Tt(e)),t.preventDefault(),!0}if(y){var _=y.firstElementChild.textContent.length;(0,N.im)(y,e.ir.element).start===_&&(i.setStart(y.firstElementChild.firstChild,_-1),i.collapse(!0),(0,N.Hc)(i))}}return!(("ArrowUp"!==t.key&&"ArrowDown"!==t.key||!C||(C.querySelectorAll(".vditor-ir__node").forEach((function(e){e.contains(n)||e.classList.add("vditor-ir__node--hidden")})),!_t(t,C,i)))&&(Ye(i,t.key),!C||!P(C,e,t,i)||(t.preventDefault(),0)))}(e,t))return;if(e.options.ctrlEnter&&R("⌘Enter",t))return e.options.ctrlEnter(r(e)),void t.preventDefault();if(R("⌘Z",t)&&!e.toolbar.elements.undo)return e.undo.undo(e),void t.preventDefault();if(R("⌘Y",t)&&!e.toolbar.elements.redo)return e.undo.redo(e),void t.preventDefault();if("Escape"===t.key)return"block"===e.hint.element.style.display?e.hint.element.style.display="none":e.options.esc&&!t.isComposing&&e.options.esc(r(e)),void t.preventDefault();if((0,c.yl)(t)&&t.altKey&&!t.shiftKey&&/^Digit[1-6]$/.test(t.code)){if("wysiwyg"===e.currentMode){var i=t.code.replace("Digit","H");(0,b.lG)(getSelection().getRangeAt(0).startContainer,i)?ie(e):te(e,i),J(e)}else"sv"===e.currentMode?Pe(e,"#".repeat(parseInt(t.code.replace("Digit",""),10))+" "):"ir"===e.currentMode&&Dt(e,"#".repeat(parseInt(t.code.replace("Digit",""),10))+" ");return t.preventDefault(),!0}if((0,c.yl)(t)&&t.altKey&&!t.shiftKey&&/^Digit[7-9]$/.test(t.code))return"Digit7"===t.code?we(e,"wysiwyg",t):"Digit8"===t.code?we(e,"ir",t):"Digit9"===t.code&&we(e,"sv",t),!0;e.options.toolbar.find((function(i){return!i.hotkey||i.toolbar?!!i.toolbar&&!!i.toolbar.find((function(i){return!!i.hotkey&&(R(i.hotkey,t)?(e.toolbar.elements[i.name].children[0].dispatchEvent(new CustomEvent((0,c.Le)())),t.preventDefault(),!0):void 0)})):R(i.hotkey,t)?(e.toolbar.elements[i.name].children[0].dispatchEvent(new CustomEvent((0,c.Le)())),t.preventDefault(),!0):void 0}))}}))},Fe=function(e,t){t.addEventListener("selectstart",(function(i){t.onmouseup=function(){setTimeout((function(){var t=xe(e[e.currentMode].element);t.trim()?("wysiwyg"===e.currentMode&&e.options.comment.enable&&((0,b.a1)(i.target,"data-type","footnotes-block")||(0,b.a1)(i.target,"data-type","link-ref-defs-block")?e.wysiwyg.hideComment():e.wysiwyg.showComment()),e.options.select&&e.options.select(t)):"wysiwyg"===e.currentMode&&e.options.comment.enable&&e.wysiwyg.hideComment()}))}}))},Ie=function(e,t){var i=(0,N.zh)(e);i.extractContents(),i.insertNode(document.createTextNode(Lute.Caret)),i.insertNode(document.createTextNode(t));var n=(0,b.a1)(i.startContainer,"data-block","0");n||(n=e.sv.element);var a=e.lute.SpinVditorSVDOM(n.textContent);a=a.indexOf('data-type="footnotes-link"')>-1||a.indexOf('data-type="link-ref-defs-block"')>-1?"<div data-block='0'>"+a+"</div>":"<div data-block='0'>"+a.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,'<span data-type="newline"><br /><span style="display: none">\n</span></span><span data-type="newline"><br /><span style="display: none">\n</span></span></div><div data-block="0"><')+"</div>",n.isEqualNode(e.sv.element)?n.innerHTML=a:n.outerHTML=a,(0,N.ib)(e.sv.element,i),De(e)},Me=function(e,t,i){void 0===i&&(i=!0);var n=e;for(3===n.nodeType&&(n=n.parentElement);n;){if(n.getAttribute("data-type")===t)return n;n=i?n.previousElementSibling:n.nextElementSibling}return!1},Ne=function(e,t){y("SpinVditorSVDOM",e,"argument",t.options.debugger);var i=t.lute.SpinVditorSVDOM(e);return e=i.indexOf('data-type="footnotes-link"')>-1||i.indexOf('data-type="link-ref-defs-block"')>-1?"<div data-block='0'>"+i+"</div>":"<div data-block='0'>"+i.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,'<span data-type="newline"><br /><span style="display: none">\n</span></span><span data-type="newline"><br /><span style="display: none">\n</span></span></div><div data-block="0"><')+"</div>",y("SpinVditorSVDOM",e,"result",t.options.debugger),e},Oe=function(e){var t=e.getAttribute("data-type"),i=e.previousElementSibling,n=t&&"text"!==t&&"table"!==t&&"heading-marker"!==t&&"newline"!==t&&"yaml-front-matter-open-marker"!==t&&"yaml-front-matter-close-marker"!==t&&"code-block-info"!==t&&"code-block-close-marker"!==t&&"code-block-open-marker"!==t?e.textContent:"",a=!1;for("newline"===t&&(a=!0);i&&!a;){var o=i.getAttribute("data-type");if("li-marker"===o||"blockquote-marker"===o||"task-marker"===o||"padding"===o){var r=i.textContent;if("li-marker"!==o||"code-block-open-marker"!==t&&"code-block-info"!==t)if("code-block-close-marker"===t&&i.nextElementSibling.isSameNode(e)){var s=Me(e,"code-block-open-marker");s&&s.previousElementSibling&&(i=s.previousElementSibling,n=r+n)}else n=r+n;else n=r.replace(/\S/g," ")+n}else"newline"===o&&(a=!0);i=i.previousElementSibling}return n},Ae=function(e,t){void 0===t&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),e.preview.render(e);var i=r(e);"function"==typeof e.options.input&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,c.pK)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),clearTimeout(e.sv.processTimeoutId),e.sv.processTimeoutId=window.setTimeout((function(){t.enableAddUndoStack&&!e.sv.composingLock&&e.undo.addToUndoStack(e)}),e.options.undoDelay)},Pe=function(e,t){var i=(0,N.zh)(e),n=(0,w.S)(i.startContainer,"SPAN");n&&""!==n.textContent.trim()&&(t="\n"+t),i.collapse(!0),document.execCommand("insertHTML",!1,t)},$e=function(e,t,i,n){var a=(0,N.zh)(e),o=t.getAttribute("data-type");0===e.sv.element.childNodes.length&&(e.sv.element.innerHTML='<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">\n</span></span>',(0,N.ib)(e.sv.element,a));var r=(0,b.F9)(a.startContainer),s=(0,w.S)(a.startContainer,"SPAN");if(r){if("link"===o){var l=void 0;return l=""===a.toString()?""+i+Lute.Caret+n:""+i+a.toString()+n.replace(")",Lute.Caret+")"),void document.execCommand("insertHTML",!1,l)}if("italic"===o||"bold"===o||"strike"===o||"inline-code"===o||"code"===o||"table"===o||"line"===o)return l=void 0,l=""===a.toString()?""+i+Lute.Caret+("code"===o?"":n):""+i+a.toString()+Lute.Caret+("code"===o?"":n),"table"===o||"code"===o&&s&&""!==s.textContent?l="\n\n"+l:"line"===o&&(l="\n\n"+i+"\n"+Lute.Caret),void document.execCommand("insertHTML",!1,l);if(("check"===o||"list"===o||"ordered-list"===o||"quote"===o)&&s){var c="* ";"check"===o?c="* [ ] ":"ordered-list"===o?c="1. ":"quote"===o&&(c="> ");var d=Me(s,"newline");return d?d.insertAdjacentText("afterend",c):r.insertAdjacentText("afterbegin",c),void q(e)}(0,N.ib)(e.sv.element,a),Ae(e)}},Re=function(e){switch(e.currentMode){case"ir":return e.ir.element;case"wysiwyg":return e.wysiwyg.element;case"sv":return e.sv.element}},He=function(e,t){e.options.upload.setHeaders&&(e.options.upload.headers=e.options.upload.setHeaders()),e.options.upload.headers&&Object.keys(e.options.upload.headers).forEach((function(i){t.setRequestHeader(i,e.options.upload.headers[i])}))},je=function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,s)}l((n=n.apply(e,t||[])).next())}))},qe=function(e,t){var i,n,a,o,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!((a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(6===o[0]&&r.label<a[1]){r.label=a[1],a=o;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(o);break}a[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],n=0}finally{i=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ze=function(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"},Be=function(e,t,i){return je(void 0,void 0,void 0,(function(){var n,a,o,r,s,l,c,d,u,h,p,f,m,g;return qe(this,(function(v){switch(v.label){case 0:for(n=[],a=!0===e.options.upload.multiple?t.length:1,f=0;f<a;f++)(o=t[f])instanceof DataTransferItem&&(o=o.getAsFile()),n.push(o);return e.options.upload.handler?[4,e.options.upload.handler(n)]:[3,2];case 1:return r=v.sent(),i&&(i.value=""),"string"==typeof r?(e.tip.show(r),[2]):[2];case 2:return e.options.upload.url&&e.upload?e.options.upload.file?[4,e.options.upload.file(n)]:[3,4]:(i&&(i.value=""),e.tip.show("please config: options.upload.url"),[2]);case 3:n=v.sent(),v.label=4;case 4:if(e.options.upload.validate&&"string"==typeof(r=e.options.upload.validate(n)))return e.tip.show(r),[2];if(s=Re(e),e.upload.range=(0,N.zh)(e),l=function(e,t){e.tip.hide();for(var i=[],n="",a="",o=(e.options.lang,e.options,function(o,r){var s=t[r],l=!0;s.name||(n+="<li>"+window.VditorI18n.nameEmpty+"</li>",l=!1),s.size>e.options.upload.max&&(n+="<li>"+s.name+" "+window.VditorI18n.over+" "+e.options.upload.max/1024/1024+"M</li>",l=!1);var c=s.name.lastIndexOf("."),d=s.name.substr(c),u=e.options.upload.filename(s.name.substr(0,c))+d;e.options.upload.accept&&(e.options.upload.accept.split(",").some((function(e){var t=e.trim();if(0===t.indexOf(".")){if(d.toLowerCase()===t.toLowerCase())return!0}else if(s.type.split("/")[0]===t.split("/")[0])return!0;return!1}))||(n+="<li>"+s.name+" "+window.VditorI18n.fileTypeError+"</li>",l=!1)),l&&(i.push(s),a+="<li>"+u+" "+window.VditorI18n.uploading+"</li>")}),r=t.length,s=0;s<r;s++)o(0,s);return e.tip.show("<ul>"+n+a+"</ul>"),i}(e,n),0===l.length)return i&&(i.value=""),[2];for(c=new FormData,d=e.options.upload.extraData,u=0,h=Object.keys(d);u<h.length;u++)p=h[u],c.append(p,d[p]);for(f=0,m=l.length;f<m;f++)c.append(e.options.upload.fieldName,l[f]);return(g=new XMLHttpRequest).open("POST",e.options.upload.url),e.options.upload.token&&g.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(g.withCredentials=!0),He(e,g),e.upload.isUploading=!0,s.setAttribute("contenteditable","false"),g.onreadystatechange=function(){if(g.readyState===XMLHttpRequest.DONE){if(e.upload.isUploading=!1,s.setAttribute("contenteditable","true"),g.status>=200&&g.status<300)if(e.options.upload.success)e.options.upload.success(s,g.responseText);else{var n=g.responseText;e.options.upload.format&&(n=e.options.upload.format(t,g.responseText)),function(e,t){Re(t).focus();var i=JSON.parse(e),n="";1===i.code&&(n=""+i.msg),i.data.errFiles&&i.data.errFiles.length>0&&(n="<ul><li>"+n+"</li>",i.data.errFiles.forEach((function(e){var i=e.lastIndexOf("."),a=t.options.upload.filename(e.substr(0,i))+e.substr(i);n+="<li>"+a+" "+window.VditorI18n.uploadError+"</li>"})),n+="</ul>"),n?t.tip.show(n):t.tip.hide();var a="";Object.keys(i.data.succMap).forEach((function(e){var n=i.data.succMap[e],o=e.lastIndexOf("."),r=e.substr(o),s=t.options.upload.filename(e.substr(0,o))+r;0===(r=r.toLowerCase()).indexOf(".wav")||0===r.indexOf(".mp3")||0===r.indexOf(".ogg")?"wysiwyg"===t.currentMode?a+='<div class="vditor-wysiwyg__block" data-type="html-block"\n data-block="0"><pre><code>&lt;audio controls="controls" src="'+n+'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="'+n+'"></audio></pre></div>\n':"ir"===t.currentMode?a+='<audio controls="controls" src="'+n+'"></audio>\n':a+="["+s+"]("+n+")\n":0===r.indexOf(".apng")||0===r.indexOf(".bmp")||0===r.indexOf(".gif")||0===r.indexOf(".ico")||0===r.indexOf(".cur")||0===r.indexOf(".jpg")||0===r.indexOf(".jpeg")||0===r.indexOf(".jfif")||0===r.indexOf(".pjp")||0===r.indexOf(".pjpeg")||0===r.indexOf(".png")||0===r.indexOf(".svg")||0===r.indexOf(".webp")?"wysiwyg"===t.currentMode?a+='<img alt="'+s+'" src="'+n+'">\n':a+="!["+s+"]("+n+")\n":"wysiwyg"===t.currentMode?a+='<a href="'+n+'">'+s+"</a>\n":a+="["+s+"]("+n+")\n"})),(0,N.Hc)(t.upload.range),document.execCommand("insertHTML",!1,a),t.upload.range=getSelection().getRangeAt(0).cloneRange()}(n,e)}else e.options.upload.error?e.options.upload.error(g.responseText):e.tip.show(g.responseText);i&&(i.value=""),e.upload.element.style.display="none"}},g.upload.onprogress=function(t){if(t.lengthComputable){var i=t.loaded/t.total*100;e.upload.element.style.display="block",e.upload.element.style.width=i+"%"}},g.send(c),[2]}}))}))},Ve=function(e,t,i){var n,o=(0,b.F9)(t.startContainer);if(o||(o=e.wysiwyg.element),i&&"formatItalic"!==i.inputType&&"deleteByDrag"!==i.inputType&&"insertFromDrop"!==i.inputType&&"formatBold"!==i.inputType&&"formatRemove"!==i.inputType&&"formatStrikeThrough"!==i.inputType&&"insertUnorderedList"!==i.inputType&&"insertOrderedList"!==i.inputType&&"formatOutdent"!==i.inputType&&"formatIndent"!==i.inputType&&""!==i.inputType||!i){var r=function(e){for(var t=e.previousSibling;t;){if(3!==t.nodeType&&"A"===t.tagName&&!t.previousSibling&&""===t.innerHTML.replace(a.g.ZWSP,"")&&t.nextSibling)return t;t=t.previousSibling}return!1}(t.startContainer);r&&r.remove(),e.wysiwyg.element.querySelectorAll("wbr").forEach((function(e){e.remove()})),t.insertNode(document.createElement("wbr")),o.querySelectorAll("[style]").forEach((function(e){e.removeAttribute("style")})),o.querySelectorAll(".vditor-comment").forEach((function(e){""===e.textContent.trim()&&(e.classList.remove("vditor-comment","vditor-comment--focus"),e.removeAttribute("data-cmtids"))})),null===(n=o.previousElementSibling)||void 0===n||n.querySelectorAll(".vditor-comment").forEach((function(e){""===e.textContent.trim()&&(e.classList.remove("vditor-comment","vditor-comment--focus"),e.removeAttribute("data-cmtids"))}));var s="";"link-ref-defs-block"===o.getAttribute("data-type")&&(o=e.wysiwyg.element);var l,c=o.isEqualNode(e.wysiwyg.element),d=(0,b.a1)(o,"data-type","footnotes-block");if(c)s=o.innerHTML;else{var u=(0,b.O9)(t.startContainer);if(u&&!d){var h=(0,w.S)(t.startContainer,"BLOCKQUOTE");o=h?(0,b.F9)(t.startContainer)||o:u}if(d&&(o=d),s=o.outerHTML,"UL"===o.tagName||"OL"===o.tagName){var p=o.previousElementSibling,f=o.nextElementSibling;!p||"UL"!==p.tagName&&"OL"!==p.tagName||(s=p.outerHTML+s,p.remove()),!f||"UL"!==f.tagName&&"OL"!==f.tagName||(s+=f.outerHTML,f.remove()),s=s.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}o.innerText.startsWith("```")||(e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach((function(e){e&&!o.isEqualNode(e)&&(s+=e.outerHTML,e.remove())})),e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach((function(e){e&&!o.isEqualNode(e)&&(s+=e.outerHTML,e.remove())})))}if('<p data-block="0">```<wbr></p>'===(s=s.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""))&&e.hint.recentLanguage&&(s='<p data-block="0">```<wbr></p>'.replace("```","```"+e.hint.recentLanguage)),y("SpinVditorDOM",s,"argument",e.options.debugger),s=e.lute.SpinVditorDOM(s),y("SpinVditorDOM",s,"result",e.options.debugger),c)o.innerHTML=s;else if(o.outerHTML=s,d){var m=(0,b.E2)(e.wysiwyg.element.querySelector("wbr"),"LI");if(m){var g=e.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'+m.getAttribute("data-marker")+'"]');g&&g.setAttribute("aria-label",m.textContent.trim().substr(0,24))}}var v,x=e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");x.forEach((function(e,t){0===t?l=e:(l.insertAdjacentHTML("beforeend",e.innerHTML),e.remove())})),x.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",x[0]);var C=e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");C.forEach((function(e,t){0===t?v=e:(v.insertAdjacentHTML("beforeend",e.innerHTML),e.remove())})),C.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",C[0]),(0,N.ib)(e.wysiwyg.element,t),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach((function(t){M(t,e)})),i&&("deleteContentBackward"===i.inputType||"deleteContentForward"===i.inputType)&&e.options.comment.enable&&(e.wysiwyg.triggerRemoveComment(e),e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)))}O(e),J(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Ue=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},We=function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,s)}l((n=n.apply(e,t||[])).next())}))},Ge=function(e,t){var i,n,a,o,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!((a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(6===o[0]&&r.label<a[1]){r.label=a[1],a=o;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(o);break}a[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],n=0}finally{i=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Xe=function(e,t,i){if(229===e.keyCode&&""===e.code&&"Unidentified"===e.key&&"sv"!==t.currentMode){var n=(0,b.F9)(i);if(n&&""===n.textContent.trim())return t[t.currentMode].composingLock=!0,!1}return!0},Ke=function(e,t,i){if(!("Enter"===i.key||"Tab"===i.key||"Backspace"===i.key||i.key.indexOf("Arrow")>-1||(0,c.yl)(i)||"Escape"===i.key||i.shiftKey||i.altKey)){var n=(0,b.lG)(e.startContainer,"P")||(0,b.lG)(e.startContainer,"LI");if(n&&0===(0,N.im)(n,t[t.currentMode].element,e).start){n.nodeValue&&(n.nodeValue=n.nodeValue.replace(/\u2006/g,""));var o=document.createTextNode(a.g.ZWSP);e.insertNode(o),e.setStartAfter(o)}}},Ye=function(e,t){if("ArrowDown"===t||"ArrowUp"===t){var i=(0,b.a1)(e.startContainer,"data-type","math-inline")||(0,b.a1)(e.startContainer,"data-type","html-entity")||(0,b.a1)(e.startContainer,"data-type","html-inline");i&&("ArrowDown"===t&&e.setStartAfter(i.parentElement),"ArrowUp"===t&&e.setStartBefore(i.parentElement))}},Je=function(e,t){var i=(0,N.zh)(e),n=(0,b.F9)(i.startContainer);n&&(n.insertAdjacentHTML(t,'<p data-block="0">'+a.g.ZWSP+"<wbr>\n</p>"),(0,N.ib)(e[e.currentMode].element,i),fe(e),ct(e))},Qe=function(e){var t=(0,b.lG)(e,"TABLE");return!(!t||!t.rows[0].cells[0].isSameNode(e))&&t},Ze=function(e){var t=(0,b.lG)(e,"TABLE");return!(!t||!t.lastElementChild.lastElementChild.lastElementChild.isSameNode(e))&&t},et=function(e,t,i){void 0===i&&(i=!0);var n=e.previousElementSibling;return n||(n=e.parentElement.previousElementSibling?e.parentElement.previousElementSibling.lastElementChild:"TBODY"===e.parentElement.parentElement.tagName&&e.parentElement.parentElement.previousElementSibling?e.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:null),n&&(t.selectNodeContents(n),i||t.collapse(!1),(0,N.Hc)(t)),n},tt=function(e,t,i,n,o){var r=(0,N.im)(n,e[e.currentMode].element,i);if("ArrowDown"===t.key&&-1===n.textContent.trimRight().substr(r.start).indexOf("\n")||"ArrowRight"===t.key&&r.start>=n.textContent.trimRight().length){var s=o.nextElementSibling;return!s||s&&("TABLE"===s.tagName||s.getAttribute("data-type"))?(o.insertAdjacentHTML("afterend",'<p data-block="0">'+a.g.ZWSP+"<wbr></p>"),(0,N.ib)(e[e.currentMode].element,i)):(i.selectNodeContents(s),i.collapse(!0),(0,N.Hc)(i)),t.preventDefault(),!0}return!1},it=function(e,t,i,n,o){var r=(0,N.im)(n,e[e.currentMode].element,i);if("ArrowUp"===t.key&&-1===n.textContent.substr(0,r.start).indexOf("\n")||("ArrowLeft"===t.key||"Backspace"===t.key&&""===i.toString())&&0===r.start){var s=o.previousElementSibling;return!s||s&&("TABLE"===s.tagName||s.getAttribute("data-type"))?(o.insertAdjacentHTML("beforebegin",'<p data-block="0">'+a.g.ZWSP+"<wbr></p>"),(0,N.ib)(e[e.currentMode].element,i)):(i.selectNodeContents(s),i.collapse(!1),(0,N.Hc)(i)),t.preventDefault(),!0}return!1},nt=function(e,t,i,n){void 0===n&&(n=!0);var a=(0,b.lG)(t.startContainer,"LI");if(e[e.currentMode].element.querySelectorAll("wbr").forEach((function(e){e.remove()})),t.insertNode(document.createElement("wbr")),n&&a){for(var o="",r=0;r<a.parentElement.childElementCount;r++){var s=a.parentElement.children[r].querySelector("input");s&&s.remove(),o+='<p data-block="0">'+a.parentElement.children[r].innerHTML.trimLeft()+"</p>"}a.parentElement.insertAdjacentHTML("beforebegin",o),a.parentElement.remove()}else if(a)if("check"===i)a.parentElement.querySelectorAll("li").forEach((function(e){e.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'+(0===e.textContent.indexOf(" ")?"":" ")),e.classList.add("vditor-task")}));else{a.querySelector("input")&&a.parentElement.querySelectorAll("li").forEach((function(e){e.querySelector("input").remove(),e.classList.remove("vditor-task")}));var l=void 0;"list"===i?(l=document.createElement("ul")).setAttribute("data-marker","*"):(l=document.createElement("ol")).setAttribute("data-marker","1."),l.setAttribute("data-block","0"),l.setAttribute("data-tight",a.parentElement.getAttribute("data-tight")),l.innerHTML=a.parentElement.innerHTML,a.parentElement.parentNode.replaceChild(l,a.parentElement)}else{var c=(0,b.a1)(t.startContainer,"data-block","0");c||(e[e.currentMode].element.querySelector("wbr").remove(),(c=e[e.currentMode].element.querySelector("p")).innerHTML="<wbr>"),"check"===i?(c.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '+c.innerHTML+"</li></ul>"),c.remove()):"list"===i?(c.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'+c.innerHTML+"</li></ul>"),c.remove()):"ordered-list"===i&&(c.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'+c.innerHTML+"</li></ol>"),c.remove())}},at=function(e,t,i){var n=t.previousElementSibling;if(t&&n){var a=[t];Array.from(i.cloneContents().children).forEach((function(e,i){3!==e.nodeType&&t&&""!==e.textContent.trim()&&t.getAttribute("data-node-id")===e.getAttribute("data-node-id")&&(0!==i&&a.push(t),t=t.nextElementSibling)})),e[e.currentMode].element.querySelectorAll("wbr").forEach((function(e){e.remove()})),i.insertNode(document.createElement("wbr"));var o=n.parentElement,r="";a.forEach((function(e){var t=e.getAttribute("data-marker");1!==t.length&&(t="1"+t.slice(-1)),r+='<li data-node-id="'+e.getAttribute("data-node-id")+'" data-marker="'+t+'">'+e.innerHTML+"</li>",e.remove()})),n.insertAdjacentHTML("beforeend","<"+o.tagName+' data-block="0">'+r+"</"+o.tagName+">"),"wysiwyg"===e.currentMode?o.outerHTML=e.lute.SpinVditorDOM(o.outerHTML):o.outerHTML=e.lute.SpinVditorIRDOM(o.outerHTML),(0,N.ib)(e[e.currentMode].element,i);var s=(0,b.O9)(i.startContainer);s&&s.querySelectorAll(".vditor-"+e.currentMode+"__preview[data-render='2']").forEach((function(t){M(t,e),"wysiwyg"===e.currentMode&&t.previousElementSibling.setAttribute("style","display:none")})),ct(e),fe(e)}else e[e.currentMode].element.focus()},ot=function(e,t,i,n){var a=(0,b.lG)(t.parentElement,"LI");if(a){e[e.currentMode].element.querySelectorAll("wbr").forEach((function(e){e.remove()})),i.insertNode(document.createElement("wbr"));var o=t.parentElement,r=o.cloneNode(),s=[t];Array.from(i.cloneContents().children).forEach((function(e,i){3!==e.nodeType&&t&&""!==e.textContent.trim()&&t.getAttribute("data-node-id")===e.getAttribute("data-node-id")&&(0!==i&&s.push(t),t=t.nextElementSibling)}));var l=!1,c="";o.querySelectorAll("li").forEach((function(e){l&&(c+=e.outerHTML,e.nextElementSibling||e.previousElementSibling?e.remove():e.parentElement.remove()),e.isSameNode(s[s.length-1])&&(l=!0)})),s.reverse().forEach((function(e){a.insertAdjacentElement("afterend",e)})),c&&(r.innerHTML=c,s[0].insertAdjacentElement("beforeend",r)),"wysiwyg"===e.currentMode?n.outerHTML=e.lute.SpinVditorDOM(n.outerHTML):n.outerHTML=e.lute.SpinVditorIRDOM(n.outerHTML),(0,N.ib)(e[e.currentMode].element,i);var d=(0,b.O9)(i.startContainer);d&&d.querySelectorAll(".vditor-"+e.currentMode+"__preview[data-render='2']").forEach((function(t){M(t,e),"wysiwyg"===e.currentMode&&t.previousElementSibling.setAttribute("style","display:none")})),ct(e),fe(e)}else e[e.currentMode].element.focus()},rt=function(e,t){for(var i=getSelection().getRangeAt(0).startContainer.parentElement,n=e.rows[0].cells.length,a=e.rows.length,o=0,r=0;r<a;r++)for(var s=0;s<n;s++)if(e.rows[r].cells[s].isSameNode(i)){o=s;break}for(var l=0;l<a;l++)e.rows[l].cells[o].setAttribute("align",t)},st=function(e){var t=e.trimRight().split("\n").pop();return""!==t&&(""===t.replace(/ |-/g,"")||""===t.replace(/ |_/g,"")||""===t.replace(/ |\*/g,""))&&t.replace(/ /g,"").length>2&&!(t.indexOf("-")>-1&&-1===t.trimLeft().indexOf(" ")&&e.trimRight().split("\n").length>1)&&0!==t.indexOf("    ")&&0!==t.indexOf("\t")},lt=function(e){var t=e.trimRight().split("\n");return 0!==(e=t.pop()).indexOf("    ")&&0!==e.indexOf("\t")&&""!==(e=e.trimLeft())&&0!==t.length&&(""===e.replace(/-/g,"")||""===e.replace(/=/g,""))},ct=function(e,t){void 0===t&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),"wysiwyg"===e.currentMode?J(e,t):"ir"===e.currentMode?Tt(e,t):"sv"===e.currentMode&&Ae(e,t)},dt=function(e,t,i,n){var o,r=e.startContainer,s=(0,b.lG)(r,"LI");if(s){if(!(0,c.yl)(n)&&!n.altKey&&"Enter"===n.key&&!n.shiftKey&&i&&s.contains(i)&&i.nextElementSibling)return s&&!s.textContent.endsWith("\n")&&s.insertAdjacentText("beforeend","\n"),e.insertNode(document.createTextNode("\n\n")),e.collapse(!1),ct(t),n.preventDefault(),!0;if(!((0,c.yl)(n)||n.shiftKey||n.altKey||"Backspace"!==n.key||s.previousElementSibling||""!==e.toString()||0!==(0,N.im)(s,t[t.currentMode].element,e).start))return s.nextElementSibling?(s.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'+s.innerHTML+"</p>"),s.remove()):s.parentElement.outerHTML='<p data-block="0"><wbr>'+s.innerHTML+"</p>",(0,N.ib)(t[t.currentMode].element,e),ct(t),n.preventDefault(),!0;if(!(0,c.yl)(n)&&!n.shiftKey&&!n.altKey&&"Backspace"===n.key&&""===s.textContent.trim().replace(a.g.ZWSP,"")&&""===e.toString()&&"LI"===(null===(o=s.previousElementSibling)||void 0===o?void 0:o.tagName))return s.previousElementSibling.insertAdjacentText("beforeend","\n\n"),e.selectNodeContents(s.previousElementSibling),e.collapse(!1),s.remove(),(0,N.ib)(t[t.currentMode].element,e),ct(t),n.preventDefault(),!0;if(!(0,c.yl)(n)&&!n.altKey&&"Tab"===n.key){var l=!1;if((0===e.startOffset&&(3===r.nodeType&&!r.previousSibling||3!==r.nodeType&&"LI"===r.nodeName)||s.classList.contains("vditor-task")&&1===e.startOffset&&3!==r.previousSibling.nodeType&&"INPUT"===r.previousSibling.tagName)&&(l=!0),l||""!==e.toString())return n.shiftKey?ot(t,s,e,s.parentElement):at(t,s,e),n.preventDefault(),!0}}return!1},ut=function(e,t,i){if(e.options.tab&&"Tab"===i.key)return i.shiftKey||(""===t.toString()?(t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1)):(t.extractContents(),t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1))),(0,N.Hc)(t),ct(e),i.preventDefault(),!0},ht=function(e,t,i,n){if(i){if(!(0,c.yl)(e)&&!e.altKey&&"Enter"===e.key){var a=String.raw(X||(X=Ue(["",""],["",""])),i.textContent).replace(/\\\|/g,"").trim(),o=a.split("|");if(a.startsWith("|")&&a.endsWith("|")&&o.length>3){var r=o.map((function(){return"---"})).join("|");return r=i.textContent+"\n"+r.substring(3,r.length-3)+"\n|<wbr>",i.outerHTML=t.lute.SpinVditorDOM(r),(0,N.ib)(t[t.currentMode].element,n),ct(t),De(t),e.preventDefault(),!0}if(st(i.innerHTML)&&i.previousElementSibling){var s="",l=i.innerHTML.trimRight().split("\n");return l.length>1&&(l.pop(),s='<p data-block="0">'+l.join("\n")+"</p>"),i.insertAdjacentHTML("afterend",s+'<hr data-block="0"><p data-block="0"><wbr>\n</p>'),i.remove(),(0,N.ib)(t[t.currentMode].element,n),ct(t),De(t),e.preventDefault(),!0}if(lt(i.innerHTML))return"wysiwyg"===t.currentMode?i.outerHTML=t.lute.SpinVditorDOM(i.innerHTML+'<p data-block="0"><wbr>\n</p>'):i.outerHTML=t.lute.SpinVditorIRDOM(i.innerHTML+'<p data-block="0"><wbr>\n</p>'),(0,N.ib)(t[t.currentMode].element,n),ct(t),De(t),e.preventDefault(),!0}if(n.collapsed&&i.previousElementSibling&&"Backspace"===e.key&&!(0,c.yl)(e)&&!e.altKey&&!e.shiftKey&&i.textContent.trimRight().split("\n").length>1&&0===(0,N.im)(i,t[t.currentMode].element,n).start){var d=(0,b.DX)(i.previousElementSibling);return d.textContent.endsWith("\n")||(d.textContent=d.textContent+"\n"),d.parentElement.insertAdjacentHTML("beforeend","<wbr>"+i.innerHTML),i.remove(),(0,N.ib)(t[t.currentMode].element,n),!1}return!1}},pt=function(e,t,i){for(var n="",a=0;a<i.parentElement.childElementCount;a++)n+='<td align="'+i.parentElement.children[a].getAttribute("align")+'"> </td>';"TH"===i.tagName?i.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>"+n+"</tr></tbody>"):i.parentElement.insertAdjacentHTML("afterend","<tr>"+n+"</tr>"),ct(e)},ft=function(e,t,i){for(var n="",a=0;a<i.parentElement.childElementCount;a++)"TH"===i.tagName?n+='<th align="'+i.parentElement.children[a].getAttribute("align")+'"> </th>':n+='<td align="'+i.parentElement.children[a].getAttribute("align")+'"> </td>';if("TH"===i.tagName){i.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>"+n+"</tr></thead>"),t.insertNode(document.createElement("wbr"));var o=i.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");i.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",o),i.parentElement.parentElement.remove(),(0,N.ib)(e.ir.element,t)}else i.parentElement.insertAdjacentHTML("beforebegin","<tr>"+n+"</tr>");ct(e)},mt=function(e,t,i,n){void 0===n&&(n="afterend");for(var a=0,o=i.previousElementSibling;o;)a++,o=o.previousElementSibling;for(var r=0;r<t.rows.length;r++)0===r?t.rows[r].cells[a].insertAdjacentHTML(n,"<th> </th>"):t.rows[r].cells[a].insertAdjacentHTML(n,"<td> </td>");ct(e)},gt=function(e,t,i){if("TD"===i.tagName){var n=i.parentElement.parentElement;i.parentElement.previousElementSibling?t.selectNodeContents(i.parentElement.previousElementSibling.lastElementChild):t.selectNodeContents(n.previousElementSibling.lastElementChild.lastElementChild),1===n.childElementCount?n.remove():i.parentElement.remove(),t.collapse(!1),(0,N.Hc)(t),ct(e)}},vt=function(e,t,i,n){for(var a=0,o=n.previousElementSibling;o;)a++,o=o.previousElementSibling;(n.previousElementSibling||n.nextElementSibling)&&(t.selectNodeContents(n.previousElementSibling||n.nextElementSibling),t.collapse(!0));for(var r=0;r<i.rows.length;r++){var s=i.rows[r].cells;if(1===s.length){i.remove(),fe(e);break}s[a].remove()}(0,N.Hc)(t),ct(e)},bt=function(e,t,i){var n=i.startContainer,a=(0,b.lG)(n,"TD")||(0,b.lG)(n,"TH");if(a){if(!(0,c.yl)(t)&&!t.altKey&&"Enter"===t.key){a.lastElementChild&&(!a.lastElementChild||a.lastElementChild.isSameNode(a.lastChild)&&"BR"===a.lastElementChild.tagName)||a.insertAdjacentHTML("beforeend","<br>");var o=document.createElement("br");return i.insertNode(o),i.setStartAfter(o),ct(e),De(e),t.preventDefault(),!0}if("Tab"===t.key)return t.shiftKey?(et(a,i),t.preventDefault(),!0):((u=a.nextElementSibling)||(u=a.parentElement.nextElementSibling?a.parentElement.nextElementSibling.firstElementChild:"THEAD"===a.parentElement.parentElement.tagName&&a.parentElement.parentElement.nextElementSibling?a.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:null),u&&(i.selectNodeContents(u),(0,N.Hc)(i)),t.preventDefault(),!0);var r=a.parentElement.parentElement.parentElement;if("ArrowUp"===t.key){if(t.preventDefault(),"TH"===a.tagName)return r.previousElementSibling?(i.selectNodeContents(r.previousElementSibling),i.collapse(!1),(0,N.Hc)(i)):Je(e,"beforebegin"),!0;for(var s=0,l=a.parentElement;s<l.cells.length&&!l.cells[s].isSameNode(a);s++);var d=l.previousElementSibling;return d||(d=l.parentElement.previousElementSibling.firstChild),i.selectNodeContents(d.cells[s]),i.collapse(!1),(0,N.Hc)(i),!0}if("ArrowDown"===t.key){var u;if(t.preventDefault(),!(l=a.parentElement).nextElementSibling&&"TD"===a.tagName)return r.nextElementSibling?(i.selectNodeContents(r.nextElementSibling),i.collapse(!0),(0,N.Hc)(i)):Je(e,"afterend"),!0;for(s=0;s<l.cells.length&&!l.cells[s].isSameNode(a);s++);return(u=l.nextElementSibling)||(u=l.parentElement.nextElementSibling.firstChild),i.selectNodeContents(u.cells[s]),i.collapse(!0),(0,N.Hc)(i),!0}if("wysiwyg"===e.currentMode&&!(0,c.yl)(t)&&"Enter"===t.key&&!t.shiftKey&&t.altKey){var h=e.wysiwyg.popover.querySelector(".vditor-input");return h.focus(),h.select(),t.preventDefault(),!0}if(!(0,c.yl)(t)&&!t.shiftKey&&!t.altKey&&"Backspace"===t.key&&0===i.startOffset&&""===i.toString())return!et(a,i,!1)&&r&&(""===r.textContent.trim()?(r.outerHTML='<p data-block="0"><wbr>\n</p>',(0,N.ib)(e[e.currentMode].element,i)):(i.setStartBefore(r),i.collapse(!0)),ct(e)),t.preventDefault(),!0;if(R("⇧⌘F",t))return ft(e,i,a),t.preventDefault(),!0;if(R("⌘=",t))return pt(e,i,a),t.preventDefault(),!0;if(R("⇧⌘G",t))return mt(e,r,a,"beforebegin"),t.preventDefault(),!0;if(R("⇧⌘=",t))return mt(e,r,a),t.preventDefault(),!0;if(R("⌘-",t))return gt(e,i,a),t.preventDefault(),!0;if(R("⇧⌘-",t))return vt(e,i,r,a),t.preventDefault(),!0;if(R("⇧⌘L",t)){if("ir"===e.currentMode)return rt(r,"left"),ct(e),t.preventDefault(),!0;if(p=e.wysiwyg.popover.querySelector('[data-type="left"]'))return p.click(),t.preventDefault(),!0}if(R("⇧⌘C",t)){if("ir"===e.currentMode)return rt(r,"center"),ct(e),t.preventDefault(),!0;if(p=e.wysiwyg.popover.querySelector('[data-type="center"]'))return p.click(),t.preventDefault(),!0}if(R("⇧⌘R",t)){if("ir"===e.currentMode)return rt(r,"right"),ct(e),t.preventDefault(),!0;var p;if(p=e.wysiwyg.popover.querySelector('[data-type="right"]'))return p.click(),t.preventDefault(),!0}}return!1},wt=function(e,t,i,n){if("PRE"===i.tagName&&R("⌘A",t))return n.selectNodeContents(i.firstElementChild),t.preventDefault(),!0;if(e.options.tab&&"Tab"===t.key&&!t.shiftKey&&""===n.toString())return n.insertNode(document.createTextNode(e.options.tab)),n.collapse(!1),ct(e),t.preventDefault(),!0;if("Backspace"===t.key&&!(0,c.yl)(t)&&!t.shiftKey&&!t.altKey){var a=(0,N.im)(i,e[e.currentMode].element,n);if((0===a.start||1===a.start&&"\n"===i.innerText)&&""===n.toString())return i.parentElement.outerHTML='<p data-block="0"><wbr>'+i.firstElementChild.innerHTML+"</p>",(0,N.ib)(e[e.currentMode].element,n),ct(e),t.preventDefault(),!0}return!(0,c.yl)(t)&&!t.altKey&&"Enter"===t.key&&(i.firstElementChild.textContent.endsWith("\n")||i.firstElementChild.insertAdjacentText("beforeend","\n"),n.extractContents(),n.insertNode(document.createTextNode("\n")),n.collapse(!1),(0,N.Hc)(n),(0,c.vU)()||("wysiwyg"===e.currentMode?Ve(e,n):$(e,n)),De(e),t.preventDefault(),!0)},yt=function(e,t,i,n){var o=t.startContainer,r=(0,b.lG)(o,"BLOCKQUOTE");if(r&&""===t.toString()){if("Backspace"===i.key&&!(0,c.yl)(i)&&!i.shiftKey&&!i.altKey&&0===(0,N.im)(r,e[e.currentMode].element,t).start)return t.insertNode(document.createElement("wbr")),r.outerHTML=r.innerHTML,(0,N.ib)(e[e.currentMode].element,t),ct(e),i.preventDefault(),!0;if(n&&"Enter"===i.key&&!(0,c.yl)(i)&&!i.shiftKey&&!i.altKey&&"BLOCKQUOTE"===n.parentElement.tagName){var s=!1;if("\n"===n.innerHTML.replace(a.g.ZWSP,"")||""===n.innerHTML.replace(a.g.ZWSP,"")?(s=!0,n.remove()):n.innerHTML.endsWith("\n\n")&&(0,N.im)(n,e[e.currentMode].element,t).start===n.textContent.length-1&&(n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-2),s=!0),s)return r.insertAdjacentHTML("afterend",'<p data-block="0">'+a.g.ZWSP+"<wbr>\n</p>"),(0,N.ib)(e[e.currentMode].element,t),ct(e),i.preventDefault(),!0}var l=(0,b.F9)(o);if("wysiwyg"===e.currentMode&&l&&R("⇧⌘;",i))return t.insertNode(document.createElement("wbr")),l.outerHTML='<blockquote data-block="0">'+l.outerHTML+"</blockquote>",(0,N.ib)(e.wysiwyg.element,t),J(e),i.preventDefault(),!0;if(tt(e,i,t,r,r))return!0;if(it(e,i,t,r,r))return!0}return!1},xt=function(e,t,i){var n=t.startContainer,a=(0,b.fb)(n,"vditor-task");if(a){if(R("⇧⌘J",i)){var o=a.firstElementChild;return o.checked?o.removeAttribute("checked"):o.setAttribute("checked","checked"),ct(e),i.preventDefault(),!0}if("Backspace"===i.key&&!(0,c.yl)(i)&&!i.shiftKey&&!i.altKey&&""===t.toString()&&1===t.startOffset&&(3===n.nodeType&&n.previousSibling&&"INPUT"===n.previousSibling.tagName||3!==n.nodeType)){var r=a.previousElementSibling;return a.querySelector("input").remove(),r?((0,b.DX)(r).parentElement.insertAdjacentHTML("beforeend","<wbr>"+a.innerHTML.trim()),a.remove()):(a.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'+(a.innerHTML.trim()||"\n")+"</p>"),a.nextElementSibling?a.remove():a.parentElement.remove()),(0,N.ib)(e[e.currentMode].element,t),ct(e),i.preventDefault(),!0}if("Enter"===i.key&&!(0,c.yl)(i)&&!i.shiftKey&&!i.altKey){if(""===a.textContent.trim())if((0,b.fb)(a.parentElement,"vditor-task")){var s=(0,b.O9)(n);s&&ot(e,a,t,s)}else if(a.nextElementSibling){var l="",d="",u=!1;Array.from(a.parentElement.children).forEach((function(e){a.isSameNode(e)?u=!0:u?l+=e.outerHTML:d+=e.outerHTML}));var h=a.parentElement.tagName,p="OL"===a.parentElement.tagName?"":' data-marker="'+a.parentElement.getAttribute("data-marker")+'"',f="";d&&(f="UL"===a.parentElement.tagName?"":' start="1"',d="<"+h+' data-tight="true"'+p+' data-block="0">'+d+"</"+h+">"),a.parentElement.outerHTML=d+'<p data-block="0"><wbr>\n</p><'+h+'\n data-tight="true"'+p+' data-block="0"'+f+">"+l+"</"+h+">"}else a.parentElement.insertAdjacentHTML("afterend",'<p data-block="0"><wbr>\n</p>'),1===a.parentElement.querySelectorAll("li").length?a.parentElement.remove():a.remove();else 3!==n.nodeType&&0===t.startOffset&&"INPUT"===n.firstChild.tagName?t.setStart(n.childNodes[1],1):(t.setEndAfter(a.lastChild),a.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'+a.getAttribute("data-marker")+'"><input type="checkbox"> <wbr></li>'),document.querySelector("wbr").after(t.extractContents()));return(0,N.ib)(e[e.currentMode].element,t),ct(e),De(e),i.preventDefault(),!0}}return!1},Ct=function(e,t,i,n){if(3!==t.startContainer.nodeType){var a=t.startContainer.children[t.startOffset];if(a&&"HR"===a.tagName)return t.selectNodeContents(a.previousElementSibling),t.collapse(!1),i.preventDefault(),!0}if(n){var o=n.previousElementSibling;if(o&&0===(0,N.im)(n,e[e.currentMode].element,t).start&&((0,c.vU)()&&"HR"===o.tagName||"TABLE"===o.tagName)){if("TABLE"===o.tagName){var r=o.lastElementChild.lastElementChild.lastElementChild;r.innerHTML=r.innerHTML.trimLeft()+"<wbr>"+n.textContent.trim(),n.remove()}else o.remove();return(0,N.ib)(e[e.currentMode].element,t),ct(e),i.preventDefault(),!0}}return!1},kt=function(e){(0,c.vU)()&&3!==e.startContainer.nodeType&&"HR"===e.startContainer.tagName&&e.setStartBefore(e.startContainer)},_t=function(e,t,i){var n,a;if(!(0,c.vU)())return!1;if("ArrowUp"===e.key&&t&&"TABLE"===(null===(n=t.previousElementSibling)||void 0===n?void 0:n.tagName)){var o=t.previousElementSibling;return i.selectNodeContents(o.rows[o.rows.length-1].lastElementChild),i.collapse(!1),e.preventDefault(),!0}return!("ArrowDown"!==e.key||!t||"TABLE"!==(null===(a=t.nextElementSibling)||void 0===a?void 0:a.tagName))&&(i.selectNodeContents(t.nextElementSibling.rows[0].cells[0]),i.collapse(!0),e.preventDefault(),!0)},St=function(e,t,i){return We(void 0,void 0,void 0,(function(){var n,o,r,s,l,c,d,u,h,p,f,m,g,v,w,y;return Ge(this,(function(x){switch(x.label){case 0:return"true"!==e[e.currentMode].element.getAttribute("contenteditable")?[2]:(t.stopPropagation(),t.preventDefault(),"clipboardData"in t?(n=t.clipboardData.getData("text/html"),o=t.clipboardData.getData("text/plain"),r=t.clipboardData.files):(n=t.dataTransfer.getData("text/html"),o=t.dataTransfer.getData("text/plain"),t.dataTransfer.types.includes("Files")&&(r=t.dataTransfer.items)),s={},l=function(t,i){if(!i)return["",Lute.WalkContinue];var n=t.TokensStr();if(34===t.__internal_object__.Parent.Type&&n&&-1===n.indexOf("file://")&&e.options.upload.linkToImgUrl){var a=new XMLHttpRequest;a.open("POST",e.options.upload.linkToImgUrl),e.options.upload.token&&a.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(a.withCredentials=!0),He(e,a),a.setRequestHeader("Content-Type","application/json; charset=utf-8"),a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE){if(200===a.status){var t=a.responseText;e.options.upload.linkToImgFormat&&(t=e.options.upload.linkToImgFormat(a.responseText));var i=JSON.parse(t);if(0!==i.code)return void e.tip.show(i.msg);var n=i.data.originalURL;if("sv"===e.currentMode)e.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach((function(e){e.textContent===n&&(e.textContent=i.data.url)}));else{var o=e[e.currentMode].element.querySelector('img[src="'+n+'"]');o.src=i.data.url,"ir"===e.currentMode&&(o.previousElementSibling.previousElementSibling.innerHTML=i.data.url)}ct(e)}else e.tip.show(a.responseText);e.options.upload.linkToImgCallback&&e.options.upload.linkToImgCallback(a.responseText)}},a.send(JSON.stringify({url:n}))}return"ir"===e.currentMode?['<span class="vditor-ir__marker vditor-ir__marker--link">'+Lute.EscapeHTMLStr(n)+"</span>",Lute.WalkContinue]:"wysiwyg"===e.currentMode?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'+Lute.EscapeHTMLStr(n)+"</span>",Lute.WalkContinue]},n.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/gi,"").trim()!=='<a href="'+o+'">'+o+"</a>"&&n.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/gi,"").trim()!=='\x3c!--StartFragment--\x3e<a href="'+o+'">'+o+"</a>\x3c!--EndFragment--\x3e"||(n=""),(c=(new DOMParser).parseFromString(n,"text/html")).body&&(n=c.body.innerHTML),n=Lute.Sanitize(n),e.wysiwyg.getComments(e),d=e[e.currentMode].element.scrollHeight,u=function(e,t,i){void 0===i&&(i="sv");var n=document.createElement("div");n.innerHTML=e;var a=!1;1===n.childElementCount&&n.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(a=!0);var o=n.querySelectorAll("pre");if(1===n.childElementCount&&1===o.length&&"vditor-wysiwyg"!==o[0].className&&"vditor-sv"!==o[0].className&&(a=!0),0===e.indexOf('\n<p class="p1">')&&(a=!0),1===n.childElementCount&&"TABLE"===n.firstElementChild.tagName&&n.querySelector(".line-number")&&n.querySelector(".line-content")&&(a=!0),a){var r=t||e;return/\n/.test(r)||1===o.length?"wysiwyg"===i?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'+r.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"<wbr></code></pre></div>":"\n```\n"+r.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":"wysiwyg"===i?"<code>"+r.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"</code><wbr>":"`"+r+"`"}return!1}(n,o,e.currentMode),(h="sv"===e.currentMode?(0,b.a1)(t.target,"data-type","code-block"):(0,b.lG)(t.target,"CODE"))?("sv"===e.currentMode?document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(p=(0,N.im)(t.target,e[e.currentMode].element),"PRE"!==h.parentElement.tagName&&(o+=a.g.ZWSP),h.textContent=h.textContent.substring(0,p.start)+o+h.textContent.substring(p.end),(0,N.$j)(p.start+o.length,p.start+o.length,h.parentElement),(null===(y=h.parentElement)||void 0===y?void 0:y.nextElementSibling.classList.contains("vditor-"+e.currentMode+"__preview"))&&(h.parentElement.nextElementSibling.innerHTML=h.outerHTML,M(h.parentElement.nextElementSibling,e))),[3,8]):[3,1]);case 1:return u?(i.pasteCode(u),[3,8]):[3,2];case 2:return""===n.trim()?[3,3]:((f=document.createElement("div")).innerHTML=n,f.querySelectorAll("[style]").forEach((function(e){e.removeAttribute("style")})),f.querySelectorAll(".vditor-copy").forEach((function(e){e.remove()})),"ir"===e.currentMode?(s.HTML2VditorIRDOM={renderLinkDest:l},e.lute.SetJSRenderers({renderers:s}),(0,N.oC)(e.lute.HTML2VditorIRDOM(f.innerHTML),e)):"wysiwyg"===e.currentMode?(s.HTML2VditorDOM={renderLinkDest:l},e.lute.SetJSRenderers({renderers:s}),(0,N.oC)(e.lute.HTML2VditorDOM(f.innerHTML),e)):(s.Md2VditorSVDOM={renderLinkDest:l},e.lute.SetJSRenderers({renderers:s}),Ie(e,e.lute.HTML2Md(f.innerHTML).trimRight())),e.outline.render(e),[3,8]);case 3:return r.length>0?e.options.upload.url||e.options.upload.handler?[4,Be(e,r)]:[3,5]:[3,7];case 4:return x.sent(),[3,6];case 5:m=new FileReader,"clipboardData"in t?(r=t.clipboardData.files,g=r[0]):t.dataTransfer.types.includes("Files")&&(r=t.dataTransfer.items,g=r[0].getAsFile()),g&&g.type.startsWith("image")&&(m.readAsDataURL(g),m.onload=function(){var t="";"wysiwyg"===e.currentMode?t+='<img alt="'+g.name+'" src="'+m.result.toString()+'">\n':t+="!["+g.name+"]("+m.result.toString()+")\n",document.execCommand("insertHTML",!1,t)}),x.label=6;case 6:return[3,8];case 7:""!==o.trim()&&0===r.length&&(""!==(w=(0,N.zh)(e)).toString()&&e.lute.IsValidLinkDest(o)&&(o="["+w.toString()+"]("+o+")"),"ir"===e.currentMode?(s.Md2VditorIRDOM={renderLinkDest:l},e.lute.SetJSRenderers({renderers:s}),(0,N.oC)(e.lute.Md2VditorIRDOM(o),e)):"wysiwyg"===e.currentMode?(s.Md2VditorDOM={renderLinkDest:l},e.lute.SetJSRenderers({renderers:s}),(0,N.oC)(e.lute.Md2VditorDOM(o),e)):(s.Md2VditorSVDOM={renderLinkDest:l},e.lute.SetJSRenderers({renderers:s}),Ie(e,o)),e.outline.render(e)),x.label=8;case 8:return"sv"!==e.currentMode&&((v=(0,b.F9)((0,N.zh)(e).startContainer))&&(w=(0,N.zh)(e),e[e.currentMode].element.querySelectorAll("wbr").forEach((function(e){e.remove()})),w.insertNode(document.createElement("wbr")),"wysiwyg"===e.currentMode?v.outerHTML=e.lute.SpinVditorDOM(v.outerHTML):v.outerHTML=e.lute.SpinVditorIRDOM(v.outerHTML),(0,N.ib)(e[e.currentMode].element,w)),e[e.currentMode].element.querySelectorAll(".vditor-"+e.currentMode+"__preview[data-render='2']").forEach((function(t){M(t,e)}))),e.wysiwyg.triggerRemoveComment(e),ct(e),e[e.currentMode].element.scrollHeight-d>Math.min(e[e.currentMode].element.clientHeight,window.innerHeight)/2&&De(e),[2]}}))}))},Lt=function(e){e.hint.render(e);var t=(0,N.zh)(e).startContainer,i=(0,b.a1)(t,"data-type","code-block-info");if(i)if(""===i.textContent.replace(a.g.ZWSP,"")&&e.hint.recentLanguage)i.textContent=a.g.ZWSP+e.hint.recentLanguage,(0,N.zh)(e).selectNodeContents(i);else{var n=[],o=i.textContent.substring(0,(0,N.im)(i,e.ir.element).start).replace(a.g.ZWSP,"");a.g.CODE_LANGUAGES.forEach((function(e){e.indexOf(o.toLowerCase())>-1&&n.push({html:e,value:e})})),e.hint.genHTML(n,o,e)}},Tt=function(e,t){void 0===t&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&Lt(e),clearTimeout(e.ir.processTimeoutId),e.ir.processTimeoutId=window.setTimeout((function(){if(!e.ir.composingLock){var i=r(e);"function"==typeof e.options.input&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,c.pK)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}}),e.options.undoDelay)},Dt=function(e,t){var i=(0,N.zh)(e),n=(0,b.F9)(i.startContainer)||i.startContainer;if(n){var a=n.querySelector(".vditor-ir__marker--heading");a?a.innerHTML=t:(n.insertAdjacentText("afterbegin",t),i.selectNodeContents(n),i.collapse(!1)),$(e,i.cloneRange()),Y(e)}},Et=function(e,t,i){var n=(0,b.a1)(e.startContainer,"data-type",i);if(n){n.firstElementChild.remove(),n.lastElementChild.remove(),e.insertNode(document.createElement("wbr"));var a=document.createElement("div");a.innerHTML=t.lute.SpinVditorIRDOM(n.outerHTML),n.outerHTML=a.firstElementChild.innerHTML.trim()}},Ft=function(e,t,i,n){var a=(0,N.zh)(e),o=t.getAttribute("data-type"),r=a.startContainer;3===r.nodeType&&(r=r.parentElement);var s=!0;if(t.classList.contains("vditor-menu--current"))if("quote"===o){var l=(0,b.lG)(r,"BLOCKQUOTE");l&&(a.insertNode(document.createElement("wbr")),l.outerHTML=""===l.innerHTML.trim()?'<p data-block="0">'+l.innerHTML+"</p>":l.innerHTML)}else if("link"===o){var c=(0,b.a1)(a.startContainer,"data-type","a");if(c){var u=(0,b.fb)(a.startContainer,"vditor-ir__link");u?(a.insertNode(document.createElement("wbr")),c.outerHTML=u.innerHTML):c.outerHTML=c.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else"italic"===o?Et(a,e,"em"):"bold"===o?Et(a,e,"strong"):"strike"===o?Et(a,e,"s"):"inline-code"===o?Et(a,e,"code"):"check"!==o&&"list"!==o&&"ordered-list"!==o||(nt(e,a,o),s=!1,t.classList.remove("vditor-menu--current"));else{0===e.ir.element.childNodes.length&&(e.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,N.ib)(e.ir.element,a));var h=(0,b.F9)(a.startContainer);if("line"===o){if(h){var p='<hr data-block="0"><p data-block="0"><wbr>\n</p>';""===h.innerHTML.trim()?h.outerHTML=p:h.insertAdjacentHTML("afterend",p)}}else if("quote"===o)h&&(a.insertNode(document.createElement("wbr")),h.outerHTML='<blockquote data-block="0">'+h.outerHTML+"</blockquote>",s=!1,t.classList.add("vditor-menu--current"));else if("link"===o){var f=void 0;f=""===a.toString()?i+"<wbr>"+n:""+i+a.toString()+n.replace(")","<wbr>)"),document.execCommand("insertHTML",!1,f),s=!1,t.classList.add("vditor-menu--current")}else if("italic"===o||"bold"===o||"strike"===o||"inline-code"===o||"code"===o||"table"===o){f=void 0,""===a.toString()?f=i+"<wbr>"+n:(f="code"===o?i+"\n"+a.toString()+"<wbr>"+n:"table"===o?""+i+a.toString()+"<wbr>"+n:""+i+a.toString()+n+"<wbr>",a.deleteContents()),"table"!==o&&"code"!==o||(f="\n"+f+"\n\n");var m=document.createElement("span");m.innerHTML=f,a.insertNode(m),$(e,a),"table"===o&&(a.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,N.Hc)(a))}else"check"!==o&&"list"!==o&&"ordered-list"!==o||(nt(e,a,o,!1),s=!1,d(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current"))}(0,N.ib)(e.ir.element,a),Tt(e),s&&Y(e)},It=function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,s)}l((n=n.apply(e,t||[])).next())}))},Mt=function(e,t){var i,n,a,o,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!((a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(6===o[0]&&r.label<a[1]){r.label=a[1],a=o;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(o);break}a[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],n=0}finally{i=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Nt=function(){function e(e){var t=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(e,i){t.element.style.display="none";var n=decodeURIComponent(e.getAttribute("data-value")),o=window.getSelection().getRangeAt(0);if("ir"===i.currentMode){var r=(0,b.a1)(o.startContainer,"data-type","code-block-info");if(r)return r.textContent=a.g.ZWSP+n.trimRight(),o.selectNodeContents(r),o.collapse(!1),Tt(i),r.parentElement.querySelectorAll("code").forEach((function(e){e.className="language-"+n.trimRight()})),M(r.parentElement.querySelector(".vditor-ir__preview"),i),void(t.recentLanguage=n.trimRight())}if("wysiwyg"===i.currentMode&&3!==o.startContainer.nodeType){var s=o.startContainer,l=void 0;if((l=s.classList.contains("vditor-input")?s:s.firstElementChild)&&l.classList.contains("vditor-input"))return l.value=n.trimRight(),o.selectNodeContents(l),o.collapse(!1),l.dispatchEvent(new CustomEvent("input",{detail:1})),void(t.recentLanguage=n.trimRight())}if(o.setStart(o.startContainer,t.lastIndex),o.deleteContents(),i.options.hint.parse?"sv"===i.currentMode?(0,N.oC)(i.lute.SpinVditorSVDOM(n),i):"wysiwyg"===i.currentMode?(0,N.oC)(i.lute.SpinVditorDOM(n),i):(0,N.oC)(i.lute.SpinVditorIRDOM(n),i):(0,N.oC)(n,i),":"===t.splitChar&&n.indexOf(":")>-1&&"sv"!==i.currentMode&&o.insertNode(document.createTextNode(" ")),o.collapse(!1),(0,N.Hc)(o),"wysiwyg"===i.currentMode)(c=(0,b.fb)(o.startContainer,"vditor-wysiwyg__block"))&&c.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(c.lastElementChild.innerHTML=c.firstElementChild.innerHTML,M(c.lastElementChild,i));else if("ir"===i.currentMode){var c;(c=(0,b.fb)(o.startContainer,"vditor-ir__marker--pre"))&&c.nextElementSibling.classList.contains("vditor-ir__preview")&&(c.nextElementSibling.innerHTML=c.innerHTML,M(c.nextElementSibling,i))}ct(i)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",e.push({key:":"})}return e.prototype.render=function(e){var t=this;if(window.getSelection().focusNode){var i,n=getSelection().getRangeAt(0);i=n.startContainer.textContent.substring(0,n.startOffset)||"";var a=this.getKey(i,e.options.hint.extend);if(void 0===a)this.element.style.display="none",clearTimeout(this.timeId);else if(":"===this.splitChar){var o=""===a?e.options.hint.emoji:e.lute.GetEmojis(),r=[];Object.keys(o).forEach((function(e){0===e.indexOf(a.toLowerCase())&&(o[e].indexOf(".")>-1?r.push({html:'<img src="'+o[e]+'" title=":'+e+':"/> :'+e+":",value:":"+e+":"}):r.push({html:'<span class="vditor-hint__emoji">'+o[e]+"</span>"+e,value:o[e]}))})),this.genHTML(r,a,e)}else e.options.hint.extend.forEach((function(i){i.key===t.splitChar&&(clearTimeout(t.timeId),t.timeId=window.setTimeout((function(){return It(t,void 0,void 0,(function(){var t;return Mt(this,(function(n){switch(n.label){case 0:return t=this.genHTML,[4,i.hint(a)];case 1:return t.apply(this,[n.sent(),a,e]),[2]}}))}))}),e.options.hint.delay))}))}},e.prototype.genHTML=function(e,t,i){var n=this;if(0!==e.length){var a=i[i.currentMode].element,o=(0,N.Ny)(a),r=o.left+("left"===i.options.outline.position?i.outline.element.offsetWidth:0),s=o.top,l="";e.forEach((function(e,i){if(!(i>7)){var n=e.html;if(""!==t){var a=n.lastIndexOf(">")+1,o=n.substr(a),r=o.toLowerCase().indexOf(t.toLowerCase());r>-1&&(o=o.substring(0,r)+"<b>"+o.substring(r,r+t.length)+"</b>"+o.substring(r+t.length),n=n.substr(0,a)+o)}l+='<button data-value="'+encodeURIComponent(e.value)+' "\n'+(0===i?"class='vditor-hint--current'":"")+"> "+n+"</button>"}})),this.element.innerHTML=l;var c=parseInt(document.defaultView.getComputedStyle(a,null).getPropertyValue("line-height"),10);this.element.style.top=s+(c||22)+"px",this.element.style.left=r+"px",this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach((function(e){e.addEventListener("click",(function(t){n.fillEmoji(e,i),t.preventDefault()}))})),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top=s-this.element.offsetHeight+"px"),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")}else this.element.style.display="none"},e.prototype.select=function(e,t){if(0===this.element.querySelectorAll("button").length||"none"===this.element.style.display)return!1;var i=this.element.querySelector(".vditor-hint--current");if("ArrowDown"===e.key)return e.preventDefault(),e.stopPropagation(),i.removeAttribute("class"),i.nextElementSibling?i.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if("ArrowUp"===e.key){if(e.preventDefault(),e.stopPropagation(),i.removeAttribute("class"),i.previousElementSibling)i.previousElementSibling.className="vditor-hint--current";else{var n=this.element.children.length;this.element.children[n-1].className="vditor-hint--current"}return!0}return!((0,c.yl)(e)||e.shiftKey||e.altKey||"Enter"!==e.key||e.isComposing)&&(e.preventDefault(),e.stopPropagation(),this.fillEmoji(i,t),!0)},e.prototype.getKey=function(e,t){var i,n=this;if(this.lastIndex=-1,this.splitChar="",t.forEach((function(t){var i=e.lastIndexOf(t.key);n.lastIndex<i&&(n.splitChar=t.key,n.lastIndex=i)})),-1===this.lastIndex)return i;var a=e.split(this.splitChar),r=a[a.length-1];if(a.length>1&&r.trim()===r)if(2===a.length&&""===a[0]&&a[1].length<32)i=a[1];else{var s=a[a.length-2].slice(-1);" "===(0,o.X)(s)&&r.length<32&&(i=r)}return i},e}(),Ot=function(){function e(e){this.composingLock=!1;var t=document.createElement("div");t.className="vditor-ir",t.innerHTML='<pre class="vditor-reset" placeholder="'+e.options.placeholder+'"\n contenteditable="true" spellcheck="false"></pre>',this.element=t.firstElementChild,this.bindEvent(e),Ce(e,this.element),ke(e,this.element),_e(e,this.element),Ee(e,this.element),Fe(e,this.element),Se(e,this.element),Le(e,this.element,this.copy),Te(e,this.element,this.copy)}return e.prototype.copy=function(e,t){var i=getSelection().getRangeAt(0);if(""!==i.toString()){e.stopPropagation(),e.preventDefault();var n=document.createElement("div");n.appendChild(i.cloneContents()),e.clipboardData.setData("text/plain",t.lute.VditorIRDOM2Md(n.innerHTML).trim()),e.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(e){var t=this;this.element.addEventListener("paste",(function(t){St(e,t,{pasteCode:function(e){document.execCommand("insertHTML",!1,e)}})})),this.element.addEventListener("compositionstart",(function(e){t.composingLock=!0})),this.element.addEventListener("compositionend",(function(i){(0,c.vU)()||$(e,getSelection().getRangeAt(0).cloneRange()),t.composingLock=!1})),this.element.addEventListener("input",(function(i){if("deleteByDrag"!==i.inputType&&"insertFromDrop"!==i.inputType)return t.preventInput?(t.preventInput=!1,void Tt(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})):void(t.composingLock||"‘"===i.data||"“"===i.data||"《"===i.data||$(e,getSelection().getRangeAt(0).cloneRange(),!1,i))})),this.element.addEventListener("click",(function(i){if("INPUT"===i.target.tagName)return i.target.checked?i.target.setAttribute("checked","checked"):i.target.removeAttribute("checked"),t.preventInput=!0,void Tt(e);var n=(0,N.zh)(e),o=(0,b.fb)(i.target,"vditor-ir__preview");if(o||(o=(0,b.fb)(n.startContainer,"vditor-ir__preview")),o&&(o.previousElementSibling.firstElementChild?n.selectNodeContents(o.previousElementSibling.firstElementChild):n.selectNodeContents(o.previousElementSibling),n.collapse(!0),(0,N.Hc)(n),De(e)),"IMG"===i.target.tagName){var r=i.target.parentElement.querySelector(".vditor-ir__marker--link");r&&(n.selectNode(r),(0,N.Hc)(n))}var s=(0,b.a1)(i.target,"data-type","a");if(!s||s.classList.contains("vditor-ir__node--expand")){if(i.target.isEqualNode(t.element)&&t.element.lastElementChild&&n.collapsed){var l=t.element.lastElementChild.getBoundingClientRect();i.y>l.top+l.height&&("P"===t.element.lastElementChild.tagName&&""===t.element.lastElementChild.textContent.trim().replace(a.g.ZWSP,"")?(n.selectNodeContents(t.element.lastElementChild),n.collapse(!1)):(t.element.insertAdjacentHTML("beforeend",'<p data-block="0">'+a.g.ZWSP+"<wbr></p>"),(0,N.ib)(t.element,n)))}""===n.toString()?H(n,e):setTimeout((function(){H((0,N.zh)(e),e)})),A(i,e),Y(e)}else e.options.link.click?e.options.link.click(s.querySelector(":scope > .vditor-ir__marker--link")):e.options.link.isOpen&&window.open(s.querySelector(":scope > .vditor-ir__marker--link").textContent)})),this.element.addEventListener("keyup",(function(i){if(!i.isComposing&&!(0,c.yl)(i))if("Enter"===i.key&&De(e),Y(e),"Backspace"!==i.key&&"Delete"!==i.key||""===e.ir.element.innerHTML||1!==e.ir.element.childNodes.length||!e.ir.element.firstElementChild||"P"!==e.ir.element.firstElementChild.tagName||0!==e.ir.element.firstElementChild.childElementCount||""!==e.ir.element.textContent&&"\n"!==e.ir.element.textContent){var n=(0,N.zh)(e);"Backspace"===i.key?((0,c.vU)()&&"\n"===n.startContainer.textContent&&1===n.startOffset&&(n.startContainer.textContent="",H(n,e)),t.element.querySelectorAll(".language-math").forEach((function(e){var t=e.querySelector("br");t&&t.remove()}))):i.key.indexOf("Arrow")>-1?("ArrowLeft"!==i.key&&"ArrowRight"!==i.key||Lt(e),H(n,e)):229===i.keyCode&&""===i.code&&"Unidentified"===i.key&&H(n,e);var o=(0,b.fb)(n.startContainer,"vditor-ir__preview");if(o){if("ArrowUp"===i.key||"ArrowLeft"===i.key)return o.previousElementSibling.firstElementChild?n.selectNodeContents(o.previousElementSibling.firstElementChild):n.selectNodeContents(o.previousElementSibling),n.collapse(!1),i.preventDefault(),!0;if("SPAN"===o.tagName&&("ArrowDown"===i.key||"ArrowRight"===i.key))return"html-entity"===o.parentElement.getAttribute("data-type")?(o.parentElement.insertAdjacentText("afterend",a.g.ZWSP),n.setStart(o.parentElement.nextSibling,1)):n.selectNodeContents(o.parentElement.lastElementChild),n.collapse(!1),i.preventDefault(),!0}}else e.ir.element.innerHTML=""}))},e}(),At=function(e){return"sv"===e.currentMode?e.lute.Md2HTML(r(e)):"wysiwyg"===e.currentMode?e.lute.VditorDOM2HTML(e.wysiwyg.element.innerHTML):"ir"===e.currentMode?e.lute.VditorIRDOM2HTML(e.ir.element.innerHTML):void 0},Pt=i(895),$t=i(818),Rt=function(){function e(e){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'+e+'</div>\n<div class="vditor-outline__content"></div>'}return e.prototype.render=function(e){return"block"===e.preview.element.style.display?(0,$t.k)(e.preview.element.lastElementChild,this.element.lastElementChild,e):(0,$t.k)(e[e.currentMode].element,this.element.lastElementChild,e)},e.prototype.toggle=function(e,t,i){var n;void 0===t&&(t=!0),void 0===i&&(i=!0);var o=null===(n=e.toolbar.elements.outline)||void 0===n?void 0:n.firstElementChild;if(t&&window.innerWidth>=a.g.MOBILE_WIDTH?(this.element.style.display="block",this.render(e),null==o||o.classList.add("vditor-menu--current")):(this.element.style.display="none",null==o||o.classList.remove("vditor-menu--current")),i&&getSelection().rangeCount>0){var r=getSelection().getRangeAt(0);e[e.currentMode].element.contains(r.startContainer)&&(0,N.Hc)(r)}V(e)},e}(),Ht=i(554),jt=function(){function e(e){var t=this;this.element=document.createElement("div"),this.element.className="vditor-preview";var i=document.createElement("div");i.className="vditor-reset",e.options.classes.preview&&i.classList.add(e.options.classes.preview),i.style.maxWidth=e.options.preview.maxWidth+"px",i.addEventListener("copy",(function(i){if("TEXTAREA"!==i.target.tagName){var n=document.createElement("div");n.className="vditor-reset",n.appendChild(getSelection().getRangeAt(0).cloneContents()),t.copyToX(e,n),i.preventDefault()}})),i.addEventListener("click",(function(n){var a=(0,b.lG)(n.target,"SPAN");if(a&&(0,b.fb)(a,"vditor-toc")){var o=i.querySelector("#"+a.getAttribute("data-target-id"));o&&(t.element.scrollTop=o.offsetTop)}else{if("A"===n.target.tagName)return e.options.link.click?e.options.link.click(n.target):e.options.link.isOpen&&window.open(n.target.getAttribute("href")),void n.preventDefault();"IMG"===n.target.tagName&&(e.options.image.preview?e.options.image.preview(n.target):e.options.image.isPreview&&(0,j.E)(n.target,e.options.lang,e.options.theme))}}));var n=e.options.preview.actions,a=document.createElement("div");a.className="vditor-preview__action";for(var o=[],r=0;r<n.length;r++){var s=n[r];if("object"!=typeof s)switch(s){case"desktop":o.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":o.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":o.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":o.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":o.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>')}else o.push('<button type="button" data-type="'+s.key+'" class="'+s.className+'"'+(s.tooltip?' aria-label="'+s.tooltip+'"':"")+'">'+s.text+"</button>")}a.innerHTML=o.join(""),0===n.length&&(a.style.display="none"),this.element.appendChild(a),this.element.appendChild(i),a.addEventListener((0,c.Le)(),(function(o){var r=(0,w.S)(o.target,"BUTTON");if(r){var s=r.getAttribute("data-type"),l=n.find((function(e){return(null==e?void 0:e.key)===s}));l?l.click(s):"mp-wechat"!==s&&"zhihu"!==s?(i.style.width="desktop"===s?"auto":"tablet"===s?"780px":"360px",i.scrollWidth>i.parentElement.clientWidth&&(i.style.width="auto"),t.render(e),a.querySelectorAll("button").forEach((function(e){e.classList.remove("vditor-preview__action--current")})),r.classList.add("vditor-preview__action--current")):t.copyToX(e,t.element.lastElementChild.cloneNode(!0),s)}}))}return e.prototype.render=function(e,t){var i=this;if(clearTimeout(this.mdTimeoutId),"none"!==this.element.style.display)if(t)this.element.lastElementChild.innerHTML=t;else if(""!==r(e).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")){var n=(new Date).getTime(),a=r(e);this.mdTimeoutId=window.setTimeout((function(){if(e.options.preview.url){var t=new XMLHttpRequest;t.open("POST",e.options.preview.url),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE)if(200===t.status){var o=JSON.parse(t.responseText);if(0!==o.code)return void e.tip.show(o.msg);e.options.preview.transform&&(o.data=e.options.preview.transform(o.data)),i.element.lastElementChild.innerHTML=o.data,i.afterRender(e,n)}else{var r=e.lute.Md2HTML(a);e.options.preview.transform&&(r=e.options.preview.transform(r)),i.element.lastElementChild.innerHTML=r,i.afterRender(e,n)}},t.send(JSON.stringify({markdownText:a}))}else{var o=e.lute.Md2HTML(a);e.options.preview.transform&&(o=e.options.preview.transform(o)),i.element.lastElementChild.innerHTML=o,i.afterRender(e,n)}}),e.options.preview.delay)}else this.element.lastElementChild.innerHTML="";else"renderPerformance"===this.element.getAttribute("data-type")&&e.tip.hide()},e.prototype.afterRender=function(e,t){e.options.preview.parse&&e.options.preview.parse(this.element);var i=(new Date).getTime()-t;(new Date).getTime()-t>2600?(e.tip.show(window.VditorI18n.performanceTip.replace("${x}",i.toString())),e.preview.element.setAttribute("data-type","renderPerformance")):"renderPerformance"===e.preview.element.getAttribute("data-type")&&(e.tip.hide(),e.preview.element.removeAttribute("data-type"));var n=e.preview.element.querySelector(".vditor-comment--focus");n&&n.classList.remove("vditor-comment--focus"),(0,k.O)(e.preview.element.lastElementChild),(0,L.s)(e.options.preview.hljs,e.preview.element.lastElementChild,e.options.cdn),(0,D.i)(e.preview.element.lastElementChild,e.options.cdn,e.options.theme),(0,E.K)(e.preview.element.lastElementChild,e.options.cdn,e.options.theme),(0,_.P)(e.preview.element.lastElementChild,e.options.cdn),(0,S.v)(e.preview.element.lastElementChild,e.options.cdn),(0,C.p)(e.preview.element.lastElementChild,e.options.cdn,e.options.theme),(0,F.P)(e.preview.element.lastElementChild,e.options.cdn,e.options.theme),(0,I.B)(e.preview.element.lastElementChild,e.options.cdn),(0,x.Q)(e.preview.element.lastElementChild,e.options.cdn),(0,Ht.Y)(e.preview.element.lastElementChild);var a=e.preview.element,o=e.outline.render(e);""===o&&(o="[ToC]"),a.querySelectorAll('[data-type="toc-block"]').forEach((function(t){t.innerHTML=o,(0,T.H)(t,{cdn:e.options.cdn,math:e.options.preview.math})})),(0,T.H)(e.preview.element.lastElementChild,{cdn:e.options.cdn,math:e.options.preview.math})},e.prototype.copyToX=function(e,t,i){void 0===i&&(i="mp-wechat"),"zhihu"!==i?t.querySelectorAll(".katex-html .base").forEach((function(e){e.style.display="initial"})):t.querySelectorAll(".language-math").forEach((function(e){e.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'+e.getAttribute("data-math")+'\\" style="display: block; margin: 0 auto; max-width: 100%;">'})),t.style.backgroundColor="#fff",t.querySelectorAll("code").forEach((function(e){e.style.backgroundImage="none"})),this.element.append(t);var n=t.ownerDocument.createRange();n.selectNode(t),(0,N.Hc)(n),document.execCommand("copy"),this.element.lastElementChild.remove(),e.tip.show("已复制，可到"+("zhihu"===i?"知乎":"微信公众号平台")+"进行粘贴")},e}(),qt=function(){function e(e){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--"+e.options.resize.position,this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(e)}return e.prototype.bindEvent=function(e){var t=this;this.element.addEventListener("mousedown",(function(i){var n=document,a=i.clientY,o=e.element.offsetHeight,r=63+e.element.querySelector(".vditor-toolbar").clientHeight;n.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),t.element.classList.add("vditor-resize--selected"),n.onmousemove=function(t){"top"===e.options.resize.position?e.element.style.height=Math.max(r,o+(a-t.clientY))+"px":e.element.style.height=Math.max(r,o+(t.clientY-a))+"px",e.options.typewriterMode&&(e.sv.element.style.paddingBottom=e.sv.element.parentElement.offsetHeight/2+"px")},n.onmouseup=function(){e.options.resize.after&&e.options.resize.after(e.element.offsetHeight-o),window.captureEvents&&window.captureEvents(),n.onmousemove=null,n.onmouseup=null,n.ondragstart=null,n.onselectstart=null,n.onselect=null,t.element.classList.remove("vditor-resize--selected")}}))},e}(),zt=function(){function e(e){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",e.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(e),Ce(e,this.element),_e(e,this.element),Ee(e,this.element),Fe(e,this.element),Se(e,this.element),Le(e,this.element,this.copy),Te(e,this.element,this.copy)}return e.prototype.copy=function(e,t){e.stopPropagation(),e.preventDefault(),e.clipboardData.setData("text/plain",xe(t[t.currentMode].element))},e.prototype.bindEvent=function(e){var t=this;this.element.addEventListener("paste",(function(t){St(e,t,{pasteCode:function(e){document.execCommand("insertHTML",!1,e)}})})),this.element.addEventListener("scroll",(function(){if("block"===e.preview.element.style.display){var i=t.element.scrollTop,n=t.element.clientHeight,a=t.element.scrollHeight-parseFloat(t.element.style.paddingBottom||"0"),o=e.preview.element;o.scrollTop=i/n>.5?(i+n)*o.scrollHeight/a-n:i*o.scrollHeight/a}})),this.element.addEventListener("compositionstart",(function(e){t.composingLock=!0})),this.element.addEventListener("compositionend",(function(i){(0,c.vU)()||q(e,i),t.composingLock=!1})),this.element.addEventListener("input",(function(i){if("deleteByDrag"!==i.inputType&&"insertFromDrop"!==i.inputType&&!t.composingLock&&"‘"!==i.data&&"“"!==i.data&&"《"!==i.data)return t.preventInput?(t.preventInput=!1,void Ae(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})):void q(e,i)})),this.element.addEventListener("keyup",(function(t){t.isComposing||(0,c.yl)(t)||("Backspace"!==t.key&&"Delete"!==t.key||""===e.sv.element.innerHTML||1!==e.sv.element.childNodes.length||!e.sv.element.firstElementChild||"DIV"!==e.sv.element.firstElementChild.tagName||2!==e.sv.element.firstElementChild.childElementCount||""!==e.sv.element.firstElementChild.textContent&&"\n"!==e.sv.element.textContent?"Enter"===t.key&&De(e):e.sv.element.innerHTML="")}))},e}(),Bt=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return e.prototype.show=function(e,t){var i=this;void 0===t&&(t=6e3),this.element.className="vditor-tip vditor-tip--show",0===t?(this.element.innerHTML='<div class="vditor-tip__content">'+e+'\n<div class="vditor-tip__close">X</div></div>',this.element.querySelector(".vditor-tip__close").addEventListener("click",(function(){i.hide()}))):(this.element.innerHTML='<div class="vditor-tip__content">'+e+"</div>",setTimeout((function(){i.hide()}),t)),this.element.removeAttribute("style"),setTimeout((function(){i.element.getBoundingClientRect().top<46&&(i.element.style.position="fixed",i.element.style.top="46px")}),150)},e.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},e}(),Vt=function(e,t){if(t.options.preview.mode!==e){switch(t.options.preview.mode=e,e){case"both":t.sv.element.style.display="block",t.preview.element.style.display="block",t.preview.render(t),u(t.toolbar.elements,["both"]);break;case"editor":t.sv.element.style.display="block",t.preview.element.style.display="none",d(t.toolbar.elements,["both"])}t.devtools&&t.devtools.renderEchart(t)}},Ut=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wt=function(e){function t(t,i){var n=e.call(this,t,i)||this;return"both"===t.options.preview.mode&&n.element.children[0].classList.add("vditor-menu--current"),n.element.children[0].addEventListener((0,c.Le)(),(function(e){n.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)||(e.preventDefault(),"sv"===t.currentMode&&("both"===t.options.preview.mode?Vt("editor",t):Vt("both",t)))})),n}return Ut(t,e),t}(ve),Gt=function(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"},Xt=i(312),Kt=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Yt=function(e){function t(t,i){var n=e.call(this,t,i)||this,o=n.element.children[0],r=document.createElement("div");r.className="vditor-hint"+(2===i.level?"":" vditor-panel--arrow");var s="";return a.g.CODE_THEME.forEach((function(e){s+="<button>"+e+"</button>"})),r.innerHTML='<div style="overflow: auto;max-height:'+window.innerHeight/2+'px">'+s+"</div>",r.addEventListener((0,c.Le)(),(function(e){"BUTTON"===e.target.tagName&&(g(t,["subToolbar"]),t.options.preview.hljs.style=e.target.textContent,(0,Xt.Y)(e.target.textContent,t.options.cdn),e.preventDefault(),e.stopPropagation())})),n.element.appendChild(r),v(t,r,o,i.level),n}return Kt(t,e),t}(ve),Jt=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Qt=function(e){function t(t,i){var n=e.call(this,t,i)||this,a=n.element.children[0],o=document.createElement("div");o.className="vditor-hint"+(2===i.level?"":" vditor-panel--arrow");var r="";return Object.keys(t.options.preview.theme.list).forEach((function(e){r+='<button data-type="'+e+'">'+t.options.preview.theme.list[e]+"</button>"})),o.innerHTML='<div style="overflow: auto;max-height:'+window.innerHeight/2+'px">'+r+"</div>",o.addEventListener((0,c.Le)(),(function(e){"BUTTON"===e.target.tagName&&(g(t,["subToolbar"]),t.options.preview.theme.current=e.target.getAttribute("data-type"),(0,z.Z)(t.options.preview.theme.current,t.options.preview.theme.path),e.preventDefault(),e.stopPropagation())})),n.element.appendChild(o),v(t,o,a,i.level),n}return Jt(t,e),t}(ve),Zt=function(){function e(e){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(e,"")}return e.prototype.render=function(e,t){var i=t.endsWith("\n")?t.length-1:t.length;if("text"===e.options.counter.type&&e[e.currentMode]){var n=e[e.currentMode].element.cloneNode(!0);n.querySelectorAll(".vditor-wysiwyg__preview").forEach((function(e){e.remove()})),i=n.textContent.length}"number"==typeof e.options.counter.max?(i>e.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML=i+"/"+e.options.counter.max):this.element.innerHTML=""+i,this.element.setAttribute("aria-label",e.options.counter.type),e.options.counter.after&&e.options.counter.after(i,{enable:e.options.counter.enable,max:e.options.counter.max,type:e.options.counter.type})},e}(),ei=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ti=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.element.children[0].innerHTML=i.icon,n.element.children[0].addEventListener((0,c.Le)(),(function(e){e.preventDefault(),e.currentTarget.classList.contains(a.g.CLASS_MENU_DISABLED)||i.click(e,t)})),n}return ei(t,e),t}(ve),ii=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ni=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.element.firstElementChild.addEventListener((0,c.Le)(),(function(e){var i=n.element.firstElementChild;i.classList.contains(a.g.CLASS_MENU_DISABLED)||(e.preventDefault(),i.classList.contains("vditor-menu--current")?(i.classList.remove("vditor-menu--current"),t.devtools.element.style.display="none",V(t)):(i.classList.add("vditor-menu--current"),t.devtools.element.style.display="block",V(t),t.devtools.renderEchart(t)))})),n}return ii(t,e),t}(ve),ai=function(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"},oi=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ri=function(e){function t(t,i){var n=e.call(this,t,i)||this,a=document.createElement("div");a.className="vditor-panel vditor-panel--arrow";var o="";return Object.keys(t.options.hint.emoji).forEach((function(e){var i=t.options.hint.emoji[e];i.indexOf(".")>-1?o+='<button data-value=":'+e+': " data-key=":'+e+':"><img\ndata-value=":'+e+': " data-key=":'+e+':" class="vditor-emojis__icon" src="'+i+'"/></button>':o+='<button data-value="'+i+' "\n data-key="'+e+'"><span class="vditor-emojis__icon">'+i+"</span></button>"})),a.innerHTML='<div class="vditor-emojis" style="max-height: '+("auto"===t.options.height?"auto":t.options.height-80)+'px">'+o+'</div><div class="vditor-emojis__tail">\n    <span class="vditor-emojis__tip"></span><span>'+(t.options.hint.emojiTail||"")+"</span>\n</div>",n.element.appendChild(a),v(t,a,n.element.firstElementChild,i.level),n.bindEvent(t),n}return oi(t,e),t.prototype.bindEvent=function(e){var t=this;this.element.lastElementChild.addEventListener((0,c.Le)(),(function(i){var n=(0,w.S)(i.target,"BUTTON");if(n){i.preventDefault();var a=n.getAttribute("data-value"),o=(0,N.zh)(e),r=a;if("wysiwyg"===e.currentMode?r=e.lute.SpinVditorDOM(a):"ir"===e.currentMode&&(r=e.lute.SpinVditorIRDOM(a)),a.indexOf(":")>-1&&"sv"!==e.currentMode){var s=document.createElement("div");s.innerHTML=r,r=s.firstElementChild.firstElementChild.outerHTML+" ",(0,N.oC)(r,e)}else o.extractContents(),o.insertNode(document.createTextNode(a));o.collapse(!1),(0,N.Hc)(o),t.element.lastElementChild.style.display="none",ct(e)}})),this.element.lastElementChild.addEventListener("mouseover",(function(e){var i=(0,w.S)(e.target,"BUTTON");i&&(t.element.querySelector(".vditor-emojis__tip").innerHTML=i.getAttribute("data-key"))}))},t}(ve),si=function(e,t,i){var n=document.createElement("a");"download"in n?(n.download=i,n.style.display="none",n.href=URL.createObjectURL(new Blob([t])),document.body.appendChild(n),n.click(),n.remove()):e.tip.show(window.VditorI18n.downloadTip,0)},li=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ci=function(e){function t(t,i){var n=e.call(this,t,i)||this,a=n.element.children[0],o=document.createElement("div");return o.className="vditor-hint"+(2===i.level?"":" vditor-panel--arrow"),o.innerHTML='<button data-type="markdown">Markdown</button>\n<button data-type="pdf">PDF</button>\n<button data-type="html">HTML</button>',o.addEventListener((0,c.Le)(),(function(e){var i=e.target;if("BUTTON"===i.tagName){switch(i.getAttribute("data-type")){case"markdown":!function(e){var t=r(e);si(e,t,t.substr(0,10)+".md")}(t);break;case"pdf":!function(e){e.tip.show(window.VditorI18n.generate,3800);var t=document.querySelector("#vditorExportIframe");t.contentDocument.open(),t.contentDocument.write('<link rel="stylesheet" href="'+e.options.cdn+'/dist/index.css"/>\n<script src="'+e.options.cdn+'/dist/method.min.js"><\/script>\n<div id="preview" style="width: 800px"></div>\n<script>\nwindow.addEventListener("message", (e) => {\n  if(!e.data) {\n    return;\n  }\n  Vditor.preview(document.getElementById(\'preview\'), e.data, {\n    markdown: {\n      theme: "'+e.options.preview.theme+'"\n    },\n    hljs: {\n      style: "'+e.options.preview.hljs.style+'"\n    }\n  });\n  setTimeout(() => {\n        window.print();\n    }, 3600);\n}, false);\n<\/script>'),t.contentDocument.close(),setTimeout((function(){t.contentWindow.postMessage(r(e),"*")}),200)}(t);break;case"html":!function(e){var t=At(e),i='<html><head><link rel="stylesheet" type="text/css" href="'+e.options.cdn+'/dist/index.css"/>\n<script src="'+e.options.cdn+"/dist/js/i18n/"+e.options.lang+'.js"><\/script>\n<script src="'+e.options.cdn+'/dist/method.min.js"><\/script></head>\n<body><div class="vditor-reset" id="preview">'+t+"</div>\n<script>\n    const previewElement = document.getElementById('preview')\n    Vditor.setContentTheme('"+e.options.preview.theme.current+"', '"+e.options.preview.theme.path+"');\n    Vditor.codeRender(previewElement);\n    Vditor.highlightRender("+JSON.stringify(e.options.preview.hljs)+", previewElement, '"+e.options.cdn+"');\n    Vditor.mathRender(previewElement, {\n        cdn: '"+e.options.cdn+"',\n        math: "+JSON.stringify(e.options.preview.math)+",\n    });\n    Vditor.mermaidRender(previewElement, '"+e.options.cdn+"', '"+e.options.theme+"');\n    Vditor.markmapRender(previewElement, '"+e.options.cdn+"', '"+e.options.theme+"');\n    Vditor.flowchartRender(previewElement, '"+e.options.cdn+"');\n    Vditor.graphvizRender(previewElement, '"+e.options.cdn+"');\n    Vditor.chartRender(previewElement, '"+e.options.cdn+"', '"+e.options.theme+"');\n    Vditor.mindmapRender(previewElement, '"+e.options.cdn+"', '"+e.options.theme+"');\n    Vditor.abcRender(previewElement, '"+e.options.cdn+"');\n    Vditor.mediaRender(previewElement);\n    Vditor.speechRender(previewElement);\n<\/script>\n<script src=\""+e.options.cdn+"/dist/js/icons/"+e.options.icon+'.js"><\/script></body></html>';si(e,i,t.substr(0,10)+".html")}(t)}g(t,["subToolbar"]),e.preventDefault(),e.stopPropagation()}})),n.element.appendChild(o),v(t,o,a,i.level),n}return li(t,e),t}(ve),di=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ui=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._bindEvent(t,i),n}return di(t,e),t.prototype._bindEvent=function(e,t){this.element.children[0].addEventListener((0,c.Le)(),(function(i){i.preventDefault(),e.element.className.includes("vditor--fullscreen")?(t.level||(this.innerHTML=t.icon),e.element.style.zIndex="",document.body.style.overflow="",e.element.classList.remove("vditor--fullscreen"),Object.keys(e.toolbar.elements).forEach((function(t){var i=e.toolbar.elements[t].firstChild;i&&(i.className=i.className.replace("__s","__n"))})),e.counter&&(e.counter.element.className=e.counter.element.className.replace("__s","__n"))):(t.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),e.element.style.zIndex=e.options.fullscreen.index.toString(),document.body.style.overflow="hidden",e.element.classList.add("vditor--fullscreen"),Object.keys(e.toolbar.elements).forEach((function(t){var i=e.toolbar.elements[t].firstChild;i&&(i.className=i.className.replace("__n","__s"))})),e.counter&&(e.counter.element.className=e.counter.element.className.replace("__n","__s"))),e.devtools&&e.devtools.renderEchart(e),t.click&&t.click(i,e),V(e),U(e)}))},t}(ve),hi=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pi=function(e){function t(t,i){var n=e.call(this,t,i)||this,a=document.createElement("div");return a.className="vditor-hint vditor-panel--arrow",a.innerHTML='<button data-tag="h1" data-value="# ">'+window.VditorI18n.heading1+" "+(0,c.ns)("&lt;⌥⌘1>")+'</button>\n<button data-tag="h2" data-value="## ">'+window.VditorI18n.heading2+" &lt;"+(0,c.ns)("⌥⌘2")+'></button>\n<button data-tag="h3" data-value="### ">'+window.VditorI18n.heading3+" &lt;"+(0,c.ns)("⌥⌘3")+'></button>\n<button data-tag="h4" data-value="#### ">'+window.VditorI18n.heading4+" &lt;"+(0,c.ns)("⌥⌘4")+'></button>\n<button data-tag="h5" data-value="##### ">'+window.VditorI18n.heading5+" &lt;"+(0,c.ns)("⌥⌘5")+'></button>\n<button data-tag="h6" data-value="###### ">'+window.VditorI18n.heading6+" &lt;"+(0,c.ns)("⌥⌘6")+"></button>",n.element.appendChild(a),n._bindEvent(t,a),n}return hi(t,e),t.prototype._bindEvent=function(e,t){var i=this.element.children[0];i.addEventListener((0,c.Le)(),(function(n){n.preventDefault(),clearTimeout(e.wysiwyg.afterRenderTimeoutId),i.classList.contains(a.g.CLASS_MENU_DISABLED)||(i.blur(),i.classList.contains("vditor-menu--current")?("wysiwyg"===e.currentMode?(ie(e),J(e)):"ir"===e.currentMode&&Dt(e,""),i.classList.remove("vditor-menu--current")):(g(e,["subToolbar"]),t.style.display="block"))}));for(var n=0;n<6;n++)t.children.item(n).addEventListener((0,c.Le)(),(function(n){n.preventDefault(),"wysiwyg"===e.currentMode?(te(e,n.target.getAttribute("data-tag")),J(e),i.classList.add("vditor-menu--current")):"ir"===e.currentMode?(Dt(e,n.target.getAttribute("data-value")),i.classList.add("vditor-menu--current")):Pe(e,n.target.getAttribute("data-value")),t.style.display="none"}))},t}(ve),fi=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mi=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.element.children[0].addEventListener((0,c.Le)(),(function(e){e.preventDefault(),t.tip.show('<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">\n<div style="margin-top: 14px;flex: 1">\n    <div>Markdown 使用指南</div>\n    <ul style="list-style: none">\n        <li><a href="https://ld246.com/article/1583308420519" target="_blank">语法速查手册</a></li>\n        <li><a href="https://ld246.com/article/1583129520165" target="_blank">基础语法</a></li>\n        <li><a href="https://ld246.com/article/1583305480675" target="_blank">扩展语法</a></li>\n        <li><a href="https://ld246.com/article/1582778815353" target="_blank">键盘快捷键</a></li>\n    </ul>\n</div>\n<div style="margin-top: 14px;flex: 1">\n    <div>Vditor 支持</div>\n    <ul style="list-style: none">\n        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>\n        <li><a href="https://ld246.com/tag/vditor" target="_blank">官方讨论区</a></li>\n        <li><a href="https://ld246.com/article/1549638745630" target="_blank">开发手册</a></li>\n        <li><a href="https://ld246.com/guide/markdown" target="_blank">演示地址</a></li>\n    </ul>\n</div></div>',0)})),n}return fi(t,e),t}(ve),gi=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vi=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.element.children[0].addEventListener((0,c.Le)(),(function(e){if(e.preventDefault(),!n.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)&&"sv"!==t.currentMode){var i=(0,N.zh)(t),o=(0,b.lG)(i.startContainer,"LI");o&&at(t,o,i)}})),n}return gi(t,e),t}(ve),bi=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),wi=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.element.children[0].addEventListener((0,c.Le)(),(function(e){e.preventDefault(),t.tip.show('<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">\n<p style="text-align: center;margin: 14px 0">\n    <em>下一代的 Markdown 编辑器，为未来而构建</em>\n</p>\n<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">\n    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>\n    <div>&nbsp;&nbsp;</div>\n    <div style="flex: 1;min-width: 250px">\n        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。\n        它使用 TypeScript 实现，支持原生 JavaScript 以及 Vue、React、Angular 和 Svelte 等框架。\n    </div>\n</div>\n<div style="display: flex;flex-wrap: wrap;">\n    <ul style="list-style: none;flex: 1;min-width:148px">\n        <li>\n        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>\n        </li>\n        <li>\n        开源协议：MIT\n        </li>\n    </ul>\n    <ul style="list-style: none;margin-right: 18px">\n        <li>\n        组件版本：Vditor v'+a.H+" / Lute v"+Lute.Version+'\n        </li>\n        <li>\n        赞助捐赠：<a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>\n        </li>\n    </ul>\n</div>\n</div>',0)})),n}return bi(t,e),t}(ve),yi=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),xi=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.element.children[0].addEventListener((0,c.Le)(),(function(e){e.preventDefault(),n.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)||"sv"===t.currentMode||Je(t,"afterend")})),n}return yi(t,e),t}(ve),Ci=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ki=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.element.children[0].addEventListener((0,c.Le)(),(function(e){e.preventDefault(),n.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)||"sv"===t.currentMode||Je(t,"beforebegin")})),n}return Ci(t,e),t}(ve),_i=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Si=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.element.children[0].addEventListener((0,c.Le)(),(function(e){if(e.preventDefault(),!n.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)&&"sv"!==t.currentMode){var i=(0,N.zh)(t),o=(0,b.lG)(i.startContainer,"LI");o&&ot(t,o,i,o.parentElement)}})),n}return _i(t,e),t}(ve),Li=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ti=function(e){function t(t,i){var n=e.call(this,t,i)||this;return t.options.outline&&n.element.firstElementChild.classList.add("vditor-menu--current"),n.element.children[0].addEventListener((0,c.Le)(),(function(e){e.preventDefault(),t.toolbar.elements.outline.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)||(t.options.outline.enable=!n.element.firstElementChild.classList.contains("vditor-menu--current"),t.outline.toggle(t,t.options.outline.enable))})),n}return Li(t,e),t}(ve),Di=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ei=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._bindEvent(t),n}return Di(t,e),t.prototype._bindEvent=function(e){var t=this;this.element.children[0].addEventListener((0,c.Le)(),(function(i){i.preventDefault();var n=t.element.firstElementChild;if(!n.classList.contains(a.g.CLASS_MENU_DISABLED)){var o=a.g.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);n.classList.contains("vditor-menu--current")?(n.classList.remove("vditor-menu--current"),"sv"===e.currentMode?(e.sv.element.style.display="block","both"===e.options.preview.mode?e.preview.element.style.display="block":e.preview.element.style.display="none"):(e[e.currentMode].element.parentElement.style.display="block",e.preview.element.style.display="none"),h(e.toolbar.elements,o),e.outline.render(e)):(p(e.toolbar.elements,o),e.preview.element.style.display="block","sv"===e.currentMode?e.sv.element.style.display="none":e[e.currentMode].element.parentElement.style.display="none",e.preview.render(e),n.classList.add("vditor-menu--current"),g(e,["subToolbar","hint","popover"]),setTimeout((function(){e.outline.render(e)}),e.options.preview.delay+10)),V(e)}}))},t}(ve),Fi=function(){function e(e){var t;if(this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0,"undefined"!=typeof AudioContext)t=new AudioContext;else{if(!webkitAudioContext)return;t=new webkitAudioContext}this.DEFAULT_SAMPLE_RATE=t.sampleRate;var i=t.createGain();t.createMediaStreamSource(e).connect(i),this.recorder=t.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,i.connect(this.recorder),this.recorder.connect(t.destination),this.readyFlag=!0}return e.prototype.cloneChannelData=function(e,t){this.leftChannel.push(new Float32Array(e)),this.rightChannel.push(new Float32Array(t)),this.recordingLength+=2048},e.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},e.prototype.stopRecording=function(){this.isRecording=!1},e.prototype.buildWavFileBlob=function(){for(var e=this.mergeBuffers(this.leftChannel),t=this.mergeBuffers(this.rightChannel),i=new Float32Array(e.length),n=0;n<e.length;++n)i[n]=.5*(e[n]+t[n]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(i=this.downSampleBuffer(i,this.SAMPLE_RATE));var a=44+2*i.length,o=new ArrayBuffer(a),r=new DataView(o);this.writeUTFBytes(r,0,"RIFF"),r.setUint32(4,a,!0),this.writeUTFBytes(r,8,"WAVE"),this.writeUTFBytes(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,1,!0),r.setUint32(24,this.SAMPLE_RATE,!0),r.setUint32(28,2*this.SAMPLE_RATE,!0),r.setUint16(32,2,!0),r.setUint16(34,16,!0);var s=2*i.length;this.writeUTFBytes(r,36,"data"),r.setUint32(40,s,!0);for(var l=i.length,c=44,d=0;d<l;d++)r.setInt16(c,32767*i[d],!0),c+=2;return new Blob([r],{type:"audio/wav"})},e.prototype.downSampleBuffer=function(e,t){if(t===this.DEFAULT_SAMPLE_RATE)return e;if(t>this.DEFAULT_SAMPLE_RATE)return e;for(var i=this.DEFAULT_SAMPLE_RATE/t,n=Math.round(e.length/i),a=new Float32Array(n),o=0,r=0;o<a.length;){for(var s=Math.round((o+1)*i),l=0,c=0,d=r;d<s&&d<e.length;d++)l+=e[d],c++;a[o]=l/c,o++,r=s}return a},e.prototype.mergeBuffers=function(e){for(var t=new Float32Array(this.recordingLength),i=0,n=e.length,a=0;a<n;++a){var o=e[a];t.set(o,i),i+=o.length}return t},e.prototype.writeUTFBytes=function(e,t,i){for(var n=i.length,a=0;a<n;a++)e.setUint8(t+a,i.charCodeAt(a))},e}(),Ii=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Mi=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._bindEvent(t),n}return Ii(t,e),t.prototype._bindEvent=function(e){var t,i=this;this.element.children[0].addEventListener((0,c.Le)(),(function(n){if(n.preventDefault(),!i.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)){var o=e[e.currentMode].element;if(t)if(t.isRecording){t.stopRecording(),e.tip.hide();var r=new File([t.buildWavFileBlob()],"record"+(new Date).getTime()+".wav",{type:"video/webm"});Be(e,[r]),i.element.children[0].classList.remove("vditor-menu--current")}else e.tip.show(window.VditorI18n.recording),o.setAttribute("contenteditable","false"),t.startRecordingNewWavFile(),i.element.children[0].classList.add("vditor-menu--current");else navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){(t=new Fi(n)).recorder.onaudioprocess=function(e){if(t.isRecording){var i=e.inputBuffer.getChannelData(0),n=e.inputBuffer.getChannelData(1);t.cloneChannelData(i,n)}},t.startRecordingNewWavFile(),e.tip.show(window.VditorI18n.recording),o.setAttribute("contenteditable","false"),i.element.children[0].classList.add("vditor-menu--current")})).catch((function(){e.tip.show(window.VditorI18n["record-tip"])}))}}))},t}(ve),Ni=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Oi=function(e){function t(t,i){var n=e.call(this,t,i)||this;return p({redo:n.element},["redo"]),n.element.children[0].addEventListener((0,c.Le)(),(function(e){e.preventDefault(),n.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)||t.undo.redo(t)})),n}return Ni(t,e),t}(ve),Ai=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pi=function(e){function t(t,i){var n=e.call(this,t,i)||this;return p({undo:n.element},["undo"]),n.element.children[0].addEventListener((0,c.Le)(),(function(e){e.preventDefault(),n.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED)||t.undo.undo(t)})),n}return Ai(t,e),t}(ve),$i=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ri=function(e){function t(t,i){var n=e.call(this,t,i)||this,a='<input type="file"';return t.options.upload.multiple&&(a+=' multiple="multiple"'),t.options.upload.accept&&(a+=' accept="'+t.options.upload.accept+'"'),n.element.children[0].innerHTML=""+(i.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>')+a+">",n._bindEvent(t),n}return $i(t,e),t.prototype._bindEvent=function(e){var t=this;this.element.children[0].addEventListener((0,c.Le)(),(function(e){if(t.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED))return e.stopPropagation(),void e.preventDefault()})),this.element.querySelector("input").addEventListener("change",(function(i){if(t.element.firstElementChild.classList.contains(a.g.CLASS_MENU_DISABLED))return i.stopPropagation(),void i.preventDefault();0!==i.target.files.length&&Be(e,i.target.files,i.target)}))},t}(ve),Hi=function(){function e(e){var t=this,i=e.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",i.toolbar.forEach((function(i,n){var a=t.genItem(e,i,n);if(t.element.appendChild(a),i.toolbar){var o=document.createElement("div");o.className="vditor-hint vditor-panel--arrow",o.addEventListener((0,c.Le)(),(function(e){o.style.display="none"})),i.toolbar.forEach((function(i,a){i.level=2,o.appendChild(t.genItem(e,i,n+a))})),a.appendChild(o),v(e,o,a.children[0])}})),e.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),e.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),e.options.counter.enable&&(e.counter=new Zt(e),this.element.appendChild(e.counter.element))}return e.prototype.genItem=function(e,t,i){var n;switch(t.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":n=new ve(e,t);break;case"emoji":n=new ri(e,t);break;case"headings":n=new pi(e,t);break;case"|":n=new ai;break;case"br":n=new Gt;break;case"undo":n=new Pi(e,t);break;case"redo":n=new Oi(e,t);break;case"help":n=new mi(e,t);break;case"both":n=new Wt(e,t);break;case"preview":n=new Ei(e,t);break;case"fullscreen":n=new ui(e,t);break;case"upload":n=new Ri(e,t);break;case"record":n=new Mi(e,t);break;case"info":n=new wi(e,t);break;case"edit-mode":n=new ye(e,t);break;case"devtools":n=new ni(e,t);break;case"outdent":n=new Si(e,t);break;case"indent":n=new vi(e,t);break;case"outline":n=new Ti(e,t);break;case"insert-after":n=new xi(e,t);break;case"insert-before":n=new ki(e,t);break;case"code-theme":n=new Yt(e,t);break;case"content-theme":n=new Qt(e,t);break;case"export":n=new ci(e,t);break;default:n=new ti(e,t)}if(n){var a=t.name;return"br"!==a&&"|"!==a||(a+=i),this.elements[a]=n.element,n.element}},e}(),ji=i(14),qi=function(){function e(){this.stackSize=50,this.resetStack(),this.dmp=new ji}return e.prototype.clearStack=function(e){this.resetStack(),this.resetIcon(e)},e.prototype.resetIcon=function(e){e.toolbar&&(this[e.currentMode].undoStack.length>1?h(e.toolbar.elements,["undo"]):p(e.toolbar.elements,["undo"]),0!==this[e.currentMode].redoStack.length?h(e.toolbar.elements,["redo"]):p(e.toolbar.elements,["redo"]))},e.prototype.undo=function(e){if("false"!==e[e.currentMode].element.getAttribute("contenteditable")&&!(this[e.currentMode].undoStack.length<2)){var t=this[e.currentMode].undoStack.pop();t&&(this[e.currentMode].redoStack.push(t),this.renderDiff(t,e),this[e.currentMode].hasUndo=!0,g(e,["hint"]))}},e.prototype.redo=function(e){if("false"!==e[e.currentMode].element.getAttribute("contenteditable")){var t=this[e.currentMode].redoStack.pop();t&&(this[e.currentMode].undoStack.push(t),this.renderDiff(t,e,!0))}},e.prototype.recordFirstPosition=function(e,t){if(0!==getSelection().rangeCount&&!(1!==this[e.currentMode].undoStack.length||0===this[e.currentMode].undoStack[0].length||this[e.currentMode].redoStack.length>0||(0,c.vU)()&&"Backspace"===t.key||(0,c.G6)())){var i=this.addCaret(e);i.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[e.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[e.currentMode].undoStack[0][0].diffs[0][1]=i,this[e.currentMode].lastText=i)}},e.prototype.addToUndoStack=function(e){var t=this.addCaret(e,!0),i=this.dmp.diff_main(t,this[e.currentMode].lastText,!0),n=this.dmp.patch_make(t,this[e.currentMode].lastText,i);0===n.length&&this[e.currentMode].undoStack.length>0||(this[e.currentMode].lastText=t,this[e.currentMode].undoStack.push(n),this[e.currentMode].undoStack.length>this.stackSize&&this[e.currentMode].undoStack.shift(),this[e.currentMode].hasUndo&&(this[e.currentMode].redoStack=[],this[e.currentMode].hasUndo=!1,p(e.toolbar.elements,["redo"])),this[e.currentMode].undoStack.length>1&&h(e.toolbar.elements,["undo"]))},e.prototype.renderDiff=function(e,t,i){var n;if(void 0===i&&(i=!1),i){var a=this.dmp.patch_deepCopy(e).reverse();a.forEach((function(e){e.diffs.forEach((function(e){e[0]=-e[0]}))})),n=this.dmp.patch_apply(a,this[t.currentMode].lastText)[0]}else n=this.dmp.patch_apply(e,this[t.currentMode].lastText)[0];if(this[t.currentMode].lastText=n,t[t.currentMode].element.innerHTML=n,"sv"!==t.currentMode&&t[t.currentMode].element.querySelectorAll(".vditor-"+t.currentMode+"__preview[data-render='2']").forEach((function(e){M(e,t)})),t[t.currentMode].element.querySelector("wbr"))(0,N.ib)(t[t.currentMode].element,t[t.currentMode].element.ownerDocument.createRange()),De(t);else{var o=getSelection().getRangeAt(0);o.setEndBefore(t[t.currentMode].element),o.collapse(!1)}O(t),ct(t,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),fe(t),t[t.currentMode].element.querySelectorAll(".vditor-"+t.currentMode+"__preview[data-render='2']").forEach((function(e){M(e,t)})),this[t.currentMode].undoStack.length>1?h(t.toolbar.elements,["undo"]):p(t.toolbar.elements,["undo"]),0!==this[t.currentMode].redoStack.length?h(t.toolbar.elements,["redo"]):p(t.toolbar.elements,["redo"])},e.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},e.prototype.addCaret=function(e,t){var i;if(void 0===t&&(t=!1),0!==getSelection().rangeCount&&!e[e.currentMode].element.querySelector("wbr")){var n=getSelection().getRangeAt(0);if(e[e.currentMode].element.contains(n.startContainer)){i=n.cloneRange();var a=document.createElement("span");a.className="vditor-wbr",n.insertNode(a)}}e.ir.element.cloneNode(!0).querySelectorAll(".vditor-"+e.currentMode+"__preview[data-render='1']").forEach((function(e){(e.firstElementChild.classList.contains("language-echarts")||e.firstElementChild.classList.contains("language-plantuml")||e.firstElementChild.classList.contains("language-mindmap"))&&(e.firstElementChild.removeAttribute("_echarts_instance_"),e.firstElementChild.removeAttribute("data-processed"),e.firstElementChild.innerHTML=e.previousElementSibling.firstElementChild.innerHTML,e.setAttribute("data-render","2")),e.firstElementChild.classList.contains("language-math")&&(e.setAttribute("data-render","2"),e.firstElementChild.textContent=e.firstElementChild.getAttribute("data-math"),e.firstElementChild.removeAttribute("data-math"))}));var o=e[e.currentMode].element.innerHTML;return e[e.currentMode].element.querySelectorAll(".vditor-wbr").forEach((function(e){e.remove()})),t&&i&&(0,N.Hc)(i),o.replace('<span class="vditor-wbr"></span>',"<wbr>")},e}(),zi=i(640),Bi=function(){function e(e){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:a.g.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:a.g.CDN+"/dist/images/emoji",extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:a.g.HLJS_OPTIONS,markdown:a.g.MARKDOWN_OPTIONS,math:a.g.MATH_OPTIONS,maxWidth:800,mode:"both",theme:a.g.THEME_OPTIONS},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(e){return e.replace(/\W/g,"")},linkToImgUrl:"",max:10485760,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=e}return e.prototype.merge=function(){var e,t,i;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),(null===(t=null===(e=this.options.preview)||void 0===e?void 0:e.theme)||void 0===t?void 0:t.list)&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),(null===(i=this.options.hint)||void 0===i?void 0:i.emoji)&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment));var n=(0,zi.T)(this.defaultOptions,this.options);if(n.cache.enable&&!n.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return n},e.prototype.mergeToolbar=function(e){var t=this,i=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⇧⌘I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⇧⌘O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⇧⌘H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⇧⌘B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⇧⌘E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:" | col2 | col3 |\n| --- | --- | --- |\n|  |  |  |\n|  |  |  |",tipPosition:"n"},{name:"|"},{hotkey:"⌘Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],n=[];return e.forEach((function(e){var a=e;i.forEach((function(t){"string"==typeof e&&t.name===e&&(a=t),"object"==typeof e&&t.name===e.name&&(a=Object.assign({},t,e))})),e.toolbar&&(a.toolbar=t.mergeToolbar(e.toolbar)),n.push(a)})),n},e}(),Vi=function(){function e(e){var t=this;this.composingLock=!1,this.commentIds=[];var i=document.createElement("div");i.className="vditor-wysiwyg",i.innerHTML='<pre class="vditor-reset" placeholder="'+e.options.placeholder+'"\n contenteditable="true" spellcheck="false"></pre>\n<div class="vditor-panel vditor-panel--none"></div>\n<div class="vditor-panel vditor-panel--none">\n    <button type="button" aria-label="'+window.VditorI18n.comment+'" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">\n        <svg><use xlink:href="#vditor-icon-comment"></use></svg>\n    </button>\n</div>',this.element=i.firstElementChild,this.popover=i.firstElementChild.nextElementSibling,this.selectPopover=i.lastElementChild,this.bindEvent(e),Ce(e,this.element),ke(e,this.element),_e(e,this.element),Ee(e,this.element),Fe(e,this.element),Se(e,this.element),Le(e,this.element,this.copy),Te(e,this.element,this.copy),e.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var i,n,o=Lute.NewNodeID(),r=getSelection().getRangeAt(0),s=r.cloneRange(),l=r.extractContents(),c=!1,d=!1;l.childNodes.forEach((function(e,t){var a=!1;if(3===e.nodeType?a=!0:e.classList.contains("vditor-comment")?e.classList.contains("vditor-comment")&&e.setAttribute("data-cmtids",e.getAttribute("data-cmtids")+" "+o):a=!0,a)if(3!==e.nodeType&&"0"===e.getAttribute("data-block")&&0===t&&s.startOffset>0)e.innerHTML='<span class="vditor-comment" data-cmtids="'+o+'">'+e.innerHTML+"</span>",i=e;else if(3!==e.nodeType&&"0"===e.getAttribute("data-block")&&t===l.childNodes.length-1&&s.endOffset<s.endContainer.textContent.length)e.innerHTML='<span class="vditor-comment" data-cmtids="'+o+'">'+e.innerHTML+"</span>",n=e;else if(3!==e.nodeType&&"0"===e.getAttribute("data-block"))0===t?c=!0:t===l.childNodes.length-1&&(d=!0),e.innerHTML='<span class="vditor-comment" data-cmtids="'+o+'">'+e.innerHTML+"</span>";else{var r=document.createElement("span");r.classList.add("vditor-comment"),r.setAttribute("data-cmtids",o),e.parentNode.insertBefore(r,e),r.appendChild(e)}}));var u=(0,b.F9)(s.startContainer);u&&(i?(u.insertAdjacentHTML("beforeend",i.innerHTML),i.remove()):""===u.textContent.trim().replace(a.g.ZWSP,"")&&c&&u.remove());var h=(0,b.F9)(s.endContainer);h&&(n?(h.insertAdjacentHTML("afterbegin",n.innerHTML),n.remove()):""===h.textContent.trim().replace(a.g.ZWSP,"")&&d&&h.remove()),r.insertNode(l),e.options.comment.add(o,r.toString(),t.getComments(e,!0)),J(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),t.hideComment()})}return e.prototype.getComments=function(e,t){var i=this;if(void 0===t&&(t=!1),"wysiwyg"!==e.currentMode||!e.options.comment.enable)return[];this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach((function(e){i.commentIds=i.commentIds.concat(e.getAttribute("data-cmtids").split(" "))})),this.commentIds=Array.from(new Set(this.commentIds));var n=[];return t?(this.commentIds.forEach((function(e){n.push({id:e,top:i.element.querySelector('.vditor-comment[data-cmtids="'+e+'"]').offsetTop})})),n):void 0},e.prototype.triggerRemoveComment=function(e){var t,i,n;if("wysiwyg"===e.currentMode&&e.options.comment.enable&&e.wysiwyg.commentIds.length>0){var a=JSON.parse(JSON.stringify(this.commentIds));this.getComments(e);var o=(t=a,i=this.commentIds,n=new Set(i),t.filter((function(e){return!n.has(e)})));o.length>0&&e.options.comment.remove(o)}},e.prototype.showComment=function(){var e=(0,N.Ny)(this.element);this.selectPopover.setAttribute("style","left:"+e.left+"px;display:block;top:"+Math.max(-8,e.top-21)+"px")},e.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},e.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},e.prototype.copy=function(e,t){var i=getSelection().getRangeAt(0);if(""!==i.toString()){e.stopPropagation(),e.preventDefault();var n=(0,b.lG)(i.startContainer,"CODE"),a=(0,b.lG)(i.endContainer,"CODE");if(n&&a&&a.isSameNode(n)){var o="";return o="PRE"===n.parentElement.tagName?i.toString():"`"+i.toString()+"`",e.clipboardData.setData("text/plain",o),void e.clipboardData.setData("text/html","")}var r=(0,b.lG)(i.startContainer,"A"),s=(0,b.lG)(i.endContainer,"A");if(r&&s&&s.isSameNode(r)){var l=r.getAttribute("title")||"";return l&&(l=' "'+l+'"'),e.clipboardData.setData("text/plain","["+i.toString()+"]("+r.getAttribute("href")+l+")"),void e.clipboardData.setData("text/html","")}var c=document.createElement("div");c.appendChild(i.cloneContents()),e.clipboardData.setData("text/plain",t.lute.VditorDOM2Md(c.innerHTML).trim()),e.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(e){var t=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(g(e,["hint"]),"block"===t.popover.style.display&&"block"===t.selectPopover.style.display){var i=parseInt(t.popover.getAttribute("data-top"),10);if("auto"===e.options.height){if(e.options.toolbarConfig.pin){var n=Math.max(i,window.scrollY-e.element.offsetTop-8)+"px";"block"===t.popover.style.display&&(t.popover.style.top=n),"block"===t.selectPopover.style.display&&(t.selectPopover.style.top=n)}}else if(e.options.toolbarConfig.pin&&0===e.toolbar.element.getBoundingClientRect().top){var a=Math.max(window.scrollY-e.element.offsetTop-8,Math.min(i-e.wysiwyg.element.scrollTop,t.element.clientHeight-21))+"px";"block"===t.popover.style.display&&(t.popover.style.top=a),"block"===t.selectPopover.style.display&&(t.selectPopover.style.top=a)}}}),this.element.addEventListener("scroll",(function(){if(g(e,["hint"]),e.options.comment&&e.options.comment.enable&&e.options.comment.scroll&&e.options.comment.scroll(e.wysiwyg.element.scrollTop),"block"===t.popover.style.display){var i=parseInt(t.popover.getAttribute("data-top"),10)-e.wysiwyg.element.scrollTop,n=-8;e.options.toolbarConfig.pin&&0===e.toolbar.element.getBoundingClientRect().top&&(n=window.scrollY-e.element.offsetTop+n);var a=Math.max(n,Math.min(i,t.element.clientHeight-21))+"px";t.popover.style.top=a,t.selectPopover.style.top=a}})),this.element.addEventListener("paste",(function(t){St(e,t,{pasteCode:function(t){var i=(0,N.zh)(e),n=document.createElement("template");n.innerHTML=t,i.insertNode(n.content.cloneNode(!0));var a=(0,b.a1)(i.startContainer,"data-block","0");a?a.outerHTML=e.lute.SpinVditorDOM(a.outerHTML):e.wysiwyg.element.innerHTML=e.lute.SpinVditorDOM(e.wysiwyg.element.innerHTML),(0,N.ib)(e.wysiwyg.element,i)}})})),this.element.addEventListener("compositionstart",(function(){t.composingLock=!0})),this.element.addEventListener("compositionend",(function(i){var n=(0,w.W)(getSelection().getRangeAt(0).startContainer);n&&""===n.textContent?O(e):((0,c.vU)()||Ve(e,getSelection().getRangeAt(0).cloneRange(),i),t.composingLock=!1)})),this.element.addEventListener("input",(function(i){if("deleteByDrag"!==i.inputType&&"insertFromDrop"!==i.inputType){if(t.preventInput)return t.preventInput=!1,void J(e);if(t.composingLock||"‘"===i.data||"“"===i.data||"《"===i.data)J(e);else{var n=getSelection().getRangeAt(0),a=(0,b.F9)(n.startContainer);if(a||(ee(e,n),a=(0,b.F9)(n.startContainer)),a){for(var o=(0,N.im)(a,e.wysiwyg.element,n).start,s=!0,l=o-1;l>a.textContent.substr(0,o).lastIndexOf("\n");l--)if(" "!==a.textContent.charAt(l)&&"\t"!==a.textContent.charAt(l)){s=!1;break}0===o&&(s=!1);var c=!0;for(l=o-1;l<a.textContent.length;l++)if(" "!==a.textContent.charAt(l)&&"\n"!==a.textContent.charAt(l)){c=!1;break}var d=(0,w.W)(getSelection().getRangeAt(0).startContainer);d&&""===d.textContent&&(O(e),d.remove()),s&&"code-block"!==a.getAttribute("data-type")||c||lt(a.innerHTML)||st(a.innerHTML)&&a.previousElementSibling?"function"==typeof e.options.input&&e.options.input(r(e)):Ve(e,n,i)}}}})),this.element.addEventListener("click",(function(i){if("INPUT"===i.target.tagName){var n=i.target;return n.checked?n.setAttribute("checked","checked"):n.removeAttribute("checked"),t.preventInput=!0,void J(e)}if("IMG"!==i.target.tagName||i.target.parentElement.classList.contains("vditor-wysiwyg__preview")){if("A"===i.target.tagName)return e.options.link.click?e.options.link.click(i.target):e.options.link.isOpen&&window.open(i.target.getAttribute("href")),void i.preventDefault();var o=(0,N.zh)(e);if(i.target.isEqualNode(t.element)&&t.element.lastElementChild&&o.collapsed){var r=t.element.lastElementChild.getBoundingClientRect();i.y>r.top+r.height&&("P"===t.element.lastElementChild.tagName&&""===t.element.lastElementChild.textContent.trim().replace(a.g.ZWSP,"")?(o.selectNodeContents(t.element.lastElementChild),o.collapse(!1)):(t.element.insertAdjacentHTML("beforeend",'<p data-block="0">'+a.g.ZWSP+"<wbr></p>"),(0,N.ib)(t.element,o)))}oe(e);var s=(0,b.fb)(i.target,"vditor-wysiwyg__preview");s||(s=(0,b.fb)((0,N.zh)(e).startContainer,"vditor-wysiwyg__preview")),s&&ne(s,e),A(i,e)}else"link-ref"===i.target.getAttribute("data-type")?se(e,i.target):function(e,t){var i=e.target;t.wysiwyg.popover.innerHTML="";var n=function(){i.setAttribute("src",o.value),i.setAttribute("alt",s.value),i.setAttribute("title",c.value)},a=document.createElement("span");a.setAttribute("aria-label",window.VditorI18n.imageURL),a.className="vditor-tooltipped vditor-tooltipped__n";var o=document.createElement("input");a.appendChild(o),o.className="vditor-input",o.setAttribute("placeholder",window.VditorI18n.imageURL),o.value=i.getAttribute("src")||"",o.oninput=function(){n()},o.onkeydown=function(e){ae(t,e)};var r=document.createElement("span");r.setAttribute("aria-label",window.VditorI18n.alternateText),r.className="vditor-tooltipped vditor-tooltipped__n";var s=document.createElement("input");r.appendChild(s),s.className="vditor-input",s.setAttribute("placeholder",window.VditorI18n.alternateText),s.style.width="52px",s.value=i.getAttribute("alt")||"",s.oninput=function(){n()},s.onkeydown=function(e){ae(t,e)};var l=document.createElement("span");l.setAttribute("aria-label",window.VditorI18n.title),l.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");l.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.title),c.value=i.getAttribute("title")||"",c.oninput=function(){n()},c.onkeydown=function(e){ae(t,e)},de(i,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",a),t.wysiwyg.popover.insertAdjacentElement("beforeend",r),t.wysiwyg.popover.insertAdjacentElement("beforeend",l),re(t,i)}(i,e)})),this.element.addEventListener("keyup",(function(t){if(!t.isComposing&&!(0,c.yl)(t)){"Enter"===t.key&&De(e),"Backspace"!==t.key&&"Delete"!==t.key||""===e.wysiwyg.element.innerHTML||1!==e.wysiwyg.element.childNodes.length||!e.wysiwyg.element.firstElementChild||"P"!==e.wysiwyg.element.firstElementChild.tagName||0!==e.wysiwyg.element.firstElementChild.childElementCount||""!==e.wysiwyg.element.textContent&&"\n"!==e.wysiwyg.element.textContent||(e.wysiwyg.element.innerHTML="");var i=(0,N.zh)(e);if("Backspace"===t.key&&(0,c.vU)()&&"\n"===i.startContainer.textContent&&1===i.startOffset&&(i.startContainer.textContent=""),ee(e,i),oe(e),"ArrowDown"===t.key||"ArrowRight"===t.key||"Backspace"===t.key||"ArrowLeft"===t.key||"ArrowUp"===t.key){"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||e.hint.render(e);var n=(0,b.fb)(i.startContainer,"vditor-wysiwyg__preview");if(!n&&3!==i.startContainer.nodeType&&i.startOffset>0&&(o=i.startContainer).classList.contains("vditor-wysiwyg__block")&&(n=o.lastElementChild),n)if("none"!==n.previousElementSibling.style.display){var a=n.previousElementSibling;if("PRE"===a.tagName&&(a=a.firstElementChild),"ArrowDown"===t.key||"ArrowRight"===t.key){var o,r=function(e){for(var t=e;t&&!t.nextSibling;)t=t.parentElement;return t.nextSibling}(o=n.parentElement);if(r&&3!==r.nodeType){var s=r.querySelector(".vditor-wysiwyg__preview");if(s)return void ne(s,e)}if(3===r.nodeType){for(;0===r.textContent.length&&r.nextSibling;)r=r.nextSibling;i.setStart(r,1)}else i.setStart(r.firstChild,0)}else i.selectNodeContents(a),i.collapse(!1)}else"ArrowDown"===t.key||"ArrowRight"===t.key?ne(n,e):ne(n,e,!1)}}}))},e}(),Ui=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Wi=function(e){function t(t,i){var n=e.call(this)||this;n.version=a.H,"string"==typeof t&&(i?i.cache?i.cache.id||(i.cache.id="vditor"+t):i.cache={id:"vditor"+t}:i={cache:{id:"vditor"+t}},t=document.getElementById(t));var o=new Bi(i).merge();if(o.i18n)window.VditorI18n=o.i18n,n.init(t,o);else{if(!["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(o.lang))throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");var r="vditorI18nScript",l=r+o.lang;document.querySelectorAll('head script[id^="vditorI18nScript"]').forEach((function(e){e.id!==l&&document.head.removeChild(e)})),(0,s.G)(o.cdn+"/dist/js/i18n/"+o.lang+".js",l).then((function(){n.init(t,o)}))}return n}return Ui(t,e),t.prototype.setTheme=function(e,t,i,n){this.vditor.options.theme=e,B(this.vditor),t&&(this.vditor.options.preview.theme.current=t,(0,z.Z)(t,n||this.vditor.options.preview.theme.path)),i&&(this.vditor.options.preview.hljs.style=i,(0,Xt.Y)(i,this.vditor.options.cdn))},t.prototype.getValue=function(){return r(this.vditor)},t.prototype.getCurrentMode=function(){return this.vditor.currentMode},t.prototype.focus=function(){"sv"===this.vditor.currentMode?this.vditor.sv.element.focus():"wysiwyg"===this.vditor.currentMode?this.vditor.wysiwyg.element.focus():"ir"===this.vditor.currentMode&&this.vditor.ir.element.focus()},t.prototype.blur=function(){"sv"===this.vditor.currentMode?this.vditor.sv.element.blur():"wysiwyg"===this.vditor.currentMode?this.vditor.wysiwyg.element.blur():"ir"===this.vditor.currentMode&&this.vditor.ir.element.blur()},t.prototype.disabled=function(){g(this.vditor,["subToolbar","hint","popover"]),p(this.vditor.toolbar.elements,a.g.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},t.prototype.enable=function(){h(this.vditor.toolbar.elements,a.g.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},t.prototype.getSelection=function(){return"wysiwyg"===this.vditor.currentMode?xe(this.vditor.wysiwyg.element):"sv"===this.vditor.currentMode?xe(this.vditor.sv.element):"ir"===this.vditor.currentMode?xe(this.vditor.ir.element):void 0},t.prototype.renderPreview=function(e){this.vditor.preview.render(this.vditor,e)},t.prototype.getCursorPosition=function(){return(0,N.Ny)(this.vditor[this.vditor.currentMode].element)},t.prototype.isUploading=function(){return this.vditor.upload.isUploading},t.prototype.clearCache=function(){localStorage.removeItem(this.vditor.options.cache.id)},t.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},t.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},t.prototype.html2md=function(e){return this.vditor.lute.HTML2Md(e)},t.prototype.exportJSON=function(e){return this.vditor.lute.RenderJSON(e)},t.prototype.getHTML=function(){return At(this.vditor)},t.prototype.tip=function(e,t){this.vditor.tip.show(e,t)},t.prototype.setPreviewMode=function(e){Vt(e,this.vditor)},t.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},t.prototype.updateValue=function(e){document.execCommand("insertHTML",!1,e)},t.prototype.insertValue=function(e,t){void 0===t&&(t=!0);var i=(0,N.zh)(this.vditor);i.collapse(!0);var n=document.createElement("template");n.innerHTML=e,i.insertNode(n.content.cloneNode(!0)),"sv"===this.vditor.currentMode?(this.vditor.sv.preventInput=!0,t&&q(this.vditor)):"wysiwyg"===this.vditor.currentMode?(this.vditor.wysiwyg.preventInput=!0,t&&Ve(this.vditor,getSelection().getRangeAt(0))):"ir"===this.vditor.currentMode&&(this.vditor.ir.preventInput=!0,t&&$(this.vditor,getSelection().getRangeAt(0),!0))},t.prototype.setValue=function(e,t){var i=this;void 0===t&&(t=!1),"sv"===this.vditor.currentMode?(this.vditor.sv.element.innerHTML="<div data-block='0'>"+this.vditor.lute.SpinVditorSVDOM(e)+"</div>",Ae(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):"wysiwyg"===this.vditor.currentMode?me(this.vditor,e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(e),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach((function(e){M(e,i.vditor)})),Tt(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),e||(g(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),t&&this.clearStack()},t.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},t.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var e=document.getElementById("vditorIconScript");e&&e.remove(),this.clearCache(),W(),this.vditor.wysiwyg.unbindListener()},t.prototype.getCommentIds=function(){return"wysiwyg"!==this.vditor.currentMode?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},t.prototype.hlCommentIds=function(e){if("wysiwyg"===this.vditor.currentMode){var t=function(t){t.classList.remove("vditor-comment--hover"),e.forEach((function(e){t.getAttribute("data-cmtids").indexOf(e)>-1&&t.classList.add("vditor-comment--hover")}))};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach((function(e){t(e)})),"none"!==this.vditor.preview.element.style.display&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach((function(e){t(e)}))}},t.prototype.unHlCommentIds=function(e){if("wysiwyg"===this.vditor.currentMode){var t=function(t){e.forEach((function(e){t.getAttribute("data-cmtids").indexOf(e)>-1&&t.classList.remove("vditor-comment--hover")}))};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach((function(e){t(e)})),"none"!==this.vditor.preview.element.style.display&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach((function(e){t(e)}))}},t.prototype.removeCommentIds=function(e){var t=this;if("wysiwyg"===this.vditor.currentMode){var i=function(e,i){var n=e.getAttribute("data-cmtids").split(" ");n.find((function(e,t){if(e===i)return n.splice(t,1),!0})),0===n.length?(e.outerHTML=e.innerHTML,(0,N.zh)(t.vditor).collapse(!0)):e.setAttribute("data-cmtids",n.join(" "))};e.forEach((function(e){t.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach((function(t){i(t,e)})),"none"!==t.vditor.preview.element.style.display&&t.vditor.preview.element.querySelectorAll(".vditor-comment").forEach((function(t){i(t,e)}))})),J(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},t.prototype.init=function(e,t){var i=this;this.vditor={currentMode:t.mode,element:e,hint:new Nt(t.hint.extend),lute:void 0,options:t,originalInnerHTML:e.innerHTML,outline:new Rt(window.VditorI18n.outline),tip:new Bt},this.vditor.sv=new zt(this.vditor),this.vditor.undo=new qi,this.vditor.wysiwyg=new Vi(this.vditor),this.vditor.ir=new Ot(this.vditor),this.vditor.toolbar=new Hi(this.vditor),t.resize.enable&&(this.vditor.resize=new qt(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new l),(t.upload.url||t.upload.handler)&&(this.vditor.upload=new ze),(0,s.G)(t._lutePath||t.cdn+"/dist/js/lute/lute.min.js","vditorLuteScript").then((function(){i.vditor.lute=(0,Pt.X)({autoSpace:i.vditor.options.preview.markdown.autoSpace,codeBlockPreview:i.vditor.options.preview.markdown.codeBlockPreview,emojiSite:i.vditor.options.hint.emojiPath,emojis:i.vditor.options.hint.emoji,fixTermTypo:i.vditor.options.preview.markdown.fixTermTypo,footnotes:i.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:i.vditor.options.preview.math.inlineDigit,linkBase:i.vditor.options.preview.markdown.linkBase,linkPrefix:i.vditor.options.preview.markdown.linkPrefix,listStyle:i.vditor.options.preview.markdown.listStyle,mark:i.vditor.options.preview.markdown.mark,mathBlockPreview:i.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:i.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:i.vditor.options.preview.markdown.sanitize,toc:i.vditor.options.preview.markdown.toc}),i.vditor.preview=new jt(i.vditor),function(e){e.element.innerHTML="",e.element.classList.add("vditor"),e.options.rtl&&e.element.setAttribute("dir","rtl"),B(e),(0,z.Z)(e.options.preview.theme.current,e.options.preview.theme.path),"number"==typeof e.options.height?e.element.style.height=e.options.height+"px":e.element.style.height=e.options.height,"number"==typeof e.options.minHeight&&(e.element.style.minHeight=e.options.minHeight+"px"),"number"==typeof e.options.width?e.element.style.width=e.options.width+"px":e.element.style.width=e.options.width,e.element.appendChild(e.toolbar.element);var t=document.createElement("div");if(t.className="vditor-content","left"===e.options.outline.position&&t.appendChild(e.outline.element),t.appendChild(e.wysiwyg.element.parentElement),t.appendChild(e.sv.element),t.appendChild(e.ir.element.parentElement),t.appendChild(e.preview.element),e.toolbar.elements.devtools&&t.appendChild(e.devtools.element),"right"===e.options.outline.position&&(e.outline.element.classList.add("vditor-outline--right"),t.appendChild(e.outline.element)),e.upload&&t.appendChild(e.upload.element),e.options.resize.enable&&t.appendChild(e.resize.element),t.appendChild(e.hint.element),t.appendChild(e.tip.element),e.element.appendChild(t),t.addEventListener("click",(function(){g(e,["subToolbar"])})),e.toolbar.elements.export&&e.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),we(e,e.options.mode,K(e)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&void 0!==window.visualViewport){var i=!1,n=function(t){i||(i=!0,requestAnimationFrame((function(){i=!1;var t=e.toolbar.element;t.style.transform="none",t.getBoundingClientRect().top<0&&(t.style.transform="translate(0, "+-t.getBoundingClientRect().top+"px)")})))};window.visualViewport.addEventListener("scroll",n),window.visualViewport.addEventListener("resize",n)}}(i.vditor),t.after&&t.after(),t.icon&&(0,s.J)(t.cdn+"/dist/js/icons/"+t.icon+".js","vditorIconScript")}))},t}(t.default)})(),n.default})()}))},ff90:function(e,t,i){}}]);